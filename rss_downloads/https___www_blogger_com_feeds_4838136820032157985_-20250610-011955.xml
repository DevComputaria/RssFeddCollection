<?xml version='1.0' encoding='UTF-8'?><?xml-stylesheet href="http://www.blogger.com/styles/atom.css" type="text/css"?><entry xmlns='http://www.w3.org/2005/Atom' xmlns:blogger='http://schemas.google.com/blogger/2008' xmlns:georss='http://www.georss.org/georss' xmlns:gd='http://schemas.google.com/g/2005' xmlns:thr='http://purl.org/syndication/thread/1.0'><id>tag:blogger.com,1999:blog-4838136820032157985.post-2386590713508572091</id><published>2021-02-03T09:10:00.006-08:00</published><updated>2021-02-04T10:23:09.489-08:00</updated><title type='text'>Déjà vu-lnerability</title><content type='html'>&lt;style type=&quot;text/css&quot;&gt;@import url(&#39;https://themes.googleusercontent.com/fonts/css?kit=cGvuclDC_Z1vE_cnVEU6Ae_NZQ7StBcqH_vXVqoPMX0&#39;);.lst-kix_r9pow2tp8cv0-3&gt;li{counter-increment:lst-ctn-kix_r9pow2tp8cv0-3}ol.lst-kix_r9pow2tp8cv0-8.start{counter-reset:lst-ctn-kix_r9pow2tp8cv0-8 0}ol.lst-kix_rh2sjnt7clnl-5.start{counter-reset:lst-ctn-kix_rh2sjnt7clnl-5 0}.lst-kix_r9pow2tp8cv0-8&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_r9pow2tp8cv0-8,lower-roman) &quot;. &quot;}ol.lst-kix_r9pow2tp8cv0-5.start{counter-reset:lst-ctn-kix_r9pow2tp8cv0-5 0}ol.lst-kix_rh2sjnt7clnl-2.start{counter-reset:lst-ctn-kix_rh2sjnt7clnl-2 0}.lst-kix_xcgzvmnt5e4b-8&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_r9pow2tp8cv0-4&gt;li:before{content:&quot;(&quot; counter(lst-ctn-kix_r9pow2tp8cv0-4,lower-latin) &quot;) &quot;}.lst-kix_r9pow2tp8cv0-6&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_r9pow2tp8cv0-6,decimal) &quot;. &quot;}.lst-kix_r9pow2tp8cv0-3&gt;li:before{content:&quot;(&quot; counter(lst-ctn-kix_r9pow2tp8cv0-3,decimal) &quot;) &quot;}.lst-kix_r9pow2tp8cv0-7&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_r9pow2tp8cv0-7,lower-latin) &quot;. &quot;}.lst-kix_rh2sjnt7clnl-0&gt;li{counter-increment:lst-ctn-kix_rh2sjnt7clnl-0}.lst-kix_r9pow2tp8cv0-4&gt;li{counter-increment:lst-ctn-kix_r9pow2tp8cv0-4}ol.lst-kix_rh2sjnt7clnl-8.start{counter-reset:lst-ctn-kix_rh2sjnt7clnl-8 0}.lst-kix_r9pow2tp8cv0-5&gt;li:before{content:&quot;(&quot; counter(lst-ctn-kix_r9pow2tp8cv0-5,lower-roman) &quot;) &quot;}.lst-kix_ir94vkdxrs7o-0&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_ir94vkdxrs7o-2&gt;li:before{content:&quot;\0025a0  &quot;}ul.lst-kix_ir94vkdxrs7o-0{list-style-type:none}ul.lst-kix_ir94vkdxrs7o-1{list-style-type:none}.lst-kix_ir94vkdxrs7o-3&gt;li:before{content:&quot;\0025cf  &quot;}ul.lst-kix_ir94vkdxrs7o-2{list-style-type:none}ul.lst-kix_ir94vkdxrs7o-3{list-style-type:none}ul.lst-kix_ir94vkdxrs7o-4{list-style-type:none}ul.lst-kix_ir94vkdxrs7o-5{list-style-type:none}.lst-kix_r9pow2tp8cv0-0&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_r9pow2tp8cv0-0,decimal) &quot;) &quot;}.lst-kix_r9pow2tp8cv0-2&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_r9pow2tp8cv0-2,lower-roman) &quot;) &quot;}ul.lst-kix_ir94vkdxrs7o-6{list-style-type:none}.lst-kix_r9pow2tp8cv0-5&gt;li{counter-increment:lst-ctn-kix_r9pow2tp8cv0-5}ul.lst-kix_ir94vkdxrs7o-7{list-style-type:none}ul.lst-kix_ir94vkdxrs7o-8{list-style-type:none}.lst-kix_ir94vkdxrs7o-1&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_r9pow2tp8cv0-1&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_r9pow2tp8cv0-1,lower-latin) &quot;) &quot;}.lst-kix_rh2sjnt7clnl-1&gt;li{counter-increment:lst-ctn-kix_rh2sjnt7clnl-1}.lst-kix_r9pow2tp8cv0-2&gt;li{counter-increment:lst-ctn-kix_r9pow2tp8cv0-2}ol.lst-kix_r9pow2tp8cv0-2.start{counter-reset:lst-ctn-kix_r9pow2tp8cv0-2 0}.lst-kix_wa1quvbznvvl-0&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_wa1quvbznvvl-1&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_r9pow2tp8cv0-0&gt;li{counter-increment:lst-ctn-kix_r9pow2tp8cv0-0}ol.lst-kix_r9pow2tp8cv0-3.start{counter-reset:lst-ctn-kix_r9pow2tp8cv0-3 0}.lst-kix_rh2sjnt7clnl-0&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_rh2sjnt7clnl-0,decimal) &quot;) &quot;}.lst-kix_rh2sjnt7clnl-1&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_rh2sjnt7clnl-1,lower-latin) &quot;) &quot;}.lst-kix_r9pow2tp8cv0-6&gt;li{counter-increment:lst-ctn-kix_r9pow2tp8cv0-6}ul.lst-kix_xcgzvmnt5e4b-8{list-style-type:none}.lst-kix_wa1quvbznvvl-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_rh2sjnt7clnl-2&gt;li{counter-increment:lst-ctn-kix_rh2sjnt7clnl-2}.lst-kix_rh2sjnt7clnl-3&gt;li:before{content:&quot;(&quot; counter(lst-ctn-kix_rh2sjnt7clnl-3,decimal) &quot;) &quot;}.lst-kix_wa1quvbznvvl-4&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_wa1quvbznvvl-5&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_wa1quvbznvvl-3&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_rh2sjnt7clnl-2&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_rh2sjnt7clnl-2,lower-roman) &quot;) &quot;}.lst-kix_ir94vkdxrs7o-8&gt;li:before{content:&quot;\0025a0  &quot;}ol.lst-kix_rh2sjnt7clnl-3.start{counter-reset:lst-ctn-kix_rh2sjnt7clnl-3 0}.lst-kix_ir94vkdxrs7o-6&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_ir94vkdxrs7o-7&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_ir94vkdxrs7o-4&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_ir94vkdxrs7o-5&gt;li:before{content:&quot;\0025a0  &quot;}ol.lst-kix_r9pow2tp8cv0-4.start{counter-reset:lst-ctn-kix_r9pow2tp8cv0-4 0}.lst-kix_rh2sjnt7clnl-8&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_rh2sjnt7clnl-8,lower-roman) &quot;. &quot;}.lst-kix_wa1quvbznvvl-8&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_wa1quvbznvvl-6&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_rh2sjnt7clnl-7&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_rh2sjnt7clnl-7,lower-latin) &quot;. &quot;}.lst-kix_rh2sjnt7clnl-8&gt;li{counter-increment:lst-ctn-kix_rh2sjnt7clnl-8}.lst-kix_rh2sjnt7clnl-4&gt;li:before{content:&quot;(&quot; counter(lst-ctn-kix_rh2sjnt7clnl-4,lower-latin) &quot;) &quot;}.lst-kix_rh2sjnt7clnl-5&gt;li:before{content:&quot;(&quot; counter(lst-ctn-kix_rh2sjnt7clnl-5,lower-roman) &quot;) &quot;}.lst-kix_rh2sjnt7clnl-5&gt;li{counter-increment:lst-ctn-kix_rh2sjnt7clnl-5}.lst-kix_wa1quvbznvvl-7&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_rh2sjnt7clnl-6&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_rh2sjnt7clnl-6,decimal) &quot;. &quot;}ol.lst-kix_rh2sjnt7clnl-0{list-style-type:none}ol.lst-kix_rh2sjnt7clnl-1{list-style-type:none}.lst-kix_r9pow2tp8cv0-8&gt;li{counter-increment:lst-ctn-kix_r9pow2tp8cv0-8}ol.lst-kix_r9pow2tp8cv0-1.start{counter-reset:lst-ctn-kix_r9pow2tp8cv0-1 0}.lst-kix_z1i3uqhq0nom-7&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_z1i3uqhq0nom-8&gt;li:before{content:&quot;\0025a0  &quot;}ul.lst-kix_wa1quvbznvvl-4{list-style-type:none}ul.lst-kix_wa1quvbznvvl-5{list-style-type:none}ul.lst-kix_wa1quvbznvvl-6{list-style-type:none}ul.lst-kix_wa1quvbznvvl-7{list-style-type:none}ul.lst-kix_wa1quvbznvvl-0{list-style-type:none}.lst-kix_rh2sjnt7clnl-6&gt;li{counter-increment:lst-ctn-kix_rh2sjnt7clnl-6}ul.lst-kix_wa1quvbznvvl-1{list-style-type:none}ul.lst-kix_wa1quvbznvvl-2{list-style-type:none}ul.lst-kix_wa1quvbznvvl-3{list-style-type:none}ol.lst-kix_rh2sjnt7clnl-1.start{counter-reset:lst-ctn-kix_rh2sjnt7clnl-1 0}ul.lst-kix_wa1quvbznvvl-8{list-style-type:none}.lst-kix_rh2sjnt7clnl-4&gt;li{counter-increment:lst-ctn-kix_rh2sjnt7clnl-4}ul.lst-kix_xcgzvmnt5e4b-3{list-style-type:none}ul.lst-kix_xcgzvmnt5e4b-2{list-style-type:none}ul.lst-kix_xcgzvmnt5e4b-1{list-style-type:none}ol.lst-kix_rh2sjnt7clnl-4.start{counter-reset:lst-ctn-kix_rh2sjnt7clnl-4 0}ul.lst-kix_xcgzvmnt5e4b-0{list-style-type:none}ul.lst-kix_xcgzvmnt5e4b-7{list-style-type:none}ul.lst-kix_xcgzvmnt5e4b-6{list-style-type:none}ul.lst-kix_xcgzvmnt5e4b-5{list-style-type:none}ul.lst-kix_xcgzvmnt5e4b-4{list-style-type:none}ol.lst-kix_rh2sjnt7clnl-0.start{counter-reset:lst-ctn-kix_rh2sjnt7clnl-0 0}ol.lst-kix_rh2sjnt7clnl-7.start{counter-reset:lst-ctn-kix_rh2sjnt7clnl-7 0}ol.lst-kix_r9pow2tp8cv0-5{list-style-type:none}ol.lst-kix_r9pow2tp8cv0-6{list-style-type:none}ol.lst-kix_r9pow2tp8cv0-7{list-style-type:none}ol.lst-kix_r9pow2tp8cv0-8{list-style-type:none}.lst-kix_rh2sjnt7clnl-7&gt;li{counter-increment:lst-ctn-kix_rh2sjnt7clnl-7}ol.lst-kix_r9pow2tp8cv0-6.start{counter-reset:lst-ctn-kix_r9pow2tp8cv0-6 0}.lst-kix_r9pow2tp8cv0-7&gt;li{counter-increment:lst-ctn-kix_r9pow2tp8cv0-7}.lst-kix_r9pow2tp8cv0-1&gt;li{counter-increment:lst-ctn-kix_r9pow2tp8cv0-1}.lst-kix_rh2sjnt7clnl-3&gt;li{counter-increment:lst-ctn-kix_rh2sjnt7clnl-3}ol.lst-kix_rh2sjnt7clnl-6.start{counter-reset:lst-ctn-kix_rh2sjnt7clnl-6 0}.lst-kix_xcgzvmnt5e4b-0&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_xcgzvmnt5e4b-1&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_z1i3uqhq0nom-1&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_z1i3uqhq0nom-3&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_xcgzvmnt5e4b-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_z1i3uqhq0nom-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_z1i3uqhq0nom-6&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_z1i3uqhq0nom-5&gt;li:before{content:&quot;\0025a0  &quot;}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_xcgzvmnt5e4b-7&gt;li:before{content:&quot;\0025cb  &quot;}ol.lst-kix_r9pow2tp8cv0-0.start{counter-reset:lst-ctn-kix_r9pow2tp8cv0-0 0}.lst-kix_z1i3uqhq0nom-4&gt;li:before{content:&quot;\0025cb  &quot;}ol.lst-kix_r9pow2tp8cv0-1{list-style-type:none}ol.lst-kix_rh2sjnt7clnl-2{list-style-type:none}ol.lst-kix_r9pow2tp8cv0-2{list-style-type:none}ol.lst-kix_rh2sjnt7clnl-3{list-style-type:none}ol.lst-kix_r9pow2tp8cv0-3{list-style-type:none}ol.lst-kix_rh2sjnt7clnl-4{list-style-type:none}ol.lst-kix_r9pow2tp8cv0-4{list-style-type:none}ol.lst-kix_rh2sjnt7clnl-5{list-style-type:none}.lst-kix_xcgzvmnt5e4b-6&gt;li:before{content:&quot;\0025cf  &quot;}ul.lst-kix_z1i3uqhq0nom-8{list-style-type:none}ol.lst-kix_rh2sjnt7clnl-6{list-style-type:none}ul.lst-kix_z1i3uqhq0nom-7{list-style-type:none}ol.lst-kix_rh2sjnt7clnl-7{list-style-type:none}.lst-kix_xcgzvmnt5e4b-5&gt;li:before{content:&quot;\0025a0  &quot;}ol.lst-kix_rh2sjnt7clnl-8{list-style-type:none}ol.lst-kix_r9pow2tp8cv0-0{list-style-type:none}.lst-kix_xcgzvmnt5e4b-4&gt;li:before{content:&quot;\0025cb  &quot;}ul.lst-kix_z1i3uqhq0nom-4{list-style-type:none}ul.lst-kix_z1i3uqhq0nom-3{list-style-type:none}ol.lst-kix_r9pow2tp8cv0-7.start{counter-reset:lst-ctn-kix_r9pow2tp8cv0-7 0}ul.lst-kix_z1i3uqhq0nom-6{list-style-type:none}ul.lst-kix_z1i3uqhq0nom-5{list-style-type:none}ul.lst-kix_z1i3uqhq0nom-0{list-style-type:none}.lst-kix_xcgzvmnt5e4b-3&gt;li:before{content:&quot;\0025cf  &quot;}ul.lst-kix_z1i3uqhq0nom-2{list-style-type:none}.lst-kix_z1i3uqhq0nom-0&gt;li:before{content:&quot;\0025cf  &quot;}ul.lst-kix_z1i3uqhq0nom-1{list-style-type:none}ol{margin:0;padding:0}table td,table th{padding:0}.c28{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#e0e0e0;border-top-width:1pt;border-right-width:1pt;border-left-color:#e0e0e0;vertical-align:top;border-right-color:#e0e0e0;border-left-width:1pt;border-top-style:solid;background-color:#fafafa;border-left-style:solid;border-bottom-width:1pt;width:468pt;border-top-color:#e0e0e0;border-bottom-style:solid}.c30{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:174.8pt;border-top-color:#000000;border-bottom-style:solid}.c32{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:137.2pt;border-top-color:#000000;border-bottom-style:solid}.c12{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:156pt;border-top-color:#000000;border-bottom-style:solid}.c38{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c9{padding-top:20pt;padding-bottom:6pt;line-height:1.5;page-break-after:avoid;text-align:left}.c7{padding-top:16pt;padding-bottom:4pt;line-height:1.5;page-break-after:avoid;text-align:left}.c42{padding-top:0pt;padding-bottom:16pt;line-height:1.5;page-break-after:avoid;text-align:left}.c36{padding-top:18pt;padding-bottom:6pt;line-height:1.5;page-break-after:avoid;text-align:left}.c37{-webkit-text-decoration-skip:none;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-style:normal}.c17{border-spacing:0;border-collapse:collapse;margin-right:auto}.c2{font-size:10pt;font-family:Consolas,&quot;Courier New&quot;;color:#000000;font-weight:400}.c11{color:#000000;font-weight:400;font-size:11pt;font-family:&quot;Arial&quot;}.c27{color:#000000;font-weight:400;font-size:20pt;font-family:&quot;Arial&quot;}.c33{color:#000000;font-weight:400;font-size:16pt;font-family:&quot;Arial&quot;}.c8{font-size:10pt;font-family:Consolas,&quot;Courier New&quot;;color:#3367d6;font-weight:400}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:left}.c5{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c18{font-size:10pt;font-family:Consolas,&quot;Courier New&quot;;color:#455a64;font-weight:400}.c1{font-size:10pt;font-family:Consolas,&quot;Courier New&quot;;color:#616161;font-weight:400}.c16{color:#434343;font-weight:400;font-size:14pt;font-family:&quot;Arial&quot;}.c46{color:#666666;font-weight:400;font-size:15pt;font-family:&quot;Arial&quot;}.c34{font-size:10pt;font-family:Consolas,&quot;Courier New&quot;;color:#0f9d58;font-weight:400}.c20{font-size:10pt;font-family:Consolas,&quot;Courier New&quot;;color:#c53929;font-weight:400}.c6{font-size:10pt;font-family:Consolas,&quot;Courier New&quot;;color:#9c27b0;font-weight:400}.c25{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c29{font-size:10pt;font-family:Consolas,&quot;Courier New&quot;;color:#000000}.c44{font-size:10pt;font-family:Consolas,&quot;Courier New&quot;;color:#9c27b0}.c24{font-size:10pt;font-family:Consolas,&quot;Courier New&quot;;color:#3367d6}.c40{-webkit-text-decoration-skip:none;text-decoration:underline;text-decoration-skip-ink:none}.c43{color:#000000;font-size:11pt;font-family:&quot;Arial&quot;}.c39{font-size:10pt;font-family:Consolas,&quot;Courier New&quot;;color:#616161}.c45{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c23{font-family:Consolas,&quot;Courier New&quot;;color:#0d904f;font-weight:400}.c4{text-decoration:none;vertical-align:baseline;font-style:normal}.c22{margin-left:36pt;padding-left:0pt}.c3{orphans:2;widows:2}.c41{padding:0;margin:0}.c21{color:inherit;text-decoration:inherit}.c13{height:11pt}.c10{background-color:#ea9999}.c31{font-style:italic}.c15{background-color:#ffff00}.c19{font-weight:700}.c14{background-color:#b6d7a8}.c26{height:0pt}.c35{height:21pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:&quot;Arial&quot;}p{margin:0;color:#000000;font-size:11pt;font-family:&quot;Arial&quot;}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}&lt;/style&gt;&lt;/head&gt;&lt;body class=&quot;c45&quot;&gt;&lt;p class=&quot;c3 c42 subtitle&quot; id=&quot;h.g01b955lvcgn&quot;&gt;&lt;span class=&quot;c4 c46&quot;&gt;A Year in Review of 0-days Exploited In-The-Wild in 2020&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Posted by Maddie Stone, Project Zero&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;2020 was a year full of 0-day exploits. Many of the Internet&amp;rsquo;s most popular browsers had their moment in the spotlight. Memory corruption is &lt;/span&gt;&lt;span class=&quot;c31&quot;&gt;still&lt;/span&gt;&lt;span&gt;&amp;nbsp;the name of the game and how the vast majority of detected 0-days are getting in. While we tried new methods of 0-day detection with modest success, 2020 showed us that there is still a long way to go in detecting these 0-day exploits in-the-wild. But what may be the most notable fact is that&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;25% of the 0-days detected in 2020 are c&lt;/span&gt;&lt;span&gt;losely related to&lt;/span&gt;&lt;span&gt;&amp;nbsp;previously publicly disclosed vulnerabilities.&lt;/span&gt;&lt;span&gt;&amp;nbsp;In other words,&lt;/span&gt;&lt;span class=&quot;c19&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c19&quot;&gt;1 out of every 4 detected 0-day exploits could potentially have been avoided if a more thorough investigation and patching effort were explored&lt;/span&gt;&lt;span class=&quot;c19&quot;&gt;.&lt;/span&gt;&lt;span&gt;&amp;nbsp;Across the industry, incomplete patches &amp;mdash; patches that don&amp;rsquo;t correctly and comprehensively fix the root cause of a vulnerability &amp;mdash; allow attackers to use 0-days against users with less effort.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;Since mid-2019, Project Zero has dedicated an effort specifically to track, analyze, and learn from 0-days that are actively exploited in-the-wild. For the last 6 years, Project Zero&amp;rsquo;s mission has been to &amp;ldquo;make 0-day hard&amp;rdquo;. From that came the goal of our in-the-wild program: &amp;ldquo;Learn from 0-days exploited in-the-wild in order to make 0-day hard.&amp;rdquo; In order to ensure our work is &lt;/span&gt;&lt;span class=&quot;c31&quot;&gt;actually&lt;/span&gt;&lt;span&gt;&amp;nbsp;making it harder to exploit 0-days, we need to &lt;/span&gt;&lt;span&gt;understand how 0-days are&lt;/span&gt;&lt;span class=&quot;c31&quot;&gt;&amp;nbsp;actually&lt;/span&gt;&lt;span&gt;&amp;nbsp;being used&lt;/span&gt;&lt;span&gt;. Continuously pushing forward the public&amp;rsquo;s understanding of&lt;/span&gt;&lt;span&gt;&amp;nbsp;0-day exploitation&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;is only helpful when it doesn&amp;rsquo;t diverge from the &amp;ldquo;private state-of-the-art&amp;rdquo;, what attackers are doing and are capable of. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;Over the last 18 months, we&amp;rsquo;ve learned a lot about the active exploitation of 0-days and our work has matured and evolved with it. &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://googleprojectzero.blogspot.com/2020/07/detection-deficit-year-in-review-of-0.html&quot;&gt;For the 2nd year in a row&lt;/a&gt;&lt;/span&gt;&lt;span&gt;, we&amp;rsquo;re publishing a &amp;ldquo;Year in Review&amp;rdquo; report of the previous year&amp;rsquo;s detected 0-day exploits. The goal of this report is not to detail each individual exploit, but instead to analyze the exploits from the year as a group, looking for trends, gaps, lessons learned, successes, etc. If you&amp;rsquo;re interested in each individual exploit&amp;rsquo;s analysis, please check out our&lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://googleprojectzero.blogspot.com/p/rca.html&quot;&gt;&amp;nbsp;root cause analyses&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;When looking at the 24 0-days detected in-the-wild in 2020, there&amp;rsquo;s an undeniable conclusion: &lt;/span&gt;&lt;span class=&quot;c19&quot;&gt;increasing investment in correct and comprehensive patches is a huge opportunity for our industry to impact attackers using 0-days.&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;A correct patch is one that fixes a bug with complete accuracy, &lt;/span&gt;&lt;span&gt;meaning the patch no longer allows any exploitation of the vulnerability&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;. A comprehensive patch applies that fix everywhere that it needs to be applied, covering all of the variants. We consider a patch to be complete only when it is both correct and comprehensive. When exploiting a single vulnerability or bug, there are often multiple ways to trigger the vulnerability, or multiple paths to access it. Many times we&amp;rsquo;re seeing vendors block only the path that is shown in the proof-of-concept or exploit sample, rather than fixing the vulnerability as a whole, which would block all of the paths. Similarly, security researchers are often reporting bugs without following up on how the patch works and exploring related attacks.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;While the idea that incomplete patches are making it easier for attackers to exploit 0-days may be uncomfortable,&lt;/span&gt;&lt;span&gt;&amp;nbsp;the converse of this conclusion can give us hope. We have a clear path toward making 0-days harder.&lt;/span&gt;&lt;span class=&quot;c19&quot;&gt;&amp;nbsp;If more vulnerabilities are patched correctly and comprehensively, it will be harder for&lt;/span&gt;&lt;span class=&quot;c19&quot;&gt;&amp;nbsp;attackers to exploit &lt;/span&gt;&lt;span class=&quot;c4 c19 c43&quot;&gt;0-days.&lt;/span&gt;&lt;/p&gt;&lt;h1 class=&quot;c9 c3&quot; id=&quot;h.pjwf2y1do0f0&quot;&gt;&lt;span class=&quot;c27 c4&quot;&gt;This vulnerability looks familiar &amp;#x1f914;&lt;/span&gt;&lt;/h1&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;As stated in the introduction, 2020 included 0-day exploits that are similar to ones we&amp;rsquo;ve seen before. 6 of 24 0-days exploits detected in-the-wild are closely related to publicly disclosed vulnerabilities. Some of these 0-day exploits only had to change a line or two of code to have a new working 0-day exploit. This section explains how each of these 6 actively exploited 0-days are related to a previously seen vulnerability. We&amp;rsquo;re taking the time to detail each and show the minimal differences between the vulnerabilities to demonstrate that once you understand one of the vulnerabilities, it&amp;rsquo;s much easier to then exploit another.&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.b74f5f217f98f20b760791f8e1d63f313284b751&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.0&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Product&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c30&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Vulnerability exploited in-the-wild&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c32&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Variant of...&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Microsoft Internet Explorer&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c30&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2020-0674&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c25 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c32&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2018-8653* CVE-2019-1367* CVE-2019-1429*&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Mozilla Firefox&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c30&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2020-6820&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c32&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span&gt;Mozilla &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1507180&quot;&gt;Bug 1507180&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Google Chrome&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c30&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2020-6572&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c32&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2019-5870&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2019-13695&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Microsoft Windows&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c30&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2020-0986&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c32&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2019-0880*&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Google Chrome/Freetype&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c30&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2020-15999&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c32&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2014-9665&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Apple Safari&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c30&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2020-27930&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c32&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2015-0093&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c35&quot;&gt;&lt;td class=&quot;c38&quot; colspan=&quot;3&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;* vulnerability was also exploited in-the-wild in previous years&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c36 c3&quot; id=&quot;h.k0ack2noqebb&quot;&gt;&lt;span class=&quot;c33 c4&quot;&gt;Internet Explorer JScript CVE-2020-0674&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;CVE-2020-0674 is the fourth vulnerability that&amp;rsquo;s been exploited in this bug class in 2 years. The other three vulnerabilities are CVE-2018-8653, CVE-2019-1367, and CVE-2019-1429. In the &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://googleprojectzero.blogspot.com/2020/07/detection-deficit-year-in-review-of-0.html&quot;&gt;2019 year-in-review&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;we devoted a section to these vulnerabilities. &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://www.blog.google/threat-analysis-group/identifying-vulnerabilities-and-protecting-you-phishing/&quot;&gt;Google&amp;rsquo;s Threat Analysis Group attributed&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;all four exploits to the same threat actor. &lt;/span&gt;&lt;span&gt;It bears repeating, the same actor exploited similar vulnerabilities four separate times.&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;For all four exploits, the attacker used the same vulnerability type and the same exact exploitation method&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;. Fixing these vulnerabilities comprehensively the first time would have caused attackers to work harder or find new 0-days.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;JScript is the legacy Javascript engine in Internet Explorer. While it&amp;rsquo;s legacy, &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://support.microsoft.com/en-us/topic/option-to-disable-jscript-execution-in-internet-explorer-9e3b5ab3-8115-4650-f3d8-e496e7f8e40e&quot;&gt;by default it is still enabled&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;in Internet Explorer 11, which is a built-in feature of &lt;/span&gt;&lt;span&gt;Windows 10 computers&lt;/span&gt;&lt;span&gt;. The bug class, or type of vulnerability, is that a specific JScript &lt;/span&gt;&lt;span&gt;object&lt;/span&gt;&lt;span&gt;, a &lt;/span&gt;&lt;span class=&quot;c31&quot;&gt;variable&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;(uses the VAR struct), is not tracked by the garbage collector. I&amp;rsquo;ve included the code to trigger each of the four vulnerabilities below to demonstrate how similar they are. Ivan Fratric from Project Zero wrote all of the included code that triggers the four vulnerabilities.&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;c7 c3&quot; id=&quot;h.667740l9k8k0&quot;&gt;&lt;span class=&quot;c16 c4&quot;&gt;CVE-2018-8653&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In December 2018, it was discovered that &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8653&quot;&gt;CVE-2018-8653&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;was being actively exploited. In this vulnerability, the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;this&lt;/span&gt;&lt;span&gt;&amp;nbsp;variable is not tracked by the garbage collector in the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;isPrototypeof&lt;/span&gt;&lt;span&gt;&amp;nbsp;callback. McAfee also wrote a &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ie-scripting-flaw-still-a-threat-to-unpatched-systems-analyzing-cve-2018-8653/&quot;&gt;write-up going through each step of this exploit&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.1f8226adda08b392a30970fd8b644091a916c945&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.1&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c28&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;objs &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;refs &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;dummyObj &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;getFreeRef&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;()&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 5. delete prototype objects as well as ordinary objects&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; objs&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CollectGarbage&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; refs&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;prototype &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 6. Garbage collector frees unused variable blocks.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// This includes the one holding the &amp;quot;this&amp;quot; variable&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CollectGarbage&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 7. Boom&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; alert&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c18&quot;&gt;// 1. create &amp;quot;special&amp;quot; objects for which isPrototypeOf can be invoked&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;arr &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;prototype&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;});&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;e &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Enumerator&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; refs&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;e&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c18&quot;&gt;// 2. create a bunch of ordinary objects&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; objs&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c18&quot;&gt;// 3. create objects to serve as prototypes and set up callbacks&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; refs&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;prototype &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{};&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; refs&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;prototype&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;isPrototypeOf &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;getFreeRef&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c18&quot;&gt;// 4. calls isPrototypeOf. This sets up refs[100].prototype as &amp;quot;this&amp;quot; variable&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c18&quot;&gt;// During callback, the &amp;quot;this&amp;quot; variable won&amp;#39;t be tracked by the Garbage collector&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c18&quot;&gt;// use different index if this doesn&amp;#39;t work&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;dummyObj &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;instanceof&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;refs&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;];&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;h3 class=&quot;c7 c3&quot; id=&quot;h.ine73rgba0in&quot;&gt;&lt;span class=&quot;c16 c4&quot;&gt;CVE-2019-1367&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In September 2019, &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2019-1367&quot;&gt;CVE-2019-1367&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;was detected as exploited in-the-wild. This is the same vulnerability type as CVE-2018-8653: a JScript &lt;/span&gt;&lt;span class=&quot;c31&quot;&gt;variable&lt;/span&gt;&lt;span&gt;&amp;nbsp;object&lt;/span&gt;&lt;span&gt;&amp;nbsp;is not tracked by the garbage collector. This time though the &lt;/span&gt;&lt;span class=&quot;c31&quot;&gt;variables&lt;/span&gt;&lt;span&gt;&amp;nbsp;that are not tracked are in the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;arguments&lt;/span&gt;&lt;span&gt;&amp;nbsp;array in the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;Array.sort&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;callback.&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.43a0a5db0b1d20befc1e52448e47d5adb550749a&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.2&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c28&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;F&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 2. Create a bunch of objects&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;++)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 3. Store a reference to one of them in the arguments array&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;The arguments array isn&amp;#39;t tracked by garbage collector&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; arguments&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;5000&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;];&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 4. Delete the objects and call the garbage collector&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;All JSCript variables get reclaimed... &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;++)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CollectGarbage&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 5. But we still have reference to one of them in the&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;arguments array&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; alert&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;arguments&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c18&quot;&gt;// 1. Call sort with a custom callback&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;h3 class=&quot;c3 c7&quot; id=&quot;h.8h929p3lop4y&quot;&gt;&lt;span class=&quot;c16 c4&quot;&gt;CVE-2019-1429&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;The CVE-2019-1367 patch did not actually fix the vulnerability triggered by the proof-of-concept above and exploited in the in-the-wild. The proof-of-concept for CVE-2019-1367 &lt;/span&gt;&lt;span class=&quot;c31&quot;&gt;still worked&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;even after the CVE-2019-1367 patch was applied! &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In November 2019, Microsoft released another patch to address this gap. &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2019-1429&quot;&gt;CVE-2019-1429&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;addressed the shortcomings of the CVE-2019-1367 and also fixed a variant. &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugs.chromium.org/p/project-zero/issues/detail?id=1947&quot;&gt;The variant&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;is that &lt;/span&gt;&lt;span&gt;the &lt;/span&gt;&lt;span class=&quot;c31&quot;&gt;variables&lt;/span&gt;&lt;span&gt;&amp;nbsp;in the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;arguments&lt;/span&gt;&lt;span&gt;&amp;nbsp;array are not tracked by the garbage collector in the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;toJson&lt;/span&gt;&lt;span&gt;&amp;nbsp;callback rather than the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;Array.sort&lt;/span&gt;&lt;span&gt;&amp;nbsp;callback. &lt;/span&gt;&lt;span&gt;The only difference between the variant triggers&lt;/span&gt;&lt;span&gt;&amp;nbsp;is the&lt;/span&gt;&lt;span&gt;&amp;nbsp;highlighted lines&lt;/span&gt;&lt;span&gt;. Instead of calling the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;Array.sort&lt;/span&gt;&lt;span&gt;&amp;nbsp;callback, we call the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;toJSON&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;callback.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.1e22b404c604206b0862eb75b336baee152ee3ca&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.3&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c28&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;F&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 2. Create a bunch of objects&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;++)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 3. Store a reference to one of them in the arguments array&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;The arguments array isn&amp;#39;t tracked by garbage collector&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; arguments&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;5000&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;];&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 4. Delete the objects and call the garbage collector&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;All JSCript variables get reclaimed... &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;++)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CollectGarbage&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 5. But we still have reference to one of them in the&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;arguments array&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; alert&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;arguments&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18 c14&quot;&gt;// 1. Cause toJSON callback to fire&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6 c14&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;o &lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;toJSON&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; JSON&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4 c15&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18 c10&quot;&gt;// 1. Call sort with a custom callback&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20 c10&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c20 c10&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;c1 c4 c10&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;h3 class=&quot;c7 c3&quot; id=&quot;h.7s5b4t8wlng1&quot;&gt;&lt;span class=&quot;c4 c16&quot;&gt;CVE-2020-0674&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In January 2020, &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2020-0674&quot;&gt;CVE-2020-0674&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;was detected as exploited in-the-wild. The vulnerability is that the named arguments are not tracked by the garbage collector in the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;Array.sort&lt;/span&gt;&lt;span&gt;&amp;nbsp;callback. &lt;/span&gt;&lt;span&gt;The only changes required to the trigger &lt;/span&gt;&lt;span&gt;for CVE-2019-1367 is to change the references to &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;arguments[]&lt;/span&gt;&lt;span&gt;&amp;nbsp;to one of the arguments named in the function definition. For example, we replaced any instances of &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;arguments[0]&lt;/span&gt;&lt;span&gt;&amp;nbsp;with &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;arg1&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.cb84ed0d0e41c9e179f65374ff4d12c9a051426f&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.4&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c28&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6 c14&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;F&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;arg1&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;arg2&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6 c10&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;F&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 2. Create a bunch of objects&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;++)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 3. Store a reference to one of them in one of the named arguments&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;The named arguments aren&amp;#39;t tracked by garbage collector&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; arg1 &lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;spray&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20 c14&quot;&gt;5000&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;];&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp; &amp;nbsp; arguments&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20 c10&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;spray&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20 c10&quot;&gt;5000&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;];&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 4. Delete the objects and call the garbage collector&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;All JScript variables get reclaimed... &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;++)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CollectGarbage&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 5. But we still have reference to one of them in&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; a named argument&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; alert&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;arg1&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp; &amp;nbsp; alert&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;arguments&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20 c10&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;]);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c18&quot;&gt;// 1. Call sort with a custom callback&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;h3 class=&quot;c7 c3&quot; id=&quot;h.n3s7fz70dd0k&quot;&gt;&lt;span class=&quot;c16 c4&quot;&gt;CVE-2020-0968&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;Unfortunately CVE-2020-0674 was not the end of this story, even though it was the fourth vulnerability of this type to be exploited in-the-wild. In April 2020, Microsoft patched &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://msrc.microsoft.com/update-guide/en-us/vulnerability/CVE-2020-0968&quot;&gt;CVE-2020-0968&lt;/a&gt;&lt;/span&gt;&lt;span&gt;, another Internet Explorer JScript vulnerability. When the bulletin was first released, it was designated as exploited in-the-wild, &lt;/span&gt;&lt;span&gt;but t&lt;/span&gt;&lt;span&gt;he following day, Microsoft changed this field to say it was not exploited in-the-wild (see the revisions section at the bottom of the &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://msrc.microsoft.com/update-guide/en-us/vulnerability/CVE-2020-0968&quot;&gt;advisory&lt;/a&gt;&lt;/span&gt;&lt;span&gt;). &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.e6bf02b53677f0afb1adc9e2d195428f0079f5f2&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.5&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c28&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;f1&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; alert&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c34&quot;&gt;&amp;#39;callback 1&amp;#39;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;spray&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;6000&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;];&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;f2&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; alert&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c34&quot;&gt;&amp;#39;callback 2&amp;#39;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; spray &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CollectGarbage&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c34&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;boom&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;e &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;o1&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;d &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;o2&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 3. the first callback (e.toString) happens&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;it returns one of the string variables&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;which is stored in a temporary variable&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;on the stack, not tracked by garbage collector&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 4. Second callback (d.toString) happens&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;There, string variables get freed&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;and the space reclaimed&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// 5. Crash happens when attempting to access&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// &amp;nbsp; &amp;nbsp;string content of the temporary variable&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;b &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;e &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;d&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; alert&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c18&quot;&gt;// 1. create two objects with toString callbacks&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;o1 &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;toString&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;f1 &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;};&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;o2 &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;toString&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;f2 &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;};&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c18&quot;&gt;// 2. create a bunch of string variables&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;a &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;a &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;a&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;++)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; spray&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c34&quot;&gt;&amp;quot;aaa&amp;quot;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;boom&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;();&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In addition to the vulnerabilities themselves being very similar, the attacker used the same exploit method for each of the four 0-day exploits&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;. This provided a type of &amp;ldquo;plug and play&amp;rdquo; quality to their 0-day development which would have reduced the amount of work required for each new 0-day exploit. &lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c36 c3&quot; id=&quot;h.o5e89hxj78l&quot;&gt;&lt;span class=&quot;c33 c4&quot;&gt;Firefox CVE-2020-6820&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;Mozilla patched &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://www.mozilla.org/en-US/security/advisories/mfsa2020-11/&quot;&gt;CVE-2020-6820 in Firefox with an out-of-band security update&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;in April 2020. It is a use-after-free in the Cache subsystem. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;CVE-2020-6820 is a use-after-free of the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;CacheStreamControlParent&lt;/span&gt;&lt;span&gt;&amp;nbsp;when closing its last open read stream. The read stream is the response returned to the context process from a cache query. If the close or abort command is received while any read streams are still open, it triggers &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;StreamList::CloseAll&lt;/span&gt;&lt;span&gt;. If the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;StreamControl&lt;/span&gt;&lt;span&gt;&amp;nbsp;(must be the Parent which lives in the browser process in order to get the use-after-free in the browser process; the Child would only provide in renderer) still has &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;ReadStreams&lt;/span&gt;&lt;span&gt;&amp;nbsp;when &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;StreamList::CloseAll&lt;/span&gt;&lt;span&gt;&amp;nbsp;is called, then this will cause the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;CacheStreamControlParent&lt;/span&gt;&lt;span&gt;&amp;nbsp;to be freed. The &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;mId&lt;/span&gt;&lt;span&gt;&amp;nbsp;member of the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;CacheStreamControl&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;parent is then subsequently accessed, causing the use-after-free.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;The execution patch for CVE-2020-6820 is:&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.3234b37aec7a6c3a6791502170cd32aec509fe5b&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.6&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c28&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c8&quot;&gt;StreamList&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CloseAll&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c39 c15 c19&quot;&gt;&amp;larr;&lt;/span&gt;&lt;span class=&quot;c29 c15 c19&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c24 c15 c19&quot;&gt;Patched&lt;/span&gt;&lt;span class=&quot;c29 c15 c19&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c15 c19 c44&quot;&gt;function&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CacheStreamControlParent&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CloseAll&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CacheStreamControlParent&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;NotifyCloseAll&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;StreamControl&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CloseAllReadStreams&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8 c40&quot;&gt;For&lt;/span&gt;&lt;span class=&quot;c2 c40&quot;&gt;&amp;nbsp;each stream&lt;/span&gt;&lt;span class=&quot;c1 c40&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;c2 c37&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;ReadStream&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Inner&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CloseStream&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;ReadStream&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Inner&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Close&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;ReadStream&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Inner&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;NoteClosed&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;hellip;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;StreamControl&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;NoteClosed&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;StreamControl&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;ForgetReadStream&lt;/span&gt;&lt;span class=&quot;c2 c4&quot;&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CacheStreamControlParent&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Child&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;NoteClosedAfterForget&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CacheStreamControlParent&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;RecvNoteClosed&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;StreamList&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;NoteClosed&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;StreamList&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;empty &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;mStreamControl&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;:&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;CacheStreamControlParent&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Shutdown&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;Send__delete&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c29 c15 c19&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c39 c15 c19&quot;&gt;&amp;larr;&lt;/span&gt;&lt;span class=&quot;c29 c15 c19&quot;&gt;&amp;nbsp;FREED HERE&lt;/span&gt;&lt;span class=&quot;c15 c19 c39&quot;&gt;!&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;PCacheStreamControlParent&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;SendCloseAll&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c39 c15 c19&quot;&gt;&amp;larr;&lt;/span&gt;&lt;span class=&quot;c29 c15 c19&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c15 c19 c24&quot;&gt;Used&lt;/span&gt;&lt;span class=&quot;c29 c15 c19&quot;&gt;&amp;nbsp;here &lt;/span&gt;&lt;span class=&quot;c44 c15 c19&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;c15 c19 c29&quot;&gt;&amp;nbsp;call to &lt;/span&gt;&lt;span class=&quot;c24 c15 c19&quot;&gt;Id&lt;/span&gt;&lt;span class=&quot;c39 c15 c19&quot;&gt;()&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;CVE-2020-6820 is a variant of an internally found Mozilla vulnerability, &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1507180&quot;&gt;Bug 1507180&lt;/a&gt;&lt;/span&gt;&lt;span&gt;. 1507180 was discovered in November 2018 and &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://hg.mozilla.org/mozilla-central/rev/cdf525897bff&quot;&gt;patched in December 2019&lt;/a&gt;&lt;/span&gt;&lt;span&gt;. 1507180 is a use-after-free of the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;ReadStream&lt;/span&gt;&lt;span&gt;&amp;nbsp;in &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;mReadStreamList&lt;/span&gt;&lt;span&gt;&amp;nbsp;in &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;StreamList::CloseAll&lt;/span&gt;&lt;span&gt;. While it was patched in December, &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://hg.mozilla.org/mozilla-central/rev/25beb671c14a&quot;&gt;an explanatory comment&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;for why the December 2019 patch was needed was added in early March 2020. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;For 150718 the execution path was the same as for CVE-2020-6820 except that the the use-after-free occurred earlier, in &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;StreamControl::CloseAllReadStreams&lt;/span&gt;&lt;span&gt;&amp;nbsp;rather than a few calls &amp;ldquo;higher&amp;rdquo; in &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;StreamList::CloseAll&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In my personal opinion, I have doubts about whether or not this vulnerability was actually exploited in-the-wild.&lt;/span&gt;&lt;span&gt;&amp;nbsp;As far as we know, no one (including myself or Mozilla engineers [&lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1626728#c15&quot;&gt;1&lt;/a&gt;&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1507180#c10&quot;&gt;2&lt;/a&gt;&lt;/span&gt;&lt;span&gt;]), has found a way to trigger this exploit without shutting down the process. Therefore, &lt;/span&gt;&lt;span&gt;exploiting this vulnerability doesn&amp;rsquo;t seem very practical.&lt;/span&gt;&lt;span&gt;&amp;nbsp;However, because it was marked as exploited in-the-wild in the advisory, it remains in our &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://docs.google.com/spreadsheets/d/1lkNJ0uQwbeC1ZTRrxdtuPLCIl7mlUreoKfSIgajnSyY/edit#gid=1869060786&quot;&gt;in-the-wild tracking spreadsheet&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;and thus included in this list.&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c36 c3&quot; id=&quot;h.u7zhsxie5e9k&quot;&gt;&lt;span&gt;Chrome for Android CVE-2020-6572&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://chromereleases.googleblog.com/2020/04/stable-channel-update-for-desktop_7.html&quot;&gt;CVE-2020-6572&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;is use-after-free in &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;MediaCodecAudioDecoder::~MediaCodecAudioDecoder()&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;This is Android-specific code that uses Android&amp;#39;s media decoding APIs to support playback of DRM-protected media on Android. The root of this use-after-free is that a `unique_ptr` is assigned to another, going out of scope which means it can be deleted, while at the same time a raw pointer from the originally referenced object isn&amp;#39;t updated. &amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;More specifically, &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;MediaCodecAudioDecoder::Initialize&lt;/span&gt;&lt;span&gt;&amp;nbsp;doesn&amp;#39;t reset &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;media_crypto_context_&lt;/span&gt;&lt;span&gt;&amp;nbsp;if &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;media_crypto_&lt;/span&gt;&lt;span&gt;&amp;nbsp;has been previously set. This can occur if &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;MediaCodecAudioDecoder::Initialize&lt;/span&gt;&lt;span&gt;&amp;nbsp;is called twice, which is explicitly supported. This is problematic when the second initialization uses a different CDM than the first one. Each CDM owns the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;media_crypto_context_ &lt;/span&gt;&lt;span&gt;object&lt;/span&gt;&lt;span&gt;, and the CDM itself (&lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;cdm_context_ref_&lt;/span&gt;&lt;span&gt;) is a `unique_ptr`. Once the new CDM is set, the old CDM loses a reference and may be destructed. However, &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;MediaCodecAudioDecoder&lt;/span&gt;&lt;span&gt;&amp;nbsp;still holds a raw pointer to &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;media_crypto_context_&lt;/span&gt;&lt;span&gt;&amp;nbsp;from the old CDM since it wasn&amp;#39;t updated, which results in the use-after-free on &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;media_crypto_context_&lt;/span&gt;&lt;span&gt;&amp;nbsp;(for example, in &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;MediaCodecAudioDecoder::~MediaCodecAudioDecoder&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;). &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;This vulnerability that was exploited in-the-wild was reported in April 2020. 7 months prior, in September 2019, Man Yue Mo of Semmle &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1004730&quot;&gt;reported a very similar vulnerability&lt;/a&gt;&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://chromereleases.googleblog.com/2019/10/stable-channel-update-for-desktop.html&quot;&gt;CVE-2019-13695&lt;/a&gt;&lt;/span&gt;&lt;span&gt;. CVE-2019-13695 is also a use-after-free on a dangling &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;media_crypto_context_&lt;/span&gt;&lt;span&gt;&amp;nbsp;in &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;MojoAudioDecoderService&lt;/span&gt;&lt;span&gt;&amp;nbsp;after releasing the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;cdm_context_ref_&lt;/span&gt;&lt;span&gt;. &lt;/span&gt;&lt;span&gt;This vulnerability is essentially the same bug as CVE-2020-6572, it&amp;rsquo;s just triggered by an error path after initializing &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;MojoAudioDecoderService&lt;/span&gt;&lt;span&gt;&amp;nbsp;twice rather than by reinitializing the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;MediaCodecAudioDecoder&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In addition, in August 2019, Guang Gong of Alpha Team, Qihoo 360 reported another similar vulnerability in the same component. The &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=999311&quot;&gt;vulnerability&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;is where the CDM could be registered twice (e.g. &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;MojoCdmService::Initialize&lt;/span&gt;&lt;span&gt;&amp;nbsp;could be called twice) leading to use-after-free. When &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;MojoCdmService::Initialize&lt;/span&gt;&lt;span&gt;&amp;nbsp;was called twice there would be two map entries in &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;cdm_services_&lt;/span&gt;&lt;span&gt;, but only one would be removed upon destruction, and the other was left dangling. This vulnerability is &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://chromereleases.googleblog.com/2019/09/stable-channel-update-for-desktop.html&quot;&gt;CVE-2019-5870&lt;/a&gt;&lt;/span&gt;&lt;span&gt;. Guang Gong used this vulnerability as a part of an Android exploit chain. He presented on this exploit chain at Blackhat USA 2020, &amp;ldquo;&lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://github.com/secmob/TiYunZong-An-Exploit-Chain-to-Remotely-Root-Modern-Android-Devices/blob/master/us-20-Gong-TiYunZong-An-Exploit-Chain-to-Remotely-Root-Modern-Android-Devices-wp.pdf&quot;&gt;TiYunZong: An Exploit Chain to Remotely Root Modern Android Devices&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;rdquo;. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;While one could argue that the vulnerability from Guang Gong is not a variant of the vulnerability exploited in-the-wild, it was at the very least an early indicator that the Mojo CDM code for Android had life-cycle issues and needed a closer look. This &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=999311#c8&quot;&gt;was noted in the issue tracker &lt;/a&gt;&lt;/span&gt;&lt;span&gt;for CVE-2019-5870 and then &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1004730#c1&quot;&gt;brought up again&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;after Man Yue Mo reported CVE-2019-13695.&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c36 c3&quot; id=&quot;h.ejffpv4bguza&quot;&gt;&lt;span class=&quot;c33 c4&quot;&gt;Windows splwow64 CVE-2020-0986&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2020-0986&quot;&gt;CVE-2020-0986&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;is an arbitrary pointer dereference in Windows splwow64. Splwow64 is executed any time a 32-bit application wants to &lt;/span&gt;&lt;span&gt;print&lt;/span&gt;&lt;span&gt;&amp;nbsp;a document. &lt;/span&gt;&lt;span&gt;It runs as a Medium integrity process. Internet Explorer runs as a 32-bit application and a Low integrity process.&lt;/span&gt;&lt;span&gt;&amp;nbsp;Internet Explorer can send LPC messages to splwow64. CVE-2020-0986 allows an attacker in the Internet Explorer process to control all three arguments to a &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;memcpy&lt;/span&gt;&lt;span&gt;&amp;nbsp;call in the more privileged splwow64 address space. The only difference between CVE-2020-0986 and &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2019-0880&quot;&gt;CVE-2019-0880&lt;/a&gt;&lt;/span&gt;&lt;span&gt;, which was also exploited in-the-wild, is that CVE-2019-0880 exploited the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;by sending message type 0x75 and CVE-2020-0986 exploits it by sending message type 0x6D. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;From this &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://byteraptors.github.io/windows/exploitation/2020/05/24/sandboxescape.html&quot;&gt;great write-up from ByteRaptors&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;on CVE-2019-0880 the pseudo code that allows the controlling of the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;is:&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.a6fa8b5c3c8ad2be97429c1d22237b810a735e00&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.7&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c28&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;GdiPrinterThunk&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;LPVOID firstAddress&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;LPVOID secondAddress&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;LPVOID thirdAddress&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;...&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(*((&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;BYTE&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*)(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;firstAddress &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0x4&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0x75&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;){&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; ULONG64 memcpyDestinationAddress &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*((&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;ULONG64&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*)(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;firstAddress &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;));&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;memcpyDestinationAddress &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;NULL&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;){&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ULONG64 sourceAddress &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*((&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;ULONG64&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*)(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;firstAddress &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0x18&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;));&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; DWORD copySize &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*((&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;DWORD&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*)(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;firstAddress &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;));&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; memcpy&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;memcpyDestinationAddress&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;sourceAddress&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;copySize&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;...&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;The equivalent pseudocode for CVE-2020-0986 is below. &lt;/span&gt;&lt;span&gt;Only the message type (0x75 to 0x6D) and the offsets of the controlled &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;memcpy&lt;/span&gt;&lt;span&gt;&amp;nbsp;arguments changed&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;as highlighted below.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.8dbc0fb11c95a5ee904cce1df18fa4f5f62d385d&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.8&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c28&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;GdiPrinterThunk&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;LPVOID msgSend&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;LPVOID msgReply&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;LPVOID arg3&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;...&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6 c15&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c1 c15&quot;&gt;(*((&lt;/span&gt;&lt;span class=&quot;c2 c15&quot;&gt;BYTE&lt;/span&gt;&lt;span class=&quot;c1 c15&quot;&gt;*)(&lt;/span&gt;&lt;span class=&quot;c2 c15&quot;&gt;msgSend &lt;/span&gt;&lt;span class=&quot;c1 c15&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c15&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20 c15&quot;&gt;0x4&lt;/span&gt;&lt;span class=&quot;c1 c15&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;c2 c15&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c15&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;c2 c15&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20 c15&quot;&gt;0x6D&lt;/span&gt;&lt;span class=&quot;c1 c15&quot;&gt;){&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;...&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;ULONG64 srcAddress &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;**((&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;ULONG64 &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;**)(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;msgSend &lt;/span&gt;&lt;span class=&quot;c1 c15&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c15&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20 c15&quot;&gt;0xA&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;));&lt;/span&gt;&lt;span class=&quot;c2 c4&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;srcAddress &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;NULL&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;){&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; DWORD copySize &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*((&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;DWORD&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*)(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;msgSend &lt;/span&gt;&lt;span class=&quot;c1 c15&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c15&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20 c15&quot;&gt;0x40&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;));&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;copySize &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0x1FFFE&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ULONG64 destAddress &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*((&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;ULONG64&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*)(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;msgSend &lt;/span&gt;&lt;span class=&quot;c1 c15&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c15&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20 c15&quot;&gt;0xB&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;));&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; memcpy&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;destAddress&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;sourceAddress&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;copySize&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;...&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In addition to CVE-2020-0986 being a trivial variant of a previous in-the-wild vulnerability, CVE-2020-0986 was also not patched completely and the vulnerability was still exploitable even after the patch was applied. This is detailed in the&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;ldquo;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;Exploited 0-days not properly fixed&amp;rdquo; section below.&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c3 c36&quot; id=&quot;h.3ecniw2v9hbz&quot;&gt;&lt;span&gt;Freetype CVE-2020-15999&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In October 2020, Project Zero discovered multiple exploit chains being used in the wild. The exploit chains targeted iPhone, Android, and Windows users, but they all shared the same Freetype RCE to exploit the Chrome renderer, &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://chromereleases.googleblog.com/2020/10/stable-channel-update-for-desktop_20.html&quot;&gt;CVE-2020-15999&lt;/a&gt;&lt;/span&gt;&lt;span&gt;. &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://savannah.nongnu.org/bugs/?59308&quot;&gt;The vulnerability is a heap buffer overflow&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;in the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;Load_SBit_Png&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;function. The vulnerability was being triggered by an integer truncation. `Load_SBit_Png` processes PNG images embedded in fonts. The image width and height are stored in the PNG header as 32-bit integers. Freetype then truncated them to 16-bit integers. This truncated value was used to calculate the bitmap size and the backing buffer is allocated to that size. However, the original 32-bit width and height values of the bitmap are used when reading the bitmap into its backing buffer, thus causing the buffer overflow.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In November 2014, Project Zero team member &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugs.chromium.org/p/project-zero/issues/detail?id=168&quot;&gt;Mateusz Jurczyk reported CVE-2014-9665&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;to Freetype. CVE-2014-9665 is also a heap buffer overflow in the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;Load_SBit_Png&lt;/span&gt;&lt;span&gt;&amp;nbsp;function. This one was triggered differently though. In CVE-2014-9665, when calculating the bitmap size, the size variable is vulnerable to an integer overflow causing the backing buffer to be too small. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c25 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span&gt;To patch CVE-2014-9665, &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;http://git.savannah.gnu.org/cgit/freetype/freetype2.git/tree/src/sfnt/pngshim.c?id=54abd22891bd51ef8b533b24df53b3019b5cee81&quot;&gt;Freetype added a check to the rows and width&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;prior to calculating the size as shown below.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c25 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.544aaafdb3cb243b450aa049bcdb0901e282420f&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.9&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c28&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;populate_map_and_metrics &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; FT_Long &amp;nbsp;size&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; metrics&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;width &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;FT_Int&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;imgWidth&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; metrics&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;height &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;FT_Int&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;imgHeight&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;width &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;metrics&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;rows &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;metrics&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;pixel_mode &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;FT_PIXEL_MODE_BGRA&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;pitch &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;width &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;num_grays &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18 c14&quot;&gt;/* reject too large bitmaps similarly to the rasterizer */&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6 c14&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;rows &lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20 c14&quot;&gt;0x7FFF&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;width &lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20 c14&quot;&gt;0x7FFF&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; error &lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;FT_THROW&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8 c14&quot;&gt;Array_Too_Large&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6 c14&quot;&gt;goto&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8 c14&quot;&gt;DestroyExit&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; size &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;rows &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;pitch&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c15&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;c2 c4 c15&quot;&gt;&amp;nbsp;overflow size&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; error &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;ft_glyphslot_alloc_bitmap&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;slot&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;size &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;error &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;goto&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8&quot;&gt;DestroyExit&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;c25 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c25 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;To patch CVE-2020-15999, the vulnerability exploited in the wild in 2020, this check was moved up earlier in the `Load_Sbit_Png` function and changed to `imgHeight` and `imgWidth`, the width and height values that are included in the header of the PNG. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c25 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.7619df884503092ed17583662f4823868b1905a5&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.10&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c28&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;populate_map_and_metrics &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18 c14&quot;&gt;/* reject too large bitmaps similarly to the rasterizer */&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6 c14&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;imgWidth &lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20 c14&quot;&gt;0x7FFF&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;imgHeight &lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20 c14&quot;&gt;0x7FFF&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; error &lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;FT_THROW&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8 c14&quot;&gt;Array_Too_Large&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6 c14&quot;&gt;goto&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8 c14&quot;&gt;DestroyExit&lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c2 c14&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1 c14&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c14&quot;&gt;+&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;metrics&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;width &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;FT_UShort&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;imgWidth&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;metrics&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;height &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;FT_UShort&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;imgHeight&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;width &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;metrics&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;rows &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;metrics&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;pixel_mode &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;FT_PIXEL_MODE_BGRA&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;pitch &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;width &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;num_grays &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c13&quot;&gt;&lt;span class=&quot;c2 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18 c10&quot;&gt;/* reject too large bitmaps similarly to the rasterizer */&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6 c10&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;rows &lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20 c10&quot;&gt;0x7FFF&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;map&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;width &lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20 c10&quot;&gt;0x7FFF&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; error &lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;FT_THROW&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8 c10&quot;&gt;Array_Too_Large&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;);&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6 c10&quot;&gt;goto&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c8 c10&quot;&gt;DestroyExit&lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1 c10&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c2 c10&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1 c10&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;[...]&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;To summarize: &lt;/span&gt;&lt;/p&gt;&lt;ul style=&#39;padding: 0;&#39; class=&quot;c41 lst-kix_ir94vkdxrs7o-0 start&quot;&gt;&lt;li style=&#39;margin-left: 46pt;&#39; class=&quot;c0 c3 c22 li-bullet-0&quot;&gt;&lt;span&gt;CVE-2014-9665 caused a buffer overflow by overflowing the size field in the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;size = map-&amp;gt;rows * map-&amp;gt;pitch;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;calculation.&lt;/span&gt;&lt;/li&gt;&lt;li style=&#39;margin-left: 46pt;&#39; class=&quot;c0 c22 c3 li-bullet-0&quot;&gt;&lt;span&gt;CVE-2020-15999 caused a buffer overflow by truncating &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;metrics-&amp;gt;width&lt;/span&gt;&lt;span&gt;&amp;nbsp;and &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;metrics-&amp;gt;height&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;which are then used to calculate the size field, thus causing the size field to be too small.&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;A fix for the root cause of the buffer overflow in November 2014 would have been to bounds check &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;imgWidth&lt;/span&gt;&lt;span&gt;&amp;nbsp;and &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;imgHeight&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;prior to any assignments to an unsigned short. Including the bounds check of the height and widths from the PNG headers early would have prevented both manners of triggering this buffer overflow. &lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c36 c3&quot; id=&quot;h.c0g67ylrwoty&quot;&gt;&lt;span&gt;Apple Safari CVE-2020-27930&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;This vulnerability is slightly different than the rest in that while it&amp;rsquo;s still a variant, it&amp;rsquo;s not clear that by current disclosure norms, one would have necessarily expected Apple to have picked up the patc&lt;/span&gt;&lt;span&gt;h. Apple and Microsoft both forked the Adobe Type Manager code over 20 years&lt;/span&gt;&lt;span&gt;&amp;nbsp;ago&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;. Due to the forks, there&amp;rsquo;s no true &amp;ldquo;upstream&amp;rdquo;. However when vulnerabilities were reported in Microsoft&amp;rsquo;s, Apple&amp;rsquo;s, or Adobe&amp;rsquo;s fork, there is a possibility (though no guarantee) that it was also in the others.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;CVE-2020-27930 vulnerability was used in an exploit chain for iOS. The &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;http://bugs.chromium.org/p/project-zero/issues/detail?id=180&quot;&gt;variant, CVE-2015-0993, was reported&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;to Microsoft in November 2014. In CVE-2015-0993, the vulnerability is in the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;blend&lt;/span&gt;&lt;span&gt;&amp;nbsp;operator in Microsoft&amp;rsquo;s implementation of Adobe&amp;rsquo;s Type 1/2 Charstring Font Format. The &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;blend&lt;/span&gt;&lt;span&gt;&amp;nbsp;operation takes &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;n + 1&lt;/span&gt;&lt;span&gt;&amp;nbsp;parameters. The vulnerability is that it did not validate or handle correctly when &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;is negative, allowing the font to arbitrarily read and write on the native interpreter stack. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://support.apple.com/en-us/HT211929&quot;&gt;CVE-2020-27930&lt;/a&gt;&lt;/span&gt;&lt;span&gt;, the vulnerability exploited in-the-wild in 2020, is very similar. The vulnerability this time is in the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;callothersubr&lt;/span&gt;&lt;span&gt;&amp;nbsp;operator in Apple&amp;rsquo;s implementation of Adobe&amp;rsquo;s Type 1 Charstring Font Format. In the same way as the vulnerability reported in November 2014, &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;callothersubr&lt;/span&gt;&lt;span&gt;&amp;nbsp;expects &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;n&lt;/span&gt;&lt;span&gt;&amp;nbsp;arguments from the stack. However, the function did not validate nor handle correctly negative values of &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;, leading to the same outcome of arbitrary stack read/write. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;Six years after the original vulnerability was reported, a similar vulnerability was exploited in a different project. This presents an interesting question: &lt;/span&gt;&lt;span&gt;How do&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;related, but separate, projects stay up-to-date on security vulnerabilities that likely exist in their fork of a common code base? There&amp;rsquo;s little doubt that reviewing the vulnerability Microsoft fixed in 2015 would help the attackers discover this vulnerability in Apple.&lt;/span&gt;&lt;/p&gt;&lt;h1 class=&quot;c9 c3&quot; id=&quot;h.4ehznvuodkxx&quot;&gt;&lt;span class=&quot;c27 c4&quot;&gt;Exploited 0-days not properly fixed&amp;hellip; &amp;#x1f62d;&lt;/span&gt;&lt;/h1&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Three vulnerabilities that were exploited in-the-wild were not properly fixed after they were reported to the vendor. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.edf72bcd4c78a28db713eae74fa87ed90f591310&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.11&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Product&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Vulnerability that was exploited in-the-wild&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;2nd patch&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Internet Explorer&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2020-0674&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2020-0968&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Google Chrome&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c4 c11&quot;&gt;CVE-2019-13764*&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2020-6383&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Microsoft Windows&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2020-0986&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=&quot;c12&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;CVE-2020-17008/CVE-2021-1648&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c35&quot;&gt;&lt;td class=&quot;c38&quot; colspan=&quot;3&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c25&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;* when CVE-2019-13764 was patched, it was not known to be exploited in-the-wild&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c36 c3&quot; id=&quot;h.1vbp8s70d1dn&quot;&gt;&lt;span class=&quot;c33 c4&quot;&gt;Internet Explorer JScript CVE-2020-0674&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In the section above, we detailed the timeline of the Internet Explorer JScript vulnerabilities that were exploited in-the-wild. After the most recent vulnerability, CVE-2020-0674, was exploited in January 2020, it still didn&amp;rsquo;t comprehensively fix all of the variants. Microsoft patched &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://msrc.microsoft.com/update-guide/en-us/vulnerability/CVE-2020-0968&quot;&gt;CVE-2020-0968&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;in April 2020. We show the trigger in the section above.&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c36 c3&quot; id=&quot;h.djf2g8z23hpx&quot;&gt;&lt;span&gt;Google Chrome CVE-2019-13674&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://chromereleases.googleblog.com/2019/12/stable-channel-update-for-desktop.html&quot;&gt;CVE-2019-13674&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;in Chrome is an interesting case. When it was &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://chromium.googlesource.com/v8/v8/+/b8b6075021ade0969c6b8de9459cd34163f7dbe1&quot;&gt;patched in November 2019&lt;/a&gt;&lt;/span&gt;&lt;span&gt;, it was not known to be exploited in-the-wild. Instead, &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1028863&quot;&gt;it was reported by security researchers Soyeon Park and Wen Xu&lt;/a&gt;&lt;/span&gt;&lt;span&gt;. Three months later, in February 2020, Sergei Glazunov of Project Zero discovered that it was exploited in-the-wild, and may have been exploited as a 0-day prior to the patch. When Sergei realized it had already been patched, he decided to look a little closer at the patch. That&amp;rsquo;s when he realized that the patch didn&amp;rsquo;t fix all of the paths to trigger the vulnerability. To read about the vulnerability and the subsequent patches in greater detail, check out Sergei&amp;rsquo;s blog post, &amp;ldquo;&lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://googleprojectzero.blogspot.com/2021/01/in-wild-series-chrome-infinity-bug.html&quot;&gt;Chrome Infinity Bug&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;rdquo;. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;To summarize, the vulnerability is a type confusion in Chrome&amp;rsquo;s v8 Javascript engine. The issue is in the function that is designed to compute the type of induction variables, the variable that gets increased or decreased by a fixed amount in each iteration of a loop, such as a &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;for&lt;/span&gt;&lt;span&gt;&amp;nbsp;loop. The algorithm works only on v8&amp;rsquo;s integer type though. The integer type in v8 includes a few special values, &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;+Infinity&lt;/span&gt;&lt;span&gt;&amp;nbsp;and &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;-Infinity&lt;/span&gt;&lt;span&gt;. &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;-0&lt;/span&gt;&lt;span&gt;&amp;nbsp;and &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;NaN&lt;/span&gt;&lt;span&gt;&amp;nbsp;do not belong to the integer type though. Another interesting aspect to v8&amp;rsquo;s integer type is that it is not closed under addition meaning that adding two integers doesn&amp;rsquo;t always result in an integer. An example of this is &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;+Infinity + -Infinity = NaN&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;Therefore, the following line is sufficient to &lt;/span&gt;&lt;span&gt;trigger&lt;/span&gt;&lt;span&gt;&amp;nbsp;CVE-2019-13674. Note that this line will not show any observable crash effects and the road to making this vulnerability exploitable is quite long, check out &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://googleprojectzero.blogspot.com/&quot;&gt;this blog post&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;if you&amp;rsquo;re interested! &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.a9314e9b2bd8b19d1e18395634993f466fea284a&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.12&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c28&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://chromium.googlesource.com/v8/v8.git/+/b8b6075021ade0969c6b8de9459cd34163f7dbe1&quot;&gt;The patch&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;that Chrome released for this vulnerability added an explicit check for the &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;NaN&lt;/span&gt;&lt;span&gt;&amp;nbsp;case. But the patch made an assumption that leads to it being insufficient: that the loop variable can only become &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;NaN&lt;/span&gt;&lt;span&gt;&amp;nbsp;if the sum or difference of the initial value of the variable and the increment is &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;NaN&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;. The issue is that the value of the increment can change inside the loop body. Therefore the following trigger would still work even after the patch was applied.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;a id=&quot;t.9eb676d3c545b8bdcea88fbbc80c4de5301054de&quot;&gt;&lt;/a&gt;&lt;a id=&quot;t.13&quot;&gt;&lt;/a&gt;&lt;table class=&quot;c17&quot;&gt;&lt;tbody&gt;&lt;tr class=&quot;c26&quot;&gt;&lt;td class=&quot;c28&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;increment &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;k &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c18&quot;&gt;// The initial loop value is 0 and the increment is -Infinity.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c18&quot;&gt;// This is permissible because 0 + -Infinity = -Infinity, an integer.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;increment&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;i &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// Once the initial variable equals -Infinity (one loop through)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;// the increment is changed to +Infinity. -Infinity + +Infinity = NaN&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; increment &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;(++&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;k &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;{&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0&quot;&gt;&lt;span class=&quot;c1&quot;&gt;}&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;To &amp;ldquo;revive&amp;rdquo; the entire exploit, the attacker only needed to change a couple of lines in the trigger to have another working 0-day. &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1051017&quot;&gt;This incomplete fix was reported&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;to Chrome in February 2020. &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://chromium.googlesource.com/v8/v8.git/+/a2e971c56d1c46f7c71ccaf33057057308cc8484&quot;&gt;This patch&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;was more conservative: it bailed as soon as the type detected that increment can be &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;+Infinity&lt;/span&gt;&lt;span&gt;&amp;nbsp;or &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;-Infinity&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;Unfortunately, this patch introduced an additional security vulnerability, which allowed for a wider choice of possible &amp;ldquo;type confusions&amp;rdquo;. Again, check out &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://googleprojectzero.blogspot.com/2021/01/in-wild-series-chrome-infinity-bug.html&quot;&gt;Sergei&amp;rsquo;s blog post&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;if you&amp;rsquo;re interested in more details. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;This is an example where the exploit is found &lt;/span&gt;&lt;span class=&quot;c31&quot;&gt;after&lt;/span&gt;&lt;span&gt;&amp;nbsp;the bug was initially reported by security researchers. As an aside, I&lt;/span&gt;&lt;span&gt;&amp;nbsp;think this shows why it&amp;rsquo;s important to work towards &amp;ldquo;correct &amp;amp; comprehensive&amp;rdquo; patches in general, not just vulnerabilities known to be exploited in-the-wild. &lt;/span&gt;&lt;span&gt;The security industry &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://googleprojectzero.blogspot.com/2020/07/detection-deficit-year-in-review-of-0.html&quot;&gt;knows there is a detection gap&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;in our ability to detect 0-days exploited in-the-wild. We don&amp;rsquo;t find and detect all exploited 0-days and we certainly don&amp;rsquo;t find them all in a timely manner. &lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c36 c3&quot; id=&quot;h.n50yx180dgki&quot;&gt;&lt;span class=&quot;c33 c4&quot;&gt;Windows splwow64 CVE-2020-0986&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;This vulnerability has already been discussed in the previous section on variants. After &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://securelist.com/operation-powerfall-cve-2020-0986-and-variants/98329/&quot;&gt;Kaspersky reported that CVE-2020-0986 was actively exploited&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;as a 0-day, I began performing root cause analysis and variant analysis on the vulnerability. The vulnerability was patched in June 2020, but it was only&lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://securelist.com/ie-and-windows-zero-day-operation-powerfall/97976/&quot;&gt;&amp;nbsp;disclosed as exploited in-the-wild in August 2020&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;Microsoft&amp;rsquo;s patch for CVE-2020-0986 replaced the raw pointers that an attacker could previously send through the LPC message, with offsets. This didn&amp;rsquo;t fix the root cause vulnerability, just changed how an attacker would trigger the vulnerability. &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://bugs.chromium.org/p/project-zero/issues/detail?id=2096&quot;&gt;This issue was reported&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;to Microsoft in September 2020, including a working trigger. Microsoft released a more complete patch for the vulnerability in January 2021, four months later. This new patch checks that all &lt;/span&gt;&lt;span class=&quot;c23&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;operations are only reading from and copying into the buffer of the message.&lt;/span&gt;&lt;/p&gt;&lt;h1 class=&quot;c3 c9&quot; id=&quot;h.3yn8y6vmd87d&quot;&gt;&lt;span class=&quot;c4 c27&quot;&gt;Correct and comprehensive patches&lt;/span&gt;&lt;/h1&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;We&amp;rsquo;ve detailed how six 0-days that were exploited in-the-wild in 2020 were closely related to vulnerabilities that had been seen previously.&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;We also showed how three vulnerabilities that were exploited in-the-wild were either not fixed correctly or not fixed comprehensively when patched this year. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;When 0-day exploits are detected in-the-wild, it&amp;rsquo;s the failure case for an attacker. It&amp;rsquo;s a gift for us security defenders to learn as much as we can and take actions to ensure that that vector can&amp;rsquo;t be used again. The goal is to force attackers to start from scratch each time we detect one of their exploits: &lt;/span&gt;&lt;span&gt;they&amp;rsquo;re forced to discover a whole new vulnerability&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;, they have to invest the time in learning and analyzing a new attack surface, they must develop a brand new exploitation method. To do that, we need correct and comprehensive fixes. &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;Being able to &lt;/span&gt;&lt;span&gt;correctly and comprehensively patch isn&amp;#39;t just flicking a switch: it requires investment, prioritization, and planning. It also requires developing a patching process that balances both protecting users quickly and ensuring it is comprehensive, which can at times be in tension. While we expect that none of this will come as a surprise to security teams in an organization, this analysis is a good reminder that there is still more work to be done.&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;Exactly what investments are likely required depends on each unique situation, but we see some common themes around staffing/resourcing, incentive structures, process maturity, automation/testing, release cadence, and partnerships.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;While the aim is that one day all vulnerabilities will be fixed correctly &lt;/span&gt;&lt;span class=&quot;c31&quot;&gt;and&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;comprehensively, each step we take in that direction will make it harder for attackers to exploit 0-days.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In 2021, Project Zero will continue completing root cause and variant analyses for vulnerabilities reported as in-the-wild. We will also be looking over the patches for these exploited vulnerabilities with more scrutiny. We hope to also expand our work into variant analysis work on other vulnerabilities as well. We hope more researchers will join us in this work. (If you&amp;rsquo;re an aspiring vulnerability researcher, variant analysis could be a great way to begin building your skills! Here are two conference talks on the topic: &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://www.youtube.com/watch?v=mC1Pwsdy814&quot;&gt;my talk at BluehatIL 2020&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;and &lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&lt;a class=&quot;c211&quot; href=&quot;https://www.youtube.com/watch?v=fTNzylTMYks&quot;&gt;Ki Chan Ahn at OffensiveCon 2020&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;.)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3&quot;&gt;&lt;span&gt;In addition, we would really like to work more closely with vendors on patches and mitigations &lt;/span&gt;&lt;span class=&quot;c31&quot;&gt;prior&lt;/span&gt;&lt;span class=&quot;c11 c4&quot;&gt;&amp;nbsp;to the patch being released. We often have ideas of how issues can be addressed. Early collaboration and offering feedback during the patch design and implementation process is good for everyone. Researchers and vendors alike can save time, resources, and energy by working together, rather than patch diffing a binary after release and realizing the vulnerability was not completely fixed.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c0 c3 c13&quot;&gt;&lt;span class=&quot;c11 c4&quot;&gt;&lt;/span&gt;&lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='https://googleprojectzero.blogspot.com/feeds/2386590713508572091/comments/default' title='Post Comments'/><link rel='replies' type='text/html' href='https://googleprojectzero.blogspot.com/2021/02/deja-vu-lnerability.html#comment-form' title='0 Comments'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/4838136820032157985/posts/default/2386590713508572091'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/4838136820032157985/posts/default/2386590713508572091'/><link rel='alternate' type='text/html' href='https://googleprojectzero.blogspot.com/2021/02/deja-vu-lnerability.html' title='Déjà vu-lnerability'/><author><name>Anonymous</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:total>0</thr:total></entry>