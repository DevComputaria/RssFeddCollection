<?xml version='1.0' encoding='UTF-8'?><?xml-stylesheet href="http://www.blogger.com/styles/atom.css" type="text/css"?><entry xmlns='http://www.w3.org/2005/Atom' xmlns:blogger='http://schemas.google.com/blogger/2008' xmlns:georss='http://www.georss.org/georss' xmlns:gd='http://schemas.google.com/g/2005' xmlns:thr='http://purl.org/syndication/thread/1.0'><id>tag:blogger.com,1999:blog-4838136820032157985.post-405547501763334781</id><published>2021-01-28T11:47:00.004-08:00</published><updated>2022-08-24T11:07:07.562-07:00</updated><title type='text'>A Look at iMessage in iOS 14</title><content type='html'>&lt;style type=&quot;text/css&quot;&gt;@import url(&#39;https://themes.googleusercontent.com/fonts/css?kit=cGvuclDC_Z1vE_cnVEU6Ae_NZQ7StBcqH_vXVqoPMX0&#39;);ol.lst-kix_ezf2mrk385uq-4.start{counter-reset:lst-ctn-kix_ezf2mrk385uq-4 0}ol.lst-kix_ct3zb543qdjl-5{list-style-type:none}ol.lst-kix_ct3zb543qdjl-4{list-style-type:none}ol.lst-kix_ct3zb543qdjl-7{list-style-type:none}ol.lst-kix_ct3zb543qdjl-6{list-style-type:none}ol.lst-kix_ct3zb543qdjl-1{list-style-type:none}ol.lst-kix_ct3zb543qdjl-0{list-style-type:none}ol.lst-kix_ct3zb543qdjl-3{list-style-type:none}ol.lst-kix_ct3zb543qdjl-2{list-style-type:none}ol.lst-kix_aue93cd1tacp-8{list-style-type:none}.lst-kix_ezf2mrk385uq-8&gt;li{counter-increment:lst-ctn-kix_ezf2mrk385uq-8}ol.lst-kix_ha0mdd7f5mn8-8.start{counter-reset:lst-ctn-kix_ha0mdd7f5mn8-8 0}ol.lst-kix_hisa166i97g-1.start{counter-reset:lst-ctn-kix_hisa166i97g-1 0}ol.lst-kix_ct3zb543qdjl-8{list-style-type:none}.lst-kix_f1zwtsa21lze-6&gt;li{counter-increment:lst-ctn-kix_f1zwtsa21lze-6}ol.lst-kix_aue93cd1tacp-6.start{counter-reset:lst-ctn-kix_aue93cd1tacp-6 0}ol.lst-kix_2zj51yim977x-4.start{counter-reset:lst-ctn-kix_2zj51yim977x-4 0}ol.lst-kix_ct3zb543qdjl-5.start{counter-reset:lst-ctn-kix_ct3zb543qdjl-5 0}.lst-kix_aue93cd1tacp-8&gt;li{counter-increment:lst-ctn-kix_aue93cd1tacp-8}.lst-kix_ezf2mrk385uq-4&gt;li{counter-increment:lst-ctn-kix_ezf2mrk385uq-4}.lst-kix_hmo7gyj5poo-3&gt;li{counter-increment:lst-ctn-kix_hmo7gyj5poo-3}ol.lst-kix_aue93cd1tacp-3{list-style-type:none}ol.lst-kix_aue93cd1tacp-2{list-style-type:none}ol.lst-kix_aue93cd1tacp-1{list-style-type:none}ol.lst-kix_aue93cd1tacp-0{list-style-type:none}.lst-kix_hisa166i97g-0&gt;li{counter-increment:lst-ctn-kix_hisa166i97g-0}ol.lst-kix_aue93cd1tacp-7{list-style-type:none}ol.lst-kix_aue93cd1tacp-6{list-style-type:none}ol.lst-kix_aue93cd1tacp-5{list-style-type:none}ol.lst-kix_aue93cd1tacp-4{list-style-type:none}ol.lst-kix_hisa166i97g-6.start{counter-reset:lst-ctn-kix_hisa166i97g-6 0}ol.lst-kix_ct3zb543qdjl-0.start{counter-reset:lst-ctn-kix_ct3zb543qdjl-0 0}ol.lst-kix_aue93cd1tacp-1.start{counter-reset:lst-ctn-kix_aue93cd1tacp-1 0}ol.lst-kix_hmo7gyj5poo-4.start{counter-reset:lst-ctn-kix_hmo7gyj5poo-4 0}.lst-kix_ju6nxsiwjdzc-0&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_33m87cusbobo-0&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_ct3zb543qdjl-2&gt;li{counter-increment:lst-ctn-kix_ct3zb543qdjl-2}.lst-kix_ha0mdd7f5mn8-1&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ha0mdd7f5mn8-1,lower-latin) &quot;) &quot;}.lst-kix_ha0mdd7f5mn8-3&gt;li:before{content:&quot;(&quot; counter(lst-ctn-kix_ha0mdd7f5mn8-3,decimal) &quot;) &quot;}.lst-kix_ju6nxsiwjdzc-1&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_33m87cusbobo-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_hmo7gyj5poo-6&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hmo7gyj5poo-6,decimal) &quot;. &quot;}.lst-kix_hmo7gyj5poo-6&gt;li{counter-increment:lst-ctn-kix_hmo7gyj5poo-6}.lst-kix_hmo7gyj5poo-4&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hmo7gyj5poo-4,lower-latin) &quot;. &quot;}.lst-kix_hmo7gyj5poo-8&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hmo7gyj5poo-8,lower-roman) &quot;. &quot;}.lst-kix_ju6nxsiwjdzc-3&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_33m87cusbobo-4&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_ju6nxsiwjdzc-5&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_hisa166i97g-3&gt;li{counter-increment:lst-ctn-kix_hisa166i97g-3}.lst-kix_33m87cusbobo-6&gt;li:before{content:&quot;\0025cf  &quot;}ol.lst-kix_ezf2mrk385uq-8{list-style-type:none}.lst-kix_ju6nxsiwjdzc-7&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_33m87cusbobo-8&gt;li:before{content:&quot;\0025a0  &quot;}ol.lst-kix_ezf2mrk385uq-6{list-style-type:none}.lst-kix_ezf2mrk385uq-0&gt;li{counter-increment:lst-ctn-kix_ezf2mrk385uq-0}ol.lst-kix_ezf2mrk385uq-7{list-style-type:none}ol.lst-kix_ezf2mrk385uq-4{list-style-type:none}ol.lst-kix_ezf2mrk385uq-5{list-style-type:none}ol.lst-kix_ezf2mrk385uq-2{list-style-type:none}ol.lst-kix_ezf2mrk385uq-3{list-style-type:none}ol.lst-kix_ezf2mrk385uq-0{list-style-type:none}ol.lst-kix_ezf2mrk385uq-1{list-style-type:none}.lst-kix_ha0mdd7f5mn8-7&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ha0mdd7f5mn8-7,lower-latin) &quot;. &quot;}.lst-kix_ha0mdd7f5mn8-5&gt;li:before{content:&quot;(&quot; counter(lst-ctn-kix_ha0mdd7f5mn8-5,lower-roman) &quot;) &quot;}.lst-kix_ct3zb543qdjl-1&gt;li{counter-increment:lst-ctn-kix_ct3zb543qdjl-1}ol.lst-kix_ezf2mrk385uq-6.start{counter-reset:lst-ctn-kix_ezf2mrk385uq-6 0}ol.lst-kix_f1zwtsa21lze-6.start{counter-reset:lst-ctn-kix_f1zwtsa21lze-6 0}.lst-kix_2zj51yim977x-2&gt;li{counter-increment:lst-ctn-kix_2zj51yim977x-2}.lst-kix_mqtiiergx266-0&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_mqtiiergx266-4&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_yvc47pi19nhn-4&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_yvc47pi19nhn-8&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_u10h5r66zlog-4&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_mqtiiergx266-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_yvc47pi19nhn-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_yvc47pi19nhn-0&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_2zj51yim977x-3&gt;li{counter-increment:lst-ctn-kix_2zj51yim977x-3}.lst-kix_u10h5r66zlog-6&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_gavezx7jyt0h-4&gt;li:before{content:&quot;\0025cb  &quot;}ol.lst-kix_hisa166i97g-4.start{counter-reset:lst-ctn-kix_hisa166i97g-4 0}.lst-kix_u10h5r66zlog-8&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_gavezx7jyt0h-6&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_hisa166i97g-4&gt;li{counter-increment:lst-ctn-kix_hisa166i97g-4}.lst-kix_aue93cd1tacp-1&gt;li{counter-increment:lst-ctn-kix_aue93cd1tacp-1}.lst-kix_hmo7gyj5poo-0&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hmo7gyj5poo-0,decimal) &quot;. &quot;}.lst-kix_hmo7gyj5poo-7&gt;li{counter-increment:lst-ctn-kix_hmo7gyj5poo-7}ol.lst-kix_hmo7gyj5poo-1.start{counter-reset:lst-ctn-kix_hmo7gyj5poo-1 0}.lst-kix_hmo7gyj5poo-2&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hmo7gyj5poo-2,lower-roman) &quot;. &quot;}ol.lst-kix_f1zwtsa21lze-8.start{counter-reset:lst-ctn-kix_f1zwtsa21lze-8 0}.lst-kix_gavezx7jyt0h-2&gt;li:before{content:&quot;\0025a0  &quot;}ol.lst-kix_ct3zb543qdjl-3.start{counter-reset:lst-ctn-kix_ct3zb543qdjl-3 0}ol.lst-kix_hisa166i97g-3.start{counter-reset:lst-ctn-kix_hisa166i97g-3 0}.lst-kix_u10h5r66zlog-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_gavezx7jyt0h-0&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_f1zwtsa21lze-6&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_f1zwtsa21lze-6,decimal) &quot;. &quot;}.lst-kix_mqtiiergx266-8&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_u10h5r66zlog-0&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_f1zwtsa21lze-8&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_f1zwtsa21lze-8,lower-roman) &quot;. &quot;}.lst-kix_ha0mdd7f5mn8-6&gt;li{counter-increment:lst-ctn-kix_ha0mdd7f5mn8-6}.lst-kix_mqtiiergx266-6&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_yvc47pi19nhn-6&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_ezf2mrk385uq-5&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ezf2mrk385uq-5,lower-roman) &quot;. &quot;}.lst-kix_ezf2mrk385uq-7&gt;li{counter-increment:lst-ctn-kix_ezf2mrk385uq-7}.lst-kix_ct3zb543qdjl-8&gt;li{counter-increment:lst-ctn-kix_ct3zb543qdjl-8}.lst-kix_f1zwtsa21lze-2&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_f1zwtsa21lze-2,lower-roman) &quot;. &quot;}.lst-kix_ezf2mrk385uq-4&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ezf2mrk385uq-4,lower-latin) &quot;. &quot;}ol.lst-kix_2zj51yim977x-1.start{counter-reset:lst-ctn-kix_2zj51yim977x-1 0}.lst-kix_ezf2mrk385uq-1&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ezf2mrk385uq-1,lower-latin) &quot;. &quot;}ol.lst-kix_f1zwtsa21lze-5.start{counter-reset:lst-ctn-kix_f1zwtsa21lze-5 0}.lst-kix_f1zwtsa21lze-1&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_f1zwtsa21lze-1,lower-latin) &quot;. &quot;}ol.lst-kix_ha0mdd7f5mn8-5.start{counter-reset:lst-ctn-kix_ha0mdd7f5mn8-5 0}.lst-kix_ezf2mrk385uq-0&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ezf2mrk385uq-0,decimal) &quot;. &quot;}.lst-kix_hmo7gyj5poo-0&gt;li{counter-increment:lst-ctn-kix_hmo7gyj5poo-0}.lst-kix_gavezx7jyt0h-7&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_2zj51yim977x-0&gt;li{counter-increment:lst-ctn-kix_2zj51yim977x-0}.lst-kix_ha0mdd7f5mn8-7&gt;li{counter-increment:lst-ctn-kix_ha0mdd7f5mn8-7}ol.lst-kix_ct3zb543qdjl-8.start{counter-reset:lst-ctn-kix_ct3zb543qdjl-8 0}ol.lst-kix_f1zwtsa21lze-0{list-style-type:none}ol.lst-kix_f1zwtsa21lze-1{list-style-type:none}ol.lst-kix_f1zwtsa21lze-2{list-style-type:none}ol.lst-kix_f1zwtsa21lze-3{list-style-type:none}ol.lst-kix_2zj51yim977x-7.start{counter-reset:lst-ctn-kix_2zj51yim977x-7 0}ol.lst-kix_f1zwtsa21lze-4{list-style-type:none}.lst-kix_ezf2mrk385uq-8&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ezf2mrk385uq-8,lower-roman) &quot;. &quot;}ol.lst-kix_f1zwtsa21lze-5{list-style-type:none}ol.lst-kix_f1zwtsa21lze-6{list-style-type:none}ol.lst-kix_f1zwtsa21lze-7{list-style-type:none}ol.lst-kix_aue93cd1tacp-3.start{counter-reset:lst-ctn-kix_aue93cd1tacp-3 0}ol.lst-kix_f1zwtsa21lze-8{list-style-type:none}ol.lst-kix_aue93cd1tacp-2.start{counter-reset:lst-ctn-kix_aue93cd1tacp-2 0}.lst-kix_2zj51yim977x-1&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_2zj51yim977x-1,lower-latin) &quot;. &quot;}.lst-kix_2zj51yim977x-0&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_2zj51yim977x-0,decimal) &quot;. &quot;}ol.lst-kix_ha0mdd7f5mn8-0.start{counter-reset:lst-ctn-kix_ha0mdd7f5mn8-0 0}ol.lst-kix_ezf2mrk385uq-2.start{counter-reset:lst-ctn-kix_ezf2mrk385uq-2 0}ul.lst-kix_33m87cusbobo-1{list-style-type:none}ul.lst-kix_33m87cusbobo-0{list-style-type:none}ol.lst-kix_2zj51yim977x-2.start{counter-reset:lst-ctn-kix_2zj51yim977x-2 0}.lst-kix_2zj51yim977x-8&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_2zj51yim977x-8,lower-roman) &quot;. &quot;}ol.lst-kix_ct3zb543qdjl-7.start{counter-reset:lst-ctn-kix_ct3zb543qdjl-7 0}ol.lst-kix_f1zwtsa21lze-4.start{counter-reset:lst-ctn-kix_f1zwtsa21lze-4 0}ul.lst-kix_mqtiiergx266-4{list-style-type:none}ul.lst-kix_mqtiiergx266-3{list-style-type:none}ol.lst-kix_ezf2mrk385uq-1.start{counter-reset:lst-ctn-kix_ezf2mrk385uq-1 0}ol.lst-kix_ha0mdd7f5mn8-6.start{counter-reset:lst-ctn-kix_ha0mdd7f5mn8-6 0}ul.lst-kix_mqtiiergx266-2{list-style-type:none}ul.lst-kix_mqtiiergx266-1{list-style-type:none}ul.lst-kix_mqtiiergx266-0{list-style-type:none}.lst-kix_2zj51yim977x-4&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_2zj51yim977x-4,lower-latin) &quot;. &quot;}.lst-kix_2zj51yim977x-7&gt;li{counter-increment:lst-ctn-kix_2zj51yim977x-7}ul.lst-kix_33m87cusbobo-7{list-style-type:none}ul.lst-kix_33m87cusbobo-6{list-style-type:none}.lst-kix_2zj51yim977x-5&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_2zj51yim977x-5,lower-roman) &quot;. &quot;}ol.lst-kix_aue93cd1tacp-8.start{counter-reset:lst-ctn-kix_aue93cd1tacp-8 0}ul.lst-kix_33m87cusbobo-8{list-style-type:none}ul.lst-kix_mqtiiergx266-8{list-style-type:none}ul.lst-kix_33m87cusbobo-3{list-style-type:none}ul.lst-kix_mqtiiergx266-7{list-style-type:none}ul.lst-kix_33m87cusbobo-2{list-style-type:none}ul.lst-kix_mqtiiergx266-6{list-style-type:none}ul.lst-kix_33m87cusbobo-5{list-style-type:none}ul.lst-kix_mqtiiergx266-5{list-style-type:none}ul.lst-kix_33m87cusbobo-4{list-style-type:none}.lst-kix_a7picbopwap5-4&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_ha0mdd7f5mn8-2&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ha0mdd7f5mn8-2,lower-roman) &quot;) &quot;}ol.lst-kix_aue93cd1tacp-4.start{counter-reset:lst-ctn-kix_aue93cd1tacp-4 0}.lst-kix_xkot2rd1rwjd-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_xkot2rd1rwjd-6&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_f1zwtsa21lze-1&gt;li{counter-increment:lst-ctn-kix_f1zwtsa21lze-1}.lst-kix_a7picbopwap5-0&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_a7picbopwap5-8&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_hisa166i97g-2&gt;li{counter-increment:lst-ctn-kix_hisa166i97g-2}ol.lst-kix_2zj51yim977x-5.start{counter-reset:lst-ctn-kix_2zj51yim977x-5 0}.lst-kix_33m87cusbobo-1&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_2zj51yim977x-5&gt;li{counter-increment:lst-ctn-kix_2zj51yim977x-5}.lst-kix_5fvsno8h94t-3&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_ju6nxsiwjdzc-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_33m87cusbobo-5&gt;li:before{content:&quot;\0025a0  &quot;}ol.lst-kix_ezf2mrk385uq-0.start{counter-reset:lst-ctn-kix_ezf2mrk385uq-0 0}.lst-kix_ezf2mrk385uq-2&gt;li{counter-increment:lst-ctn-kix_ezf2mrk385uq-2}.lst-kix_ju6nxsiwjdzc-6&gt;li:before{content:&quot;\0025cf  &quot;}ol.lst-kix_aue93cd1tacp-7.start{counter-reset:lst-ctn-kix_aue93cd1tacp-7 0}ol.lst-kix_2zj51yim977x-8.start{counter-reset:lst-ctn-kix_2zj51yim977x-8 0}.lst-kix_hmo7gyj5poo-7&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hmo7gyj5poo-7,lower-latin) &quot;. &quot;}.lst-kix_f1zwtsa21lze-3&gt;li{counter-increment:lst-ctn-kix_f1zwtsa21lze-3}.lst-kix_5fvsno8h94t-7&gt;li:before{content:&quot;\0025cb  &quot;}ul.lst-kix_gavezx7jyt0h-8{list-style-type:none}.lst-kix_ha0mdd7f5mn8-4&gt;li{counter-increment:lst-ctn-kix_ha0mdd7f5mn8-4}ul.lst-kix_gavezx7jyt0h-4{list-style-type:none}ul.lst-kix_gavezx7jyt0h-5{list-style-type:none}.lst-kix_ha0mdd7f5mn8-2&gt;li{counter-increment:lst-ctn-kix_ha0mdd7f5mn8-2}ul.lst-kix_gavezx7jyt0h-6{list-style-type:none}ul.lst-kix_gavezx7jyt0h-7{list-style-type:none}ul.lst-kix_gavezx7jyt0h-0{list-style-type:none}ul.lst-kix_gavezx7jyt0h-1{list-style-type:none}ul.lst-kix_gavezx7jyt0h-2{list-style-type:none}ul.lst-kix_gavezx7jyt0h-3{list-style-type:none}ol.lst-kix_f1zwtsa21lze-3.start{counter-reset:lst-ctn-kix_f1zwtsa21lze-3 0}.lst-kix_ha0mdd7f5mn8-6&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ha0mdd7f5mn8-6,decimal) &quot;. &quot;}.lst-kix_hmo7gyj5poo-5&gt;li{counter-increment:lst-ctn-kix_hmo7gyj5poo-5}ol.lst-kix_ha0mdd7f5mn8-1.start{counter-reset:lst-ctn-kix_ha0mdd7f5mn8-1 0}ol.lst-kix_hisa166i97g-8.start{counter-reset:lst-ctn-kix_hisa166i97g-8 0}.lst-kix_mqtiiergx266-1&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_yvc47pi19nhn-7&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_ct3zb543qdjl-5&gt;li{counter-increment:lst-ctn-kix_ct3zb543qdjl-5}ol.lst-kix_ha0mdd7f5mn8-4.start{counter-reset:lst-ctn-kix_ha0mdd7f5mn8-4 0}.lst-kix_yvc47pi19nhn-3&gt;li:before{content:&quot;\0025cf  &quot;}ol.lst-kix_f1zwtsa21lze-0.start{counter-reset:lst-ctn-kix_f1zwtsa21lze-0 0}.lst-kix_u10h5r66zlog-3&gt;li:before{content:&quot;\0025cf  &quot;}ol.lst-kix_2zj51yim977x-6.start{counter-reset:lst-ctn-kix_2zj51yim977x-6 0}.lst-kix_gavezx7jyt0h-3&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_u10h5r66zlog-7&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_ct3zb543qdjl-7&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ct3zb543qdjl-7,lower-latin) &quot;. &quot;}ol.lst-kix_ha0mdd7f5mn8-3.start{counter-reset:lst-ctn-kix_ha0mdd7f5mn8-3 0}ol.lst-kix_f1zwtsa21lze-1.start{counter-reset:lst-ctn-kix_f1zwtsa21lze-1 0}.lst-kix_aue93cd1tacp-4&gt;li{counter-increment:lst-ctn-kix_aue93cd1tacp-4}ol.lst-kix_aue93cd1tacp-5.start{counter-reset:lst-ctn-kix_aue93cd1tacp-5 0}.lst-kix_hisa166i97g-7&gt;li{counter-increment:lst-ctn-kix_hisa166i97g-7}.lst-kix_hmo7gyj5poo-3&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hmo7gyj5poo-3,decimal) &quot;. &quot;}.lst-kix_f1zwtsa21lze-5&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_f1zwtsa21lze-5,lower-roman) &quot;. &quot;}.lst-kix_n1wl50guyz1t-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_n1wl50guyz1t-6&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_ct3zb543qdjl-3&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ct3zb543qdjl-3,decimal) &quot;. &quot;}.lst-kix_mqtiiergx266-5&gt;li:before{content:&quot;\0025a0  &quot;}ol.lst-kix_2zj51yim977x-1{list-style-type:none}ol.lst-kix_2zj51yim977x-2{list-style-type:none}ol.lst-kix_2zj51yim977x-3{list-style-type:none}.lst-kix_aue93cd1tacp-1&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_aue93cd1tacp-1,lower-latin) &quot;. &quot;}ol.lst-kix_2zj51yim977x-4{list-style-type:none}ol.lst-kix_2zj51yim977x-5{list-style-type:none}ol.lst-kix_2zj51yim977x-6{list-style-type:none}ol.lst-kix_2zj51yim977x-7{list-style-type:none}.lst-kix_aue93cd1tacp-2&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_aue93cd1tacp-2,lower-roman) &quot;. &quot;}ol.lst-kix_2zj51yim977x-8{list-style-type:none}.lst-kix_1alpl2noeu5i-1&gt;li:before{content:&quot;\0025cb  &quot;}ol.lst-kix_hmo7gyj5poo-5.start{counter-reset:lst-ctn-kix_hmo7gyj5poo-5 0}.lst-kix_aue93cd1tacp-3&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_aue93cd1tacp-3,decimal) &quot;. &quot;}.lst-kix_aue93cd1tacp-5&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_aue93cd1tacp-5,lower-roman) &quot;. &quot;}.lst-kix_1alpl2noeu5i-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_1alpl2noeu5i-3&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_aue93cd1tacp-4&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_aue93cd1tacp-4,lower-latin) &quot;. &quot;}ol.lst-kix_2zj51yim977x-0{list-style-type:none}.lst-kix_ha0mdd7f5mn8-8&gt;li{counter-increment:lst-ctn-kix_ha0mdd7f5mn8-8}.lst-kix_ezf2mrk385uq-6&gt;li{counter-increment:lst-ctn-kix_ezf2mrk385uq-6}ul.lst-kix_1alpl2noeu5i-1{list-style-type:none}ul.lst-kix_1alpl2noeu5i-0{list-style-type:none}.lst-kix_f1zwtsa21lze-8&gt;li{counter-increment:lst-ctn-kix_f1zwtsa21lze-8}ol.lst-kix_ha0mdd7f5mn8-2.start{counter-reset:lst-ctn-kix_ha0mdd7f5mn8-2 0}.lst-kix_1alpl2noeu5i-0&gt;li:before{content:&quot;\0025cf  &quot;}ol.lst-kix_f1zwtsa21lze-2.start{counter-reset:lst-ctn-kix_f1zwtsa21lze-2 0}ul.lst-kix_u10h5r66zlog-6{list-style-type:none}ul.lst-kix_u10h5r66zlog-7{list-style-type:none}ul.lst-kix_u10h5r66zlog-8{list-style-type:none}.lst-kix_aue93cd1tacp-0&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_aue93cd1tacp-0,decimal) &quot;. &quot;}ul.lst-kix_u10h5r66zlog-2{list-style-type:none}ul.lst-kix_u10h5r66zlog-3{list-style-type:none}ul.lst-kix_u10h5r66zlog-4{list-style-type:none}ul.lst-kix_u10h5r66zlog-5{list-style-type:none}ul.lst-kix_u10h5r66zlog-0{list-style-type:none}ul.lst-kix_u10h5r66zlog-1{list-style-type:none}ol.lst-kix_aue93cd1tacp-0.start{counter-reset:lst-ctn-kix_aue93cd1tacp-0 0}.lst-kix_1alpl2noeu5i-4&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_1alpl2noeu5i-5&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_aue93cd1tacp-7&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_aue93cd1tacp-7,lower-latin) &quot;. &quot;}.lst-kix_ct3zb543qdjl-7&gt;li{counter-increment:lst-ctn-kix_ct3zb543qdjl-7}.lst-kix_aue93cd1tacp-6&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_aue93cd1tacp-6,decimal) &quot;. &quot;}.lst-kix_1alpl2noeu5i-8&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_1alpl2noeu5i-6&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_1alpl2noeu5i-7&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_aue93cd1tacp-8&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_aue93cd1tacp-8,lower-roman) &quot;. &quot;}ol.lst-kix_hisa166i97g-0.start{counter-reset:lst-ctn-kix_hisa166i97g-0 0}ol.lst-kix_2zj51yim977x-3.start{counter-reset:lst-ctn-kix_2zj51yim977x-3 0}ol.lst-kix_hisa166i97g-7.start{counter-reset:lst-ctn-kix_hisa166i97g-7 0}.lst-kix_f1zwtsa21lze-4&gt;li{counter-increment:lst-ctn-kix_f1zwtsa21lze-4}ol.lst-kix_ct3zb543qdjl-6.start{counter-reset:lst-ctn-kix_ct3zb543qdjl-6 0}.lst-kix_ct3zb543qdjl-0&gt;li{counter-increment:lst-ctn-kix_ct3zb543qdjl-0}ol.lst-kix_ha0mdd7f5mn8-7.start{counter-reset:lst-ctn-kix_ha0mdd7f5mn8-7 0}.lst-kix_hisa166i97g-8&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hisa166i97g-8,lower-roman) &quot;. &quot;}.lst-kix_aue93cd1tacp-6&gt;li{counter-increment:lst-ctn-kix_aue93cd1tacp-6}.lst-kix_ha0mdd7f5mn8-1&gt;li{counter-increment:lst-ctn-kix_ha0mdd7f5mn8-1}.lst-kix_hisa166i97g-1&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hisa166i97g-1,lower-latin) &quot;. &quot;}.lst-kix_hisa166i97g-2&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hisa166i97g-2,lower-roman) &quot;. &quot;}.lst-kix_hisa166i97g-0&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hisa166i97g-0,decimal) &quot;. &quot;}.lst-kix_hisa166i97g-4&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hisa166i97g-4,lower-latin) &quot;. &quot;}.lst-kix_hisa166i97g-5&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hisa166i97g-5,lower-roman) &quot;. &quot;}ul.lst-kix_ju6nxsiwjdzc-7{list-style-type:none}ul.lst-kix_ju6nxsiwjdzc-6{list-style-type:none}ul.lst-kix_ju6nxsiwjdzc-8{list-style-type:none}.lst-kix_hisa166i97g-7&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hisa166i97g-7,lower-latin) &quot;. &quot;}ul.lst-kix_ju6nxsiwjdzc-3{list-style-type:none}ul.lst-kix_ju6nxsiwjdzc-2{list-style-type:none}.lst-kix_hisa166i97g-6&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hisa166i97g-6,decimal) &quot;. &quot;}ul.lst-kix_ju6nxsiwjdzc-5{list-style-type:none}ul.lst-kix_ju6nxsiwjdzc-4{list-style-type:none}ol.lst-kix_ha0mdd7f5mn8-8{list-style-type:none}ul.lst-kix_ju6nxsiwjdzc-1{list-style-type:none}ul.lst-kix_ju6nxsiwjdzc-0{list-style-type:none}ol.lst-kix_ha0mdd7f5mn8-0{list-style-type:none}ol.lst-kix_ha0mdd7f5mn8-1{list-style-type:none}ol.lst-kix_ha0mdd7f5mn8-2{list-style-type:none}ol.lst-kix_ha0mdd7f5mn8-3{list-style-type:none}ol.lst-kix_ha0mdd7f5mn8-4{list-style-type:none}ol.lst-kix_ha0mdd7f5mn8-5{list-style-type:none}.lst-kix_hisa166i97g-3&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hisa166i97g-3,decimal) &quot;. &quot;}ol.lst-kix_ha0mdd7f5mn8-6{list-style-type:none}ol.lst-kix_ha0mdd7f5mn8-7{list-style-type:none}.lst-kix_2zj51yim977x-1&gt;li{counter-increment:lst-ctn-kix_2zj51yim977x-1}.lst-kix_a7picbopwap5-5&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_xkot2rd1rwjd-3&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_xkot2rd1rwjd-5&gt;li:before{content:&quot;\0025a0  &quot;}ol.lst-kix_hisa166i97g-0{list-style-type:none}.lst-kix_aue93cd1tacp-2&gt;li{counter-increment:lst-ctn-kix_aue93cd1tacp-2}.lst-kix_a7picbopwap5-1&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_5fvsno8h94t-0&gt;li:before{content:&quot;\0025cf  &quot;}ol.lst-kix_hisa166i97g-5.start{counter-reset:lst-ctn-kix_hisa166i97g-5 0}.lst-kix_a7picbopwap5-7&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_5fvsno8h94t-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_5fvsno8h94t-4&gt;li:before{content:&quot;\0025cb  &quot;}ol.lst-kix_hisa166i97g-2.start{counter-reset:lst-ctn-kix_hisa166i97g-2 0}ol.lst-kix_ct3zb543qdjl-4.start{counter-reset:lst-ctn-kix_ct3zb543qdjl-4 0}ul.lst-kix_a7picbopwap5-1{list-style-type:none}ol.lst-kix_hisa166i97g-4{list-style-type:none}ul.lst-kix_a7picbopwap5-2{list-style-type:none}ol.lst-kix_hisa166i97g-3{list-style-type:none}ol.lst-kix_ct3zb543qdjl-1.start{counter-reset:lst-ctn-kix_ct3zb543qdjl-1 0}ol.lst-kix_hisa166i97g-2{list-style-type:none}.lst-kix_ct3zb543qdjl-3&gt;li{counter-increment:lst-ctn-kix_ct3zb543qdjl-3}.lst-kix_xkot2rd1rwjd-1&gt;li:before{content:&quot;\0025cb  &quot;}ul.lst-kix_a7picbopwap5-0{list-style-type:none}ol.lst-kix_hisa166i97g-1{list-style-type:none}.lst-kix_a7picbopwap5-3&gt;li:before{content:&quot;\0025cf  &quot;}ol.lst-kix_hisa166i97g-8{list-style-type:none}ol.lst-kix_hisa166i97g-7{list-style-type:none}ol.lst-kix_hisa166i97g-6{list-style-type:none}ol.lst-kix_hisa166i97g-5{list-style-type:none}ul.lst-kix_a7picbopwap5-7{list-style-type:none}ul.lst-kix_a7picbopwap5-8{list-style-type:none}ol.lst-kix_ezf2mrk385uq-3.start{counter-reset:lst-ctn-kix_ezf2mrk385uq-3 0}ul.lst-kix_a7picbopwap5-5{list-style-type:none}ul.lst-kix_a7picbopwap5-6{list-style-type:none}.lst-kix_f1zwtsa21lze-0&gt;li{counter-increment:lst-ctn-kix_f1zwtsa21lze-0}ul.lst-kix_a7picbopwap5-3{list-style-type:none}ul.lst-kix_a7picbopwap5-4{list-style-type:none}.lst-kix_5fvsno8h94t-6&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_5fvsno8h94t-8&gt;li:before{content:&quot;\0025a0  &quot;}ol.lst-kix_hmo7gyj5poo-3.start{counter-reset:lst-ctn-kix_hmo7gyj5poo-3 0}.lst-kix_hisa166i97g-5&gt;li{counter-increment:lst-ctn-kix_hisa166i97g-5}.lst-kix_hmo7gyj5poo-8&gt;li{counter-increment:lst-ctn-kix_hmo7gyj5poo-8}.lst-kix_xkot2rd1rwjd-7&gt;li:before{content:&quot;\0025cb  &quot;}ol.lst-kix_hmo7gyj5poo-0.start{counter-reset:lst-ctn-kix_hmo7gyj5poo-0 0}ol.lst-kix_f1zwtsa21lze-7.start{counter-reset:lst-ctn-kix_f1zwtsa21lze-7 0}.lst-kix_2zj51yim977x-8&gt;li{counter-increment:lst-ctn-kix_2zj51yim977x-8}.lst-kix_ha0mdd7f5mn8-0&gt;li{counter-increment:lst-ctn-kix_ha0mdd7f5mn8-0}.lst-kix_f1zwtsa21lze-5&gt;li{counter-increment:lst-ctn-kix_f1zwtsa21lze-5}ol.lst-kix_2zj51yim977x-0.start{counter-reset:lst-ctn-kix_2zj51yim977x-0 0}.lst-kix_hmo7gyj5poo-1&gt;li{counter-increment:lst-ctn-kix_hmo7gyj5poo-1}ol.lst-kix_ezf2mrk385uq-5.start{counter-reset:lst-ctn-kix_ezf2mrk385uq-5 0}.lst-kix_ct3zb543qdjl-6&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ct3zb543qdjl-6,decimal) &quot;. &quot;}ul.lst-kix_1alpl2noeu5i-5{list-style-type:none}ul.lst-kix_1alpl2noeu5i-4{list-style-type:none}ul.lst-kix_1alpl2noeu5i-3{list-style-type:none}.lst-kix_aue93cd1tacp-7&gt;li{counter-increment:lst-ctn-kix_aue93cd1tacp-7}ul.lst-kix_1alpl2noeu5i-2{list-style-type:none}ul.lst-kix_1alpl2noeu5i-8{list-style-type:none}.lst-kix_n1wl50guyz1t-7&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_ct3zb543qdjl-0&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ct3zb543qdjl-0,decimal) &quot;. &quot;}.lst-kix_ct3zb543qdjl-8&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ct3zb543qdjl-8,lower-roman) &quot;. &quot;}ul.lst-kix_1alpl2noeu5i-7{list-style-type:none}ul.lst-kix_1alpl2noeu5i-6{list-style-type:none}.lst-kix_n1wl50guyz1t-1&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_n1wl50guyz1t-5&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_ct3zb543qdjl-2&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ct3zb543qdjl-2,lower-roman) &quot;. &quot;}.lst-kix_n1wl50guyz1t-3&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_ct3zb543qdjl-4&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ct3zb543qdjl-4,lower-latin) &quot;. &quot;}.lst-kix_ezf2mrk385uq-6&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ezf2mrk385uq-6,decimal) &quot;. &quot;}.lst-kix_f1zwtsa21lze-7&gt;li{counter-increment:lst-ctn-kix_f1zwtsa21lze-7}.lst-kix_ezf2mrk385uq-2&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ezf2mrk385uq-2,lower-roman) &quot;. &quot;}.lst-kix_f1zwtsa21lze-3&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_f1zwtsa21lze-3,decimal) &quot;. &quot;}.lst-kix_f1zwtsa21lze-4&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_f1zwtsa21lze-4,lower-latin) &quot;. &quot;}.lst-kix_ezf2mrk385uq-3&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ezf2mrk385uq-3,decimal) &quot;. &quot;}ol.lst-kix_ezf2mrk385uq-7.start{counter-reset:lst-ctn-kix_ezf2mrk385uq-7 0}.lst-kix_f1zwtsa21lze-0&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_f1zwtsa21lze-0,decimal) &quot;. &quot;}ol.lst-kix_hmo7gyj5poo-2.start{counter-reset:lst-ctn-kix_hmo7gyj5poo-2 0}.lst-kix_gavezx7jyt0h-8&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_ezf2mrk385uq-5&gt;li{counter-increment:lst-ctn-kix_ezf2mrk385uq-5}ol.lst-kix_ct3zb543qdjl-2.start{counter-reset:lst-ctn-kix_ct3zb543qdjl-2 0}.lst-kix_hisa166i97g-8&gt;li{counter-increment:lst-ctn-kix_hisa166i97g-8}.lst-kix_hmo7gyj5poo-2&gt;li{counter-increment:lst-ctn-kix_hmo7gyj5poo-2}.lst-kix_ezf2mrk385uq-7&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ezf2mrk385uq-7,lower-latin) &quot;. &quot;}ol.lst-kix_hmo7gyj5poo-6{list-style-type:none}ul.lst-kix_yvc47pi19nhn-0{list-style-type:none}ol.lst-kix_hmo7gyj5poo-5{list-style-type:none}ul.lst-kix_yvc47pi19nhn-1{list-style-type:none}ol.lst-kix_hmo7gyj5poo-8{list-style-type:none}ul.lst-kix_yvc47pi19nhn-2{list-style-type:none}ol.lst-kix_hmo7gyj5poo-7{list-style-type:none}ul.lst-kix_yvc47pi19nhn-3{list-style-type:none}ul.lst-kix_yvc47pi19nhn-4{list-style-type:none}ul.lst-kix_yvc47pi19nhn-5{list-style-type:none}ul.lst-kix_yvc47pi19nhn-6{list-style-type:none}ol.lst-kix_hmo7gyj5poo-0{list-style-type:none}ol.lst-kix_hmo7gyj5poo-2{list-style-type:none}ol.lst-kix_hmo7gyj5poo-1{list-style-type:none}ol.lst-kix_hmo7gyj5poo-4{list-style-type:none}ol.lst-kix_hmo7gyj5poo-3{list-style-type:none}.lst-kix_ha0mdd7f5mn8-5&gt;li{counter-increment:lst-ctn-kix_ha0mdd7f5mn8-5}.lst-kix_hisa166i97g-6&gt;li{counter-increment:lst-ctn-kix_hisa166i97g-6}ul.lst-kix_yvc47pi19nhn-7{list-style-type:none}ul.lst-kix_yvc47pi19nhn-8{list-style-type:none}.lst-kix_aue93cd1tacp-0&gt;li{counter-increment:lst-ctn-kix_aue93cd1tacp-0}.lst-kix_ct3zb543qdjl-6&gt;li{counter-increment:lst-ctn-kix_ct3zb543qdjl-6}ol.lst-kix_ezf2mrk385uq-8.start{counter-reset:lst-ctn-kix_ezf2mrk385uq-8 0}.lst-kix_2zj51yim977x-2&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_2zj51yim977x-2,lower-roman) &quot;. &quot;}.lst-kix_2zj51yim977x-3&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_2zj51yim977x-3,decimal) &quot;. &quot;}.lst-kix_2zj51yim977x-4&gt;li{counter-increment:lst-ctn-kix_2zj51yim977x-4}.lst-kix_2zj51yim977x-6&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_2zj51yim977x-6,decimal) &quot;. &quot;}.lst-kix_2zj51yim977x-7&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_2zj51yim977x-7,lower-latin) &quot;. &quot;}.lst-kix_ezf2mrk385uq-1&gt;li{counter-increment:lst-ctn-kix_ezf2mrk385uq-1}.lst-kix_ha0mdd7f5mn8-0&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ha0mdd7f5mn8-0,decimal) &quot;) &quot;}ul.lst-kix_xkot2rd1rwjd-0{list-style-type:none}.lst-kix_a7picbopwap5-6&gt;li:before{content:&quot;\0025cf  &quot;}ul.lst-kix_xkot2rd1rwjd-2{list-style-type:none}ul.lst-kix_xkot2rd1rwjd-1{list-style-type:none}ul.lst-kix_xkot2rd1rwjd-4{list-style-type:none}ul.lst-kix_xkot2rd1rwjd-3{list-style-type:none}ul.lst-kix_xkot2rd1rwjd-6{list-style-type:none}ul.lst-kix_xkot2rd1rwjd-5{list-style-type:none}ul.lst-kix_xkot2rd1rwjd-8{list-style-type:none}ul.lst-kix_xkot2rd1rwjd-7{list-style-type:none}.lst-kix_xkot2rd1rwjd-4&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_f1zwtsa21lze-2&gt;li{counter-increment:lst-ctn-kix_f1zwtsa21lze-2}.lst-kix_aue93cd1tacp-3&gt;li{counter-increment:lst-ctn-kix_aue93cd1tacp-3}.lst-kix_33m87cusbobo-3&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_5fvsno8h94t-1&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_5fvsno8h94t-5&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_ju6nxsiwjdzc-4&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_hmo7gyj5poo-5&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hmo7gyj5poo-5,lower-roman) &quot;. &quot;}.lst-kix_a7picbopwap5-2&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_2zj51yim977x-6&gt;li{counter-increment:lst-ctn-kix_2zj51yim977x-6}.lst-kix_33m87cusbobo-7&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_xkot2rd1rwjd-0&gt;li:before{content:&quot;\0025cf  &quot;}ol.lst-kix_hmo7gyj5poo-6.start{counter-reset:lst-ctn-kix_hmo7gyj5poo-6 0}.lst-kix_ju6nxsiwjdzc-8&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_ha0mdd7f5mn8-8&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ha0mdd7f5mn8-8,lower-roman) &quot;. &quot;}.lst-kix_ct3zb543qdjl-4&gt;li{counter-increment:lst-ctn-kix_ct3zb543qdjl-4}.lst-kix_ha0mdd7f5mn8-4&gt;li:before{content:&quot;(&quot; counter(lst-ctn-kix_ha0mdd7f5mn8-4,lower-latin) &quot;) &quot;}.lst-kix_aue93cd1tacp-5&gt;li{counter-increment:lst-ctn-kix_aue93cd1tacp-5}.lst-kix_xkot2rd1rwjd-8&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_yvc47pi19nhn-5&gt;li:before{content:&quot;\0025a0  &quot;}.lst-kix_n1wl50guyz1t-0&gt;li:before{content:&quot;\0025cf  &quot;}.lst-kix_yvc47pi19nhn-1&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_mqtiiergx266-3&gt;li:before{content:&quot;\0025cf  &quot;}ul.lst-kix_n1wl50guyz1t-1{list-style-type:none}ul.lst-kix_n1wl50guyz1t-0{list-style-type:none}ul.lst-kix_n1wl50guyz1t-3{list-style-type:none}ul.lst-kix_n1wl50guyz1t-2{list-style-type:none}.lst-kix_ezf2mrk385uq-3&gt;li{counter-increment:lst-ctn-kix_ezf2mrk385uq-3}.lst-kix_u10h5r66zlog-5&gt;li:before{content:&quot;\0025a0  &quot;}ul.lst-kix_n1wl50guyz1t-8{list-style-type:none}ul.lst-kix_n1wl50guyz1t-5{list-style-type:none}ul.lst-kix_n1wl50guyz1t-4{list-style-type:none}ol.lst-kix_hmo7gyj5poo-7.start{counter-reset:lst-ctn-kix_hmo7gyj5poo-7 0}ul.lst-kix_n1wl50guyz1t-7{list-style-type:none}.lst-kix_gavezx7jyt0h-5&gt;li:before{content:&quot;\0025a0  &quot;}ul.lst-kix_n1wl50guyz1t-6{list-style-type:none}ul.lst-kix_5fvsno8h94t-4{list-style-type:none}ul.lst-kix_5fvsno8h94t-3{list-style-type:none}ul.lst-kix_5fvsno8h94t-6{list-style-type:none}ul.lst-kix_5fvsno8h94t-5{list-style-type:none}ul.lst-kix_5fvsno8h94t-0{list-style-type:none}.lst-kix_ct3zb543qdjl-5&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ct3zb543qdjl-5,lower-roman) &quot;. &quot;}ul.lst-kix_5fvsno8h94t-2{list-style-type:none}.lst-kix_hmo7gyj5poo-1&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_hmo7gyj5poo-1,lower-latin) &quot;. &quot;}ul.lst-kix_5fvsno8h94t-1{list-style-type:none}.lst-kix_hisa166i97g-1&gt;li{counter-increment:lst-ctn-kix_hisa166i97g-1}.lst-kix_n1wl50guyz1t-8&gt;li:before{content:&quot;\0025a0  &quot;}ul.lst-kix_5fvsno8h94t-8{list-style-type:none}ul.lst-kix_5fvsno8h94t-7{list-style-type:none}.lst-kix_hmo7gyj5poo-4&gt;li{counter-increment:lst-ctn-kix_hmo7gyj5poo-4}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_gavezx7jyt0h-1&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_n1wl50guyz1t-4&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_f1zwtsa21lze-7&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_f1zwtsa21lze-7,lower-latin) &quot;. &quot;}.lst-kix_ct3zb543qdjl-1&gt;li:before{content:&quot;&quot; counter(lst-ctn-kix_ct3zb543qdjl-1,lower-latin) &quot;. &quot;}.lst-kix_u10h5r66zlog-1&gt;li:before{content:&quot;\0025cb  &quot;}ol.lst-kix_hmo7gyj5poo-8.start{counter-reset:lst-ctn-kix_hmo7gyj5poo-8 0}.lst-kix_mqtiiergx266-7&gt;li:before{content:&quot;\0025cb  &quot;}.lst-kix_ha0mdd7f5mn8-3&gt;li{counter-increment:lst-ctn-kix_ha0mdd7f5mn8-3}ol{margin:0;padding:0}table td,table th{padding:0}.c9{background-color:#ffffff;padding-top:0pt;padding-bottom:0pt;line-height:1.38;orphans:2;widows:2;text-align:left}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:&quot;Arial&quot;;font-style:normal}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:Consolas,&quot;Courier New&quot;;font-style:normal}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:8pt;font-family:Consolas,&quot;Courier New&quot;;font-style:normal}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:20pt;font-family:&quot;Arial&quot;;font-style:normal}.c13{padding-top:20pt;padding-bottom:6pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c14{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:&quot;Arial&quot;;font-style:normal}.c17{padding-top:18pt;padding-bottom:6pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c26{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:&quot;Arial&quot;}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c21{color:#000000;text-decoration:none;vertical-align:baseline;font-size:12pt;font-style:normal}.c8{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c7{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c19{text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:normal}.c29{color:#000000;font-weight:700;font-family:Consolas,&quot;Courier New&quot;}.c27{text-decoration:none;vertical-align:baseline;font-style:normal}.c28{border:1px solid black;margin:5px}.c10{background-color:#efefef;font-size:10pt}.c30{max-width:468pt;padding:72pt 72pt 72pt 72pt}.c16{color:inherit;text-decoration:inherit}.c22{font-size:12pt;color:#999999}.c11{margin-left:36pt;padding-left:0pt}.c15{padding:0;margin:0}.c6{font-weight:400;font-family:Consolas,&quot;Courier New&quot;}.c31{color:#000000}.c4{height:11pt}.c23{background-color:#efefef}.c12{color:#666666}.c18{background-color:#ffffff}.c20{font-size:10pt}.c24{font-size:12pt}.c25{font-style:italic}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:&quot;Arial&quot;}p{margin:0;color:#000000;font-size:11pt;font-family:&quot;Arial&quot;}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:&quot;Arial&quot;;line-height:1.5;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}&lt;/style&gt;&lt;/head&gt;&lt;body class=&quot;c18 c30&quot;&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Posted By Samuel Gro&amp;szlig;, Project Zero&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;On December 20, Citizenlab published &amp;ldquo;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://citizenlab.ca/2020/12/the-great-ipwn-journalists-hacked-with-suspected-nso-group-imessage-zero-click-exploit/&quot;&gt;The Great iPwn&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;rdquo;, detailing how &lt;/span&gt;&lt;span&gt;&amp;ldquo;Journalists [were] Hacked with Suspected NSO Group iMessage &amp;lsquo;Zero-Click&amp;rsquo; Exploit&amp;rdquo;&lt;/span&gt;&lt;span&gt;. Of particular interest is the following note: &amp;ldquo;We do not believe that [the exploit] works against iOS 14 and above, which includes new security protections&amp;#39;&amp;#39;. Given that it is also now almost exactly one year ago since we published the &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://googleprojectzero.blogspot.com/2020/01/remote-iphone-exploitation-part-1.html&quot;&gt;Remote iPhone Exploitation&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;blog post series&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;, in which we described how an iMessage 0-click exploit can work in practice and gave a number of suggestions on how similar attacks could be prevented in the future, now seemed like a great time to dig into the security improvements in iOS 14 in more detail and explore how Apple has hardened their platform against 0-click attacks.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;The content of this blog post is the result of a roughly one-week reverse engineering project, mostly performed on a M1 Mac Mini running macOS 11.1, with the results, where possible, verified to also apply to iOS 14.3, running on an iPhone XS. Due to the nature of this project and the limited timeframe, it is possible that I have missed some relevant changes or made mistakes interpreting some results. Where possible, I&amp;rsquo;ve tried to describe the steps necessary to verify the presented results, and would appreciate any corrections or additions.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;The blog post will start with an overview of the major changes Apple implemented in iOS 14 which affect the security of iMessage. Afterwards, and mostly for the readers interested in the technical details, each of the major improvements is described in more detail while also providing a walkthrough of how it was reverse engineered. At least for the technical details, it is recommended to briefly review the blog post series from last year for a basic introduction to iMessage and the exploitation techniques used to attack it.&lt;/span&gt;&lt;/p&gt;&lt;h1 class=&quot;c13&quot; id=&quot;h.2ep7vgcii9xa&quot;&gt;&lt;span class=&quot;c5&quot;&gt;Overview&lt;/span&gt;&lt;/h1&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Memory corruption based 0-click exploits typically require at least the following pieces:&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;c15 lst-kix_2zj51yim977x-0 start&quot; start=&quot;1&quot;&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;A memory corruption vulnerability, reachable without user interaction and ideally without triggering any user notifications&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span&gt;A way to break &lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;ASLR remotely&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;A way to turn the vulnerability into remote code execution&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;Likely&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;) A way to break out of any sandbox, typically by exploiting a separate vulnerability in another operating system component (e.g. a userspace service or the kernel)&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;With iOS 14, Apple shipped a significant refactoring of iMessage processing, and made all four parts of the attack harder. This is mainly due to three central changes:&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c17&quot; id=&quot;h.xlynwox5rkc7&quot;&gt;&lt;span class=&quot;c14&quot;&gt;1. The BlastDoor Service&lt;/span&gt;&lt;/h2&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;One of the major changes in iOS 14 is the introduction of a new, tightly sandboxed &amp;ldquo;BlastDoor&amp;rdquo; service which is now responsible for almost all parsing of untrusted data in iMessages (for example, &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://bugs.chromium.org/p/project-zero/issues/detail?id=1858&quot;&gt;NSKeyedArchiver payloads&lt;/a&gt;&lt;/span&gt;&lt;span&gt;). Furthermore, this service is written in &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://developer.apple.com/swift/&quot;&gt;Swift&lt;/a&gt;&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;a (mostly) memory safe language which makes it significantly harder to introduce classic memory corruption vulnerabilities into the code base.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;The following diagram shows the rough new iMessage processing pipeline, with the name of the respective service process shown at the top of each box.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c25 c26&quot;&gt;&lt;a href=&quot;https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiWbfjpXKVDVZfZasnzWXN02AH5-A4Nw1229VrO2_FG1otEQSw_r0uRNkB8TedmfA-__gncfPoZ_aa5YE1Ac1_8kzmqKi2Iyj4l47OgN7o9K6Ue8JtRN42XdwHZyBJCg1U26pscYx2ObqwWrouGS9uoZizPZmxvpYwX3PDLanDgdDcOuicfmRwIbRMi/s623/image1%282%29.png&quot; style=&quot;display: block; padding: 1em 0;text-align: center;&quot;&gt;&lt;img src=&quot;https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiWbfjpXKVDVZfZasnzWXN02AH5-A4Nw1229VrO2_FG1otEQSw_r0uRNkB8TedmfA-__gncfPoZ_aa5YE1Ac1_8kzmqKi2Iyj4l47OgN7o9K6Ue8JtRN42XdwHZyBJCg1U26pscYx2ObqwWrouGS9uoZizPZmxvpYwX3PDLanDgdDcOuicfmRwIbRMi/s623/image1%282%29.png&quot; border=&quot;0&quot; alt=&quot;The iMessage processing pipeline in iOS 14 and macOS Big Sur. An iMessage arrives in apsd as a push notification from Apple&amp;rsquo;s servers. From there, it is first passed to identityservicesd, which decrypts its payload using the local iMessage private key, then to imagent. Imagent then delegates the majority of the parsing work to the BlastDoor service. Afterwards, if the iMessage contains any attachments, they are downloaded from iCloud servers by IMTransferAgent. If the iMessage contains plugin data (such as a URL with a preview image), the serialized plugin data is again processed by the BlastDoor service and a preview message is generated from it. Finally, IMDPersistenceAgent stores the iMessage into the messages database, triggers a user notification, and returns to imagent, which sends the delivery receipt to the iMessage servers and thus to the sender.&quot; style=&quot;max-height: 750; max-width: 600px;&quot; /&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;As can be seen, the majority of the processing of complex, untrusted data has been moved into the new BlastDoor service. Furthermore, this design with its 7+ involved services allows fine-grained sandboxing rules to be applied, for example, only the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;IMTransferAgent&lt;/span&gt;&lt;span&gt;&amp;nbsp;and &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;apsd&lt;/span&gt;&lt;span&gt;&amp;nbsp;processes are required to perform network operations. As such, all services in this pipeline are now properly sandboxed (with the BlastDoor service arguably being sandboxed the strongest).&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c17&quot; id=&quot;h.i6ctyzs304y5&quot;&gt;&lt;span class=&quot;c14&quot;&gt;2. Re-randomization of the Dyld Shared Cache Region&lt;/span&gt;&lt;/h2&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;Historically, ASLR on Apple&amp;rsquo;s platforms had one architectural weakness: the &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://iphonedevwiki.net/index.php/Dyld_shared_cache&quot;&gt;shared cache region&lt;/a&gt;&lt;/span&gt;&lt;span&gt;, containing most of the system libraries in a single prelinked blob, was only randomized per boot, and so would stay at the same address across all processes. This turned out to be especially critical in the context of 0-click attacks, as &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://googleprojectzero.blogspot.com/2020/01/remote-iphone-exploitation-part-2.html&quot;&gt;it allowed an attacker, able to remotely observe process crashes (e.g. through timing of automatic delivery receipts), to infer the base address of the shared cache&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;and as such break ASLR, a prerequisite for subsequent exploitation steps. &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;However, with iOS 14, Apple has added logic to &lt;/span&gt;&lt;span class=&quot;c25&quot;&gt;specifically&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;detect this kind of attack, in which case the shared cache is re-randomized for the targeted service the next time it is started, thus rendering this technique useless. This should make bypassing ASLR in a 0-click attack context significantly harder or even impossible (apart from brute force) depending on the concrete vulnerability.&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c17&quot; id=&quot;h.jbwmwscsj1ir&quot;&gt;&lt;span class=&quot;c14&quot;&gt;3. Exponential Throttling to Slow Down Brute Force Attacks&lt;/span&gt;&lt;/h2&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;To limit an attacker&amp;rsquo;s ability to retry exploits or brute force ASLR, the BlastDoor and imagent services are now subject to a newly introduced &lt;/span&gt;&lt;span&gt;exponential throttling mechanism enforced by &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;launchd&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;, causing the interval between restarts after a crash to double with every subsequent crash (up to an apparent maximum of 20 minutes). With this change, an exploit that relied on repeatedly crashing the attacked service would now likely require in the order of multiple hours to roughly half a day to complete instead of a few minutes.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;The remainder of this blog post will now look at each of these three changes in greater depths.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;h1 class=&quot;c13&quot; id=&quot;h.wft5qr5guboi&quot;&gt;&lt;span class=&quot;c5&quot;&gt;The BlastDoor Service&lt;/span&gt;&lt;/h1&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;The new BlastDoor service and its role in the processing of iMessages can be studied by following the flow of an incoming iMessage. On the wire, a simple text iMessage would look something like this, encoded as binary &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://en.wikipedia.org/wiki/Property_list&quot;&gt;plist&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c21 c6&quot;&gt;{&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c6 c24&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c22 c6 c27&quot;&gt;// Group UUID&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c21 c6&quot;&gt;&amp;nbsp; &amp;nbsp; gid = &amp;quot;008412B9-A4F7-4B96-96C3-70C4276CB2BE&amp;quot;;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c6 c24&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c27 c22 c6&quot;&gt;// Group protocol version&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c21 c6&quot;&gt;&amp;nbsp; &amp;nbsp; gv = 8;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c6 c24&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c27 c22 c6&quot;&gt;// Chat participants&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c21 c6&quot;&gt;&amp;nbsp; &amp;nbsp; p = &amp;nbsp; &amp;nbsp; (&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c21 c6&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;mailto:sender@foo.bar&amp;quot;,&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c21 c6&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;mailto:receiver@foo.bar&amp;quot;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c21 c6&quot;&gt;&amp;nbsp; &amp;nbsp; );&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c6 c24&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c27 c22 c6&quot;&gt;// Participants version&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c21 c6&quot;&gt;&amp;nbsp; &amp;nbsp; pv = 0;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c6 c24&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c22 c6&quot;&gt;// Message being replied to, usually the last message in the chat&lt;/span&gt;&lt;span class=&quot;c21 c6&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c21 c6&quot;&gt;&amp;nbsp; &amp;nbsp; r = &amp;quot;6401430E-CDD3-4BC7-A377-7611706B431F&amp;quot;;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c6 c24&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c27 c22 c6&quot;&gt;// The plain text content&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c21 c6&quot;&gt;&amp;nbsp; &amp;nbsp; t = &amp;quot;Hello World!&amp;quot;;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c6 c24&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c27 c22 c6&quot;&gt;// Probably some other version number&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c6 c21&quot;&gt;&amp;nbsp; &amp;nbsp; v = 1;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c6 c24&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6 c22&quot;&gt;// The rich text content &lt;/span&gt;&lt;span class=&quot;c21 c6&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c21 c6&quot;&gt;&amp;nbsp; &amp;nbsp; x = &amp;quot;&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;Hello World!&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&amp;quot;; &amp;nbsp;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c9&quot;&gt;&lt;span class=&quot;c6 c24&quot;&gt;}&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;As such, the minimal steps required to parse it are:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;c15 lst-kix_hisa166i97g-0 start&quot; start=&quot;1&quot;&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;If necessary, decompress the binary data&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Decode the plist from its binary serialization format&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Extract its various fields and ensure they have the correct type&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span&gt;Decode the `&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;` key if present, using an XML decoder&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;Previously, all of this work happened in imagent. With iOS 14, however, it all moved into the new BlastDoor service. While the main processing flow still starts in &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;imagent&lt;/span&gt;&lt;span&gt;, which receives the raw but unencrypted payload bytes from &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;identityservicesd&lt;/span&gt;&lt;span&gt;&amp;nbsp;(part of the IDS framework) in &lt;/span&gt;&lt;span class=&quot;c10 c6&quot;&gt;-[IMDiMessageIDSDelegate service:account:incomingTopLevelMessage:fromID:messageContext:]&lt;/span&gt;&lt;span&gt;, messages &lt;/span&gt;&lt;span&gt;are then more or less immediately forwarded to the BlastDoor service through &lt;/span&gt;&lt;span class=&quot;c10 c6&quot;&gt;+[IMBlastdoor sendDictionary:withCompletionBlock:]&lt;/span&gt;&lt;span class=&quot;c20&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;which creates the reply handler block and then calls &lt;/span&gt;&lt;span class=&quot;c10 c6&quot;&gt;-[IMMessagesBlastDoorInterface diffuseTopLevelDictionary:resultHandler:]&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;. At that point processing ends up in Swift code that deserializes the binary payload and sends it to the BlastDoor service over XPC.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Inside BlastDoor, the work mostly happens in BlastDoor.framework and MessagesBlastDoorService. As most of it is written in Swift, it is fairly unpleasant to statically reverse engineer it (no symbols, many virtual calls, swift runtime code sprinkled all over the place), but fortunately, that is also not really necessary for the purpose of this blog post. However, it is worth noting that while the high level control flow logic is written in Swift, some of the parsing steps still involve the existing ObjectiveC or C implementations. For example, XML is being parsed by libxml, and the NSKeyedArchiver payloads by the ObjectiveC implementation of NSKeyedUnarchiver.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;The responses from BlastDoor can be seen by breaking on the reply handler function in imagent (the function can be found in &lt;/span&gt;&lt;span class=&quot;c6 c23&quot;&gt;+[IMBlastdoor sendDictionary:withCompletionBlock:]&lt;/span&gt;&lt;span&gt;&amp;nbsp;or &lt;/span&gt;&lt;span&gt;by searching for XREFs to the string &amp;ldquo;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;Blastdoor response %p received (command: %hhu, guid: %@)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;rdquo; in IMDaemonCore.framework). A typical BlastDoor response for a simple text message is shown below:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;(lldb) po $x2&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;TextMessage(&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; metadata: BlastDoor.Metadata(&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; messageGUID: D391CC96-9CC6-44C6-B827-1DEB0F252529,&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; timestamp: Optional(1610108299117662350),&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; wantsDeliveryReceipt: true,&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; wantsCheckpointing: false,&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; storageContext: BlastDoor.Metadata.StorageContext(&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; isFromStorage: false, isLastFromStorage: false&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; )&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; ),&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; messageSubType: MessageType.textMessage(BlastDoor.Message(&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; plainTextBody: Optional(&amp;quot;Hello World&amp;quot;),&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; plainTextSubject: nil,&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; content: Optional(BlastDoor.AttributedString(&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; attributes: [&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; BlastDoor.BaseWritingDirectionAttribute(&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; range: Range(0..&amp;lt;11), direction: WritingDirection.natural&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ), &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; BlastDoor.MessagePartAttribute(&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; range: Range(0..&amp;lt;11), partNumber: 0&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; )&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ], &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; string: &amp;quot;Hello World&amp;quot;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; )),&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; _participantDestinationIdentifiers: [&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;mailto:sender@foo.bar&amp;quot;,&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;mailto:receiver@foo.bar&amp;quot;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ], &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; attributionInfo: []&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; )),&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; encryptionType: BlastDoor.TextMessage.EncryptionType.pair_ec, &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; replyToGUID: Optional(6401430E-CDD3-4BC7-A377-7611706B431F), &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; _threadIdentifierGUID: nil, &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; _expressiveSendStyleIdentifier: nil, &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; _groupID: Optional(&amp;quot;008412B9-A4F7-4B96-96C3-70C4276CB2BE&amp;quot;), &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; currentGroupName: nil, &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; groupParticipantVersion: Optional(0),&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; groupProtocolVersion: Optional(8),&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; groupPhotoCreationTime: nil, &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; messageSummaryInfo: nil, &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; nicknameInformation: nil, &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; truncatedNicknameRecordKey: nil&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;One can roughly associate every field in this data structure with parts of the on-wire iMessage format. For example, the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;plainTextBody&lt;/span&gt;&lt;span&gt;&amp;nbsp;field contains the content of the `t` field, while the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;field corresponds to the content of the `x` field.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;Besides simple text messages, iMessages can additionally contain attachments (essentially arbitrary files which are encrypted and temporarily uploaded to iCloud) as well as rather complex serialized &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://developer.apple.com/documentation/foundation/nskeyedarchiver&quot;&gt;NSKeyedArchiver&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;archives, which &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://googleprojectzero.blogspot.com/2019/08/the-fully-remote-attack-surface-of.html&quot;&gt;have been the source of bugs in the past&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;For these types of iMessages, the following additional parsing steps are necessary:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;c15 lst-kix_ezf2mrk385uq-0 start&quot; start=&quot;1&quot;&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Unpack attachment metadata (NSKeyedArchiver format)&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Download attachments from iCloud server&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Deserialize NSKeyedArchiver plugin archives and generate a preview for the notification&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;As an example, consider what happens when a user sends a link to a website over iMessage. In that case, the sending device will first render a preview of the webpage and collect some metadata about it (such as the title and page description), then pack those fields into an NSKeyedArchiver archive. This archive is then encrypted with a temporary key and uploaded to the iCloud servers. Finally, the link as well as the decryption key are sent to the receiver as part of the iMessage. In order to create a useful user notification about the incoming iMessage, this data has to be processed by the receiver on a 0-click code path. As that again involves a fair amount of complexity, it is also done inside BlastDoor: after receiving the BlastDoor reply from above and realizing that the message contains an attachment, &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;imagent&lt;/span&gt;&lt;span&gt;&amp;nbsp;first instructs &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;IMTransferAgent&lt;/span&gt;&lt;span&gt;&amp;nbsp;to download and decrypt the iCloud attachment. Afterwards, it will call into &lt;/span&gt;&lt;span class=&quot;c10 c6&quot;&gt;-[IMTranscodeController decodeiMessageAppPayload:bundleID:completionBlock:blockUntilReply:]&lt;/span&gt;&lt;span&gt;&amp;nbsp;w&lt;/span&gt;&lt;span&gt;hich forwards the relevant data to the&lt;/span&gt;&lt;span&gt;&amp;nbsp;IMTranscoderAgent, which then proceeds into &lt;/span&gt;&lt;span class=&quot;c10 c6&quot;&gt;+[IMAttachmentBlastdoor sendBalloonPluginPayloadData:withBundleIdentifier:completionBlock:]&lt;/span&gt;&lt;span class=&quot;c6 c20&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;a&lt;/span&gt;&lt;span&gt;nd finally calls &lt;/span&gt;&lt;span class=&quot;c10 c6&quot;&gt;-[IMMessagesBlastDoorInterface defuseBalloonPluginPayload:withIdentifier:resultHandler:]&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;In the &lt;/span&gt;&lt;span&gt;BlastDoor service, the plugin data decoding is then again performed in Swift, and dispatched to the corresponding plugin type, as determined by the plugin id. For RichLinks (plugin id com.apple.messages.URLBalloonProvider), processing ends up in &lt;/span&gt;&lt;span class=&quot;c6 c10&quot;&gt;LinkPresentation.MessagesPayload.init(dataRepresentation:)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;, which deserializes the NSKeyedArchiver payload and to extract the preview image and URL metadata from it in order to generate a preview message.&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c17&quot; id=&quot;h.v7m4aqoict2j&quot;&gt;&lt;span class=&quot;c14&quot;&gt;Sandboxing&lt;/span&gt;&lt;/h2&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;The sandbox profile can be found in &lt;/span&gt;&lt;span&gt;System/Library/Sandbox/Profiles/blastdoor.sb&lt;/span&gt;&lt;span&gt;&amp;nbsp;and is also attached at the end of this blog post. It appears to be identical on iOS and macOS. The profile can be studied statically, and for that purpose is attached at the bottom of this blogpost, or dynamically, for example by using the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;sandbox-exec&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;tool:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;gt; echo &amp;quot;(allow process-exec (literal \&amp;quot;$(pwd)/test\&amp;quot;))&amp;quot; &amp;gt;&amp;gt; ./blastdoor.sb&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;gt; clang -o test test.c &amp;nbsp; # try to open files, network connections, etc.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;gt; sandbox-exec -f ./blastdoor.sb ./test&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;The sandbox profile states: &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;;;; This profile contains the rules necessary to make BlastDoor as close to&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;;;; compute-only as possible, while still remaining functional.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;And indeed, the sandbox profile is quite tight:&lt;/span&gt;&lt;/p&gt;&lt;ul style=&quot;padding: 0;&quot; class=&quot;c15 lst-kix_xkot2rd1rwjd-0 start&quot;&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span&gt;only a handful of local IPC services, namely &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;diagnosticd&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;logd&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;opendirectoryd&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;syslogd&lt;/span&gt;&lt;span&gt;, and &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;notifyd&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;, can be reached&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;almost all file system interaction is blocked&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;any interaction with IOKit drivers (historically a big source of vulnerabilities) is forbidden&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span&gt;outbound &lt;/span&gt;&lt;span&gt;network access is denied&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Furthermore, the profile makes use of syscall filtering to restrict the interactions with the core kernel. However, as of now the syscall filter seems to be in &amp;ldquo;permissive&amp;rdquo; mode: &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;;; To be uncommented once the system call whitelist is complete...&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;;; (deny syscall-unix (with send-signal SIGKILL))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;As such, the BlastDoor service is still allowed to perform any syscall, but it is to be expected that the syscall filtering will soon be put into &amp;ldquo;enforcement mode&amp;rdquo;, which would further boost its effectiveness.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;c17&quot; id=&quot;h.rdbm0q1mrv2k&quot;&gt;&lt;span class=&quot;c14&quot;&gt;Crash Monitoring?&lt;/span&gt;&lt;/h2&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;An interesting side effect of the new processing pipeline is that &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;imagent&lt;/span&gt;&lt;span&gt;&amp;nbsp;is now able to detect when an incoming message caused a crash in BlastDoor (it will receive an XPC error). Even more interesting is the fact that &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;imagent&lt;/span&gt;&lt;span&gt;&amp;nbsp;appears to be informing Apple&amp;rsquo;s servers about such events, as can be seen by setting a breakpoint on &lt;/span&gt;&lt;span class=&quot;c6 c23&quot;&gt;-[APSConnectionServer handleSendOutgoingMessage:]&lt;/span&gt;&lt;span&gt;&amp;nbsp;in &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;apsd&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;, the daemon responsible for implementing Apple&amp;rsquo;s push services (on top of which iMessage is built). Displaying the outgoing message will show the following:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;(lldb) po [$x2 dictionaryRepresentation]&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;{&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; APSCritical = 1;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; APSMessageID = 543;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; APSMessageIdentifier = 1520040396;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; APSMessageTopic = &amp;quot;com.apple.madrid&amp;quot;;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; APSMessageUserInfo = &amp;nbsp; &amp;nbsp; {&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; c = 115;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; fR = 13500;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c6&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c19 c29&quot;&gt;fRM = &amp;quot;c-100-BlastDoor.Explosion-1-com.apple.BlastDoor.XPC-ServiceCrashed&amp;quot;;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; fU = {length = 16, bytes = 0x3a4912626c9645f98cb26c7c2d439520};&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; i = 1520040396;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; nr = 1;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; t = {length = 32, bytes = ... };&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c6&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ua = &amp;quot;[macOS,11.1,20C69,Macmini9,1]&amp;quot;;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; v = 7;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; };&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; APSOutgoingMessageSenderTokenName = 501;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; APSPayloadFormat = 1;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; APSTimeout = 120;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; APSTimestamp = &amp;quot;2021-01-06 19:52:10 +0000&amp;quot;;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c6&quot;&gt;}&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;As can be seen, &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;imagent&lt;/span&gt;&lt;span&gt;&amp;nbsp;is apparently informing the iMessage servers that the message with the UUID 0x3a4912626c9645f98cb26c7c2d439520 (&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;fU&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;key) has caused a crash in BlastDoor.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;It is unclear what the purpose of this is without access to the server&amp;rsquo;s code. While these notifications may simply be used for statistical purposes, they would also give Apple a fairly clear signal about attacks against iMessage involving brute-force and a somewhat weaker signal about any failed exploits against the BlastDoor service.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;In my experiments, after observing one of these crash notifications, the server would start directly sending delivery receipts to the sender for messages that hadn&amp;#39;t actually been processed by the receiver yet. Possibly this is another, independent effort to break the crash oracle technique by confusing the sender, but that is hard to verify without access to the code running on the server. In any case, it is worth noting that this &amp;ldquo;spoofing&amp;rdquo; of delivery receipts by the server is generally possible as the message UUID, which is more or less the only content of a delivery receipt, is part of the non-end2end encrypted payload and is thus known to the server (break on &lt;/span&gt;&lt;span class=&quot;c6 c23&quot;&gt;-[APSConnectionServer handleSendOutgoingMessage:]&lt;/span&gt;&lt;span&gt;&amp;nbsp;and inspect outgoing iMessages to verify this, the UUID will be in the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;U&lt;/span&gt;&lt;span&gt;&amp;nbsp;key, while the e2e-encrypted data will be in the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;P&lt;/span&gt;&lt;span&gt;&amp;nbsp;key)&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;. This is most likely necessary so the server can track which messages have already been delivered and which ones it still needs to keep around for delivery in the future.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;h1 class=&quot;c13&quot; id=&quot;h.tev8uvvac7bs&quot;&gt;&lt;span class=&quot;c5&quot;&gt;Shared Cache Resliding&lt;/span&gt;&lt;/h1&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;Previously, when exploiting an iMessage memory corruption bug, a &amp;ldquo;crash oracle&amp;rdquo; could be used to reveal the location of the shared cache region in memory: the attacker would trigger the memory corruption bug in a way that would cause an access to a memory location somewhere in the region 0x180000000 - 0x280000000 (where the shared cache can be mapped). If the memory was valid, no crash would occur and &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;imagent&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;would then send a delivery receipt to the attacker. However, If a crash occurred, no such receipt would be delivered, informing the attacker that the address was unmapped. Through clever selection of the queried addresses, the location of the shared cache could be revealed in logarithmic time, with only about 20 messages.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;However, with iOS 14 Apple has added a mechanism to re-randomize the location of the shared cache region for an &amp;ldquo;attacked&amp;rdquo; process, thus breaking a fundamental assumption of this technique and rendering it ineffective. This is significant as the crash oracle technique was one of very few, if not the only, fairly generic ASLR bypass techniques usable in 0-click iMessage attacks.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;To understand how the shared cache resliding works, one can start by looking at the kernel. In iOS 14, the kernel can now have &lt;/span&gt;&lt;span class=&quot;c25&quot;&gt;two&lt;/span&gt;&lt;span&gt;&amp;nbsp;active shared cache regions: the &amp;ldquo;regular&amp;rdquo; region and &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/apple/darwin-xnu/blob/d4061fb0260b3ed486147341b72468f836ed6c8f/osfmk/vm/vm_shared_region.h#L224&quot;&gt;a &amp;ldquo;reslided&amp;rdquo; region&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;. During an attack, the following then happens:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;c15 lst-kix_hmo7gyj5poo-0 start&quot; start=&quot;1&quot;&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;When an attacker attempts to use a crash-oracle-based technique, the attacked process would quickly end up accessing unmapped memory in the range 0x180000000 - 0x280000000 (where the shared cache is mapped) and crashes&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span&gt;The kernel handles the segmentation fault generated by the CPU, and &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/apple/darwin-xnu/blob/d4061fb0260b3ed486147341b72468f836ed6c8f/bsd/kern/kern_sig.c#L2009&quot;&gt;sets a specific flag in the crash info&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;that signals that the crash happened inside the shared cache region&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span&gt;At the same time, the kernel will &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/apple/darwin-xnu/blob/d4061fb0260b3ed486147341b72468f836ed6c8f/bsd/kern/kern_sig.c#L2040&quot;&gt;mark the currently active reslided shared cache region (if one exists) as stale&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;, causing it to be recreated and thus re-randomized the next time it is used&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c6&quot;&gt;launchd&lt;/span&gt;&lt;span&gt;&amp;nbsp;(as the parent process of the crashed service) receives the crash info, notices the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;OS_REASON_FLAG_SHAREDREGION_FAULT&lt;/span&gt;&lt;span&gt;&amp;nbsp;flag, and sets the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;ReslideSharedCache&lt;/span&gt;&lt;span&gt;&amp;nbsp;property on the service associated with the crashed process (see `&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;launchctl procinfo $pid&lt;/span&gt;&lt;span&gt;` and search for `&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;reslide shared cache = 1&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;`)&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span&gt;The next time the service is restarted, &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;launchd&lt;/span&gt;&lt;span&gt;&amp;nbsp;then adds the &lt;/span&gt;&lt;span class=&quot;c7 c6&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/apple/darwin-xnu/blob/d4061fb0260b3ed486147341b72468f836ed6c8f/bsd/sys/spawn.h#L78&quot;&gt;POSIX_SPAWN_RESLIDE&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;attribute for &lt;/span&gt;&lt;span class=&quot;c7 c6&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man2/posix_spawn.2.html&quot;&gt;posix_spawn&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;due to the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;ReslideSharedCache&lt;/span&gt;&lt;span&gt;&amp;nbsp;property&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span&gt;In the kernel, this flag now causes the newly created process to be given the &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/apple/darwin-xnu/blob/d4061fb0260b3ed486147341b72468f836ed6c8f/osfmk/vm/vm_shared_region.h#L224&quot;&gt;reslided shared cache image&lt;/a&gt;&lt;/span&gt;&lt;span&gt;. However, as no active reslided region currently exists (the previous one was marked as stale in step 3.), a new one is created at a newly randomized address.&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;The result of this is that whenever an attacker attempts to use a crash-oracle to break ASLR, the attacked service would receive a different shared cache region every time it is launched, thus preventing the attack from succeeding. For the time being, this feature appears to &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/apple/darwin-xnu/blob/d4061fb0260b3ed486147341b72468f836ed6c8f/bsd/kern/kern_exec.c#L205&quot;&gt;only be active on iOS&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;though&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;, but it would be expected to come to macOS as well.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;While this mechanism would in principle also protect 3rd party apps from similar attacks, protection for those is currently somewhat weaker, likely in order to first evaluate the real-world performance impact of this change (the shared cache is a significant performance optimization of the OS). In particular, step 3 is currently only performed if the crashing process is a &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://developer.apple.com/documentation/endpointsecurity/es_process_t/3228979-is_platform_binary&quot;&gt;platform binary&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;(essentially binaries that ship with the OS and are directly signed by Apple) such as the services handling iMessages. However, for 3rd party processes, it would only happen if the global &lt;/span&gt;&lt;span class=&quot;c7 c6&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/apple/darwin-xnu/blob/d4061fb0260b3ed486147341b72468f836ed6c8f/bsd/kern/kern_exec.c#L217&quot;&gt;vm_shared_region_reslide_restrict&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;is set to zero:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;/*&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp;* Flag to control what processes should get shared cache randomize resliding&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp;* after a fault in the shared cache region:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp;*&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp;* 0 - all processes get a new randomized slide&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp;* 1 - only platform processes get a new randomized slide&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c6&quot;&gt;&amp;nbsp;*/&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;Which is &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/apple/darwin-xnu/blob/d4061fb0260b3ed486147341b72468f836ed6c8f/bsd/kern/kern_exec.c#L6397&quot;&gt;controlled by the &lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c7 c6&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/apple/darwin-xnu/blob/d4061fb0260b3ed486147341b72468f836ed6c8f/bsd/kern/kern_exec.c#L6397&quot;&gt;vm_shared_region_reslide_restrict&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/apple/darwin-xnu/blob/d4061fb0260b3ed486147341b72468f836ed6c8f/bsd/kern/kern_exec.c#L6397&quot;&gt;&amp;nbsp;bootarg&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;. This currently seems to be set to one. In essence, for 3rd party apps this means:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;c15 lst-kix_aue93cd1tacp-0 start&quot; start=&quot;1&quot;&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span&gt;When the attacked process first crashes, the kernel will still set the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;OS_REASON_FLAG_SHAREDREGION_FAULT&lt;/span&gt;&lt;span&gt;&amp;nbsp;flag, and &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;launchd&lt;/span&gt;&lt;span&gt;&amp;nbsp;will add the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;ReslideSharedCache&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;property, but the current reslided region won&amp;rsquo;t be invalidated&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;The restarted service is then restarted and now uses the &amp;ldquo;reslided&amp;rdquo; shared cache region&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;When the service crashes the next time, and if that service is the only one currently using the reslided shared cache region (which should usually be the case, but could possibly be influenced by the attacker), the region&amp;rsquo;s refcount drops to zero, and the shared cache region is marked for removal.&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span&gt;However, removal will only actually happen &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/apple/darwin-xnu/blob/d4061fb0260b3ed486147341b72468f836ed6c8f/osfmk/vm/vm_shared_region.c#L144&quot;&gt;after two minutes&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;. As such, if the service is restarted within two minutes, it will receive the same shared cache region at the same location in memory.&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;As a result, a third-party app could still be attacked through a crash-oracle technique if it automatically sends some form of delivery receipt to the sender and restarts quickly enough after a crash. This could, however, be prevented for example by enabling &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;ExponentialThrottling&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;for these services. Ideally, and assuming that the performance penalty is reasonable, Apple would enable re-randomization for all apps in the future.&lt;/span&gt;&lt;/p&gt;&lt;h1 class=&quot;c13&quot; id=&quot;h.g73ammr1eqa3&quot;&gt;&lt;span class=&quot;c5&quot;&gt;Exponential Throttling&lt;/span&gt;&lt;/h1&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;Another thing we suggested back in 2019 was to limit the number of attempts an attacker gets when attempting to exploit a vulnerability. This was mostly important to defend against the crash-oracle technique, but would also help to prevent brute force attacks (e.g., given enough attempts, one could simply brute force the location of the shared cache region).&lt;/span&gt;&lt;span class=&quot;c18&quot;&gt;&amp;nbsp;The new ExponentialThrottling feature in &lt;/span&gt;&lt;span class=&quot;c6 c18&quot;&gt;launchd&lt;/span&gt;&lt;span class=&quot;c2 c18&quot;&gt;&amp;nbsp;seems to achieve just that.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2 c18&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c18&quot;&gt;To use it, a system daemon or agent has to opt-in by setting&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;&amp;quot;_ExponentialThrottling = 1&amp;rdquo; in its Info.plist (essentially the service metadata), as can be seen below for the BlastDoor service:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;gt; plutil -p /System/Library/PrivateFrameworks/MessagesBlastDoorSupport.framework/Versions/A/XPCServices/MessagesBlastDoorService.xpc/Contents/Info.plist&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;{&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;quot;CFBundleDisplayName&amp;quot; =&amp;gt; &amp;quot;MessagesBlastDoorService&amp;quot;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;quot;CFBundleExecutable&amp;quot; =&amp;gt; &amp;quot;MessagesBlastDoorService&amp;quot;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;quot;CFBundleIdentifier&amp;quot; =&amp;gt; &amp;quot;com.apple.MessagesBlastDoorService&amp;quot;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; ...&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;quot;XPCService&amp;quot; =&amp;gt; {&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c19 c29&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;quot;_ExponentialThrottling&amp;quot; =&amp;gt; 1&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; }&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;}&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Apart from the BlastDoor service, it is also used for imagent:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;gt; plutil -p /System/Library/LaunchAgents/com.apple.imagent.plist&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;{&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;quot;_ExponentialThrottling&amp;quot; =&amp;gt; 1&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; ...&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;but doesn&amp;rsquo;t appear to be used for any other service, as can, for example, be seen by looking at the output of the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;launchctl dumpstate&lt;/span&gt;&lt;span&gt;&amp;nbsp;command, which will only show &amp;ldquo;&lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;exponential throttling = 1&amp;rdquo;&lt;/span&gt;&lt;span&gt;&amp;nbsp;for &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;com.apple.imagent&lt;/span&gt;&lt;span&gt;&amp;nbsp;and &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;com.apple.MessagesBlastDoorService.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;Presumably, the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;_ExponentialThrottling&lt;/span&gt;&lt;span&gt;&amp;nbsp;property instructs launchd (the macOS and iOS init process), to delay subsequent restarts of a crashing service. While it is somewhat challenging to statically reverse engineer launchd due to the lack of source code or binary symbols, it is fortunately fairly easy to experimentally determine the impact of the &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;_ExponentialThrottling&lt;/span&gt;&lt;span&gt;&amp;nbsp;property, for example by installing a custom daemon that writes the current timestamp to a file before crashing. By default, so &lt;/span&gt;&lt;span class=&quot;c25&quot;&gt;without&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;ExponentialThrottling, one would see the following:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 13:56:03 2021&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 13:56:13 2021&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 13:56:23 2021&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 13:56:33 2021&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;As can be seen, by default, a service is, at the earliest, restarted ten seconds after it was previously started. However, using the following service plist which enables ExponentialThrottling:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;gt; # Start service with&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;gt; # launchctl bootstrap system /Library/LaunchDaemons/net.saelo.test.plist&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;gt; plutil -p /Library/LaunchDaemons/net.saelo.test.plist&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;{&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;quot;_ExponentialThrottling&amp;quot; =&amp;gt; 1&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;quot;KeepAlive&amp;quot; =&amp;gt; 1&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;quot;Label&amp;quot; =&amp;gt; &amp;quot;net.saelo.test&amp;quot;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;quot;POSIXSpawnType&amp;quot; =&amp;gt; &amp;quot;Interactive&amp;quot;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;quot;Program&amp;quot; =&amp;gt; &amp;quot;/path/to/program&amp;quot;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c6&quot;&gt;}&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;One can observe the following:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 10:42:43 2021&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 10:42:53 2021 (+10s)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 10:43:03 2021 (+10s)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 10:43:13 2021 (+10s)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 10:43:33 2021 (+20s)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 10:44:13 2021 (+40s)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 10:45:33 2021 (+80s)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 10:48:13 2021 (+160s [~2.5m])&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 10:53:33 2021 (+320s [~5m])&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 11:04:13 2021 (+640s [~10m])&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 11:24:13 2021 (+20m)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 11:44:13 2021 (+20m)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;Service started on Wed Jan &amp;nbsp;6 12:04:13 2021 (+20m)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;Here, the exponential increase in the time between subsequent restarts is clearly visible, and goes up to an apparent maximum of 20 minutes. And indeed, &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;launchd&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;does contain the following bit of code in a function presumably responsible for computing the next restart delay (search for XREFs to the string &amp;quot;%s: service throttled by %llu seconds&amp;quot;):&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; if ( delay &amp;gt;= 1200 )&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; result = 1200LL; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// 20 minutes&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; else&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; result = delay;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;With this change, an exploit that relied on brute force would now only get one attempt every 20 minutes instead of every 10 seconds.&lt;/span&gt;&lt;/p&gt;&lt;h1 class=&quot;c13&quot; id=&quot;h.mfarwae35i5h&quot;&gt;&lt;span class=&quot;c5&quot;&gt;(Upcoming?) ObjectiveC ISA PAC&lt;/span&gt;&lt;/h1&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;The PoC exploit against iMessage on iOS 12.4 relied heavily on faking ObjectiveC objects to gain a form of arbitrary code execution despite the presence of &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://support.apple.com/guide/security/pointer-authentication-codes-seca5759bf02/web&quot;&gt;pointer authentication (PAC)&lt;/a&gt;&lt;/span&gt;&lt;span&gt;. This was mainly possible because the ISA field, containing the pointer to the Class object and thus making a piece of memory appear like a valid ObjectiveC object, was not protected through PAC and could thus be faked. With iOS 14, this now seems to be changing: while previously, the &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/opensource-apple/objc4/blob/cd5e62a5597ea7a31dccef089317abb3a661c154/runtime/objc-private.h#L93&quot;&gt;top 19 bits of the ISA value contained the inline refcount&lt;/a&gt;&lt;/span&gt;&lt;span&gt;, it now appears that this field has been reduced to 9 bits (of which the LSB appears to be reserved for some purpose, leaving an &lt;/span&gt;&lt;span&gt;8-bit inline refcount&lt;/span&gt;&lt;span&gt;, see the bit shifting logic in &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;objc_release&lt;/span&gt;&lt;span&gt;&amp;nbsp;or &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;objc_retain&lt;/span&gt;&lt;span&gt;), while the freed-up bits now hold a PAC, as can be seen in &lt;/span&gt;&lt;span class=&quot;c6&quot;&gt;objc_rootAllocWithZone&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;nbsp;in libobjc.dylib:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c6 c12 c19&quot;&gt;&amp;nbsp; &amp;nbsp; ; Allocate the object&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; BL &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;j__calloc_3&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; CBZ &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; X0, loc_1953DA434&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; MOV &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; X8, X0&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c19 c6 c12&quot;&gt;&amp;nbsp; &amp;nbsp; ; &amp;ldquo;Tag&amp;rdquo; the address with a constant to get a PAC modifier value&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; MOVK &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;X8, #0x6AE1,LSL#48 &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; MOV &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; X9, X19&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c19 c6 c12&quot;&gt;&amp;nbsp; &amp;nbsp; ; Compute PAC of Class pointer with tagged object address as modifier&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; PACDA &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; X9, X8 &lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c6&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c6 c12&quot;&gt;; Clear top 9 bits (inline refcnt) and bottom 3 bits (other bitfields)&lt;/span&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; AND &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; X8, X9, #0x7FFFFFFFFFFFF8&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c6&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c19 c6 c12&quot;&gt;; Set LSB and inline refcount to one&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; MOV &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; X9, #0x100000000000001&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; ORR &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; X9, X8, X9&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c6 c12&quot;&gt;&amp;nbsp; &amp;nbsp; ; Presumably, the refcnt isn&amp;rsquo;t used for all types of classes...&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; TST &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; W20, #0x2000&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c6 c12&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c0&quot;&gt;CSEL &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;X8, X9, X8, EQ&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c6&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span class=&quot;c19 c6 c12&quot;&gt;; Store the resulting value into the ISA field&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&amp;nbsp; &amp;nbsp; STR &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; X8, [X0]&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;However, currently the ISA PAC appears to never be checked, as such, it doesn&amp;rsquo;t yet affect any exploits. The most likely reason for this is that the ISA PAC feature is being rolled out in multiple phases, with the current implementation meant to allow in-depth performance evaluation, in particular of the reduced size of the inline refcount, which will likely cause more objects to use the more expensive out-of-line refcounting (used &lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;a class=&quot;c161&quot; href=&quot;https://github.com/opensource-apple/objc4/blob/cd5e62a5597ea7a31dccef089317abb3a661c154/runtime/objc-object.h#L392&quot;&gt;once the inline refcount saturates&lt;/a&gt;&lt;/span&gt;&lt;span&gt;). With that, it can be expected that, in the absence of major performance issues, future releases of iOS and macOS will use PAC for the ObjC ISA field, thus likely breaking exploits that have to rely on faking ObjectiveC objects to achieve arbitrary code execution.&lt;/span&gt;&lt;/p&gt;&lt;h1 class=&quot;c13&quot; id=&quot;h.hdmcsd8tb0pt&quot;&gt;&lt;span class=&quot;c5&quot;&gt;Conclusion&lt;/span&gt;&lt;/h1&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;This blog post discussed three improvements in iOS 14 affecting iMessage security: the BlastDoor service, resliding of the shared cache, and exponential throttling. Overall, these changes are probably very close to the best that could&amp;rsquo;ve been done given the need for backwards compatibility, and they should have a significant impact on the security of iMessage and the platform as a whole. It&amp;rsquo;s great to see Apple putting aside the resources for these kinds of large refactorings to improve end users&amp;rsquo; security. Furthermore, these changes also highlight the value of offensive security work: not just single bugs were fixed, but instead structural improvements were made based on insights gained from exploit development work.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;As for the alleged NSO iMessage exploit, it may have been prevented from working against iOS 14 by any of the following&lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;:&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;ul style=&quot;padding: 0;&quot; class=&quot;c15 lst-kix_ju6nxsiwjdzc-0 start&quot;&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;The bug was fixed in iOS 14, for example due to the rewrite of large parts of the iMessage processing pipeline in Swift&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul style=&quot;padding: 0;&quot; class=&quot;c15 lst-kix_u10h5r66zlog-0 start&quot;&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;The mere fact that processing happens in a different process, which could for example break a heap layouting primitive&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;The shared cache resliding would break their exploit if their exploit relied on some form of crash oracle to break ASLR&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;margin-left: 46pt;&quot; class=&quot;c1 c11 li-bullet-0&quot;&gt;&lt;span class=&quot;c2&quot;&gt;The stronger sandbox of the BlastDoor service, which could prevent the exploitation of a privilege escalation vulnerability after compromising the BlastDoor process&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span&gt;While these are some possible scenarios, and &lt;/span&gt;&lt;span class=&quot;c2&quot;&gt;it could be the case that the exploit &amp;ldquo;just&amp;rdquo; needs some re-engineering to function again, the fact that these security improvements were shipped is certainly a positive outcome.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;h1 class=&quot;c13&quot; id=&quot;h.4kqlsylg7dt0&quot;&gt;&lt;span&gt;Attachment 1: blastdoor.sb&lt;/span&gt;&lt;/h1&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;;; This profile contains the rules necessary to make BlastDoor as close to&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;;; compute-only as possible, while still remaining functional.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;;;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;;; For all platforms: /System/Library/PrivateFrameworks/MessagesBlastDoorSupport.framework/XPCServices/MessagesBlastDoorService.xpc/MessagesBlastDoorService&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(version 1)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;;; -------------------------------------------------------------------------------------------- ;;;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;;; Basic Rules&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;;; -------------------------------------------------------------------------------------------- ;;;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Deny all default rules.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(deny default)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(deny file-map-executable process-info* nvram*)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(deny dynamic-code-generation)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Rules copied from system.sb. Ones that we&amp;#39;ve deemed overly permissive&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; or unnecessary for BlastDoor have been removed.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Allow read access to standard system paths.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow file-read*&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(require-all (file-mode #o0004)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; (require-any (subpath &amp;quot;/System&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(subpath &amp;quot;/usr/lib&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(subpath &amp;quot;/usr/share&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(subpath &amp;quot;/private/var/db/dyld&amp;quot;))))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow file-map-executable&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(subpath &amp;quot;/System/Library/CoreServices/RawCamera.bundle&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(subpath &amp;quot;/usr/lib&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(subpath &amp;quot;/System/Library/Frameworks&amp;quot;))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow file-test-existence (subpath &amp;quot;/System&amp;quot;))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow file-read-metadata&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(literal &amp;quot;/etc&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(literal &amp;quot;/tmp&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(literal &amp;quot;/var&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(literal &amp;quot;/private/etc/localtime&amp;quot;))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Allow access to standard special files.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow file-read*&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(literal &amp;quot;/dev/random&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(literal &amp;quot;/dev/urandom&amp;quot;))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow file-read* file-write-data&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(literal &amp;quot;/dev/null&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(literal &amp;quot;/dev/zero&amp;quot;))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow file-read* file-write-data file-ioctl&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(literal &amp;quot;/dev/dtracehelper&amp;quot;))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; TODO: Don&amp;#39;t allow core dumps to be written out unless this is on a dev&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; fused device?&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow file-write*&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(require-all (regex #&amp;quot;^/cores/&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; (require-not (file-mode 0))))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Allow IPC to standard system agents.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow mach-lookup&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(global-name &amp;quot;com.apple.diagnosticd&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(global-name &amp;quot;com.apple.logd&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(global-name &amp;quot;com.apple.system.DirectoryService.libinfo_v1&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(global-name &amp;quot;com.apple.system.logger&amp;quot;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(global-name &amp;quot;com.apple.system.notification_center&amp;quot;))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Allow mostly harmless operations.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow signal process-info-dirtycontrol process-info-pidinfo&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(target self))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Temporarily allow sysctl-read with reporting to see if this is&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; used for anything.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow (with report) sysctl-read)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; We don&amp;#39;t need to post any darwin notifications.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(deny darwin-notification-post)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; We shouldn&amp;#39;t allow any other file operations not covered under&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; the default of deny above.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(deny file-clone file-link)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Don&amp;#39;t deny file-test-existence: &amp;lt;rdar://problem/59611011&amp;gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; (deny file-test-existence)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Don&amp;#39;t allow access to any IOKit properties.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(deny iokit-get-properties)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(deny mach-cross-domain-lookup)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Don&amp;#39;t allow BlastDoor to spawn any other XPC services other than&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; ones that we can intentionally whitelist later.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(deny mach-lookup (xpc-service-name-regex #&amp;quot;.*&amp;quot;))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Don&amp;#39;t allow any commands on sockets.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(deny socket-ioctl)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Denying this should have no ill effects for our use case.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(deny system-privilege)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; To be uncommented once the system call whitelist is complete...&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; (deny syscall-unix (with send-signal SIGKILL))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow syscall-unix&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_exit)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_kevent_qos)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_kevent_id)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_thread_selfid)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_bsdthread_ctl)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_kdebug_trace64)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_getattrlist)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_sigsuspend_nocancel)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_proc_info)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS___disable_threadsignal)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS___pthread_sigmask)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS___mac_syscall)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS___semwait_signal_nocancel)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_abort_with_payload)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_access)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_bsdthread_create)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_bsdthread_terminate)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_close)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_close_nocancel)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_connect)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_csops_audittoken)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_csrctl)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_fcntl)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_fsgetpath)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_fstat64)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_fstatfs64)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_getdirentries64)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_geteuid)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_getfsstat64)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_getgid)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_getrlimit)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_getuid)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_ioctl)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_issetugid)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_lstat64)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_madvise)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_mmap)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_munmap)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_mprotect)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_mremap_encrypted)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_open)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_open_nocancel)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_openat)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_pathconf)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_pread)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_read)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_readlink)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_shm_open)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_socket)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_stat64)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_statfs64)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_sysctl)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_sysctlbyname)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_workq_kernreturn)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(syscall-number SYS_workq_open)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Still allow the system call but report in log.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow (with report) syscall-unix)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; For validating the entitlements of clients. This is so only entitled&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; clients can pass data into a BlastDoor instance.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow process-info-codesignature)&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;;; -------------------------------------------------------------------------------------------- ;;;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;;; Reading Files&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;;; -------------------------------------------------------------------------------------------- ;;;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; Support for BlastDoor receiving sandbox extensions from clients to either read files, or&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; write to a target location.&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; com.apple.app-sandbox.read&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow file-read*&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(extension &amp;quot;com.apple.app-sandbox.read&amp;quot;))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;;; com.apple.app-sandbox.read-write&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;(allow file-read* file-write*&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(extension &amp;quot;com.apple.app-sandbox.read-write&amp;quot;))&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c0&quot;&gt;&lt;/span&gt;&lt;/p&gt;
 &lt;p class=&quot;c1 c4&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&lt;/span&gt;&lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='https://googleprojectzero.blogspot.com/feeds/405547501763334781/comments/default' title='Post Comments'/><link rel='replies' type='text/html' href='https://googleprojectzero.blogspot.com/2021/01/a-look-at-imessage-in-ios-14.html#comment-form' title='0 Comments'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/4838136820032157985/posts/default/405547501763334781'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/4838136820032157985/posts/default/405547501763334781'/><link rel='alternate' type='text/html' href='https://googleprojectzero.blogspot.com/2021/01/a-look-at-imessage-in-ios-14.html' title='A Look at iMessage in iOS 14'/><author><name>Anonymous</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiWbfjpXKVDVZfZasnzWXN02AH5-A4Nw1229VrO2_FG1otEQSw_r0uRNkB8TedmfA-__gncfPoZ_aa5YE1Ac1_8kzmqKi2Iyj4l47OgN7o9K6Ue8JtRN42XdwHZyBJCg1U26pscYx2ObqwWrouGS9uoZizPZmxvpYwX3PDLanDgdDcOuicfmRwIbRMi/s72-c/image1%282%29.png" height="72" width="72"/><thr:total>0</thr:total></entry>